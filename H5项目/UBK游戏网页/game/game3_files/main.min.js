var __reflect=this&&this.__reflect||function(e,t,i){e.__class__=t,i?i.push(t):i=[t],e.__types__=e.__types__?i.concat(e.__types__):i},__extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),BaseComponent=function(e){function t(){var t=e.call(this)||this;return t.needDisposeMc=!0,t.addEventListener(eui.UIEvent.CREATION_COMPLETE,t.onCreated,t),t.addEventListener(egret.Event.REMOVED_FROM_STAGE,t.dispose,t),t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAdded,t),t.socketListeners=new Array,t}return __extends(t,e),t.prototype.addSocketListener=function(e,t){var i=Game.net.registerServerNotifyResponse(e,t,this);this.socketListeners.push(i)},t.prototype.onAdded=function(){},t.prototype.onCreated=function(){},t.prototype.getMc=function(e,t){return void 0===t&&(t=null),t?t.getChildByName(e):void 0},t.prototype.dispose=function(){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.onCreated,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.dispose,this),this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAdded,this);for(var e=0;e<this.socketListeners.length;e++)Game.net.removeListener(this.socketListeners[e]),delete this.socketListeners[e];this.socketListeners.length=0,this.needDisposeMc&&DisposeHelper.ins.disposeMc(this)},t}(eui.Component);__reflect(BaseComponent.prototype,"BaseComponent");var PreUIBase=function(){function e(){this.arg=null}return e.prototype.start=function(e){void 0===e&&(e=null),this.arg=e,this.startPre()},e.prototype.startPre=function(){throw new Error("Child class should override this function")},e.prototype.finishPre=function(e){UIManager.ins.closePre(this),UIManager.ins.open(e)},e}();__reflect(PreUIBase.prototype,"PreUIBase");var ProtobufData=function(){function e(e,t){this.cmd=e,this.protoBufName=t}return e}();__reflect(ProtobufData.prototype,"ProtobufData");var MapPlayerComponent=function(e){function t(t){var i=e.call(this)||this;i.isTree=!1,i.mapEntityVo=t;var n="PlayerEntitySkin";if(i.mapEntityVo.isMonster){var o=MetaMonsterManager.ins.getMonster(parseInt(i.mapEntityVo.id));i.isTree=1==o.type,i.isTree&&(n="TreeEntitySkin")}else i.mapEntityVo.isSelf&&(n="MajorPlayerEntitySkin");return i.skin=UIUtil.getSkin(n),i.addChild(i.skin),i.colorImg=i.skin.colorImg,i.hpBar=i.skin.hpBar,i.hpBar.slideDuration=200,i.reduceHpBar=i.skin.reduceHpBar,i.reduceHpBar.slideDuration=2200,i.nameLabel=i.skin.nameLabel,EventCenter.ins.add(EventCenter.EQUIP_UPDATE,i.onUpdateEquips,i),i.skin.addEventListener(egret.TouchEvent.TOUCH_TAP,i.onClickPlayer,i),i.addEventListener(egret.Event.ADDED_TO_STAGE,i.onAdded,i),i.addEventListener(egret.Event.REMOVED_FROM_STAGE,i.dispose,i),EventCenter.ins.add(EventCenter.UPDATE_CAMP,i.updateCamp,i),EventCenter.ins.add(EventCenter.BODY_LEVEL_UP,i.updateBody,i),EventCenter.ins.add(EventCenter.GOLD_WEAPON_UPDATE,i.updateMagicWeapon,i),i.isTree||(i.hpBgImg=i.skin.hpBgImg,i.campImg=i.skin.campImg,i.equipGroup=i.skin.equipGroup,i.godWeaponGroup=i.skin.godWeaponGroup),i.mapEntityVo.isSelf||(i.targetLabel=i.skin.targetLabel,i.monsterIconImg=i.skin.monster_icon,i.monsterIconImg&&(i.monsterIconImg.visible=!1)),i.mapEntityVo.isMonster&&!i.isTree&&(i.effectGroup=i.skin.effectGroup),i.updateMapEntityVo(i.mapEntityVo),i}return __extends(t,e),t.prototype.updateCamp=function(){this.mapEntityVo.id==PlayerVoManager.ins.playerVo.id&&(this.campImg.texture=GameUtil.getCampIcon(PlayerVoManager.ins.playerVo.camp))},t.prototype.updateHp=function(e){this.hpBar.value=e,this.reduceHpBar.value=e},t.prototype.showDeath=function(){this.mapEntityVo.isSelf||this.showDeathEffectEnd()},t.prototype.showDeathEffectEnd=function(){UIUtil.removeChildFromParent(this)},t.prototype.onAdded=function(){},t.prototype.dispose=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAdded,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.dispose,this),EventCenter.ins.remove(EventCenter.BODY_LEVEL_UP,this.updateBody,this),EventCenter.ins.remove(EventCenter.GOLD_WEAPON_UPDATE,this.updateMagicWeapon,this),EventCenter.ins.remove(EventCenter.EQUIP_UPDATE,this.onUpdateEquips,this),EventCenter.ins.remove(EventCenter.UPDATE_CAMP,this.updateCamp,this),this.skin.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickPlayer,this)},t.prototype.updateMagicWeapon=function(){this.mapEntityVo.isSelf&&(this.mapEntityVo.magicWeaponMetaId=MagicWeaponVoManager.ins.magicWeaponVo.id,this.updateMagicWeaponView())},t.prototype.updateMagicWeaponView=function(){if(this.mapEntityVo.magicWeaponMetaId){this.godWeaponGroup.visible=!0,UIUtil.dispose(this.godWeaponGroup);var e=MetaMagicWeaponManager.ins.getWeapon(this.mapEntityVo.magicWeaponMetaId);if(e.type<3){var t=new eui.Image;t.source="battle_gold_weapon_"+e.type+"_png",this.godWeaponGroup.addChild(t),t.x=(this.godWeaponGroup.width-300)/2,t.y=(this.godWeaponGroup.height-170)/2,this.mapEntityVo.isSelf?1==e.type?(t.x-=4,t.y+=10):2==e.type&&(t.x-=4,t.y+=10):(t.y-=8,t.x-=2)}else{var i=new DDMovieClip("gold_weapon_effect_"+e.type,-1);this.godWeaponGroup.addChild(i),i.x=this.godWeaponGroup.width/2,i.y=this.godWeaponGroup.height/2,this.mapEntityVo.isSelf?(i.y+=6,9==e.type?i.y-=6:10==e.type||(12==e.type?(i.x-=20,i.y-=6):13==e.type?(i.x-=10,i.y-=18):14==e.type?(i.x-=26,i.y+=2):15==e.type?i.y-=6:16==e.type?i.x-=15:17==e.type&&(i.scaleX=i.scaleY=.94,i.x-=34,i.y-=8))):3==e.type?i.y-=15:4==e.type?i.y-=16:5==e.type?i.y-=10:6==e.type?(i.x-=2,i.y-=10):7==e.type?(i.y-=10,i.x-=8):8==e.type?(i.x-=8,i.y-=10):9==e.type?(i.y-=12,i.x-=6):10==e.type?(i.y-=14,i.x-=4):11==e.type?i.y-=12:12==e.type?(i.x-=15,i.y-=10):13==e.type?(i.x-=10,i.y-=8):14==e.type?(i.x-=26,i.y-=14):15==e.type?(i.x-=10,i.y-=10):16==e.type?(i.x-=10,i.y-=10):17==e.type&&(i.x-=25,i.y-=10)}}else this.godWeaponGroup.visible=!1},t.prototype.updateBody=function(e){if(this.mapEntityVo.isSelf){var t=this.mapEntityVo.body;if(this.mapEntityVo.body=BodyVoMananger.ins.bodyVo.id,t!=this.mapEntityVo.body){var i=MetaBodyManager.ins.getBody(this.mapEntityVo.body);this.colorImg.texture=RES.getRes("entity_player_"+i.color)}}},t.prototype.updateTarget=function(){if(this.mapEntityVo.isMonster){var e=MapEntityVoManager.ins.getMonsterTarget(parseInt(this.mapEntityVo.id));e?(this.targetLabel.visible=!0,this.targetLabel.text=GameUtil.getCampName(e.playerCamp)+"-"+e.playerName):this.targetLabel.visible=!1}},t.prototype.updateMapEntityVo=function(e){if(this.mapEntityVo=e,this.nameLabel.text=this.mapEntityVo.name,this.hpBar.maximum=this.mapEntityVo.maxHp,this.hpBar.value=this.mapEntityVo.hp,this.reduceHpBar.maximum=this.mapEntityVo.maxHp,this.reduceHpBar.value=this.mapEntityVo.hp,this.isTree)return void(this.godWeaponGroup&&(this.godWeaponGroup.visible=!1));var t=this.hpBar.thumb;if(this.mapEntityVo.isMonster){this.godWeaponGroup.visible=!1,this.campImg.visible=!1;var i=MetaMonsterManager.ins.getMonster(parseInt(this.mapEntityVo.id));if(i.type==MonsterType.MONSTER)this.colorImg.texture=RES.getRes("entity_boss_"+i.hpType),t.texture=RES.getRes("entity_boss_"+i.hpType+"_hp"),this.monsterIconImg.visible=!1;else if(MonsterType.TASK_BOSS==i.type){var n=new DDMovieClip("task_monster_effect",-1);this.effectGroup.addChild(n),n.x=8,n.y=n.y-2,this.colorImg.visible=!1,this.monsterIconImg.visible=!1,t.texture=RES.getRes("entity_boss_"+MonsterType.TASK_BOSS+"_hp")}else{var o=GameUtil.checkCanKill(PlayerVoManager.ins.playerVo.fightingForce,PlayerVoManager.ins.playerVo.level,i);o?this.monsterIconImg.visible=!1:(this.monsterIconImg.source="monster_icon_6",this.monsterIconImg.visible=!0),this.colorImg.texture=RES.getRes("entity_boss_"+i.quality),this.colorImg.visible=!0,t.texture=RES.getRes("entity_boss_"+i.quality+"_hp")}return this.redDotImg=this.skin.redDotImg,this.redDotImg.visible=this.mapEntityVo.red,void this.updateTarget()}var r=PlayerVoManager.ins.playerVo,s=MetaBodyManager.ins.getBody(this.mapEntityVo.body);this.colorImg.texture=RES.getRes("entity_player_"+s.color),this.mapEntityVo.isSelf?t.texture=RES.getRes("entity_player_1_hp"):(r.camp==this.mapEntityVo.camp?t.texture=RES.getRes("entity_player_1_hp"):t.texture=RES.getRes("entity_player_2_hp"),Game.isKuaFu&&Game.mapId!=GameUtil.getTaoYuanId()&&(this.mapEntityVo.camp!=r.camp?this.nameLabel.text=GameUtil.getCampName(this.mapEntityVo.camp)+"国":this.nameLabel.text=this.mapEntityVo.name)),this.campImg.texture=GameUtil.getCampIcon(this.mapEntityVo.camp),this.updateEquip(),this.updateMagicWeaponView()},t.prototype.onUpdateEquips=function(){if(this.mapEntityVo.isSelf){if(!VoUtil.checkFunctionOpen(FunctionId.EQUIP))return;this.mapEntityVo.equipId=EquipVoMananger.ins.getMaxQuality(),this.updateEquip()}},t.prototype.updateEquip=function(){if(UIUtil.dispose(this.equipGroup),0!=this.mapEntityVo.equipId){var e=new MapPlayerEquipComponent;e.updateEquip(this.mapEntityVo.equipId),this.equipGroup.addChild(e)}},t.prototype.showSelected=function(e){if(e){var t=new egret.GlowFilter(16711680,1,4,4);this.colorImg.filters=[t]}else this.colorImg.filters=null},t.prototype.onClickPlayer=function(){},t}(egret.DisplayObjectContainer);__reflect(MapPlayerComponent.prototype,"MapPlayerComponent");var BookCmd=function(){function e(){}return e.ENTER_SEREVER=1,e.CREATE_ROLE=2,e.GM_ORDER=3,e.GET_MAP_LIST=4,e.ENTER_MAP=5,e.RESPONSE_PLAYER_ENTER_OR_LEAVE_MAP=6,e.ATTACK_OTHER_ENTITY=7,e.RESPONSE_ENTITY_ATTACK=8,e.RESPONSE_UNIT_DIE=9,e.RESPONSE_MONSTER_RELIVE=10,e.GET_OFFICER_LIST=11,e.EQUIP_ONE_OFFICER=12,e.EQUIP_OFFICERS=13,e.LEVEL_UP_ONE_OFFICER=14,e.LEVEL_UP_ALL_OFFICER=15,e.RESPONSE_EVENT_DATA=16,e.GET_EQUIPE_LIST=17,e.EQUIP_EQUIP=18,e.LEVEL_UP_ONE_EUQIP_PART=19,e.LEVEL_UP_ALL_EUQIP_PARTS=20,e.LEVEL_UP_BODY=22,e.BODY_BUY=23,e.GET_MERIDIAN=24,e.MERIDIAN_LEVEL_UP=25,e.GET_QIECUO=26,e.QIECUO_DO=27,e.HOUJIN_PANEL=28,e.HOUJIN_BUY=29,e.HOUJIN_EXCHANGE_LEVEL=30,e.HOUJIN_UPGRADE=31,e.COUNTRY_PANEL=32,e.COUNTRY_CHANGE_RESULT=33,e.SHOP_PANEL=34,e.SHOP_DRAW_CARD=35,e.SHOP_EXCHANGE_SILVER=36,e.RENOWN_RESULT=37,e.MAIL_PANEL=38,e.MAIL_DEL=39,e.MAIL_GET_REWARD=40,e.CHAT_COMMON=41,e.CHAT_CAMP=42,e.CHAT_WORLD=43,e.CHAT_PRIVATE=44,e.FIGHT_DROP=45,e.PLAYER_INFO_PANEL=46,e.TONG_TIAN_TA_PANEL=47,e.TONG_TIAN_TA_ONE_KEY=48,e.MAGIC_WEAPON_PANEL=49,e.MAGIC_WEAPON_LEVEL_UP=50,e.HUFU_BUY=51,e.RANKE_PANEL=52,e.COMMON_MAP_RESULT=53,e.OFFLINE_BEGIN=54,e.OFFLINE_PANE=55,e.GUIDE_SAVE_STEP=56,e.DAY_PANEL=57,e.DAY_SIGN_OR_RECHARGE=58,e.MONTH_CARD_PANEL=59,e.MONTH_CARD_GET_REWARD=60,e.LI_BAO_GET=61,e.SHARE_GET=62,e.GO_AWAY=63,e.MONSTER_TARGET=64,e.MAGIC_WEAPON_BUY=65,e.SIX_PROPERTY=66,e.BOOK_PANEL=67,e.BOOK_PANEL_BOOK=68,e.EQUIP_BUY_PROP=69,e.KUA_FU_PANEL=70,e.KUA_FU_ENTER=71,e.KUA_FU_OUT=72,e.MAP_CAPACITY_DROP=73,e.PLAT_SHENGTIAN_PAY=74,e.PLAT_RECHARGE_RESULT=75,e.PLAT_1758_PRE_RECHARGE=76,e.SHARE_PANEL=77,e.FIRST_RECHARGE_PANEL=81,e.FIRST_RECHARGE_GET_REWARD=82,e.DAY_FIRST_RECHARGE_PANEL=83,e.DAY_FIRST_RECHARGE_GET_REWARD=84,e.DAY_RECHARGE_PANEL=85,e.DAY_RECHARGE_GET_REWARD=86,e.PING=87,e.PLAT_33733_PRE_RECHARGET=88,e.PLAT_GET_RECHARGE_ORDER=89,e.SHARE_GET_REWARD=90,e.SHARE_GET_INVATED_REWARD=91,e.FOLLOW_GET_REWARD=92,e.NEWBIE_WELFARE_ORDER=93,e.GET_NEWBIE_WELFARE_ORDER=94,e.PLAT_WANBA_PAY=95,e.PLAT_WANBA_GET_XINGBI=96,e.PLAT_WANBA_GET_SHORT_CUT_REWARD=97,e.PLAT_SHENGTINA_IOS_PAY=99,e.CHECK_RED_POINT=98,e.OFF_LINE_TYPE=100,e.RED_POINT_UPDATE=101,e.ACITVITY_PANEL=102,e}();__reflect(BookCmd.prototype,"BookCmd");var BaseCount=function(){function e(){}return e.prototype.init=function(e){},e.prototype.joinGame=function(e){},e.prototype.leaveGame=function(e){},e.prototype.playerAccountName=function(e){},e.prototype.playerAccountType=function(e){},e.prototype.playerGender=function(e){},e.prototype.playerAge=function(e){},e.prototype.gameServer=function(e){},e.prototype.playerLevel=function(e){},e.prototype.payRequest=function(e){},e.prototype.paySuccess=function(e){},e.prototype.guideFinish=function(e){},e.prototype.onReward=function(e){},e.prototype.onItemPurchase=function(e){},e.prototype.onItemUse=function(e){},e.prototype.onMissionBegin=function(e){},e.prototype.onMissionCompleted=function(e){},e.prototype.onMissionFailed=function(e){},e.prototype.onEvent=function(e){},e}();__reflect(BaseCount.prototype,"BaseCount");var BaseScene=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddedToStage,t),t.addEventListener(egret.Event.REMOVED_FROM_STAGE,t.onRemovedFromStage,t),t.socketListeners=new Array,t}return __extends(t,e),t.prototype.addSocketListener=function(e,t){for(var i=Game.net.registerServerNotifyResponse(e,t,this),n=0,o=this.socketListeners.length;o>n;n++)if(i==this.socketListeners[n])return;this.socketListeners.push(i)},t.prototype.getMc=function(e,t){return void 0===t&&(t=null),t?t[e]:this.skin[e]},t.prototype.onAddedToStage=function(e){this.onAdded()},t.prototype.onAdded=function(){this.createSkin()},t.prototype.createSkin=function(){this.skin=UIUtil.getSkin(this.skinName),this.addChild(this.skin)},t.prototype.onRemovedFromStage=function(e){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddedToStage,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemovedFromStage,this),this.dispose()},t.prototype.dispose=function(){for(var e=0;e<this.socketListeners.length;e++)Game.net.removeListener(this.socketListeners[e]),delete this.socketListeners[e];this.socketListeners.length=0,DisposeHelper.ins.disposeMc(this)},t}(egret.DisplayObjectContainer);__reflect(BaseScene.prototype,"BaseScene");var BaseScenePre=function(){function e(){this.arg=null}return e.prototype.start=function(e){void 0===e&&(e=null),this.arg=e,this.startPre()},e.prototype.startPre=function(){throw new Error("Child class should override this function")},e.prototype.finishPre=function(e){this.newScene=e,egret.callLater(function(){SceneManager.ins.changeScene(this.newScene)},this)},e}();__reflect(BaseScenePre.prototype,"BaseScenePre");var BaseSkin=function(){function e(e,t){void 0===t&&(t=null),this.skin=e,this.argObj=t,this.onAdded()}return e.prototype.onAdded=function(){},e.prototype.getMc=function(e,t){return void 0===t&&(t=null),t?t[e]?t[e]:t.getChildByName(e):this.skin[e]?this.skin[e]:void 0},e.prototype.setVisible=function(e){this.skin&&(this.skin.visible=e)},Object.defineProperty(e.prototype,"visible",{get:function(){return this.skin?this.skin.visible:void 0},set:function(e){this.skin&&(this.skin.visible=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this.skin.x},set:function(e){this.skin.x=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.skin.y},set:function(e){this.skin.y=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.skin.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.skin.height},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){DisposeHelper.ins.disposeMc(this.skin)},e}();__reflect(BaseSkin.prototype,"BaseSkin");var BaseUI=function(e){function t(t){void 0===t&&(t=.5);var i=e.call(this)||this;return i.hasOpenEffect=!0,i.hasCloseEffect=!0,i.bgAlpha=.5,i.bgAlpha=t,i.hasCloseEffect=!1,i.addEventListener(egret.Event.ADDED_TO_STAGE,i.onAddedToStage,i),i.addEventListener(egret.Event.REMOVED_FROM_STAGE,i.onRemovedFromStage,i),i}return __extends(t,e),t.prototype.onAddedToStage=function(e){this.blockBgSpr=new egret.Sprite,this.addChild(this.blockBgSpr),this.blockBgSpr.graphics.beginFill(0,this.bgAlpha),this.blockBgSpr.graphics.drawRect(0,0,Game.stage.stageWidth,Game.stage.stageHeight),this.blockBgSpr.graphics.endFill(),this.blockBgSpr.touchEnabled=!0,this.blockBgSpr.visible=!1,this.blockBgSpr.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.onAdded()},t.prototype.onAdded=function(){this.createSkin(),this.closeBtn=UIUtil.getButton("closeBtn",this.skin,this.onClose,this)},t.prototype.getMc=function(e,t){return void 0===t&&(t=null),t?t[e]?t[e]:t.getChildByName(e):this.skin[e]?this.skin[e]:void 0},t.prototype.createSkin=function(){this.skin=UIUtil.getSkin(this.skinName),this.addChild(this.skin)},t.prototype.show=function(){this.hasOpenEffect?(this.scaleX=this.scaleY=.85,this.alpha=0,TweenMax.to(this,.1,{scaleX:1,scaleY:1,alpha:1,onComplete:this.onShowEnd,onCompleteScope:this})):this.onShowEnd()},t.prototype.onShowEnd=function(){this.blockBgSpr.visible=!0},t.prototype.close=function(){this.hasCloseEffect?(this.blockBgSpr.visible=!1,TweenMax.to(this,.1,{alpha:0,onComplete:this.onCloseEnd,onCompleteScope:this})):this.onCloseEnd()},t.prototype.onCloseEnd=function(){UIUtil.removeChildFromParent(this)},t.prototype.onRemovedFromStage=function(e){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddedToStage,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemovedFromStage,this),this.dispose()},t.prototype.onClose=function(){UIManager.ins.close(this)},t.prototype.dispose=function(){DisposeHelper.ins.disposeMc(this),this.closeBtn&&this.closeBtn.dispose(),this.closeBtn=null,this.blockBgSpr.graphics.clear(),this.blockBgSpr.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.blockBgSpr=null,this.skin&&this.removeChild(this.skin),this.skin=null,TweenMax.killTweensOf(this)},t}(egret.DisplayObjectContainer);__reflect(BaseUI.prototype,"BaseUI");var MainResLoading=function(e){function t(){var t=e.call(this)||this;return t.callBack=null,t.timerIndex=4,t.isResourceLoadEnd=!1,t.skinName="resource/skins/loading/main/MainResLoadingSkin.exml",t.initDesArr(),t.addEventListener(egret.Event.REMOVED_FROM_STAGE,t.onRemoved,t),TimerManager.ins.addTimer(t),t.runTimer(),t}return __extends(t,e),t.prototype.initDesArr=function(){this.desArr=["每日进入游戏可在签到处领取奖励，在藏宝还可以免费抽卡","进入游戏前7天每日可以领取豪华奖励","升级神兵能快速提升战力，通过打BOSS收集战意升级神兵","武将卡可以通过击杀城池BOSS收集，增加战斗力","根据武将羁绊可以产生更强的战斗力","宝物不但能增加战斗力，还能增加武将技能的触发几率","天书能增加战斗力，合成之后才会有效","切磋产生的臂力和根骨能大幅增加战斗力并且对PVP有很大作用","厚劲影响击杀BOSS的掉落，等级越高掉落越好","虎符影响是否掉落，没有虎符时可以去闭关爬塔","国家里的城池是安全图，最好跟其他玩家一起","藏宝里可以免费单抽和十连抽，并且还可以获取大量经验","经脉对PVP有很大影响，通过击杀BOSS升级","在角色信息页面，可以看到您当前的各个属性"]},t.prototype.runTimer=function(){if(this.timerIndex>3){0==this.desArr.length&&this.initDesArr();var e=Math.floor(Math.random()*this.desArr.length),t=this.desArr[e];this.desLabel.text=t,this.timerIndex=0}this.timerIndex++},t.prototype.onRemoved=function(e){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this),DisposeHelper.ins.disposeMc(this),TimerManager.ins.removeTimer(this),this.loadingBar.dispose(),this.loadingBar=null},t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.loadingBar=new ResLoadingBarComponent(this.progressBar),this.logoImg.source=GamePlatform.ins.getLogoName()+"_png"},t.prototype.loadReses=function(e,t){if(this.callBack=t,this.groupName=e,RES.isGroupLoaded(e))return void this.createScene();RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this);var i=RES.getGroupByName(e);this.loadingBar.minimum=0,this.loadingBar.maximum=i.length,RES.loadGroup(e)},t.prototype.onResourceLoadComplete=function(e){RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this);for(var t=RES.getGroupByName(this.groupName),i=0,n=t.length;n>i;i++){var o=t[i];log("itemName:"+o.name),DisposeHelper.ins.addNoNeedDisposeResPackName(o.name)}DisposeHelper.ins.addNoNeedDisposeResName("ui_normal_bg_png"),DisposeHelper.ins.addNoNeedDisposeResName("ui_bg_png"),DisposeHelper.ins.addNoNeedDisposeResName("map_jpg"),DisposeHelper.ins.addNoNeedDisposeResPackName("mapCity_json"),this.createScene()},t.prototype.createScene=function(){this.progressLabel.text="正在进入主场景...",UIUtil.removeChildFromParent(this),this.callBack&&this.callBack.call(this)},t.prototype.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},t.prototype.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},t.prototype.onResourceProgress=function(e){var t=e.itemsLoaded/e.itemsTotal*100;this.progressLabel.text=t.toFixed(0)+"%",this.loadingBar.value=e.itemsLoaded},t.loadReses=function(e,i){var n=new t;Game.loadingContainer.addChild(n),n.loadReses(e,i)},t}(eui.Component);__reflect(MainResLoading.prototype,"MainResLoading",["ITimer"]);var BaseDataHandler=function(){function e(){}return e}();__reflect(BaseDataHandler.prototype,"BaseDataHandler");var ZipRes=function(){function e(){}return e.initialze=function(){e.config=new JSZip(RES.getRes(Global.ZIP_CONFIG_DATA))},e.getProto=function(){return e.config.file(Global.PROTO_FILE_NAME).asText()},e.getConfig=function(t){return JSON.parse(e.config.file(t).asText())},e.getContent=function(t){return e.config.file(t).asText()},e.dispose=function(){e.config.remove(Global.ZIP_CONFIG_DATA),e.config.remove(Global.PROTO_FILE_NAME),e.config=null},e}();__reflect(ZipRes.prototype,"ZipRes");var MetaDataInitHelper=function(){function e(){}return e.initialize=function(){this.isInited||(this.isInited=!0,MetaConfigManager.ins.fromJson(ZipRes.getConfig("config.json")),MetaExpManager.ins.fromJson(ZipRes.getConfig("lv.json")),MetaFunctionOpenManager.ins.fromJson(ZipRes.getConfig("func_open.json")),MetaHuFuShopManager.ins.fromJson(ZipRes.getConfig("hufu_shop.json")),MetaShopManager.ins.initCard(ZipRes.getConfig("card.json")),MetaShopManager.ins.initDraw(ZipRes.getConfig("draw.json")),MetaShopManager.ins.initGold(ZipRes.getConfig("recharge.json")),MetaShopManager.ins.initSilver(ZipRes.getConfig("gold.json")),MetaDayManager.ins.fromJson(ZipRes.getConfig("recharge_total.json")),MetaTaskManager.ins.fromJson(ZipRes.getConfig("task.json")),MetaRoleManager.ins.fromJson(ZipRes.getConfig("role.json")),MetaHozaManager.ins.fromJson(ZipRes.getConfig("houjin.json")),MetaHozaShopManager.ins.fromJson(ZipRes.getConfig("houjin_shop.json")),MetaMeridianManager.ins.fromJson(ZipRes.getConfig("meridian.json")),MetaQieCuoManager.ins.fromJson(ZipRes.getConfig("qiecuo.json")),MetaBodyManager.ins.fromJson(ZipRes.getConfig("body.json")),MetaBodyShopManager.ins.fromJson(ZipRes.getConfig("body_shop.json")),MetaRenownManager.ins.fromJson(ZipRes.getConfig("renown.json")),MetaPropMananger.ins.fromJson(ZipRes.getConfig("prop.json")),MetaEquipIntensifyManager.ins.fromJson(ZipRes.getConfig("equip_lv.json")),MetaEquipManager.ins.fromJson(ZipRes.getConfig("equip.json")),MetaDropManager.ins.fromJson(ZipRes.getConfig("drop.json")),MetaOfficerManager.ins.fromJson(ZipRes.getConfig("hero.json")),MetaOfficerFetterManager.ins.fromJson(ZipRes.getConfig("hero_fetter.json")),MetaMapManager.ins.fromJson(ZipRes.getConfig("map.json")),MetaMonsterManager.ins.fromJson(ZipRes.getConfig("monster.json")),MetaRandomNameManager.ins.init(ZipRes.getConfig("randomName.json")),MetaSkillManager.ins.fromJson(ZipRes.getConfig("skill.json")),MetaSkillBuffManager.ins.fromJson(ZipRes.getConfig("skillBuff.json")),MetaMagicWeaponManager.ins.fromJson(ZipRes.getConfig("equip_god.json")),MetaPingBiManager.ins.fromJson(ZipRes.getContent("pingbi.txt")),MetaTianShuManager.ins.fromJson(ZipRes.getConfig("book.json")),MetaEquipShopGoodsManager.ins.fromJson(ZipRes.getConfig("equip_lv_shop.json")),MetaRecharRewardManager.ins.fromJson(ZipRes.getConfig("recharge_reward.json")),MetaTimingManager.ins.fromJson(ZipRes.getConfig("timing.json")))},e.isInited=!1,e}();__reflect(MetaDataInitHelper.prototype,"MetaDataInitHelper");var MetaBody=function(){function e(){}return e.prototype.fromJson=function(e){this.id=e.id,this.color=e.frame,this.colorRes=e.frame_pic,this.star=e.star,this.needHeroCount=e.need_hero,this.attack=e.attack,this.defence=e.def,this.hp=e.hp},e}();__reflect(MetaBody.prototype,"MetaBody");var MetaBodyManager=function(){function e(){this.maxLevel=0,this.bodys=new Array}return Object.defineProperty(e,"ins",{get:function(){return null==this.mInstance&&(this.mInstance=new e),this.mInstance},enumerable:!0,configurable:!0}),e.prototype.fromJson=function(e){this.maxLevel=e.length;for(var t=null,i=0,n=e.length;n>i;i++)t=new MetaBody,t.fromJson(e[i]),this.bodys.push(t);Game.BODY_MAX_ID=t.id},e.prototype.getBody=function(e){for(var t,i=0,n=this.bodys.length;n>i;i++)if(t=this.bodys[i],t.id==e)return t;return null},e.prototype.getNextLevelBody=function(e){var t=this.getBody(e),i=t.color,n=t.star;return n==Game.BODY_MAX_STAR?(i+=1,n=1):n+=1,this.getMetaBody(i,n)},e.prototype.getMetaBody=function(e,t){for(var i,n=0,o=this.bodys.length;o>n;n++)if(i=this.bodys[n],i.color==e&&i.star==t)return i;return null},e.mInstance=null,e}();__reflect(MetaBodyManager.prototype,"MetaBodyManager");var MetaBodyShop=function(){function e(){this.id=0,this.pic="",this.name="",this.cost=0,this.zhanyi=0}return e.prototype.fromJson=function(e){this.id=e.id,this.pic=e.pic,this.name=e.name,this.cost=e.cost,this.zhanyi=e.zhanyi},e}();__reflect(MetaBodyShop.prototype,"MetaBodyShop");var MetaBodyShopManager=function(){function e(){this.shops=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromJson=function(e){for(var t=0,i=e.length;i>t;t++){var n=new MetaBodyShop;n.fromJson(e[t]),this.shops.push(n)}},e.prototype.getShop=function(e){for(var t=0,i=this.shops.length;i>t;t++){var n=this.shops[t];if(n.id==e)return n}return null},e._ins=null,e}();__reflect(MetaBodyShopManager.prototype,"MetaBodyShopManager");var MetaConfig=function(){function e(){}return e.prototype.fromJson=function(e){this.value1=e.v,this.value2=e.v2},e.prototype.getValue=function(){return""!=this.value2&&"undefined"!=typeof this.value2?this.value2:this.value1},e.prototype.getValueForAll=function(){return{value1:this.value1,value2:this.value2}},e}();__reflect(MetaConfig.prototype,"MetaConfig");var MetaConfigManager=function(){function e(){this.configDic={},this.errorConfig=new MetaErrorConfig}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromJson=function(e){for(var t,i=e.length,n=0;i>n;n++)t=new MetaConfig,t.fromJson(e[n]),this.configDic[e[n].k]=t;Game.COUNTRY_CHANGE_TIME=this.getConfig("country_cd"),Game.COUNTRY_CHANGE_GOLD=this.getConfig("country_cost"),Game.HUFU_ADD_TIME=this.getConfig("hufu_add_time"),Game.HUFU_MAX_COUNT=this.getConfig("limit_hufu"),Game.BIRTH_MAP_ID=this.getConfig("born_map"),Game.KUAFU_BIRTH_MAP_ID=this.getConfig("kf_born_map"),Game.SHOW_BOSS_LEVEL=this.getConfig("share_drop");var o=this.getConfig("kf_condition"),r=o.split("|");Game.KUA_FU_PLAYER_LEVEL=parseInt(r[0]),Game.KUA_FU_BODY_LEVEL=parseInt(r[1]),Game.KUA_FU_HOZA_LEVEL=parseInt(r[2])},e.prototype.getConfig=function(e){var t=this.configDic[e];return t.getValue()},e.prototype.getConfigForAll=function(e){var t=this.configDic[e];return t.getValueForAll()},e.prototype.getError=function(e){return this.errorConfig.getError(e)},e._ins=null,e}();__reflect(MetaConfigManager.prototype,"MetaConfigManager");var MetaErrorConfig=function(){function e(){this.errorDic=new Object,this.init()}return e.prototype.getError=function(e){return this.errorDic.hasOwnProperty("error_"+e)?this.errorDic["error_"+e]:"错误码:"+e+",未知错误!"},e.prototype.init=function(){this.add(1,"参数错误"),this.add(2,"用户已存在"),this.add(3,"名称已存在"),this.add(4,"等级不足"),this.add(5,"资源不足"),this.add(6,"已达到最大等级"),this.add(7,"战意不足"),this.add(8,"元宝不足"),this.add(9,"修为不足"),this.add(10,"银币不足"),this.add(11,"次数不足"),this.add(12,"CD中"),this.add(13,"礼品码不存在!"),this.add(14,"礼品码已经使用过!"),this.add(15,"没开放!"),this.add(16,"您已经被封号!"),this.add(17,"您已经被禁言!"),this.add(19,"眩晕中")},e.prototype.add=function(e,t){this.errorDic["error_"+e]=t},e}();__reflect(MetaErrorConfig.prototype,"MetaErrorConfig");var MetaDay=function(){function e(){this.id=0,this.type=1,this.needDay=0,this.rechargeTotal=0,this.rewardType=0,this.rewardCount=0,this.rewardOfficerCount=0,this.rewardOfficerType=0}return e.prototype.fromJson=function(e){this.id=e.id,this.type=e.type,this.needDay=e.day,this.rechargeTotal=e.recharge_total;var t=e.reward;if(""!=t){var i=t.split(":");this.rewardType=parseInt(i[0]),this.rewardCount=parseInt(i[1])}var n=e.reward_card;if(""!=n){var o=n.split(":");3==this.type&&(this.rewardOfficerType=parseInt(o[0])),this.rewardOfficerCount=parseInt(o[1])}this.pic=e.pic},e}();__reflect(MetaDay.prototype,"MetaDay");var MetaDayManager=function(){function e(){this.days=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromJson=function(e){for(var t=0,i=e.length;i>t;t++){var n=new MetaDay;n.fromJson(e[t]),this.days.push(n)}},e.prototype.getDay=function(e){for(var t=0,i=this.days.length;i>t;t++)if(this.days[t].id==e)return this.days[t];return null},e.prototype.getDaysForType=function(e){for(var t=new Array,i=0,n=this.days.length;n>i;i++)this.days[i].type==e&&t.push(this.days[i]);return t},e._ins=null,e}();__reflect(MetaDayManager.prototype,"MetaDayManager");var MetaDrop=function(){function e(){this.dropCount=0}return e.prototype.fromJson=function(e){this.id=e.id,this.groupId=e.group_id,this.type=e.type,this.dropType=e.drop_id,this.dropId=e.prop_id,this.dropCount=e.drop_num,this.weight=e.weight,this.needHozaLevel=e.need_state,this.needLevel=e.need_level,this.forceDrop=e.force_drop},e}();__reflect(MetaDrop.prototype,"MetaDrop");var MetaDropManager=function(){function e(){this.drops=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromJson=function(e){for(var t=e.length,i=0;t>i;i++){var n=new MetaDrop;n.fromJson(e[i]),this.drops.push(n)}},e.prototype.getDropsForGroup=function(e){for(var t=new Array,i=this.drops.length,n=0;i>n;n++)this.drops[n].groupId==e&&t.push(this.drops[n]);return t},e.prototype.getDrop=function(e){for(var t=this.drops.length,i=0;t>i;i++)if(this.drops[i].id==e)return this.drops[i];return null},e.prototype.getDropsForType=function(e,t){for(var i,n=new Array,o=this.getDropsForGroup(e),r=0;r<o.length;r++)i=o[r],i.dropType==t&&n.push({dropId:i.dropId,hozaLevel:i.needHozaLevel});return n},e.prototype.getDropForHoza=function(e,t){var i=this.getDropsForGroup(e);i.sort(GameUtil.sortHozaDrops);for(var n,o=i.length-1;o>=0;o--)if(n=i[o],n.needHozaLevel>=t)return n;return null},e.prototype.getWillOpenDrop=function(e,t,i){for(var n,o=this.getDropsForGroup(e),r=null,s=0;s<o.length;s++){if(n=o[s],t<n.needHozaLevel){r=new WillDropInfo,r.metaDropId=n.id,r.needType=1,r.needLevel=n.needHozaLevel;break}if(i<n.needLevel){r=new WillDropInfo,r.metaDropId=n.id,r.needType=2,r.needLevel=n.needLevel;break}}return r},e._ins=null,e}();__reflect(MetaDropManager.prototype,"MetaDropManager");var WillDropInfo=function(){function e(){}return e}();__reflect(WillDropInfo.prototype,"WillDropInfo");var MetaEquip=function(){function e(){this.hand=0,this.foot=0}return e.prototype.fromJson=function(e){this.id=e.id,this.name=e.equip_name,this.maxCount=e.broken_max,this.part=e.equip_type,this.color=e.quality,this.attack=e.attack,this.defence=e.defense,this.hp=e.hp,this.dodge=e.dodge,this.head=e.head,this.hand=e.hand,this.foot=e.foot,this.force=e.force,this.fly=e.fly,this.pre=e.pre,this.effect_type=e.effect_type,this.effect=e.effect},e}();__reflect(MetaEquip.prototype,"MetaEquip");
var MetaEquipManager=function(){function e(){this.equips=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromJson=function(e){for(var t=e.length,i=0;t>i;i++){var n=new MetaEquip;n.fromJson(e[i]),this.equips.push(n)}},e.prototype.getEquip=function(e){for(var t=this.equips.length,i=0;t>i;i++)if(this.equips[i].id==e)return this.equips[i];return null},e.prototype.getEquipsForTypeColor=function(e,t){for(var i=new Array,n=0,o=this.equips.length;o>n;n++){var r=this.equips[n];r.part==e&&r.color==t&&i.push(r)}return i},e.prototype.getEquipsForPart=function(e){for(var t=new Array,i=0,n=this.equips.length;n>i;i++){var o=this.equips[i];o.part==e&&t.push(o)}return t},e._ins=null,e}();__reflect(MetaEquipManager.prototype,"MetaEquipManager");var MetaEquipShopGoods=function(){function e(){}return e.prototype.fromJson=function(e){this.id=e.id,this.propId=e.prop_id,this.name=e.name,this.gold=e.cost,this.propType=e.prop_type,this.count=e.number},e}();__reflect(MetaEquipShopGoods.prototype,"MetaEquipShopGoods");var MetaEquipShopGoodsManager=function(){function e(){this.goods=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromJson=function(e){for(var t=0,i=e.length;i>t;t++){var n=new MetaEquipShopGoods;n.fromJson(e[t]),this.goods.push(n)}},e.prototype.getGoods=function(e){for(var t=0,i=this.goods.length;i>t;t++){var n=this.goods[t];if(n.id==e)return n}return null},e.prototype.getGoodsForType=function(e){for(var t=new Array,i=0,n=this.goods.length;n>i;i++){var o=this.goods[i];o.propType==e&&t.push(o)}return t},e._ins=null,e}();__reflect(MetaEquipShopGoodsManager.prototype,"MetaEquipShopGoodsManager");var MetaEquipIntensify=function(){function e(){}return e.prototype.fromJson=function(e){this.id=e.id,this.part=e.equip_type,this.level=e.equip_lv,this.needExp=e.exp,this.attack=e.attack,this.defence=e.defense,this.hp=e.hp},e}();__reflect(MetaEquipIntensify.prototype,"MetaEquipIntensify");var MetaEquipIntensifyManager=function(){function e(){this.equipIntensifys=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromJson=function(e){for(var t=e.length,i=0;t>i;i++){var n=new MetaEquipIntensify;n.fromJson(e[i]),this.equipIntensifys.push(n)}},e.prototype.getEquipIntensifyForPart=function(e,t){t=Math.min(Game.EQUIP_PART_MAX_LEVEL,t);for(var i,n=this.equipIntensifys.length,o=0;n>o;o++)if(i=this.equipIntensifys[o],i.part==e&&i.level==t)return i;return null},e.prototype.getEquipPropertyAdd=function(e,t,i){var n=this.getEquipIntensifyForPart(e,t);if(!n)return 1;var o=1;switch(i){case PropertyType.ATTACK:o=n.attack;break;case PropertyType.DEFENCE:o=n.defence;break;case PropertyType.HP:o=n.hp}return 0==o?o=1:o/=100,o},e._ins=null,e}();__reflect(MetaEquipIntensifyManager.prototype,"MetaEquipIntensifyManager");var MetaExp=function(){function e(){}return e.prototype.fromJson=function(e){this.level=e.id,this.exp=e.exp},e}();__reflect(MetaExp.prototype,"MetaExp");var MetaExpManager=function(){function e(){this.maxLevel=0,this.exps=new Array}return Object.defineProperty(e,"ins",{get:function(){return null==this.mInstance&&(this.mInstance=new e),this.mInstance},enumerable:!0,configurable:!0}),e.prototype.fromJson=function(e){this.maxLevel=e.length;for(var t=0,i=e.length;i>t;t++){var n=new MetaExp;n.fromJson(e[t]),this.exps.push(n)}},e.prototype.getMetaExpByLevel=function(e){for(var t=0,i=this.exps.length;i>t;t++)if(this.exps[t].level==e)return this.exps[t];return null},e.mInstance=null,e}();__reflect(MetaExpManager.prototype,"MetaExpManager");var MetaFunctionOpen=function(){function e(){}return e.prototype.fromJson=function(e){this.id=e.id,this.functionId=e.func_ID,this.functionName=e.func_name,this.openLevel=e.func_lv},e}();__reflect(MetaFunctionOpen.prototype,"MetaFunctionOpen");var MetaFunctionOpenManager=function(){function e(){this.opens=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromJson=function(e){for(var t=0,i=e.length;i>t;t++){var n=new MetaFunctionOpen;n.fromJson(e[t]),this.opens.push(n)}},e.prototype.getOpenForFunctionId=function(e){for(var t=0,i=this.opens.length;i>t;t++)if(this.opens[t].functionId==e)return this.opens[t];return null},e.prototype.getOpensForLevel=function(e){for(var t=new Array,i=0,n=this.opens.length;n>i;i++)this.opens[i].openLevel==e&&t.push(this.opens[i]);return t},e._ins=null,e}();__reflect(MetaFunctionOpenManager.prototype,"MetaFunctionOpenManager");var MetaHoza=function(){function e(){}return e.prototype.fromJson=function(e){this.id=e.id,this.name=e.name,this.needLevel=e.need_lv,this.cost=e.cost},e}();__reflect(MetaHoza.prototype,"MetaHoza");var MetaHozaManager=function(){function e(){this.hozas=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromJson=function(t){var i=t.length;e.maxLevel=i;for(var n=0;i>n;n++){var o=new MetaHoza;o.fromJson(t[n]),this.hozas.push(o)}},e.prototype.getHoza=function(e){for(var t=this.hozas.length,i=0;t>i;i++)if(this.hozas[i].id==e)return this.hozas[i];return null},e._ins=null,e.maxLevel=0,e}();__reflect(MetaHozaManager.prototype,"MetaHozaManager");var MetaHozaShop=function(){function e(){}return e.prototype.fromJson=function(e){this.id=e.id,this.pic=e.pic,this.name=e.name,this.cost=e.cost,this.zhanyi=e.xuedian,this.limitCount=e.times},e}();__reflect(MetaHozaShop.prototype,"MetaHozaShop");var MetaHozaShopManager=function(){function e(){this.shops=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromJson=function(t){var i=t.length;e.maxLevel=i;for(var n=0;i>n;n++){var o=new MetaHozaShop;o.fromJson(t[n]),this.shops.push(o)}},e.prototype.getShop=function(e){for(var t=this.shops.length,i=0;t>i;i++)if(this.shops[i].id==e)return this.shops[i];return null},e._ins=null,e.maxLevel=0,e}();__reflect(MetaHozaShopManager.prototype,"MetaHozaShopManager");var MetaHuFuShop=function(){function e(){}return e.prototype.fromJson=function(e){this.id=e.id,this.gold=e.cost,this.count=e.hufu,this.icon=e.pic},e}();__reflect(MetaHuFuShop.prototype,"MetaHuFuShop");var MetaHuFuShopManager=function(){function e(){this.hufus=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromJson=function(e){for(var t=0,i=e.length;i>t;t++){var n=new MetaHuFuShop;n.fromJson(e[t]),this.hufus.push(n)}},e.prototype.getHuFu=function(e){for(var t=0,i=this.hufus.length;i>t;t++)if(this.hufus[t].id==e)return this.hufus[t];return null},e._ins=null,e}();__reflect(MetaHuFuShopManager.prototype,"MetaHuFuShopManager");var MetaItem=function(){function e(){}return e.prototype.fromJson=function(e){this.id=e.id,this.bigType=e.bigType,this.type=e.type,this.name=e.name},e}();__reflect(MetaItem.prototype,"MetaItem");var MetaItemManager=function(){function e(){this.items=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromJson=function(e){for(var t=e.length,i=0;t>i;i++){var n=new MetaItem;n.fromJson(e[i]),this.items.push(n)}},e.prototype.getItemsForType=function(e){for(var t=new Array,i=this.items.length,n=0;i>n;n++)this.items[n].bigType==e&&t.push(this.items[n]);return t},e.prototype.getItem=function(e){for(var t=this.items.length,i=0;t>i;i++)if(this.items[i].id==e)return this.items[i];return null},e._ins=null,e}();__reflect(MetaItemManager.prototype,"MetaItemManager");var MetaMagicWeapon=function(){function e(){this.delZhanyiCD=0}return e.prototype.fromJson=function(e){this.id=e.id,this.type=e.god_type,this.name=e.god_name,this.star=e.star,this.needZhanyi=e.need_zhanyi,this.attack=e.attack,this.crit=e.crit,this.critAttack=e.critatt,this.delZhanyiCD=e.time_zhanyi},e}();__reflect(MetaMagicWeapon.prototype,"MetaMagicWeapon");var MetaMagicWeaponManager=function(){function e(){this.weapons=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromJson=function(e){for(var t,i=e.length,n=0;i>n;n++)t=new MetaMagicWeapon,t.fromJson(e[n]),this.weapons.push(t);Game.MAGIC_WEAPON_MAX_ID=t.id},e.prototype.getWeapon=function(e){for(var t=this.weapons.length,i=0;t>i;i++)if(this.weapons[i].id==e)return this.weapons[i];return null},e._ins=null,e}();__reflect(MetaMagicWeaponManager.prototype,"MetaMagicWeaponManager");var MetaMap=function(){function e(){this.task=0,this.cityIcon=0,this.kf=0,this.monsterIds=new Array}return e.prototype.fromJson=function(e){if(this.id=e.id,this.type=e.map_type,this.name=e.map_name,this.cityIcon=e.map_pic,this.level=e.map_level,""!=e.npc_id)for(var t=e.npc_id.split("|"),i=0,n=t.length;n>i;i++)this.monsterIds.push(parseInt(t[i]));if(this.consumeHufu=e.hufu,this.dropReses=new Array,""!=e.drop)for(var o=e.drop.split("|"),i=0;i<o.length;i++){var r=o[i].split(":"),s=new MetaMapDropRes;s.type=parseInt(r[0]),s.count=parseInt(r[1]),this.dropReses.push(s)}this.canPvp=1==e.pvp,this.floor=e.floor,this.task=e.unlock_task,this.reliveCd=e.map_cd,this.kf=e.kf},e}();__reflect(MetaMap.prototype,"MetaMap");var MetaMapDropRes=function(){function e(){}return e}();__reflect(MetaMapDropRes.prototype,"MetaMapDropRes");var MetaMapManager=function(){function e(){this.maps=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromJson=function(e){for(var t=e.length,i=0;t>i;i++){var n=new MetaMap;n.fromJson(e[i]),this.maps.push(n)}},e.prototype.getMap=function(e){for(var t=this.maps.length,i=0;t>i;i++)if(this.maps[i].id==e)return this.maps[i];throw new Error("获取地图id："+e+"静态数据出错!")},e.prototype.getMapForFloor=function(e){for(var t=this.maps.length,i=0;t>i;i++)if(this.maps[i].floor==e)return this.maps[i];return null},e.prototype.getMapForKuaFu=function(){for(var e=new Array,t=this.maps.length,i=0;t>i;i++)1==this.maps[i].kf&&e.push(this.maps[i]);return e},e.prototype.getMapForCountry=function(e){var t=10;e==Camp.SHU?t=11:e==Camp.WU&&(t=12);for(var i=new Array,n=this.maps.length,o=0;n>o;o++)this.maps[o].type==t&&i.push(this.maps[o]);return i},e._ins=null,e}();__reflect(MetaMapManager.prototype,"MetaMapManager");var MetaMeridian=function(){function e(){}return e.prototype.fromJson=function(e){this.id=e.id,this.type=e.type,this.name=e.type_name,this.star=e.star,this.costCultivation=e.cost_xiuwei,this.wuhon=e.wuhun},e}();__reflect(MetaMeridian.prototype,"MetaMeridian");var MetaMeridianManager=function(){function e(){this.meridians=new Array}return Object.defineProperty(e,"ins",{get:function(){return null==this.mInstance&&(this.mInstance=new e),this.mInstance},enumerable:!0,configurable:!0}),e.prototype.fromJson=function(t){for(var i=0,n=t.length;n>i;i++){var o=new MetaMeridian;o.fromJson(t[i]),this.meridians.push(o)}e.maxId=t.length},e.prototype.getMeridianForId=function(e){for(var t,i=0,n=this.meridians.length;n>i;i++)if(t=this.meridians[i],t.id==e)return t;return null},e.prototype.getMeridian=function(e,t){0==e?1==t&&(e=1):t>Game.MERIDIAN_MAX_STAR&&(e+=1,t=1),e=Math.min(Game.MERIDIAN_MAX_TYPE,e);for(var i,n=0,o=this.meridians.length;o>n;n++)if(i=this.meridians[n],i.type==e&&t==i.star)return i;return null},e.mInstance=null,e.maxId=0,e}();__reflect(MetaMeridianManager.prototype,"MetaMeridianManager");var MetaMonster=function(){function e(){this.level=0,this.hpType=0,this.skills=new Array}return e.prototype.fromJson=function(e){this.id=e.id,this.type=e.type,this.name=e.name;for(var t=e.skill.split(";"),i=0;i<t.length;i++){var n=new MetaMonsterSkill,o=t[i].split(":");n.id=parseInt(o[0]),n.rate=parseInt(o[1]),this.skills.push(n)}this.attack=e.attack,this.defence=e.def,this.hp=e.hp,this.head=e.head,this.hand=e.hand,this.foot=e.foot,this.force=e.force,this.fly=e.fly,this.dropId=e.drop_id,this.relive=e.relive,this.quality=e.quality,this.level=e.lv,this.hpType=e.UI},e}();__reflect(MetaMonster.prototype,"MetaMonster");var MetaMonsterSkill=function(){function e(){}return e}();__reflect(MetaMonsterSkill.prototype,"MetaMonsterSkill");var MetaMonsterManager=function(){function e(){this.monsters=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromJson=function(e){for(var t,i=e.length,n=0;i>n;n++)t=new MetaMonster,t.fromJson(e[n]),this.monsters.push(t)},e.prototype.getMonster=function(e){for(var t=this.monsters.length,i=0;t>i;i++)if(this.monsters[i].id==e)return this.monsters[i];return null},e._ins=null,e}();__reflect(MetaMonsterManager.prototype,"MetaMonsterManager");var MetaNewbieWelfare=function(){function e(){this.id=0,this.type=1,this.needDay=0,this.rechargeTotal=0,this.rewardType=0,this.rewardCount=0,this.rewardOfficerCount=0}return e.prototype.fromJson=function(e){this.id=e.id,this.type=e.type,this.needDay=e.day,this.rechargeTotal=e.recharge_total;var t=e.reward;if(""!=t){var i=t.split(":");this.rewardType=parseInt(i[0]),this.rewardCount=parseInt(i[1])}var n=e.reward_card;if(""!=n){var o=n.split(":");this.rewardOfficerCount=parseInt(o[1])}this.pic=e.pic},e}();__reflect(MetaNewbieWelfare.prototype,"MetaNewbieWelfare");var MetaNewbieWelfareManager=function(){function e(){this.days=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromJson=function(e){for(var t=0,i=e.length;i>t;t++){var n=new MetaNewbieWelfare;n.fromJson(e[t]),this.days.push(n)}},e.prototype.getDay=function(e){for(var t=0,i=this.days.length;i>t;t++)if(this.days[t].id==e)return this.days[t];return null},e.prototype.getDaysForType=function(e){for(var t=new Array,i=0,n=this.days.length;n>i;i++)this.days[i].type==e&&t.push(this.days[i]);return t},e._ins=null,e}();__reflect(MetaNewbieWelfareManager.prototype,"MetaNewbieWelfareManager");var MetaOfficer=function(){function e(){}return e.prototype.fromJson=function(e){this.id=e.hero_id,this.type=e.hero_type,this.name=e.hero_name,this.skillId=e.skill_id,this.needLevel=e.need_lv,this.quality=e.quality,this.level=e.grade,this.consumeChip=e.consume_chip,this.consumeCoin=e.consume_coin,this.addExp=e.add_exp,this.addGold=e.add_gold,this.attack=e.attack,this.defence=e.defense,this.hp=e.hp,this.resId=e.picture_res;var t=e.where;this.mapIds=[];for(var i=""==t?[]:t.split("|"),n=0,o=i.length;o>n;n++)this.mapIds.push(parseInt(i[n]));this.attackEffect=e.special_res,this.shotRes=e.shot_res},e}();__reflect(MetaOfficer.prototype,"MetaOfficer");var MetaOfficerManager=function(){function e(){this.officers=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromJson=function(e){for(var t=e.length,i=0;t>i;i++){var n=new MetaOfficer;n.fromJson(e[i]),this.officers.push(n)}},e.prototype.getOfficer=function(e){for(var t=this.officers.length,i=0;t>i;i++)if(this.officers[i].id==e)return this.officers[i];return null},e.prototype.getOfficerMaxLevel=function(e){for(var t=0,i=this.officers.length,n=0;i>n;n++)this.officers[n].type==e&&t++;return t},e.prototype.getNextLevelOfficer=function(e){var t=this.getOfficer(e),i=this.getOfficerForTypeAndLevel(t.type,t.level+1);return i},e.prototype.getOfficerForTypeAndLevel=function(e,t){void 0===t&&(t=1);for(var i,n=this.officers.length,o=0;n>o;o++)if(i=this.officers[o],i.type==e&&i.level==t)return i;return null},e._ins=null,e}();__reflect(MetaOfficerManager.prototype,"MetaOfficerManager");var MetaOfficerFetter=function(){function e(){this.officers=new Array}return e.prototype.fromJson=function(e){this.id=e.id,this.name=e.name||"羁绊名称",e.type_one>0&&this.officers.push(e.type_one),e.type_two>0&&this.officers.push(e.type_two),e.type_three>0&&this.officers.push(e.type_three),e.type_four>0&&this.officers.push(e.type_four),e.type_five>0&&this.officers.push(e.type_five),e.type_six>0&&this.officers.push(e.type_six),this.officers.sort(Util.sortNumber),this.addAttack=e.attack_add,this.addDefence=e.def_add,this.addHp=e.hp_add},e}();__reflect(MetaOfficerFetter.prototype,"MetaOfficerFetter");var MetaOfficerFetterManager=function(){function e(){this.officerFetters=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromJson=function(e){for(var t=e.length,i=0;t>i;i++){var n=new MetaOfficerFetter;n.fromJson(e[i]),this.officerFetters.push(n)}},e.prototype.getOfficerFetterForTypes=function(e){e.sort(Util.sortNumber);for(var t,i=e.length,n=this.officerFetters.length,o=!0,r=0;n>r;r++)if(t=this.officerFetters[r],t.officers.length==i){o=!0;for(var s=0;i>s;s++)if(t.officers[s]!=e[s]){o=!1;break}if(o)return t}return null},e.prototype.getFettersForType=function(e){for(var t,i=new Array,n=0,o=this.officerFetters.length;o>n;n++)t=this.officerFetters[n],t.officers.indexOf(e)>=0&&i.push(t);return i},e.prototype.getProperty=function(e,t){var i=0;switch(t){case PropertyType.ATTACK:i=e.addAttack;break;case PropertyType.DEFENCE:i=e.addDefence;break;case PropertyType.HP:i=e.addHp}return i},e.prototype.getOfficerFetter=function(e){for(var t=this.officerFetters.length,i=0;t>i;i++)if(this.officerFetters[i].id==e)return this.officerFetters[i];return null},e._ins=null,e}();__reflect(MetaOfficerFetterManager.prototype,"MetaOfficerFetterManager");var MetaPingBi=function(){function e(){this.pingbis=new Array}return e.prototype.fromJson=function(e){for(var t=e.length,i=0;t>i;i++)this.pingbis.push(e[i])},e.prototype.getPingBi=function(e){for(var t=this.pingbis.length,i="",n=-1,o=0;t>o;o++)if(i=this.pingbis[o],n=e.indexOf(i,0),n>=0)return i;return""},e}();__reflect(MetaPingBi.prototype,"MetaPingBi");var MetaPingBiManager=function(){function e(){this.metaPingBi=new MetaPingBi}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromJson=function(e){this.metaPingBi.fromJson(e.split("|"))},e.prototype.getPingBi=function(e){return this.metaPingBi.getPingBi(e)},e._ins=null,e}();__reflect(MetaPingBiManager.prototype,"MetaPingBiManager");var MetaProp=function(){function e(){}return e.prototype.fromJson=function(e){this.id=e.id,this.res=e.pic,this.name=e.prop_name,this.des=e.prop_dess,this.type=e.prop_type,this.color=e.prop_quality,this.effectValue=e.effect_value},e}();__reflect(MetaProp.prototype,"MetaProp");var MetaPropMananger=function(){function e(){this.props=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromJson=function(e){for(var t=e.length,i=0;t>i;i++){var n=new MetaProp;n.fromJson(e[i]),this.props.push(n)}},e.prototype.getProp=function(e){for(var t=this.props.length,i=0;t>i;i++)if(this.props[i].id==e)return this.props[i];return null},e.prototype.getPropsForPart=function(e){for(var t=new Array,i=this.props.length,n=null,o=0;i>o;o++)n=this.props[o],n.type==e&&t.push(n);return t},e._ins=null,e}();__reflect(MetaPropMananger.prototype,"MetaPropMananger");var MetaQieCuo=function(){function e(){}return e.prototype.fromJson=function(e){this.id=e.id,this.type=e.type,this.pic=e.pic,this.consume=new MetaQieCuoConsume,this.consume.type=e.cost,this.consume.value=e.cost_value,this.successRate=e.success_pre,this.minReward=new MetaQieCuoReward,this.minReward.type=e.res,this.minReward.value=e.success_min,this.maxReward=new MetaQieCuoReward,this.maxReward.type=e.res,this.maxReward.value=e.success_max,this.rewardExp=e.success_exp},e}();__reflect(MetaQieCuo.prototype,"MetaQieCuo");var MetaQieCuoConsume=function(){function e(){}return e}();__reflect(MetaQieCuoConsume.prototype,"MetaQieCuoConsume");var MetaQieCuoReward=function(){function e(){}return e}();__reflect(MetaQieCuoReward.prototype,"MetaQieCuoReward");var MetaQieCuoManager=function(){function e(){this.qiecuos=new Array}return Object.defineProperty(e,"ins",{get:function(){return null==this.mInstance&&(this.mInstance=new e),this.mInstance},enumerable:!0,configurable:!0}),e.prototype.fromJson=function(e){for(var t=0,i=e.length;i>t;t++){var n=new MetaQieCuo;n.fromJson(e[t]),this.qiecuos.push(n)}},e.prototype.getQieCuo=function(e){for(var t=this.qiecuos.length,i=0;t>i;i++)if(this.qiecuos[i].id==e)return this.qiecuos[i];return null},e.mInstance=null,e}();__reflect(MetaQieCuoManager.prototype,"MetaQieCuoManager");var MetaRandomName=function(){function e(){}return e.prototype.fromJson=function(e){this.id=e.id,this.type=e.type,this.name=e.name},e}();__reflect(MetaRandomName.prototype,"MetaRandomName");var MetaRandomNameManager=function(){function e(){this.preNames=new Array,this.names=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.init=function(e){for(var t=0;t<e.length;t++){var i=e[t];1==i.type?this.preNames.push(i.name):this.names.push(i.name)}},e.prototype.getRandomName=function(){var e=Math.floor(this.preNames.length*Math.random()),t=Math.floor(this.names.length*Math.random());return{preName:this.preNames[e],name:this.names[t]}},e._ins=null,e}();__reflect(MetaRandomNameManager.prototype,"MetaRandomNameManager");var MetaRechargeReward=function(){function e(){this.rewards=new Array}return e.prototype.fromJson=function(e){this.id=e.id,this.type=e.type,this.rmb=e.recharge_number;var t=e.reward.split("|");for(var i in t){var n={},o=t[i].split(":");n.type=parseInt(o[0]),3==o.length?(n.staticId=parseInt(o[1]),n.count=parseInt(o[2])):2==o.length&&(n.count=parseInt(o[1]),n.staticId=0),this.rewards.push(n)}this.fenzu=e.fenzu},e}();__reflect(MetaRechargeReward.prototype,"MetaRechargeReward");var MetaRecharRewardManager=function(){function e(){this.rewards=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromJson=function(e){for(var t=0,i=e.length;i>t;t++){var n=new MetaRechargeReward;n.fromJson(e[t]),this.rewards.push(n)}},e.prototype.getRechargeReward=function(e){for(var t=0,i=this.rewards.length;i>t;t++){var n=this.rewards[t];if(n.id==e)return n}return null},e.prototype.getType=function(e){for(var t=new Array,i=0,n=this.rewards.length;n>i;i++)e==this.rewards[i].type&&t.push(this.rewards[i]);return t},e._ins=null,e}();__reflect(MetaRecharRewardManager.prototype,"MetaRecharRewardManager");var MetaRenown=function(){function e(){}return e.prototype.fromJson=function(e){this.level=e.renown_lv,this.needCount=e.renown_point,this.addWuHun=e.wuhun},e}();__reflect(MetaRenown.prototype,"MetaRenown");var MetaRenownManager=function(){function e(){this.maxLevel=0,this.renowns=new Array}return Object.defineProperty(e,"ins",{get:function(){return null==this.mInstance&&(this.mInstance=new e),this.mInstance},enumerable:!0,configurable:!0}),e.prototype.fromJson=function(e){this.maxLevel=e.length;for(var t=0,i=e.length;i>t;t++){var n=new MetaRenown;n.fromJson(e[t]),this.renowns.push(n)}},e.prototype.getMetaRenown=function(e){for(var t,i=0,n=this.renowns.length;n>i;i++)if(t=this.renowns[i],t.level==e)return t;return null},e.mInstance=null,e}();__reflect(MetaRenownManager.prototype,"MetaRenownManager");var MetaRole=function(){function e(){this.bone=0,this.arm=0,this.crit=0,this.critHurt=0,this.head=0,this.hand=0,this.foot=0,this.force=0,this.fly=0,this.pre=0,this.attackAdd=0,this.defenceAdd=0,this.hpAdd=0,this.pointsRoleLv=0}return e.prototype.fromJson=function(e){this.attack=e.attack,this.defence=e.def,this.hp=e.hp,this.attackSpeed=e.speed,this.head=e.head,this.hand=e.hand,this.foot=e.foot,this.force=e.force,this.fly=e.fly,this.pre=e.pre,this.attackAdd=e.attack_add,this.defenceAdd=e.def_add,this.hpAdd=e.hp_add,this.pointsRoleLv=e.points_rolelv},e}();__reflect(MetaRole.prototype,"MetaRole");var MetaRoleManager=function(){function e(){this.metaRole=new MetaRole}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromJson=function(e){this.metaRole.fromJson(e[0])},e._ins=null,e}();__reflect(MetaRoleManager.prototype,"MetaRoleManager");var MetaShopCardInfo=function(){function e(){}return e}();__reflect(MetaShopCardInfo.prototype,"MetaShopCardInfo");var MetaShopCard=function(){function e(){}return e.prototype.fromJson=function(e){this.id=e.id,this.officer=e.hero,this.box1=new MetaShopCardInfo,this.box1.hozaId=e.hojin_id1,this.box1.oneRate=e.spar_one_pro1,this.box1.tenRate=e.spar_ten_pro1,this.box2=new MetaShopCardInfo,this.box2.hozaId=e.hojin_id2,this.box2.oneRate=e.spar_one_pro2,this.box2.tenRate=e.spar_ten_pro2,this.box3=new MetaShopCardInfo,this.box3.hozaId=e.hojin_id3,this.box3.oneRate=e.spar_one_pro3,this.box3.tenRate=e.spar_ten_pro3,this.broadcast=1==e.notice},e}();__reflect(MetaShopCard.prototype,"MetaShopCard");var MetaShopDraw=function(){function e(){}return e.prototype.fromJson=function(e){this.id=e.id,this.type=e.type,this.level=e.lv,this.oneFreeCount=e.one_free,this.oneCD=e.one_cd,this.oneCost=e.one_cost,this.oneCount=e.one_time,this.oneExp=e.one_exp,this.tenFreeCount=e.ten_free,this.tenCD=e.ten_cd,this.tenCost=e.ten_cost,this.tenCount=e.ten_time,this.tenExp=e.ten_exp},e}();__reflect(MetaShopDraw.prototype,"MetaShopDraw");var MetaShopGold=function(){function e(){}return e.prototype.fromJson=function(e){this.id=e.id,this.icon=e.icon,this.name=e.recharge_name,this.gold=e.spar,this.rmb=e.price,this.type=e.type,this.day=e.day,this.wanba=e.wanba},e}();__reflect(MetaShopGold.prototype,"MetaShopGold");var MetaShopManager=function(){function e(){this.draws=new Array,this.golds=new Array,this.silvers=new Array,this.cards=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.getDraw=function(e){for(var t=0,i=this.draws.length;i>t;t++)if(this.draws[t].id==e)return this.draws[t];return null},e.prototype.initDraw=function(e){for(var t=0,i=e.length;i>t;t++){var n=new MetaShopDraw;n.fromJson(e[t]),this.draws.push(n)}},e.prototype.initGold=function(e){for(var t=0,i=e.length;i>t;t++){var n=new MetaShopGold;n.fromJson(e[t]),this.golds.push(n)}},e.prototype.getVip=function(){for(var e=new Array,t=0,i=this.golds.length;i>t;t++)(this.golds[t].type==ShopType.YUE_KA||this.golds[t].type==ShopType.YONG_JIU_KA)&&e.push(this.golds[t]);return e},e.prototype.getShopGold=function(e){for(var t=0,i=this.golds.length;i>t;t++)if(this.golds[t].id==e)return this.golds[t];return null},e.prototype.getShopGolds=function(){for(var e=new Array,t=0,i=this.golds.length;i>t;t++)this.golds[t].type==ShopType.GOLD_RECHARGE&&e.push(this.golds[t]);return e},e.prototype.initSilver=function(e){for(var t=0,i=e.length;i>t;t++){var n=new MetaShopSilver;n.fromJson(e[t]),this.silvers.push(n)}},e.prototype.initCard=function(e){for(var t=0,i=e.length;i>t;t++){var n=new MetaShopCard;n.fromJson(e[t]),this.cards.push(n)}},e._ins=null,e}();__reflect(MetaShopManager.prototype,"MetaShopManager");var MetaShopSilver=function(){function e(){}return e.prototype.fromJson=function(e){this.id=e.id,this.icon=e.icon,this.name=e.gold_name,this.gold=e.spar,this.silver=e.gold},e}();__reflect(MetaShopSilver.prototype,"MetaShopSilver");var MetaSkill=function(){function e(){this.hasHitEffect=!1,this.skillHurt=0,this.shotResId=0}return e.prototype.fromJson=function(e){this.id=e.skill_id,this.name=e.skill_name,this.skillNameRes=e.skill_name_res,this.head=e.head,this.hand=e.hand,this.foot=e.foot,this.force=e.force,this.fly=e.fly,this.pre=e.pre,this.weight=e.weight,this.buff=e.buff,this.buffRate=e.buff_probability,this.hitEffectResId=e.special_res,this.hasHitEffect=1==e.gethit,this.des=e.describe,this.skillHurt=e.skill_hurt,this.shotResId=e.shot_res},e}();__reflect(MetaSkill.prototype,"MetaSkill");var MetaSkillManager=function(){function e(){this.skills=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromJson=function(e){for(var t=e.length,i=0;t>i;i++){var n=new MetaSkill;n.fromJson(e[i]),this.skills.push(n)}},e.prototype.getSkill=function(e){for(var t=this.skills.length,i=0;t>i;i++)if(this.skills[i].id==e)return this.skills[i];return null},e._ins=null,e}();__reflect(MetaSkillManager.prototype,"MetaSkillManager");var MetaSkillBuff=function(){function e(){}return e.prototype.fromJson=function(e){this.id=e.id,this.buff_name=e.name,this.times=e.times,this.describe=e.describe,this.buff_res=e.buff_res},e}();__reflect(MetaSkillBuff.prototype,"MetaSkillBuff");var MetaSkillBuffManager=function(){function e(){this.buffs=new Array}return Object.defineProperty(e,"ins",{get:function(){return null==this._ins&&(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromJson=function(e){for(var t=e.length,i=0;t>i;i++){var n=new MetaSkillBuff;n.fromJson(e[i]),this.buffs.push(n)}},e.prototype.getSkill=function(e){for(var t=this.buffs.length,i=0;t>i;i++)if(this.buffs[i].id==e)return this.buffs[i];return null},e._ins=null,e}();__reflect(MetaSkillBuffManager.prototype,"MetaSkillBuffManager");var MetaTaskDrop=function(){function e(){}return e.prototype.fromJson=function(e){var t=e.split(":");this.type=parseInt(t[0]),this.value=parseInt(t[1])},e}();__reflect(MetaTaskDrop.prototype,"MetaTaskDrop");var MetaTask=function(){function e(){this.drops=new Array}return e.prototype.fromJson=function(e){this.id=e.task_id,this.targetMap=e.map_id,this.targetMonster=e.monster_id,this.unlockMap=e.unlockmap_id,this.exp=e.exp;for(var t=e.drop.split("|"),i=0,n=t.length;n>i;i++){var o=new MetaTaskDrop;o.fromJson(t[i]),this.drops.push(o)}this.points=e.points},e}();__reflect(MetaTask.prototype,"MetaTask");var MetaTaskManager=function(){function e(){this.tasks=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromJson=function(e){for(var t=e.length,i=0;t>i;i++){var n=new MetaTask;n.fromJson(e[i]),this.tasks.push(n)}Game.TASK_MAX_ID=this.tasks[t-1].id},e.prototype.getTask=function(e){for(var t=this.tasks.length,i=0;t>i;i++)if(this.tasks[i].id==e)return this.tasks[i];return null},e.prototype.getTaskForTargetMap=function(e){for(var t=this.tasks.length,i=0;t>i;i++)if(this.tasks[i].targetMap==e)return this.tasks[i];return null},e.prototype.getTaskForTarget=function(e,t){for(var i,n=this.tasks.length,o=0;n>o;o++)if(i=this.tasks[o],i.targetMap==e&&i.targetMonster==t)return i;return null},e._ins=null,e}();__reflect(MetaTaskManager.prototype,"MetaTaskManager");var MetaTianShu=function(){function e(){}return e.prototype.fromJson=function(e){this.id=e.id,this.name=e.book_name,this.quality=e.quality,this.pic=e.book_pic,this.count=e.book_page,this.attack=e.attack,this.defence=e.def,this.hp=e.hp,this.speed=e.speed,this.wuli=e.head,this.zhili=e.hand,this.neili=e.foot,this.tongshuai=e.force,this.minjie=e.fly,this.meili=e.pre,this.propId=e.book_pageid;var t=e.where;this.mapIds=[];for(var i=t.split("|"),n=0,o=i.length;o>n;n++)this.mapIds.push(parseInt(i[n]))},e}();__reflect(MetaTianShu.prototype,"MetaTianShu");var MetaTianShuManager=function(){function e(){this.tianshuArr=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromJson=function(e){for(var t=0,i=e.length;i>t;t++){var n=e[t],o=new MetaTianShu;o.fromJson(n),this.tianshuArr.push(o)}this.getTianShu(1)},e.prototype.getTianShu=function(e){for(var t,i=0,n=this.tianshuArr.length;n>i;i++)if(t=this.tianshuArr[i],t.id==e)return t;
return null},e.prototype.getTianShuForProp=function(e){for(var t,i=0,n=this.tianshuArr.length;n>i;i++)if(t=this.tianshuArr[i],t.propId==e)return t;return null},e._ins=null,e}();__reflect(MetaTianShuManager.prototype,"MetaTianShuManager");var MetaTiming=function(){function e(){this.id=0,this.map=0,this.monsterIds=new Array}return e.prototype.addMonster=function(e){this.monsterIds.indexOf(e)>=0||this.monsterIds.push(e)},e}();__reflect(MetaTiming.prototype,"MetaTiming");var MetaTimingManager=function(){function e(){this.timings=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromJson=function(e){for(var t,i=0,n=e.length;n>i;i++){var o=e[i].map;t=this.getTimingForMap(o),t||(t=new MetaTiming,t.map=o,this.timings.push(t)),t.addMonster(e[i].monster)}},e.prototype.getTimingForMap=function(e){for(var t=0,i=this.timings.length;i>t;t++)if(this.timings[t].map==e)return this.timings[t];return null},e._ins=null,e}();__reflect(MetaTimingManager.prototype,"MetaTimingManager");var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.textField.fontFamily="微软雅黑",this.addChild(this.textField),log("x:"+this.textField.x+"，y:"+this.textField.y),this.textField.width=480,this.textField.height=100,this.textField.textAlign="center",this.textField.x=(640-this.textField.width)/2,this.textField.y=(1136-this.textField.height)/2},t.prototype.setProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t.prototype.setDes=function(e){this.textField.text=e},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var ProtobufDataConfig=function(){function e(){}return e.LOGIN=new ProtobufData(BookCmd.ENTER_SEREVER,"PlayerVo"),e.CREATE_ROLE=new ProtobufData(BookCmd.CREATE_ROLE,"PlayerVo"),e.GET_MAP_LIST=new ProtobufData(BookCmd.GET_MAP_LIST,"MapList"),e.ENTER_MAP=new ProtobufData(BookCmd.ENTER_MAP,"MapData"),e.PLAYER_ENTER_OR_LEAVE_MAP=new ProtobufData(BookCmd.RESPONSE_PLAYER_ENTER_OR_LEAVE_MAP,"MapPlayerChange"),e.ATTACK_OTHER_ENTITY=new ProtobufData(BookCmd.ATTACK_OTHER_ENTITY,"MapPlayerChange"),e.RESPONSE_ENTITY_ATTACK=new ProtobufData(BookCmd.RESPONSE_ENTITY_ATTACK,"FightMessage"),e.RESPONSE_UNIT_DIE=new ProtobufData(BookCmd.RESPONSE_UNIT_DIE,"UnitDie"),e.RESPONSE_MONSTER_RELIVE=new ProtobufData(BookCmd.RESPONSE_MONSTER_RELIVE,"MapDataMonster"),e.GET_OFFICER_LIST=new ProtobufData(BookCmd.GET_OFFICER_LIST,"HeroList"),e.EQUIP_ONE_OFFICER=new ProtobufData(BookCmd.EQUIP_ONE_OFFICER,"HeroUpResult"),e.EQUIP_OFFICERS=new ProtobufData(BookCmd.EQUIP_OFFICERS,"OnekeyUpResult"),e.LEVEL_UP_ONE_OFFICER=new ProtobufData(BookCmd.LEVEL_UP_ONE_OFFICER,"LvupOnceResult"),e.LEVEL_UP_ALL_OFFICER=new ProtobufData(BookCmd.LEVEL_UP_ALL_OFFICER,"HeroList"),e.RESPONSE_EVENT_DATA=new ProtobufData(BookCmd.RESPONSE_EVENT_DATA,"EventData"),e.GET_EQUIPE_LIST=new ProtobufData(BookCmd.GET_EQUIPE_LIST,"EquipPanel"),e.EQUIP_EQUIP=new ProtobufData(BookCmd.EQUIP_EQUIP,"EquipFightResult"),e.LEVEL_UP_ONE_EUQIP=new ProtobufData(BookCmd.LEVEL_UP_ONE_EUQIP_PART,"EquipPosUpgradeResult"),e.LEVEL_UP_ALL_EUQIPS=new ProtobufData(BookCmd.LEVEL_UP_ALL_EUQIP_PARTS,"EquipPanel"),e.LEVEL_UP_BODY=new ProtobufData(BookCmd.LEVEL_UP_BODY,"BodyUpgradeResult"),e.BODY_BUY=new ProtobufData(BookCmd.BODY_BUY,"BodyBuyResult"),e.GET_MERIDIAN=new ProtobufData(BookCmd.GET_MERIDIAN,"MeridianVo"),e.MERIDIAN_LEVEL_UP=new ProtobufData(BookCmd.MERIDIAN_LEVEL_UP,"MeridianVo"),e.GET_QIECUO=new ProtobufData(BookCmd.GET_QIECUO,"QiecuoPanel"),e.QIECUO_DO=new ProtobufData(BookCmd.QIECUO_DO,"QiecuoResult"),e.HOUJIN_PANEL=new ProtobufData(BookCmd.HOUJIN_PANEL,"HoujinPanel"),e.HOUJIN_BUY=new ProtobufData(BookCmd.HOUJIN_BUY,"BuyResult"),e.HOUJIN_EXCHANGE_LEVEL=new ProtobufData(BookCmd.HOUJIN_EXCHANGE_LEVEL,"HoujinPanel"),e.HOUJIN_UPGRADE=new ProtobufData(BookCmd.HOUJIN_UPGRADE,"UpgradeResult"),e.COUNTRY_PANEL=new ProtobufData(BookCmd.COUNTRY_PANEL,"CountryPanel"),e.COUNTRY_CHANGE_RESULT=new ProtobufData(BookCmd.COUNTRY_CHANGE_RESULT,"CountryChangeResult"),e.SHOP_PANEL=new ProtobufData(BookCmd.SHOP_PANEL,"ShopPanel"),e.SHOP_DRAW_CARD=new ProtobufData(BookCmd.SHOP_DRAW_CARD,"CardResult"),e.SHOP_EXCHANGE_SILVER=new ProtobufData(BookCmd.SHOP_EXCHANGE_SILVER,"SilverExchange"),e.MAIL_PANEL=new ProtobufData(BookCmd.MAIL_PANEL,"MailPanel"),e.MAIL_DEL=new ProtobufData(BookCmd.MAIL_DEL,"CommonIdResult"),e.MAIL_GET_REWARD=new ProtobufData(BookCmd.MAIL_GET_REWARD,"TakeMail"),e.CHAT_COMMON=new ProtobufData(BookCmd.CHAT_COMMON,"CommonChat"),e.RENOWN_RESULT=new ProtobufData(BookCmd.RENOWN_RESULT,"SwResult"),e.FIGHT_DROP=new ProtobufData(BookCmd.FIGHT_DROP,"FightDrop"),e.PLAYER_INFO_PANEL=new ProtobufData(BookCmd.PLAYER_INFO_PANEL,"PlayerInfoPanel"),e.TONG_TIAN_TA_PANEL=new ProtobufData(BookCmd.TONG_TIAN_TA_PANEL,"TongtiantaPanel"),e.TONG_TIAN_TA_ONE_KEY=new ProtobufData(BookCmd.TONG_TIAN_TA_ONE_KEY,"TongtiantaPanel"),e.MAGIC_WEAPON_PANEL=new ProtobufData(BookCmd.MAGIC_WEAPON_PANEL,"ShenBingPanel"),e.MAGIC_WEAPON_LEVEL_UP=new ProtobufData(BookCmd.MAGIC_WEAPON_LEVEL_UP,"CommonId2Result"),e.HUFU_BUY=new ProtobufData(BookCmd.HUFU_BUY,"CommonIdResult"),e.RANKE_PANEL=new ProtobufData(BookCmd.RANKE_PANEL,"RankPanel"),e.COMMON_MAP_RESULT=new ProtobufData(BookCmd.COMMON_MAP_RESULT,"CommonMapResult"),e.OFFLINE_BEGIN=new ProtobufData(BookCmd.OFFLINE_BEGIN,"CommonIdResult"),e.OFFLINE_PANE=new ProtobufData(BookCmd.OFFLINE_PANE,"OfflinePanel"),e.GUIDE_SAVE_STEP=new ProtobufData(BookCmd.GUIDE_SAVE_STEP,"CommonIdResult"),e.DAY_PANEL=new ProtobufData(BookCmd.DAY_PANEL,"CommonId2Result"),e.DAY_SIGN_OR_RECHARGE=new ProtobufData(BookCmd.DAY_SIGN_OR_RECHARGE,"CommonBagList"),e.MONTH_CARD_PANEL=new ProtobufData(BookCmd.MONTH_CARD_PANEL,"MonthCardPanel"),e.MONTH_CARD_GET_REWARD=new ProtobufData(BookCmd.MONTH_CARD_GET_REWARD,"CommonBagList"),e.LI_BAO_GET=new ProtobufData(BookCmd.LI_BAO_GET,"CommonBagList"),e.SHARE_GET=new ProtobufData(BookCmd.SHARE_GET,"CommonBagList"),e.GO_AWAY=new ProtobufData(BookCmd.GO_AWAY,"CommonIdResult"),e.MonsterTarget=new ProtobufData(BookCmd.MONSTER_TARGET,"MonsterTarget"),e.MAGIC_WEAPON_BUY=new ProtobufData(BookCmd.MAGIC_WEAPON_BUY,"ShenbingBuyResult"),e.SIX_PROPERTY=new ProtobufData(BookCmd.SIX_PROPERTY,"SixPro"),e.BOOK_PANEL=new ProtobufData(BookCmd.BOOK_PANEL,"BookPanel"),e.BOOK_PANEL_BOOK=new ProtobufData(BookCmd.BOOK_PANEL_BOOK,"CommonIdResult"),e.EQUIP_BUY_PROP=new ProtobufData(BookCmd.EQUIP_BUY_PROP,"CommonIdResult"),e.KUA_FU_PANEL=new ProtobufData(BookCmd.KUA_FU_PANEL,"KfPanel"),e.KUA_FU_ENTER=new ProtobufData(BookCmd.KUA_FU_ENTER,"KfData"),e.KUA_FU_OUT=new ProtobufData(BookCmd.KUA_FU_OUT,"KfData"),e.MAP_CAPACITY_DROP=new ProtobufData(BookCmd.MAP_CAPACITY_DROP,"CapacityDrop"),e.PLAT_SHENGTIAN_PAY=new ProtobufData(BookCmd.PLAT_SHENGTIAN_PAY,"ShengtianPay"),e.PLAT_RECHARGE_RESULT=new ProtobufData(BookCmd.PLAT_RECHARGE_RESULT,"CommonStrIdResult"),e.PLAT_1758_PRE_RECHARGE=new ProtobufData(BookCmd.PLAT_1758_PRE_RECHARGE,"YiqiwubaPay"),e.SHARE_PANEL=new ProtobufData(BookCmd.SHARE_PANEL,"YiqiwubaInfo"),e.SHARE_GET_REWARD=new ProtobufData(BookCmd.SHARE_GET_REWARD,"BagVo"),e.SHARE_GET_INVATED_REWARD=new ProtobufData(BookCmd.SHARE_GET_INVATED_REWARD,"BagVo"),e.FOLLOW_GET_REWARD=new ProtobufData(BookCmd.FOLLOW_GET_REWARD,"BagVo"),e.PLAT_GET_RECHARGE_ORDER=new ProtobufData(BookCmd.PLAT_GET_RECHARGE_ORDER,"CommonOrderResult"),e.FIRST_RECHARGE_PANEL=new ProtobufData(BookCmd.FIRST_RECHARGE_PANEL,"CommonIdResult"),e.FIRST_RECHARGE_GET_REWARD=new ProtobufData(BookCmd.FIRST_RECHARGE_GET_REWARD,"CommonBagList"),e.DAY_FIRST_RECHARGE_PANEL=new ProtobufData(BookCmd.DAY_FIRST_RECHARGE_PANEL,"CommonIdResult"),e.DAY_FIRST_RECHARGE_GET_REWARD=new ProtobufData(BookCmd.DAY_FIRST_RECHARGE_GET_REWARD,"CommonBagList"),e.DAY_RECHARGE_PANEL=new ProtobufData(BookCmd.DAY_RECHARGE_PANEL,"DayPayPanel"),e.DAY_RECHARGE_GET_REWARD=new ProtobufData(BookCmd.DAY_RECHARGE_GET_REWARD,"CommonBagList"),e.PLAT_33733_PRE_RECHARGET=new ProtobufData(BookCmd.PLAT_33733_PRE_RECHARGET,"CommonArrayStr"),e.NEWBIE_WELFARE_ORDER=new ProtobufData(BookCmd.NEWBIE_WELFARE_ORDER,"XinshouFuliPanel"),e.Get_NEWBIE_WELFARE_ORDER=new ProtobufData(BookCmd.GET_NEWBIE_WELFARE_ORDER,"XinshouFuliTake"),e.PLAT_WANBA_PAY=new ProtobufData(BookCmd.PLAT_WANBA_PAY,"CommonIdResult"),e.PLAT_WANBA_GET_XINGBI=new ProtobufData(BookCmd.PLAT_WANBA_GET_XINGBI,"CommonIdResult"),e.PLAT_SHENGTINA_IOS_PAY=new ProtobufData(BookCmd.PLAT_SHENGTINA_IOS_PAY,"ShengtianPay"),e.CHECK_RED_POINT=new ProtobufData(BookCmd.CHECK_RED_POINT,"CommonArrayResult"),e.OFF_LINE_TYPE=new ProtobufData(BookCmd.OFF_LINE_TYPE,"CommonBagList"),e.RED_POINT_UPDATE=new ProtobufData(BookCmd.RED_POINT_UPDATE,"CommonArrayResult"),e.ACITVITY_PANEL=new ProtobufData(BookCmd.ACITVITY_PANEL,"ActivityPanel"),e}();__reflect(ProtobufDataConfig.prototype,"ProtobufDataConfig");var GameVo=function(){function e(){}return e.uiCloseDic={},e}();__reflect(GameVo.prototype,"GameVo");var VoUtil=function(){function e(){}return e.canHozaLevelUp=function(){var e=HozaVoManager.ins.hozaVo;if(e.level>=MetaHozaManager.maxLevel)return!1;var t=MetaHozaManager.ins.getHoza(e.level);return t?e.studyPoint>=t.cost&&PlayerVoManager.ins.playerVo.level>=t.needLevel:!1},e.checkFunctionOpen=function(e,t){void 0===t&&(t=-1);var i=t>0?t:PlayerVoManager.ins.playerVo.level,n=MetaFunctionOpenManager.ins.getOpenForFunctionId(e);return n?n.openLevel<=i:!0},e.getEquipProperty=function(e){},e.getTotalSixProperty=function(){var e=SixProVoManager.ins.getSixVo(Constants.LEVEL_SIX_PRO),t=SixProVoManager.ins.getSixVo(Constants.HOZA_SIX_PRO),i=EquipVoMananger.ins.getSixProperty(),n=TianShuVoManager.ins.getSixPro(),o=new SixPropertyVo;return o.wuli=e.wuli+t.wuli+n.wuli+i.wuli,o.neili=e.neili+t.neili+n.neili+i.neili,o.zhili=e.zhili+t.zhili+n.zhili+i.zhili,o.tongshuai=e.tongshuai+t.tongshuai+n.tongshuai+i.tongshuai,o.minjie=e.minjie+t.minjie+n.minjie+i.minjie,o.meili=e.meili+t.meili+n.meili+i.meili,o},e.getTaskForMap=function(e,t){var i=MetaTaskManager.ins.getTaskForTarget(e,t);return i},e.getTaskForMapMonster=function(e,t){var i=MetaTaskManager.ins.getTaskForTarget(e,t);return i&&i.id==TaskVoMananger.ins.taskVo.taskId?i:null},e.checkFirstRecharge=function(){var e=RechargeRewardVoManager.ins.firstRewardState;return 2==e?!1:!0},e.checkDayFirstRecharge=function(){var e=RechargeRewardVoManager.ins.dayFirstRewardState;return 2==e?!1:!0},e.checkNewbieWelfare=function(){var e=NewbieWelfareVoManager.ins.newbieWelfareVo,t=[!0,!0],i=NewbieWelfareVoManager.ins.newbieWelfareVo;return t[0]=1==e.state,i.hasGet&&(t[1]=!1),t},e.checkDayRecharge=function(){var e=RechargeRewardVoManager.ins.dayRechargeRewardVo,t=MetaRecharRewardManager.ins.getType(RechargeRewardType.RECHARGE);return t.length>e.ids.length},e.checkFuLi=function(){return e.checkFunctionOpen(FunctionId.FU_LI)?RedPointManager.ins.check(6):!1},e.checkVip=function(){return e.checkFunctionOpen(FunctionId.YUE_KA)?RedPointManager.ins.check(8):!1},e.checkEquipRed=function(){return e.checkFunctionOpen(FunctionId.EQUIP)?RedPointManager.ins.check(9):!1},e.checkTask=function(e,t){var i=TaskVoMananger.ins.taskVo,n=MetaTaskManager.ins.getTask(i.taskId);n.targetMap==e&&n.targetMonster==t&&n.id!=Game.TASK_MAX_ID&&(i.taskId=i.taskId+1)},e.canLevelUpBody=function(){var e=MetaBodyManager.ins.getBody(BodyVoMananger.ins.bodyVo.id);return e?e.id==Game.BODY_MAX_ID?!1:PlayerVoManager.ins.playerInfoVo.heroCount>=e.needHeroCount:!1},e.initMap=function(){for(var e=TaskVoMananger.ins.taskVo,t=null,i=new Array,n=MetaMapManager.ins.maps,o=MetaConfigManager.ins.getConfig("born_map"),r=0,s=n.length;s>r;r++){var a=n[r];if(a.id!=o){var h={id:a.id,cd:10};if(t=MetaTaskManager.ins.getTaskForTargetMap(a.id)){h.monsters=new Array,h.isLocked=t.id>e.taskId;for(var p=0,l=a.monsterIds.length;l>p;p++)h.monsters.push({monsterId:a.monsterIds[p],cd:Math.floor(10*Math.random())+5});i.push(h)}}}MapVoManager.ins.fromServer(i)},e.prototype.getOfficerFetterProperty=function(e){},e.checkShopFree=function(){for(var e,t,i=ShopVoManager.ins.draws,n=PlayerVoManager.ins.playerVo,o=0,r=i.length;r>o;o++)if(e=i[o],t=MetaShopManager.ins.getDraw(e.id),!(t.level>n.level)){if(e.oneFreeTime<=0&&t.oneFreeCount-e.oneFreeCount>0)return!0;if(e.tenFreeTime<=0&&t.tenCD>0&&0==e.tenFreeCount)return!0}return!1},e.canOfficerOneKeyEquip=function(){for(var e,t=PlayerVoManager.ins.playerVo,i=OfficerVoManager.ins.getEquipedOrNoEquiped(!0),n=OfficerVoManager.ins.getEquipedOrNoEquiped(!1),o=0,r=0,s=n.length;s>r;r++)if(e=n[r],!(e.metaOfficer.needLevel>t.level)){o=OfficerVoManager.ins.getNormalFightingForce(e);var a=0;if(0==i.length)return!0;for(var h=0,p=i.length;p>h;h++)if(a=OfficerVoManager.ins.getNormalFightingForce(i[h]),o>a)return!0}return!1},e.getCanLevelUpOfficer=function(){for(var e=PlayerVoManager.ins.playerVo,t=OfficerVoManager.ins.getCanLevelUpOfficers(),i=new Array,n=0,o=t.length;o>n;n++)t[n].metaOfficer.consumeCoin<=e.silver&&i.push(t[n]);return i},e.checkMagicWeaponLevelUp=function(){var e=MagicWeaponVoManager.ins.magicWeaponVo;if(e.id==Game.MAGIC_WEAPON_MAX_ID)return!1;var t=MetaMagicWeaponManager.ins.getWeapon(e.id);return t?t.needZhanyi<=e.zhanyi:!1},e.getTotalProperty=function(t){var i=OfficerVoManager.ins.getTotalProperty(t),n=e.getTotalEquipProperty(t),o=BodyVoMananger.ins.getTotalProperty(t),r=MagicWeaponVoManager.ins.getTotalProperty(t),s=PlayerVoManager.ins.getTotalProperty(t);return i+n+o+s+r},e.getTotalEquipProperty=function(t){var i=e.getEquipedEquipProperty(t),n=EquipVoMananger.ins.getNoTotalProperty(t);return n+i},e.getEquipedEquipProperty=function(e){for(var t=0,i=null,n=EquipType.WEAPON;n<=EquipType.CLOTH;n++){i=EquipVoMananger.ins.getEquipedForPart(n);var o=EquipVoMananger.ins.getProperty(i,e),r=EquipPartVoManager.ins.getPart(n),s=1;r&&(s=MetaEquipIntensifyManager.ins.getEquipPropertyAdd(n,r.level,e)),o=Math.floor(o*s),t+=o}return t},e.getTotalHighProperty=function(e){var t=SixProVoManager.ins.getProperty(Constants.LEVEL_SIX_PRO,e),i=QieCuoVoManager.ins.getHighProperty(e),n=SixProVoManager.ins.getProperty(Constants.HOZA_SIX_PRO,e);return t+i+n},e.getWuHon=function(){var e=RenownVoManager.ins.getWuHon(),t=MeridianVoManager.ins.getWuHon();return e+t},e.getTotalFightingForce=function(){var t=0,i=e.getTotalProperty(PropertyType.HP)*Constants.HP_2_FIGHTING,n=e.getTotalProperty(PropertyType.ATTACK)*Constants.ATTACK_2_FIGHTING,o=e.getTotalProperty(PropertyType.DEFENCE)*Constants.DEFENCE_2_FIGHTING,r=e.getTotalProperty(PropertyType.CRIT)*Constants.CRIT_2_FIGHTING,s=e.getTotalProperty(PropertyType.CRIT_HURT)*Constants.CRIT_HURT_2_FIGHTING,a=e.getTotalProperty(PropertyType.DODGE)*Constants.DODGE_2_FIGHTING,h=e.getTotalHighProperty(PropertyType.WULI)*Constants.WULI_2_FIGHTING,p=e.getTotalHighProperty(PropertyType.ZHILI)*Constants.ZHILI_2_FIGHTING,l=e.getTotalHighProperty(PropertyType.MINJIE)*Constants.MINJIE_2_FIGHTING,u=e.getTotalHighProperty(PropertyType.MEILI)*Constants.MEILI_2_FIGHTING,c=e.getTotalHighProperty(PropertyType.TONGSHUAI)*Constants.TONGSHUAI_2_FIGHTING,d=e.getTotalHighProperty(PropertyType.NEILI)*Constants.NEILI_2_FIGHTING,f=e.getTotalHighProperty(PropertyType.GENGU)*Constants.GENGU_2_FIGHTING,g=e.getTotalHighProperty(PropertyType.BILI)*Constants.BILI_2_FIGHTING,m=e.getWuHon()*Constants.WUHON_2_FIGHTING;return t=i+n+o+r+s+a+h+p+l+u+c+d+f+g+m,t=Math.max(0,t),t+=195e3},e.getOfficerFightingForce=function(e){void 0===e&&(e=!0);var t=OfficerVoManager.ins.getOfficerProperty(!0,PropertyType.HP)*Constants.HP_2_FIGHTING,i=OfficerVoManager.ins.getOfficerProperty(!0,PropertyType.ATTACK)*Constants.ATTACK_2_FIGHTING,n=OfficerVoManager.ins.getOfficerProperty(!0,PropertyType.DEFENCE)*Constants.DEFENCE_2_FIGHTING;return t+i+n},e.canOneKeyLevelUpOfficer=function(){for(var t=OfficerVoManager.ins.officers,i=0;i<t.length;i++)if(e.canLevelUpOfficer(t[i])&&e.canLevelUpOfficerForSilver(t[i]))return!0;return!1},e.canLevelUpOfficerForSilver=function(e){var t=PlayerVoManager.ins.playerVo;return t.silver>=e.metaOfficer.consumeCoin},e.canLevelUpOfficer=function(e){var t=MetaOfficerManager.ins.getOfficerMaxLevel(e.metaOfficer.type);return e.metaOfficer.level==t?!1:e.pieceCount<e.metaOfficer.consumeChip?!1:!0},e.canEquipOfficerForLevel=function(e){if(e.isEquiped)return!1;var t=PlayerVoManager.ins.playerVo;return e.metaOfficer.needLevel>t.level?!1:!0},e.getSelfEntityVo=function(t){void 0===t&&(t=-1);var i=MapEntityVoManager.ins.makeSelfEntityVo();return i.equipId=0,e.checkFunctionOpen(FunctionId.EQUIP)&&(i.equipId=EquipVoMananger.ins.getMaxQuality()),i.magicWeaponMetaId=MagicWeaponVoManager.ins.magicWeaponVo.id,i.hp=i.maxHp=1,i.body=BodyVoMananger.ins.bodyVo.id,i},e.dispose=function(){HuFuVoManager.ins.dispose(),MapVoManager.ins.dispose(),OfficerVoManager.ins.dispose(),QieCuoVoManager.ins.dispose(),RankVoManager.ins.dispose(),ShopVoManager.ins.dispose(),ChatVoManager.ins.dispose()},e}();__reflect(VoUtil.prototype,"VoUtil");var ActivityVo=function(){function e(){}return e.prototype.fromServer=function(e){this.id=e.id,this.beginTime=e.s,this.endTime=e.e,this.param=e.param},e}();__reflect(ActivityVo.prototype,"ActivityVo");var ActivityVoManager=function(){function e(){this.activities=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromServer=function(e){var t=e.dtoList;this.activities.length=0;for(var i=0,n=t.length;n>i;i++){var o=new ActivityVo;o.fromServer(t[i]),this.activities.push(o)}EventCenter.ins.send(EventCenter.UPDATE_ACTIVITY)},e.prototype.getActivity=function(e){for(var t=0,i=this.activities.length;i>t;t++)if(this.activities[t].id==e)return this.activities[t];return null},e._ins=null,e}();__reflect(ActivityVoManager.prototype,"ActivityVoManager");var BiGuanVo=function(){function e(){this.maxFloor=1,this.nowFloor=1}return e.prototype.fromServer=function(e){this.maxFloor=e.maxTong,this.nowFloor=e.tongtianta},e}();__reflect(BiGuanVo.prototype,"BiGuanVo");var BiGuanVoManager=function(){function e(){this.biguanVo=new BiGuanVo}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromServer=function(e){this.biguanVo.fromServer(e),EventCenter.ins.send(EventCenter.BIGUAN_UPDATE)},e.prototype.addFloor=function(e){var t=this.biguanVo.nowFloor+e;this.updateFloor(t)},e.prototype.updateFloor=function(e){this.biguanVo.nowFloor!=e&&(this.biguanVo.nowFloor=e,EventCenter.ins.send(EventCenter.BIGUAN_UPDATE))},e.prototype.oneKey=function(){this.addFloor(10)},e.prototype.checkRed=function(){return 0==this.biguanVo.nowFloor},e._ins=null,e}();__reflect(BiGuanVoManager.prototype,"BiGuanVoManager");var BodyVo=function(){function e(){this.id=0}return e.prototype.initFromServer=function(e){this.id=e.body},e}();__reflect(BodyVo.prototype,"BodyVo");var BodyVoMananger=function(){function e(){this.bodyVo=new BodyVo}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromServer=function(e){this.bodyVo.initFromServer(e);var t=MetaBodyManager.ins.getBody(this.bodyVo.id);this.bodyVo.color=t.color,this.bodyVo.star=t.star},e.prototype.levelUp=function(e,t){var i=MetaBodyManager.ins.getBody(e);this.bodyVo.id=e,this.bodyVo.color=i.color,this.bodyVo.star=i.star},e.prototype.levelUpStar=function(){var e=this.bodyVo.star+1,t=this.bodyVo.color;e>Game.BODY_MAX_STAR&&(this.bodyVo.color==Game.BODY_MAX_COLOR?e=Game.BODY_MAX_STAR:(t+=1,e=1)),this.bodyVo.star=e,this.bodyVo.color=t},e.prototype.getTotalProperty=function(e){var t=MetaBodyManager.ins.getMetaBody(this.bodyVo.color,this.bodyVo.star),i=0;return PropertyType.ATTACK==e?i+=t.attack:PropertyType.DEFENCE==e?i+=t.defence:PropertyType.HP==e&&(i+=t.hp),i},e.prototype.getNormalProperty=function(){var e=new NormalPropertyVo;return e.attack=this.getTotalProperty(PropertyType.ATTACK),e.defence=this.getTotalProperty(PropertyType.DEFENCE),e.hp=this.getTotalProperty(PropertyType.HP),e},e._ins=null,e}();__reflect(BodyVoMananger.prototype,"BodyVoMananger");var ChatPrivateMessageVo=function(){function e(){this.isSelf=!1}return e}();__reflect(ChatPrivateMessageVo.prototype,"ChatPrivateMessageVo");var ChatPrivateVo=function(){function e(){this.state=0,this.messages=new Array}return e.prototype.dispose=function(){Util.disposeArr(this.messages),this.messages=null},e}();__reflect(ChatPrivateVo.prototype,"ChatPrivateVo");var ChatVo=function(){function e(){this.bags=new Array}return e.prototype.fromServer=function(e){this.playerId=e.pid,this.playerName=e.pname,this.content=e.msg,this.serverId=e.server,this.type=e.type,this.rank=e.rank,this.ext=e.ext;for(var t=0,i=e.drop.length;i>t;t++){var n=new BagVo;n.fromServer(e.drop[t]),this.bags.push(n)}this.camp=e.country},e}();__reflect(ChatVo.prototype,"ChatVo");var ChatVoManager=function(){function e(){this.chatCount=0,this.newMessages=[0,0,0],this.campArr=new Array,this.allArr=new Array,this.privateArr=new Array,this.chats=new Array,this.privates=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){Util.disposeArr(this.campArr),Util.disposeArr(this.allArr),Util.disposeArr(this.privateArr),Util.disposeArr(this.chats);for(var e=0,t=this.privates.length;t>e;e++)this.privates[e].dispose(),delete this.privates[e];this.privates.length=0,this.newMessages=[0,0,0]},e.prototype.getChats=function(e){e+=1;for(var t=new Array,i=PlayerVoManager.ins.playerVo,n=0,o=this.chats.length;o>n;n++){var r=this.chats[n];r.type==e?t.push(r):e==ChatType.CAMP?i.camp==r.camp&&(ChatType.KILL_BOSS==r.type||ChatType.LOGIN==r.type||ChatType.SYSTEM==r.type)&&t.push(r):ChatType.WORLD==e&&(ChatType.KILL_BOSS==r.type||ChatType.KILL_PLAYER==r.type||ChatType.SYSTEM==r.type)&&t.push(r)}return t},e.prototype.fromServer=function(e){for(var t=0,i=e.length;i>t;t++){var n=new ChatVo;n.fromServer(e[t]),this.chats.push(n)}},e.prototype.updateNewMessage=function(e,t){this.newMessages[e]=t,EventCenter.ins.send(EventCenter.CHAT_UPDATE_NEW_MESSAGE,e+1)},e.prototype.addChat=function(e){var t=new ChatVo;if(t.fromServer(e),t.type==ChatType.PRIVATE){var i=PlayerVoManager.ins.playerVo;if(t.playerId==i.id){var n=t.ext.split(",");this.addPrivate(n[0],n[1],parseInt(n[2]),n[3],t.content,!0)}else this.addPrivate(t.playerId,t.playerName,t.camp,t.serverId,t.content,!1);this.updateNewMessage(2,1)}else ChatType.WORLD==t.type?(t.playerId==PlayerVoManager.ins.playerVo.id&&PlayerVoManager.ins.addWorldChatCount(),this.updateNewMessage(1,1)):ChatType.CAMP==t.type?this.updateNewMessage(0,1):ChatType.HELP_KILL_BOSS==t.type||ChatType.LOGIN==t.type?this.updateNewMessage(0,1):ChatType.KILL_BOSS==t.type?(this.updateNewMessage(0,1),this.updateNewMessage(1,1)):ChatType.KILL_PLAYER==t.type?(this.updateNewMessage(0,1),this.updateNewMessage(1,1)):ChatType.KILLED_PLAYER==t.type&&(this.updateNewMessage(0,1),this.updateNewMessage(1,1)),this.chats.push(t),EventCenter.ins.send(EventCenter.CHAT_ADD,t);return t},e.prototype.getPrivate=function(e){for(var t=0,i=this.privates.length;i>t;t++){var n=this.privates[t];if(n.playerId==e)return n}return null},e.prototype.addPrivate=function(e,t,i,n,o,r){if(void 0===r&&(r=!1),e!=PlayerVoManager.ins.playerVo.id){var s=this.getPrivate(e);s||(s=new ChatPrivateVo,s.playerId=e,s.playerName=t,s.camp=i,s.serverId=n,s.messages=new Array,this.privates.push(s));var a=new ChatPrivateMessageVo;a.isSelf=r,a.message=o,s.messages.push(a),s.state=0,EventCenter.ins.send(EventCenter.CHAT_ADD_PRIVATE_MESSAGE,e)}},e.prototype.readPrivate=function(e){var t=this.getPrivate(e);t&&(t.state=1)},e._ins=null,e}();__reflect(ChatVoManager.prototype,"ChatVoManager");var BagVo=function(){function e(){}return e.prototype.fromServer=function(e){this.category=e.category,this.count=e.count,this.staticId=e.staticId},e}();__reflect(BagVo.prototype,"BagVo");var NormalPropertyVo=function(){function e(){this.attack=0,this.defence=0,this.hp=0,this.dodge=0,this.crit=0,this.critHurt=0}return e}();__reflect(NormalPropertyVo.prototype,"NormalPropertyVo");var DayVo=function(){function e(){this.signedDay=0,this.hasSigned=!1,this.rechargeDay=0,this.hasRecharge=!1,this.getIds=new Array}return e}();__reflect(DayVo.prototype,"DayVo");var DayVoManager=function(){function e(){this.dayVo=new DayVo}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromServer=function(e,t){t==SignType.SIGN?(this.dayVo.signedDay=e.id1,this.dayVo.hasSigned=1==e.id2):SignType.RECHARGE==t&&(this.dayVo.rechargeDay=e.id1,this.dayVo.hasRecharge=1==e.id2)},e.prototype.sign=function(e){var t=MetaDayManager.ins.getDay(e);SignType.SIGN==t.type?(this.dayVo.signedDay++,this.dayVo.hasSigned=!0):SignType.RECHARGE==t.type&&(this.dayVo.rechargeDay++,this.dayVo.hasRecharge=!0),EventCenter.ins.send(EventCenter.DAY_CHECK)},e._ins=null,e}();__reflect(DayVoManager.prototype,"DayVoManager");var EquipVo=function(){function e(){this.count=0}return e.prototype.initFromServer=function(e){this.id=e.equip,this.isEquiped=1==e.fight,this.metaEquip=MetaEquipManager.ins.getEquip(e.equip),this.count=e.count},e}();__reflect(EquipVo.prototype,"EquipVo");var EquipVoMananger=function(){function e(){this.equips=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromServer=function(e){this.dispose();for(var t,i=e.length,n=0;i>n;n++)t=new EquipVo,t.initFromServer(e[n]),this.equips.push(t)},e.prototype.addEquipPiece=function(e,t){var i=this.getEquip(e);i||(i=new EquipVo,i.id=e,i.metaEquip=MetaEquipManager.ins.getEquip(e),i.isEquiped=!1,this.equips.push(i)),i.count+=t,EventCenter.ins.send(EventCenter.EQUIP_UPDATE,i)},e.prototype.reduceEquipPiece=function(e,t){var i=this.getEquip(e);i&&(i.count-=t,EventCenter.ins.send(EventCenter.EQUIP_UPDATE,i))},e.prototype.getProperty=function(e,t){if(!e)return 0;var i=0;return PropertyType.ATTACK==t?i+=e.metaEquip.attack:PropertyType.DEFENCE==t?i+=e.metaEquip.defence:PropertyType.HP==t?i+=e.metaEquip.hp:PropertyType.DODGE==t&&(i+=e.metaEquip.dodge),i},e.prototype.getMaxQuality=function(){for(var e,t=null,i=(new Array,0),n=0,o=this.equips.length;o>n;n++)e=this.equips[n],e.metaEquip.color>=i&&(t?e.metaEquip.part<t.metaEquip.part?t=e:e.metaEquip.part==t.metaEquip.part&&t.metaEquip.id>e.metaEquip.id&&(t=e):t=e,i=e.metaEquip.color);return t?t.id:0},e.prototype.getTotalNormalProperty=function(){for(var e,t=new NormalPropertyVo,i=new NormalPropertyVo,n=null,o=0,r=this.equips.length;r>o;o++){e=this.equips[o],n=MetaEquipManager.ins.getEquip(e.id);var s=EquipPartVoManager.ins.getPart(n.part),a=null;s&&(a=MetaEquipIntensifyManager.ins.getEquipIntensifyForPart(s.part,s.level)),e.isEquiped?(t.hp+=Math.floor(n.hp*e.count*(a?a.hp/100:1)),t.defence+=Math.floor(n.defence*e.count*(a?a.defence/100:1)),t.attack+=Math.floor(n.attack*e.count*(a?a.attack/100:1))):(i.hp+=n.hp*e.count,i.defence+=n.defence*e.count,i.attack+=n.attack*e.count)}var h=new NormalPropertyVo;return h.attack=t.attack+Math.floor(.1*i.attack),h.defence=t.defence+Math.floor(.1*i.defence),h.hp=t.hp+Math.floor(.1*i.hp),h},e.prototype.getSixProperty=function(){for(var e,t=new SixPropertyVo,i=null,n=0,o=this.equips.length;o>n;n++)e=this.equips[n],e.isEquiped&&(i=MetaEquipManager.ins.getEquip(e.id),t.wuli+=i.head,t.zhili+=i.hand,t.neili+=i.foot,t.tongshuai+=i.force,t.minjie+=i.fly,t.meili+=i.pre);return t},e.prototype.getTotalProperty=function(e){var t=0,i=this.getEquipedForPart(EquipType.WEAPON);t+=this.getProperty(i,e),i=this.getEquipedForPart(EquipType.HORSE),t+=this.getProperty(i,e);for(var n=this.getNoEquipedForPart(EquipType.WEAPON),o=0,r=0,s=n.length;s>r;r++)i=n[r],o+=this.getProperty(i,e);n=this.getNoEquipedForPart(EquipType.HORSE);for(var r=0,s=n.length;s>r;r++)i=n[r],o+=this.getProperty(i,e);return t+=Math.floor(.1*o)},e.prototype.getNoTotalProperty=function(e){for(var t=0,i=null,n=EquipType.WEAPON;n<=EquipType.CLOTH;n++)for(var o=this.getNoEquipedForPart(EquipType.WEAPON),r=0,s=0,a=o.length;a>s;s++)i=o[s],r+=this.getProperty(i,e);return Math.floor(.1*t)},e.prototype.getEquipsForFirst=function(){for(var t=new Array,i=EquipType.WEAPON;i<=EquipType.CLOTH;i++){var n=e.ins.getNoEquipedForPart(i),o=e.ins.getEquipedForPart(i);if(o)return[];0!=n.length&&t.push(i)}return t},e.prototype.getEquipedForPart=function(e){for(var t=0,i=this.equips.length;i>t;t++){var n=this.equips[t];if(n.isEquiped&&n.metaEquip.part==e)return n}return null},e.prototype.getNoEquipedForPart=function(e){for(var t=new Array,i=0,n=this.equips.length;n>i;i++){var o=this.equips[i];o.isEquiped||o.metaEquip.part!=e||t.push(o)}return t},e.prototype.equip=function(e,t){var i=this.getEquipedForPart(t);i&&(i.isEquiped=!1);var n=this.getEquip(e);n&&(n.isEquiped=!0)},e.prototype.getEquip=function(e){for(var t=0,i=this.equips.length;i>t;t++){var n=this.equips[t];if(n.id==e)return n}return null},e.prototype.getEquipForMetaId=function(e){for(var t=0,i=this.equips.length;i>t;t++){var n=this.equips[t];if(n.metaEquip.id==e)return n}return null},e.prototype.getOneEquipFightingForce=function(e){var t=this.getProperty(e,PropertyType.ATTACK)*e.count,i=this.getProperty(e,PropertyType.DEFENCE)*e.count,n=this.getProperty(e,PropertyType.HP)*e.count,o=this.getProperty(e,PropertyType.DODGE)*e.count,r=t*Constants.ATTACK_2_FIGHTING+i*Constants.DEFENCE_2_FIGHTING+n*Constants.HP_2_FIGHTING+o*Constants.DODGE_2_FIGHTING;return r},e.prototype.getTotalFightingForce=function(){for(var e=0,t=0,i=this.equips.length;i>t;t++)e+=this.getOneEquipFightingForce(this.equips[t]);return e},e.prototype.getOneFightingForce=function(e){var t=0,i=this.getProperty(e,PropertyType.ATTACK),n=this.getProperty(e,PropertyType.DEFENCE),o=this.getProperty(e,PropertyType.HP),r=this.getProperty(e,PropertyType.DODGE);if(e.isEquiped){var s=EquipPartVoManager.ins.getPart(e.metaEquip.part);if(s){var a=MetaEquipIntensifyManager.ins.getEquipIntensifyForPart(e.metaEquip.part,s.level);i*=0==a.attack?1:a.attack/100,n*=0==a.defence?1:a.defence/100,o*=0==a.hp?1:a.hp/100,r*=1}}else i=Math.floor(i),n=Math.floor(n),o=Math.floor(o),r=Math.floor(r);return t=i*Constants.ATTACK_2_FIGHTING+n*Constants.DEFENCE_2_FIGHTING+o*Constants.HP_2_FIGHTING+r*Constants.DODGE_2_FIGHTING},e.prototype.checkCanDress=function(e){var t=this,i=t.getEquipedForPart(e),n=t.getNoEquipedForPart(e);if(!i)return n.length>0?!0:!1;for(var o=t.getOneEquipFightingForce(i),r=0,s=n.length;s>r;r++){var a=t.getOneEquipFightingForce(n[r]);if(a>o)return!0}return!1},e.prototype.dispose=function(){this.equips.length=0},e._ins=null,e}();__reflect(EquipVoMananger.prototype,"EquipVoMananger");var EquipPartVo=function(){function e(){}return e.prototype.fromServer=function(e){this.level=e.lv,this.part=e.id,this.exp=e.exp},e}();__reflect(EquipPartVo.prototype,"EquipPartVo");var EquipPartVoManager=function(){function e(){this.equipParts=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromServer=function(e){this.dispose();for(var t=e.length,i=0;t>i;i++){var n=new EquipPartVo;n.fromServer(e[i]),this.equipParts.push(n)}},e.prototype.getPart=function(e){for(var t=0,i=this.equipParts.length;i>t;t++)if(this.equipParts[t].part==e)return this.equipParts[t];return null},e.prototype.getTotalLevel=function(){for(var e=0,t=0,i=this.equipParts.length;i>t;t++)e+=this.equipParts[t].level;return e},e.prototype.updateVo=function(e,t,i){var n=this.getPart(e);n.level=t,n.exp=i},e.prototype.dispose=function(){this.equipParts.length=0},e._ins=null,e}();__reflect(EquipPartVoManager.prototype,"EquipPartVoManager");var GoAwayVo=function(){function e(){this.remainderTime=0}return e}();__reflect(GoAwayVo.prototype,"GoAwayVo");var GoAwayVoManager=function(){function e(){this.mHasDispatch=!1,this.goAwayVo=new GoAwayVo
}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.setCD=function(e){this.mHasDispatch=!1,this.goAwayVo.remainderTime=e,TimerManager.ins.addTimer(this)},e.prototype.reset=function(){this.goAwayVo.remainderTime=MetaConfigManager.ins.getConfig("back_city_cd"),TimerManager.ins.addTimer(this)},e.prototype.runTimer=function(){this.goAwayVo.remainderTime>0&&(this.goAwayVo.remainderTime--,EventCenter.ins.send(EventCenter.GO_AWAY_UPDATE))},e._ins=null,e}();__reflect(GoAwayVoManager.prototype,"GoAwayVoManager",["ITimer"]);var GuideVo=function(){function e(){this.nowStep=20}return e}();__reflect(GuideVo.prototype,"GuideVo");var GuideVoManager=function(){function e(){this.guideVo=new GuideVo}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromServer=function(e){e=0==e?1:17,this.guideVo.nowStep=e},e.prototype.setStep=function(e){var t=e,i=e+50;this.guideVo.nowStep>=t&&this.guideVo.nowStep<i||(this.guideVo.nowStep=e,EventCenter.ins.send(EventCenter.GUIDE_CHECK))},e.prototype.isStep=function(e){return this.guideVo.nowStep==e},e.prototype.isShopStep=function(e){return this.guideVo.nowStep==GuideStepNum.SHOP+e},e.prototype.isJueseStep=function(e){return this.guideVo.nowStep==GuideStepNum.JUE_SE+e},e.prototype.isBiGuanStep=function(e){return this.guideVo.nowStep==GuideStepNum.BI_GUAN+e},e.prototype.isShenBingStep=function(e){return this.guideVo.nowStep==GuideStepNum.SHEN_BING+e},e.prototype.isTianShuStep=function(e){return this.guideVo.nowStep==GuideStepNum.TIAN_SHU+e},e.prototype.isBaoWuStep=function(e){return this.guideVo.nowStep==GuideStepNum.BAO_WU+e},e.prototype.isJingMaiStep=function(e){return this.guideVo.nowStep==GuideStepNum.JING_MAI+e},e.prototype.isHouJinStep=function(e){return this.guideVo.nowStep==GuideStepNum.HOU_JIN+e},e.prototype.skipStep=function(e){this.guideVo.nowStep+=e,EventCenter.ins.send(EventCenter.GUIDE_CHECK)},e.prototype.canGuide=function(e){return!0},e.prototype.getShopStep=function(e){return GuideStepNum.SHOP+e},e._ins=null,e}();__reflect(GuideVoManager.prototype,"GuideVoManager");var HozaVo=function(){function e(){this.level=0,this.studyPoint=0,this.remainderExchangeCount=0,this.exchangeXueDian=0,this.exchangeSilver=5}return e.prototype.fromServer=function(e){this.level=e.houjin,this.studyPoint=e.xuedian,this.remainderExchangeCount=e.exchangeTimes,this.exchangeXueDian=e.exchangeXuedian,this.exchangeSilver=e.exchangeSilver},e}();__reflect(HozaVo.prototype,"HozaVo");var HozaVoManager=function(){function e(){this.hozaVo=new HozaVo}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromServer=function(e){this.hozaVo.fromServer(e);var t=(MetaHozaManager.ins.getHoza(this.hozaVo.level),MetaConfigManager.ins.getConfig("houjin_exchange_time"));this.hozaVo.remainderExchangeCount=Math.max(0,t-this.hozaVo.remainderExchangeCount),EventCenter.ins.send(EventCenter.HOZA_UPDATE_STUDY_POINT)},e.prototype.updateStudyPoint=function(e){this.hozaVo.studyPoint=e,EventCenter.ins.send(EventCenter.HOZA_UPDATE_STUDY_POINT)},e.prototype.operStudyPoint=function(e,t){void 0===t&&(t=!0),t?this.hozaVo.studyPoint+=e:this.hozaVo.studyPoint-=e,EventCenter.ins.send(EventCenter.HOZA_UPDATE_STUDY_POINT)},e.prototype.levelUp=function(){this.hozaVo.level++},e._ins=null,e}();__reflect(HozaVoManager.prototype,"HozaVoManager");var HozaShopVo=function(){function e(){this.id=0,this.count=0}return e.prototype.fromServer=function(e,t){this.id=e,this.count=t},e}();__reflect(HozaShopVo.prototype,"HozaShopVo");var HozaShopVoManager=function(){function e(){this.shops=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromServer=function(e){for(var t in e){var i=new HozaShopVo;i.fromServer(parseInt(t),e[t]);var n=MetaHozaShopManager.ins.getShop(i.id);i.count=n.limitCount-i.count,this.shops.push(i)}},e.prototype.buy=function(e){var t=this.getShop(e);if(!t){t=new HozaShopVo;var i=MetaHozaShopManager.ins.getShop(e);t.id=e,t.count=i.limitCount,this.shops.push(t)}t.count--},e.prototype.getShop=function(e){for(var t=null,i=0,n=this.shops.length;n>i;i++)if(t=this.shops[i],t.id==e)return t;t=new HozaShopVo;var o=MetaHozaShopManager.ins.getShop(e);return t.id=e,t.count=o.limitCount,this.shops.push(t),t},e._ins=null,e}();__reflect(HozaShopVoManager.prototype,"HozaShopVoManager");var HuFuVo=function(){function e(){this.count=0}return e.prototype.fromServer=function(e){this.count=e.count},e}();__reflect(HuFuVo.prototype,"HuFuVo");var HuFuVoManager=function(){function e(){this.startTime=0,this.hufuVo=new HuFuVo}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromServer=function(e){this.dispose(),this.hufuVo.fromServer(e),TimerManager.ins.addTimer(this),EventCenter.ins.send(EventCenter.HUFU_UPDATE)},e.prototype.setHuFuCount=function(e){this.hufuVo.count=e},e.prototype.operHuFu=function(e,t){if(void 0===t&&(t=!0),t){if(this.hufuVo.count>=Game.HUFU_MAX_COUNT)return;this.hufuVo.count+=e}else this.hufuVo.count-=e;EventCenter.ins.send(EventCenter.HUFU_UPDATE)},e.prototype.runTimer=function(){this.startTime++,this.startTime>=Game.HUFU_ADD_REALLY_TIME&&(this.operHuFu(1),this.startTime=0)},e.prototype.dispose=function(){TimerManager.ins.removeTimer(this)},e._ins=null,e}();__reflect(HuFuVoManager.prototype,"HuFuVoManager",["ITimer"]);var ItemVo=function(){function e(){}return e.prototype.fromServer=function(e){this.id=e.id,this.metaId=e.metaId,this.metaItem=MetaItemManager.ins.getItem(this.metaId)},e}();__reflect(ItemVo.prototype,"ItemVo");var ItemVoManager=function(){function e(){this.items=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromServer=function(e){for(var t=e.length,i=0;t>i;i++){var n=new ItemVo;n.fromServer(e[i]),this.items.push(n)}},e._ins=null,e}();__reflect(ItemVoManager.prototype,"ItemVoManager");var KuaFuVo=function(){function e(){this.enterCD=0,this.remainderChangeCampTime="",this.port=0}return e.prototype.fromServer=function(e){for(var t=e.changeCD.split(":"),i=0,n=t.length;n>i;i++){var o=t[i];o.length<2&&(o="0"+o,t[i]=o)}this.remainderChangeCampTime=t.join(":"),this.enterCD=Math.ceil(.001*e.cd)},e}();__reflect(KuaFuVo.prototype,"KuaFuVo");var KuaFuVoManager=function(){function e(){this.kuafuVo=new KuaFuVo}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromServer=function(e){this.kuafuVo.fromServer(e)},e.prototype.setKuaFuServer=function(e){this.kuafuVo.ip=e.ip,this.kuafuVo.port=e.port},e._ins=null,e}();__reflect(KuaFuVoManager.prototype,"KuaFuVoManager");var LevelVo=function(){function e(){this.head=0,this.hand=0,this.foot=0,this.force=0,this.fly=0,this.pre=0}return e.prototype.fromServer=function(e){this.head=e.head,this.hand=e.hand,this.foot=e.foot,this.force=e.force,this.fly=e.fly,this.pre=e.pre},e}();__reflect(LevelVo.prototype,"LevelVo");var LevelVoManager=function(){function e(){this.levelVo=new LevelVo}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromServer=function(e){this.levelVo.fromServer(e)},e._ins=null,e}();__reflect(LevelVoManager.prototype,"LevelVoManager");var MagicWeaponVo=function(){function e(){this.zhanyi=0,this.cd=0}return e.prototype.fromServer=function(e){this.id=e.shenbing,this.zhanyi=e.zhanyi,this.cd=e.cd},e}();__reflect(MagicWeaponVo.prototype,"MagicWeaponVo");var MagicWeaponVoManager=function(){function e(){this.magicWeaponVo=new MagicWeaponVo}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromServer=function(e){this.magicWeaponVo.fromServer(e),EventCenter.ins.send(EventCenter.WARTH_COUNT_UPDATE)},e.prototype.addWarth=function(e){this.magicWeaponVo.zhanyi+=e,EventCenter.ins.send(EventCenter.WARTH_COUNT_UPDATE)},e.prototype.reduceWarth=function(e){this.magicWeaponVo.zhanyi-=e,EventCenter.ins.send(EventCenter.WARTH_COUNT_UPDATE)},e.prototype.setWarthCount=function(e){this.magicWeaponVo.zhanyi=e,EventCenter.ins.send(EventCenter.WARTH_COUNT_UPDATE)},e.prototype.levelUp=function(){this.magicWeaponVo.id++},e.prototype.runRemainderTime=function(){this.magicWeaponVo.cd--,this.magicWeaponVo.cd=Math.max(0,this.magicWeaponVo.cd)},e.prototype.getTotalProperty=function(e){var t=MetaMagicWeaponManager.ins.getWeapon(this.magicWeaponVo.id);if(!t)return 0;var i=0;return e==PropertyType.ATTACK?i=t.attack:PropertyType.CRIT==e?i=t.crit:PropertyType.CRIT_HURT==e&&(i=t.critAttack),i},e.prototype.getTotalNormalProperty=function(){var e=new NormalPropertyVo;return e.attack=this.getTotalProperty(PropertyType.ATTACK),e.crit=this.getTotalProperty(PropertyType.CRIT),e.critHurt=this.getTotalProperty(PropertyType.CRIT_HURT),e},e._ins=null,e}();__reflect(MagicWeaponVoManager.prototype,"MagicWeaponVoManager");var MailVo=function(){function e(){this.sendTime=0,this.remainderTime=0,this.state=0,this.rewards=new Array}return e.prototype.fromServer=function(e){this.id=e.id,this.title=e.title,this.content=e.content,this.sender="系统",this.sendTime=e.time,this.remainderTime=e.remainTime;for(var t=0,i=e.attach.length;i>t;t++){var n=new BagVo;n.fromServer(e.attach[t]),this.rewards.push(n)}},e}();__reflect(MailVo.prototype,"MailVo");var MailVoManager=function(){function e(){this.mails=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromServer=function(e){this.mails.length=0;for(var t=0,i=e.length;i>t;t++){var n=new MailVo;n.fromServer(e[t]),n.remainderTime<=0||this.mails.push(n)}},e.prototype.addMail=function(e){var t=new MailVo;t.fromServer(e),this.mails.push(t),EventCenter.ins.send(EventCenter.MAIL_UPDATE_LIST)},e.prototype.hasNew=function(){for(var e=0,t=this.mails.length;t>e;e++){var i=this.mails[e];if(0==i.state)return!0}return!1},e.prototype.getMail=function(e){for(var t=0,i=this.mails.length;i>t;t++){var n=this.mails[t];if(n.id==e)return n}return null},e.prototype.delMail=function(e){for(var t=0,i=this.mails.length;i>t;t++)if(this.mails[t].id==e){this.mails.splice(t,1);break}EventCenter.ins.send(EventCenter.MAIL_UPDATE_LIST)},e._ins=null,e}();__reflect(MailVoManager.prototype,"MailVoManager");var MapMonsterVo=function(){function e(){}return e.prototype.fromServer=function(e){this.monsterId=e.monsterId,this.cd=e.cd},e}();__reflect(MapMonsterVo.prototype,"MapMonsterVo");var MapVo=function(){function e(){this.cd=0,this.isLocked=!0,this.red=!1,this.monsters=new Array,this.maxCD=0,this.monsterMinCD=0,this.monsterCD=0}return e.prototype.fromServer=function(e){this.metaId=e.id,this.maxCD=MetaMapManager.ins.getMap(this.metaId).reliveCd,this.cd=Math.ceil(.001*e.cd),this.red=1==e.red;e.cds;this.monsterCD=0,this.monsterMinCD=0;var t=Number.MAX_VALUE,i=!1;for(var n in e.cds){var o=new MapMonsterVo;if(o.monsterId=parseInt(n),o.cd=Math.ceil(.001*parseInt(e.cds[n])),o.cd<t){var r=MetaMonsterManager.ins.getMonster(o.monsterId);t=o.cd,this.monsterMinCD=t,this.monsterCD=r.relive}i=!0,this.monsters.push(o)}i||(this.monsterCD=0,this.monsterMinCD=0)},e}();__reflect(MapVo.prototype,"MapVo");var MapVoManager=function(){function e(){this.maps=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromServer=function(e){this.dispose();for(var t,i=e.length,n=0;i>n;n++){var o=new MapVo;t=e[n],9021==t.id&&log("mapIdid:"+o.metaId),o.fromServer(t),(6e3==o.metaId||6001==o.metaId||6002==o.metaId)&&log("id:"+o.metaId+", time:"+o.monsterCD),this.maps.push(o)}TimerManager.ins.addTimer(this)},e.prototype.dispose=function(){TimerManager.ins.removeTimer(this);for(var e=0,t=this.maps.length;t>e;e++){for(var i=this.maps[e],n=0,o=i.monsters.length;o>n;n++)delete i.monsters[n];delete this.maps[e]}this.maps.length=0},e.prototype.getMap=function(e){for(var t=this.maps.length,i=0;t>i;i++)if(this.maps[i].metaId==e)return this.maps[i];return null},e.prototype.getMapMaxCD=function(e){var t=this.getMap(e);if(!t)return 0;for(var i=0,n=t.monsters.length,o=0;n>o;o++)t.monsters[o].cd>i&&(i=t.monsters[o].cd);return i},e.prototype.checkMapCD=function(e){var t=this.getMap(e);if(!t)return!1;for(var i=t.monsters.length,n=0;i>n;n++)if(t.monsters[n].cd>0)return!0;return!1},e.prototype.runTimer=function(){for(var e=0,t=this.maps.length;t>e;e++){for(var i=this.maps[e],n=0,o=i.monsters.length;o>n;n++){var r=i.monsters[n];r.cd>0&&(r.cd--,0==r.cd&&EventCenter.ins.send(EventCenter.WORLD_MAP_MONSTER_UPDATE,i.metaId))}i.monsterMinCD>0&&i.monsterMinCD--,i.cd>=0&&(i.cd--,EventCenter.ins.send(EventCenter.WORLD_MAP_CD_UPDATE,{mapId:i.metaId,maxCD:i.maxCD,cd:i.cd}))}},e._ins=null,e}();__reflect(MapVoManager.prototype,"MapVoManager",["ITimer"]);var MapEntityVo=function(){function e(){this.body=0,this.magicWeaponMetaId=0,this.equipId=0,this.red=!1}return e}();__reflect(MapEntityVo.prototype,"MapEntityVo");var MapMonsterTargetVo=function(){function e(){}return e}();__reflect(MapMonsterTargetVo.prototype,"MapMonsterTargetVo");var MapEntityVoManager=function(){function e(){this.hasInited=!1,this.enemyPlayers=new Array,this.otherPlayers=new Array,this.monsterTargets=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.onEnterMap=function(e){this.dispose();for(var t=PlayerVoManager.ins.playerVo,i=e.monsters,n=e.players,o=i.length,r=0;o>r;r++){var s=this.makeEntityVo(i[r],EntityType.MONSTER);s.isSelf=!1,s.red?this.enemyPlayers.unshift(s):t.level>Game.SHOW_BOSS_LEVEL&&this.enemyPlayers.push(s)}if(t.level>Game.SHOW_BOSS_LEVEL){o=n.length;for(var r=0;o>r;r++){var s=this.makeEntityVo(n[r],EntityType.PLAYER);this.enemyPlayers.push(s)}}for(var r=0,a=e.length;a>r;r++){var h=new MapMonsterTargetVo,p=e[r];h.monsterId=p.monsterId,h.playerCamp=p.targetCountry,h.playerName=p.targetName,this.monsterTargets.push(h)}this.selfEntityVo=VoUtil.getSelfEntityVo(),this.selfEntityVo.hp=e.hp,this.selfEntityVo.maxHp=e.maxHp,this.capacityDrop=e.capacityDrop},e.prototype.removeTarget=function(e){for(var t=0,i=this.monsterTargets.length;i>t;t++)if(e==this.monsterTargets[t].monsterId){this.monsterTargets.splice(t,1);break}},e.prototype.getMonsterTarget=function(e){for(var t=0,i=this.monsterTargets.length;i>t;t++)if(e==this.monsterTargets[t].monsterId)return this.monsterTargets[t];return null},e.prototype.updateMonsterTarget=function(e){var t=this.getMonsterTarget(e.monsterId);t?(t.playerCamp=e.targetCountry,t.playerName=e.targetName):(t=new MapMonsterTargetVo,t.monsterId=e.monsterId,t.playerCamp=e.targetCountry,t.playerName=e.targetName,this.monsterTargets.push(t))},e.prototype.makeSelfEntityVo=function(){var e=new MapEntityVo,t=PlayerVoManager.ins.playerVo;return e.id=t.id,e.name=t.name,e.head=t.head,e.camp=t.camp,e.isMonster=!1,e.isSelf=!0,e},e.prototype.dispose=function(){for(var e=0;e<this.enemyPlayers.length;e++)delete this.enemyPlayers[e];this.enemyPlayers=[];for(var e=0;e<this.monsterTargets.length;e++)delete this.monsterTargets[e];this.monsterTargets=[],delete this.selfEntityVo},e.prototype.makeEntityVo=function(e,t){var i=new MapEntityVo;if(i.id=e.id,i.entityType=t,EntityType.MONSTER==t){var n=MetaMonsterManager.ins.getMonster(parseInt(i.id));i.name=n.name,i.red=1==e.red,i.entityType=e.type,i.isMonster=!0}else i.name=e.name,i.camp=e.country,i.head=e.head,i.isMonster=!1,i.equipId=e.equips,i.magicWeaponMetaId=e.shenbing,i.body=e.body;return i.isSelf=!1,i.hp=e.hp,i.maxHp=e.maxHp,i},e}();__reflect(MapEntityVoManager.prototype,"MapEntityVoManager");var MeridianVo=function(){function e(){}return e.prototype.initFromServer=function(e){this.id=e.id,this.count=e.exp},e}();__reflect(MeridianVo.prototype,"MeridianVo");var MeridianVoManager=function(){function e(){this.meridianVo=new MeridianVo}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromServer=function(e){this.meridianVo.initFromServer(e)},e.prototype.operCount=function(e,t){void 0===t&&(t=!1),t?this.meridianVo.count+=e:this.meridianVo.count-=e,EventCenter.ins.send(EventCenter.MERIDIAN_COUNT_UPDATE)},e.prototype.getWuHon=function(){var e=MetaMeridianManager.ins.getMeridianForId(this.meridianVo.id);return e.wuhon},e.prototype.canLevelUp=function(){if(this.meridianVo.id==MetaMeridianManager.maxId)return!1;var e=MetaMeridianManager.ins.getMeridianForId(this.meridianVo.id);return e.costCultivation<=this.meridianVo.count},e._ins=null,e}();__reflect(MeridianVoManager.prototype,"MeridianVoManager");var NewbieWelfareVo=function(){function e(){this.state=0,this.dayList=[],this.nowDay=0,this.hasGet=!1}return e}();__reflect(NewbieWelfareVo.prototype,"NewbieWelfareVo");var NewbieWelfareVoManager=function(){function e(){this.newbieWelfareVo=new NewbieWelfareVo}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromServer=function(e){this.newbieWelfareVo.state=e.state,this.newbieWelfareVo.dayList=e.taked,this.newbieWelfareVo.nowDay=0==e.cur?1:e.cur,this.newbieWelfareVo.hasGet=1==e.today,EventCenter.ins.send(EventCenter.NEWBIE_WELFARE)},e.prototype.sign=function(e){this.newbieWelfareVo.dayList.push(e),this.newbieWelfareVo.hasGet=!0,7==e&&(this.newbieWelfareVo.state=0),EventCenter.ins.send(EventCenter.NEWBIE_WELFARE)},e.prototype.hasGet=function(e){for(var t=0,i=this.newbieWelfareVo.dayList.length;i>t;t++)if(this.newbieWelfareVo.dayList[t]==e)return!0;return!1},e._ins=null,e}();__reflect(NewbieWelfareVoManager.prototype,"NewbieWelfareVoManager");var NewbieWelfareVoManger=function(){function e(){this.NewbieWelfareVo=new NewbieWelfareVo}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromServer=function(e,t){t==SignType.SIGN||SignType.RECHARGE==t},e._ins=null,e}();__reflect(NewbieWelfareVoManger.prototype,"NewbieWelfareVoManger");var OfficerVo=function(){function e(){this.pieceCount=0,this.level=0}return e.prototype.initFromServer=function(e){this.id=e.id,this.isEquiped=1==e.fight,this.level=e.lv,this.metaOfficer=MetaOfficerManager.ins.getOfficerForTypeAndLevel(this.id,this.level),this.metaId=this.id,this.pieceCount=e.count},e}();__reflect(OfficerVo.prototype,"OfficerVo");var OfficerVoManager=function(){function e(){this.officers=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.initFromServer=function(e){this.dispose();for(var t=e.fightHeros.concat(e.otherHeros),i=t.length,n=0;i>n;n++){var o=new OfficerVo;o.initFromServer(t[n]),this.officers.push(o)}Game.eventCenter.send(EventCenter.UPDATE_OFFICER_PIECE,null)},e.prototype.getOfficerCount=function(){for(var e,t=0,i=0,n=this.officers.length;n>i;i++)e=this.officers[i],t+=this.getOneOfficerCount(e);return t},e.prototype.getOneOfficerCount=function(e){var t=e.pieceCount;if(1==e.metaOfficer.level)return t;for(var i=null,n=1,o=e.level;o>n;n++)i=MetaOfficerManager.ins.getOfficerForTypeAndLevel(e.metaOfficer.type,n),t+=i.consumeChip;return t},e.prototype.getOfficersLevel=function(e){void 0===e&&(e=!0);for(var t=new Array,i=this.getEquipedOrNoEquiped(e),n=0,o=i.length;o>n;n++){var r=i[n];t.push({type:r.id,level:r.level})}return t},e.prototype.equipOfficer=function(e,t){e.isEquiped=!1,t.isEquiped=!0},e.prototype.levelUpOfficer=function(e){for(var t=this.getOfficer(e),i=t.pieceCount,n=t.metaOfficer,o=MetaOfficerManager.ins.getOfficerMaxLevel(n.type),r=0;;){if(i-(r+n.consumeChip)<0)break;if(n.level==o)break;r+=n.consumeChip,n=MetaOfficerManager.ins.getNextLevelOfficer(n.id)}t.pieceCount=i-r,t.metaOfficer=n,Game.eventCenter.send(EventCenter.UPDATE_VO_OFFICER_LEVEL_UP,t)},e.prototype.addOfficerPieceForId=function(e,t){var i=this.getOfficer(e);if(i)i.pieceCount+=t;else{i=new OfficerVo;var n=MetaOfficerManager.ins.getOfficer(e);i.initFromServer({id:n.type,fight:0,lv:1,count:t}),EventCenter.ins.send(EventCenter.OFFICER_NEW),this.officers.push(i)}Game.eventCenter.send(EventCenter.UPDATE_OFFICER_PIECE,i)},e.prototype.addOfficerPiece=function(e,t){var i=this.getOfficerForType(e);i?i.pieceCount+=t:(i=new OfficerVo,i.initFromServer({id:e,fight:0,lv:1,count:t}),EventCenter.ins.send(EventCenter.OFFICER_NEW),this.officers.push(i)),Game.eventCenter.send(EventCenter.UPDATE_OFFICER_PIECE,i)},e.prototype.reduceOfficerPiece=function(e,t){var i=this.getOfficer(e);i.pieceCount-=t,Game.eventCenter.send(EventCenter.UPDATE_OFFICER_PIECE,i)},e.prototype.getOfficer=function(e){for(var t=this.officers.length,i=0;t>i;i++)if(this.officers[i].id==e)return this.officers[i];return null},e.prototype.getOfficerForType=function(e){for(var t=this.officers.length,i=0;t>i;i++)if(this.officers[i].metaOfficer.type==e)return this.officers[i];return null},e.prototype.getEquipedOrNoEquiped=function(e){void 0===e&&(e=!1);for(var t=new Array,i=0;i<this.officers.length;i++)this.officers[i].isEquiped==e&&t.push(this.officers[i]);return t},e.prototype.getNoOfficers=function(){for(var e=new Array,t=MetaOfficerManager.ins.officers,i=0,n=t.length;n>i;i++){var o=t[i];1!=o.level||this.getOfficerForType(o.type)||e.push(o)}return e},e.prototype.getCanLevelUpOfficers=function(){for(var e=new Array,t=0;t<this.officers.length;t++)this.canLevelUp(this.officers[t])&&e.push(this.officers[t]);return e},e.prototype.canLevelUp=function(e){var t=MetaOfficerManager.ins.getNextLevelOfficer(e.metaOfficer.id);return t?e.pieceCount>=e.metaOfficer.consumeChip:!1},e.prototype.oneKeyEquipOfficer=function(e,t){for(var i,n=0,o=this.officers.length;o>n;n++)i=this.officers[n],e.indexOf(i.id)>=0?i.isEquiped=!0:i.isEquiped=!1},e.prototype.getNormalPropertyVo=function(){for(var e,t=new NormalPropertyVo,i=new NormalPropertyVo,n=0,o=this.officers.length;o>n;n++)e=this.officers[n],e.isEquiped?(t.attack+=e.metaOfficer.attack,t.defence+=e.metaOfficer.defence,t.hp+=e.metaOfficer.hp):(i.attack+=Math.ceil(.1*e.metaOfficer.attack),i.defence+=Math.ceil(.1*e.metaOfficer.defence),i.hp+=Math.ceil(.1*e.metaOfficer.hp));var r=new NormalPropertyVo;return r.attack=t.attack+i.attack,r.defence=t.defence+i.defence,r.hp=t.hp+i.hp,r},e.prototype.getTotalProperty=function(e){var t=this.getOfficerProperty(!0,e),i=this.getOfficerProperty(!1,e);return t+i},e.prototype.getOfficerProperty=function(t,i){for(var n=e.ins.getEquipedOrNoEquiped(t),o=0,r=null,s=0,a=n.length;a>s;s++)r=n[s],o+=this.getOneOfficerProperty(r,i,t);return o},e.prototype.getOneOfficerFightingForce=function(e){var t=0,i=this.getOneOfficerProperty(e,PropertyType.ATTACK,e.isEquiped),n=this.getOneOfficerProperty(e,PropertyType.DEFENCE,e.isEquiped),o=this.getOneOfficerProperty(e,PropertyType.HP,e.isEquiped);return t=i*Constants.ATTACK_2_FIGHTING+n*Constants.DEFENCE_2_FIGHTING+o*Constants.HP_2_FIGHTING},e.prototype.getNormalFightingForce=function(e){var t=0,i=this.getNormalProperty(e,PropertyType.ATTACK),n=this.getNormalProperty(e,PropertyType.DEFENCE),o=this.getNormalProperty(e,PropertyType.HP),r=this.getNormalProperty(e,PropertyType.WULI),s=this.getNormalProperty(e,PropertyType.ZHILI),a=this.getNormalProperty(e,PropertyType.MINJIE),h=this.getNormalProperty(e,PropertyType.NEILI),p=this.getNormalProperty(e,PropertyType.TONGSHUAI),l=this.getNormalProperty(e,PropertyType.MEILI);return t=i*Constants.ATTACK_2_FIGHTING+n*Constants.DEFENCE_2_FIGHTING+o*Constants.HP_2_FIGHTING+r*Constants.WULI_2_FIGHTING+s*Constants.ZHILI_2_FIGHTING+a*Constants.MINJIE_2_FIGHTING+h*Constants.NEILI_2_FIGHTING+p*Constants.TONGSHUAI_2_FIGHTING+l*Constants.MEILI_2_FIGHTING},e.prototype.getNormalProperty=function(e,t){var i=0;return PropertyType.ATTACK==t?i+=e.metaOfficer.attack:PropertyType.DEFENCE==t?i+=e.metaOfficer.defence:PropertyType.HP==t&&(i+=e.metaOfficer.hp),i},e.prototype.getTotalFightingForce=function(){for(var e=0,t=0,i=this.officers.length;i>t;t++)e+=this.getOneOfficerFightingForce(this.officers[t]);return e},e.prototype.getOneOfficerProperty=function(e,t,i){void 0===i&&(i=!0);var n=this.getNormalProperty(e,t);return i||(n=Math.floor(.1*n)),n},e.prototype.getFetterProperty=function(t,i){for(var n=0,o=e.ins.getEquipedOrNoEquiped(!0),r=MetaOfficerFetterManager.ins.getFettersForType(t.metaOfficer.type),s=null,a=0,h=r.length;h>a;a++)s=r[a],this.checkFetter(o,s)&&(n+=MetaOfficerFetterManager.ins.getProperty(s,i));return n},e.prototype.checkFetter=function(e,t){for(var i=!0,n=0,o=t.officers.length;o>n;n++){for(var r=!1,s=0,a=e.length;a>s;s++)if(e[s].metaOfficer.type==t.officers[n]){r=!0;break}if(!r){i=!1;break}}return i},e.prototype.dispose=function(){for(var e=0;e<this.officers.length;e++)delete this.officers[e];this.officers.length=0},e}();__reflect(OfficerVoManager.prototype,"OfficerVoManager");var OfficerPieceVo=function(){function e(){}return e.prototype.fromServer=function(e){this.id=e.id,this.officerType=e.officerType,this.count=e.count},e}();__reflect(OfficerPieceVo.prototype,"OfficerPieceVo");var OfficerPieceVoManager=function(){function e(){this.officerPieces=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromServer=function(e){for(var t=e.length,i=0;t>i;i++){var n=new OfficerPieceVo;n.fromServer(e[i]),this.officerPieces.push(n)}},e.prototype.getOfficerPieceForOfficerType=function(e){for(var t=this.officerPieces.length,i=0;t>i;i++)if(this.officerPieces[i].officerType==e)return this.officerPieces[i];return null},e._ins=null,e}();__reflect(OfficerPieceVoManager.prototype,"OfficerPieceVoManager");var OfflineVo=function(){function e(){this.rewards=new Array}return e.prototype.fromServer=function(e){this.runTime=e.time,this.rewards=e.reward,this.mapId=e.map,this.gold=e.gold,this.type=e.type},e}();__reflect(OfflineVo.prototype,"OfflineVo");var OfflineVoManager=function(){function e(){this.offlineVo=null,this.offlineVo=new OfflineVo}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromServer=function(e){this.offlineVo.fromServer(e)},e._ins=null,e}();__reflect(OfflineVoManager.prototype,"OfflineVoManager");var PlayerInfoVo=function(){function e(){}return e.prototype.initProp=function(e){this.attack=e[1],this.defence=e[2],this.hp=e[3],this.crit=e[4],this.critHurt=e[5],this.wuli=e[6],this.zhili=e[7],this.neili=e[8],this.tongshu=e[9],this.minjie=e[10],this.meili=e[11],this.bili=e[12],this.gengu=e[13],this.wuhon=e[14],this.dodge=e[15]||0},e.prototype.getProp=function(e){var t=0;switch(e){case PropertyType.ATTACK:t=this.attack;break;case PropertyType.DEFENCE:t=this.defence;break;case PropertyType.HP:t=this.hp;break;case PropertyType.CRIT:t=this.crit;break;case PropertyType.CRIT_HURT:t=this.critHurt;break;case PropertyType.WULI:t=this.wuli;break;case PropertyType.ZHILI:t=this.zhili;break;case PropertyType.NEILI:t=this.neili;break;case PropertyType.TONGSHUAI:t=this.tongshu;break;case PropertyType.MINJIE:t=this.minjie;break;case PropertyType.MEILI:t=this.meili;break;case PropertyType.BILI:t=this.bili;break;case PropertyType.GENGU:t=this.gengu;break;case PropertyType.WUHON:t=this.wuhon;break;case PropertyType.DODGE:t=this.dodge}return t},e}();__reflect(PlayerInfoVo.prototype,"PlayerInfoVo");var PlayerVo=function(){function e(){this.gold=1e6,this.silver=1e6,this.reincarnationLevel=1,this.fightingForce=0,this.taskId=0,this.hufu=0,this.invateTimes=0,this.rank=1,this.wuli=0,this.zhili=0,this.neili=0,this.tongshuai=0,this.minjie=0,this.meili=0,this.kuaFu=!1,this.isStopChat=!1,this.wanbaDesk=0,this.openid="hyc"}return e.prototype.initFromServer=function(e){this.id=e.id,this.openid=e.openid,this.serverId=e.server,this.name=e.name,this.head=e.head,this.camp=e.country,this.level=e.lv,this.exp=e.exp,this.lastMap=e.lastMap,this.gold=e.gold,this.silver=e.silver,this.chatWorldTimes=e.chatWorldTimes,this.fightingForce=e.capacity,this.taskId=e.task,this.hufu=e.hufu,this.invateTimes=e.invateTimes,this.kuaFu=1==e.kf,this.rank=e.rank},e}();__reflect(PlayerVo.prototype,"PlayerVo");var PlayerVoManager=function(){function e(){this.playerVo=new PlayerVo,this.playerInfoVo=new PlayerInfoVo}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.initPlayerInfoVo=function(e){this.playerInfoVo.heroCount=e.heroCount,this.playerInfoVo.initProp(e.att)},e.prototype.addWorldChatCount=function(){this.playerVo.chatWorldTimes++,EventCenter.ins.send(EventCenter.CHAT_UPDATE_WORLD_TIMES)},e.prototype.setCamp=function(e){this.playerVo.camp=e,EventCenter.ins.send(EventCenter.UPDATE_CAMP)},e.prototype.initFromServer=function(e){this.playerVo.initFromServer(e),this.metaExp=MetaExpManager.ins.getMetaExpByLevel(this.playerVo.level),TaskVoMananger.ins.initFromServer({taskId:this.playerVo.taskId}),HuFuVoManager.ins.fromServer({count:this.playerVo.hufu}),GuideVoManager.ins.fromServer(e.guide),SixProVoManager.ins.fromServer(e.six,Constants.LEVEL_SIX_PRO),e.offline?(OfflineVoManager.ins.fromServer(e.offline),Game.hasLoginOffline=!0):Game.hasLoginOffline=!1},e.prototype.getTotalProperty=function(e){var t=MetaRoleManager.ins.metaRole,i=0,n=this.playerVo.level-1;switch(e){case PropertyType.HP:i=t.hp+n*t.hpAdd;break;case PropertyType.ATTACK:i=t.attack+n*t.attackAdd;break;case PropertyType.DEFENCE:i=t.defence+n*t.defenceAdd}return i},e.prototype.setServer=function(e){this.playerVo.serverId=e},e.prototype.updateExp=function(e){void 0===e&&(e=0),this.playerVo.exp=e,EventCenter.ins.send(EventCenter.UPDATE_PLAYER_EXP,null)},e.prototype.updateLevel=function(e){if(this.playerVo.level!=e){var t=this.playerVo.level;e>this.playerVo.level?(this.playerVo.level=e,EventCenter.ins.send(EventCenter.LEVEL_UPGRADE,{levelUp:!0,lastLevel:t})):(this.playerVo.level=e,EventCenter.ins.send(EventCenter.LEVEL_UPGRADE,{levelUp:!1,lastLevel:t}))}DataCount.ins.playerLevel(this.playerVo.level),this.metaExp=MetaExpManager.ins.getMetaExpByLevel(this.playerVo.level)},e.prototype.operRes=function(e,t,i){if(void 0===i&&(i=!0),0!=t){var n=this.getResForType(e),o=0;o=i?n+t:n-t,this.setResForType(e,o)}},e.prototype.setResForType=function(e,t){switch(e){case ResType.GOLD:this.playerVo.gold=t;break;case ResType.SILVER:this.playerVo.silver=t}EventCenter.ins.send(EventCenter.UPDATE_PLAYER)},e.prototype.getResForType=function(e){var t=0;switch(e){case ResType.GOLD:t=this.playerVo.gold;break;case ResType.SILVER:t=this.playerVo.silver}return t},e.prototype.updateFightingForce=function(e){this.playerVo.fightingForce=e,EventCenter.ins.send(EventCenter.UPDATE_FIGHTING_FORCE)},e.prototype.updateRank=function(e){this.playerVo.rank=e,EventCenter.ins.send(EventCenter.PLAYER_RANK_UPDATE)},e}();__reflect(PlayerVoManager.prototype,"PlayerVoManager");var PropVo=function(){function e(){this.count=0}return e.prototype.fromServer=function(e){this.metaProp=MetaPropMananger.ins.getProp(e.id),this.count=e.count},e}();__reflect(PropVo.prototype,"PropVo");var PropVoManager=function(){function e(){this.props=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.initEquipProps=function(e){this.removeEquipProps();for(var t=e.length,i=0;t>i;i++){var n=new PropVo;n.fromServer(e[i]),0!=n.count&&this.props.push(n)}},e.prototype.removeEquipProps=function(){for(var e=this.props.length-1;e>=0;e--){var t=this.props[e];(t.metaProp.type==EquipType.WEAPON||t.metaProp.type==EquipType.CLOTH||t.metaProp.type==EquipType.HORSE)&&this.props.splice(e,1)
}},e.prototype.getPropsForPart=function(e){for(var t=new Array,i=0,n=this.props.length;n>i;i++){var o=this.props[i];o.metaProp.type==e&&t.push(o)}return t},e.prototype.getProp=function(e){for(var t=0,i=this.props.length;i>t;t++)if(this.props[t].metaProp.id==e)return this.props[t];return null},e.prototype.operPropCount=function(e,t,i){void 0===i&&(i=!1);var n=this.getProp(e);n||(n=new PropVo,n.metaProp=MetaPropMananger.ins.getProp(e),this.props.push(n)),i?n.count+=t:(n.count-=t,0==n.count&&this.delProp(n.metaProp.id)),EventCenter.ins.send(EventCenter.PROP_UPDATE,e)},e.prototype.delProp=function(e){for(var t=0,i=this.props.length;i>t;t++)if(this.props[t].metaProp.id==e){this.props.splice(t,1);break}},e.prototype.updateVo=function(e,t){var i=this.getProp(e);i&&(i.count=t,0==i.count&&this.delProp(e)),EventCenter.ins.send(EventCenter.PROP_UPDATE,e)},e.prototype.dispose=function(){for(var e=0,t=this.props.length;t>e;e++)delete this.props[e];this.props.length=0},e._ins=null,e}();__reflect(PropVoManager.prototype,"PropVoManager");var QieCuoVo=function(){function e(){this.id=0,this.rewardCount=0,this.successCount=0}return e.prototype.fromServer=function(e){this.id=e.id,this.successCount=e.count,this.rewardCount=e.value},e}();__reflect(QieCuoVo.prototype,"QieCuoVo");var QieCuoVoManager=function(){function e(){this.qiecuos=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.qiecuoResult=function(e,t){var i=this.getQieCuo(e);i||(i=new QieCuoVo,i.id=e,this.qiecuos.push(i)),i.rewardCount=t,log("qiecuoResult: id:"+e+", rewardCount:"+i.rewardCount+", _reward:"+t),i.successCount++},e.prototype.fromServer=function(e){this.dispose();for(var t=e.length,i=0;t>i;i++){var n=new QieCuoVo;n.fromServer(e[i]),this.qiecuos.push(n)}},e.prototype.getQieCuo=function(e){for(var t=0,i=this.qiecuos.length;i>t;t++)if(this.qiecuos[t].id==e)return this.qiecuos[t];return null},e.prototype.getHighProperty=function(e){for(var t=0,i=0,n=this.qiecuos.length;n>i;i++)t+=this.getOneHighProperty(e,this.qiecuos[i]);return t},e.prototype.getOneHighProperty=function(e,t){var i=0,n=MetaQieCuoManager.ins.getQieCuo(t.id);return e==PropertyType.BILI?1==n.minReward.type&&(i=t.rewardCount):PropertyType.GENGU==e&&2==n.minReward.type&&(i=t.rewardCount),i},e.prototype.dispose=function(){for(var e=0,t=this.qiecuos.length;t>e;e++)delete this.qiecuos[e];this.qiecuos.length=0},e._ins=null,e}();__reflect(QieCuoVoManager.prototype,"QieCuoVoManager");var RankVo=function(){function e(){this.num=0,this.name="",this.level=0}return e.prototype.fromServer=function(e){this.num=e.rank,this.name=e.name,this.camp=e.country,this.attackForce=e.capacity,this.hoza=e.houjin,this.level=e.lv},e}();__reflect(RankVo.prototype,"RankVo");var RankVoManager=function(){function e(){this.selfVo=new RankVo,this.ranks=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromServer=function(e){this.dispose();for(var t=0,i=e.rankers.length;i>t;t++){var n=new RankVo;n.fromServer(e.rankers[t]),this.ranks.push(n)}},e.prototype.updateSelf=function(e){this.selfVo.fromServer(e)},e.prototype.getRankVo=function(e){for(var t=0,i=this.ranks.length;i>t;t++)if(this.ranks[t].name==e)return this.ranks[t];return null},e.prototype.dispose=function(){this.ranks.length=0},e._ins=null,e}();__reflect(RankVoManager.prototype,"RankVoManager");var DayRechargeRewardVo=function(){function e(){this.ids=new Array}return e.prototype.fromServer=function(e){this.ids=e.ids,this.dayPayCount=e.dayPayCount},e}();__reflect(DayRechargeRewardVo.prototype,"DayRechargeRewardVo");var RechargeRewardVoManager=function(){function e(){this.firstRewardState=0,this.dayFirstRewardState=0,this.dayRechargeRewardVo=null,this.dayRechargeRewardVo=new DayRechargeRewardVo}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.initDayRechargeReward=function(e){this.dayRechargeRewardVo.fromServer(e),log("累计充值:"+this.dayRechargeRewardVo.dayPayCount+"元")},e.prototype.hasRechargeGetReward=function(e){return this.dayRechargeRewardVo.ids.indexOf(e)>=0},e.prototype.updateDayFirst=function(e){this.dayFirstRewardState=e,EventCenter.ins.send(EventCenter.RECHARGE_REWARD_UPDATE)},e.prototype.updateFirst=function(e){this.firstRewardState=e,EventCenter.ins.send(EventCenter.RECHARGE_REWARD_UPDATE)},e.prototype.rechargeGetReward=function(e){this.dayRechargeRewardVo.ids.indexOf(e)>=0||this.dayRechargeRewardVo.ids.push(e)},e.prototype.getDayList=function(e){for(var t=MetaRecharRewardManager.ins.getType(e),i=new Array,n=0,o=t.length;o>n;n++){var r=t[n];this.hasRechargeGetReward(r.id)||i.push(r)}return i},e.prototype.getDayListGroup=function(t){for(var i=MetaRecharRewardManager.ins.getType(t),n=new Array,o=null,r=e.ins.dayRechargeRewardVo,s=0,a=0,h=0,p=i.length;p>h;h++)if(o=i[h],!this.hasRechargeGetReward(o.id)){var l=r.dayPayCount-o.rmb,u=o.rewards[0].type;if(l>=0)if(0==o.fenzu)n.push(o);else if(u==ResType.OFFICER){if(this.isOfficerMaxLevel(o))continue;n.push(o)}else{if(this.isFenZuInShowArr(o,n)||this.isFenZuInGet(o))continue;n.push(o)}else{if(o.rmb!=s){if(a>=2)break;s=o.rmb,a++}if(0==o.fenzu)n.push(o);else if(u==ResType.OFFICER){if(this.isOfficerMaxLevel(o))continue;n.push(o)}else{if(this.isFenZuInShowArr(o,n)||this.isFenZuInGet(o))continue;n.push(o)}}}return n},e.prototype.isFenZuInGet=function(e){for(var t=0,i=this.dayRechargeRewardVo.ids.length;i>t;t++){var n=MetaRecharRewardManager.ins.getRechargeReward(this.dayRechargeRewardVo.ids[t]);if(n.fenzu==e.fenzu)return!0}return!1},e.prototype.isFenZuInShowArr=function(e,t){for(var i=0,n=t.length;n>i;i++)if(t[i].fenzu==e.fenzu)return!0;return!1},e.prototype.isOfficerMaxLevel=function(e){var t=e.rewards[0],i=OfficerVoManager.ins.getOfficerForType(t.staticId);if(i){var n=MetaOfficerManager.ins.getOfficerMaxLevel(i.metaOfficer.type);if(i.level>=n)return!0}return!1},e._ins=null,e}();__reflect(RechargeRewardVoManager.prototype,"RechargeRewardVoManager");var RedPointManager=function(){function e(){this.redPoints=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromServer=function(e){this.redPoints=e.ids,EventCenter.ins.send(EventCenter.CHECK_RED_POINT)},e.prototype.check=function(e){return this.redPoints.indexOf(e)>=0},e._ins=null,e}();__reflect(RedPointManager.prototype,"RedPointManager");var RenownVo=function(){function e(){}return e.prototype.initFromServer=function(e){this.level=e.swLv,this.count=e.swExp,this.wuhun=e.wuhun},e}();__reflect(RenownVo.prototype,"RenownVo");var RenownVoManager=function(){function e(){this.renownVo=new RenownVo}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromServer=function(e){this.renownVo.initFromServer(e)},e.prototype.levelUpResult=function(e){this.renownVo.level=e.lv,this.renownVo.count=e.exp,this.renownVo.wuhun=e.wuhun,EventCenter.ins.send(EventCenter.RENOWN_COUNT_UPDATE)},e.prototype.operRenownVoCount=function(e,t){void 0===t&&(t=!0),t?this.renownVo.count+=e:this.renownVo.count-=e,EventCenter.ins.send(EventCenter.RENOWN_COUNT_UPDATE)},e.prototype.getWuHon=function(){var e=MetaRenownManager.ins.getMetaRenown(this.renownVo.level);return e.addWuHun},e.prototype.canLevelUp=function(){if(this.renownVo.level==MetaRenownManager.ins.maxLevel)return!1;var e=MetaRenownManager.ins.getMetaRenown(this.renownVo.level);return e?e.needCount<=this.renownVo.count:!1},e._ins=null,e}();__reflect(RenownVoManager.prototype,"RenownVoManager");var ServerListVo=function(){function e(){this.serverId=0,this.serverState=0}return e.prototype.initFromServer=function(e){this.serverId=e.id,this.serverName=e.name,this.serverState=e.state,this.ip=e.ip,this.port=e.port,this.loginTime=e.sort},e}();__reflect(ServerListVo.prototype,"ServerListVo");var ServerListVoManager=function(){function e(){this.servers=new Array,this.recentServers=new Array,this.newServers=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.initFromServer=function(e){var t=e;this.servers.length=0,this.recentServers.length=0;for(var i,n=0;n<t.length;n++)i=new ServerListVo,i.initFromServer(t[n]),i.loginTime>0&&this.recentServers.push(i),this.servers.push(i);this.servers.sort(function(e,t){return t.serverId-e.serverId}),this.recentServers.sort(function(e,t){return e.loginTime<t.loginTime?-1:e.loginTime==t.loginTime?0:1})},e._ins=null,e}();__reflect(ServerListVoManager.prototype,"ServerListVoManager");var ShareVo=function(){function e(){this.shareCount=0,this.invateGetCount=0,this.invateCount=0,this.followGetCount=0}return e.prototype.fromServer=function(e){this.shareCount=e.share,this.invateGetCount=e.invite,this.invateCount=e.inviteTimes,this.followGetCount=e.follow},e}();__reflect(ShareVo.prototype,"ShareVo");var ShareVoManager=function(){function e(){this.shareVo=new ShareVo}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromServer=function(e){this.shareVo.fromServer(e)},e.prototype.addShareCount=function(){this.shareVo.shareCount=1,EventCenter.ins.send(EventCenter.SHARE_UPDATE)},e._ins=null,e}();__reflect(ShareVoManager.prototype,"ShareVoManager");var ShopDrawVo=function(){function e(){}return e.prototype.fromServer=function(e){this.id=e.id,this.oneFreeTime=e.oneFreeTime,this.oneFreeCount=e.oneFreeCount,this.oneCount=e.oneCount,this.tenFreeTime=e.tenFreeTime,this.tenFreeCount=e.tenFreeCount,this.tenCount=e.tenCount},e}();__reflect(ShopDrawVo.prototype,"ShopDrawVo");var ShopVoManager=function(){function e(){this.draws=new Array,this.goldDoubles=new Array,this.goldDoubleNs=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){for(var e=0,t=this.draws.length;t>e;e++)delete this.draws[e];this.draws.length=0,TimerManager.ins.removeTimer(this)},e.prototype.fromServer=function(e){this.dispose();var t=new ShopDrawVo;t.fromServer({id:1,oneFreeTime:e.cd1,oneFreeCount:e.free1,oneCount:e.times1,tenFreeTime:e.cd10,tenFreeCount:0,tenCount:e.times10}),this.draws.push(t),t=new ShopDrawVo,t.fromServer({id:2,oneFreeTime:e.cd2,oneFreeCount:e.free2,oneCount:e.times2,tenFreeTime:e.cd20,tenFreeCount:0,tenCount:e.times20}),this.draws.push(t),t=new ShopDrawVo,t.fromServer({id:3,oneFreeTime:e.cd3,oneFreeCount:e.free3,oneCount:e.times3,tenFreeTime:e.cd30,tenFreeCount:0,tenCount:e.times30}),this.draws.push(t),this.goldDoubles=e.payDouble,this.goldDoubleNs=e.payDoubleN,EventCenter.ins.send(EventCenter.SHOP_FREE_UPDATE),TimerManager.ins.addTimer(this)},e.prototype.addDouble=function(e){this.hasDoubled(e)||this.goldDoubles.push(e)},e.prototype.hasDoubled=function(e){return this.goldDoubles.indexOf(e)>=0},e.prototype.addDoubleN=function(e){this.hasDoubleN(e)||this.goldDoubleNs.push(e)},e.prototype.hasDoubleN=function(e){return this.goldDoubleNs.indexOf(e)>=0},e.prototype.getDrawVo=function(e){for(var t=0,i=this.draws.length;i>t;t++)if(this.draws[t].id==e)return this.draws[t];return null},e.prototype.doFreeDraw=function(e,t){var i=this.getDrawVo(e),n=MetaShopManager.ins.getDraw(e);t?(i.oneFreeCount--,0==i.oneFreeCount?i.oneFreeTime=0:i.oneFreeTime=n.oneCD):(i.tenFreeCount--,0==i.tenFreeCount?i.tenFreeTime=0:i.tenFreeTime=n.tenCD)},e.prototype.doDraw=function(e,t){var i=this.getDrawVo(e);t?i.oneCount++:i.tenCount++},e.prototype.runTimer=function(){for(var e,t=!1,i=0,n=this.draws.length;n>i;i++)e=this.draws[i],e.oneFreeTime>0&&(e.oneFreeTime--,0==e.oneFreeTime&&(t=!0)),e.tenFreeTime>0&&(e.tenFreeTime--,0==e.tenFreeTime&&(t=!0));t&&EventCenter.ins.send(EventCenter.SHOP_FREE_UPDATE)},e._ins=null,e}();__reflect(ShopVoManager.prototype,"ShopVoManager",["ITimer"]);var SixPropertyVo=function(){function e(){this.wuli=0,this.zhili=0,this.neili=0,this.tongshuai=0,this.minjie=0,this.meili=0}return e.prototype.fromServer=function(e){this.wuli=e.head,this.zhili=e.hand,this.neili=e.foot,this.tongshuai=e.force,this.minjie=e.fly,this.meili=e.pre},e}();__reflect(SixPropertyVo.prototype,"SixPropertyVo");var SixProVoManager=function(){function e(){this.levelSixVo=new SixPropertyVo,this.hozaSixVo=new SixPropertyVo}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromServer=function(e,t){void 0===t&&(t=Constants.LEVEL_SIX_PRO),Constants.LEVEL_SIX_PRO==t?this.levelSixVo.fromServer(e):Constants.HOZA_SIX_PRO==t&&this.hozaSixVo.fromServer(e),EventCenter.ins.send(EventCenter.SIX_PROPERTY_UPDATE)},e.prototype.getSixVo=function(e){return void 0===e&&(e=Constants.LEVEL_SIX_PRO),e==Constants.LEVEL_SIX_PRO?this.levelSixVo:e==Constants.HOZA_SIX_PRO?this.hozaSixVo:void 0},e.prototype.getProperty=function(e,t){var i=this.getSixVo(e),n=0;switch(t){case PropertyType.WULI:n=i.wuli;break;case PropertyType.ZHILI:n=i.zhili;break;case PropertyType.NEILI:n=i.neili;break;case PropertyType.TONGSHUAI:n=i.tongshuai;break;case PropertyType.MINJIE:n=i.minjie;break;case PropertyType.MEILI:n=i.meili}return n},e._ins=null,e}();__reflect(SixProVoManager.prototype,"SixProVoManager");var SkillVo=function(){function e(){}return e.prototype.initFromServer=function(e){this.id=e.id,this.metaId=e.metaId,this.level=e.level,this.isEquiped=e.isEquiped,this.metaSkill=MetaSkillManager.ins.getSkill(this.metaId)},e}();__reflect(SkillVo.prototype,"SkillVo");var SkillVoMananger=function(){function e(){this.skills=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.initFromServer=function(e){for(var t,i=e.length,n=0;i>n;n++)t=new SkillVo,t.initFromServer(e[n]),this.skills.push(t)},e.prototype.dispose=function(){for(var e=0,t=this.skills.length;t>e;e++)delete this.skills[e];this.skills.length=0},e._ins=null,e}();__reflect(SkillVoMananger.prototype,"SkillVoMananger");var SystemVo=function(){function e(){}return e}();__reflect(SystemVo.prototype,"SystemVo");var SystemVoManager=function(){function e(){}return e}();__reflect(SystemVoManager.prototype,"SystemVoManager");var TaskVo=function(){function e(){}return e.prototype.initFromServer=function(e){this.taskId=e.taskId},e}();__reflect(TaskVo.prototype,"TaskVo");var TaskVoMananger=function(){function e(){this.taskVo=new TaskVo}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.initFromServer=function(e){this.taskVo.initFromServer(e)},e.prototype.getNextTask=function(){var e=this.taskVo.taskId+1;return e>Game.TASK_MAX_ID?null:MetaTaskManager.ins.getTask(e)},e.prototype.isTask=function(e){var t=MetaTaskManager.ins.getTask(this.taskVo.taskId);return e==t.targetMap?!0:!1},e._ins=null,e}();__reflect(TaskVoMananger.prototype,"TaskVoMananger");var TianShuVo=function(){function e(){this.id=0,this.count=0,this.hasBook=!1}return e.prototype.fromServer=function(e){this.id=e.id,this.hasBook=1==e.he,this.count=e.prop},e}();__reflect(TianShuVo.prototype,"TianShuVo");var TianShuVoManager=function(){function e(){this.tianShuArr=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromServer=function(e){this.tianShuArr.length=0;for(var t=0,i=e.length;i>t;t++){var n=new TianShuVo;n.fromServer(e[t]),this.tianShuArr.push(n)}},e.prototype.unBook=function(e){var t=this.getTianShu(e);t&&(t.hasBook=!1),EventCenter.ins.send(EventCenter.TIAN_SHU_UPDATE)},e.prototype.book=function(e){var t=this.getTianShu(e);t&&(t.hasBook=!0),EventCenter.ins.send(EventCenter.TIAN_SHU_UPDATE)},e.prototype.isFirst=function(){for(var e=0,t=0,i=this.tianShuArr.length;i>t;t++){var n=this.tianShuArr[t];if(n.hasBook)return!1;var o=MetaTianShuManager.ins.getTianShu(n.id);!n.hasBook&&n.count>=o.count&&e++}return 1==e},e.prototype.getCanBook=function(){for(var e=new Array,t=0,i=this.tianShuArr.length;i>t;t++){var n=this.tianShuArr[t],o=MetaTianShuManager.ins.getTianShu(n.id);!n.hasBook&&n.count>=o.count&&e.push(n)}return e},e.prototype.getTianShu=function(e){for(var t=0,i=this.tianShuArr.length;i>t;t++)if(this.tianShuArr[t].id==e)return this.tianShuArr[t];return null},e.prototype.updateCount=function(e,t){var i=this.getTianShu(e);i||(i=new TianShuVo,i.id=e),i.count=t,EventCenter.ins.send(EventCenter.TIAN_SHU_UPDATE)},e.prototype.reduceCount=function(e,t){var i=this.getTianShu(e);i||(i=new TianShuVo,i.id=e),i.count-=t;var n=MetaTianShuManager.ins.getTianShu(i.id);i.count<n.count&&(i.hasBook=!1),EventCenter.ins.send(EventCenter.TIAN_SHU_UPDATE)},e.prototype.addCount=function(e,t){var i=this.getTianShu(e);i||(i=new TianShuVo,i.id=e),i.count+=t,EventCenter.ins.send(EventCenter.TIAN_SHU_UPDATE)},e.prototype.checkTianShuRed=function(){for(var e=0,t=this.tianShuArr.length;t>e;e++){var i=this.tianShuArr[e];if(!i.hasBook){var n=MetaTianShuManager.ins.getTianShu(i.id);if(i.count>=n.count)return!0}}return!1},e.prototype.getSixPro=function(){for(var e=new SixPropertyVo,t=0,i=this.tianShuArr.length;i>t;t++){var n=this.tianShuArr[t];if(n.hasBook){var o=MetaTianShuManager.ins.getTianShu(n.id);e.wuli+=o.wuli,e.zhili+=o.zhili,e.minjie+=o.minjie,e.meili+=o.meili,e.tongshuai+=o.tongshuai,e.neili+=o.neili}}return e},e.prototype.getTotalHighProperty=function(e){for(var t=0,i=0,n=this.tianShuArr.length;n>i;i++){var o=this.tianShuArr[i];if(o.hasBook){var r=MetaTianShuManager.ins.getTianShu(o.id);switch(e){case PropertyType.WULI:t+=r.wuli;break;case PropertyType.ZHILI:t+=r.zhili;break;case PropertyType.MINJIE:t+=r.minjie;break;case PropertyType.MEILI:t+=r.meili;break;case PropertyType.TONGSHUAI:t+=r.tongshuai;break;case PropertyType.NEILI:t+=r.neili}}}return t},e.prototype.getNormalProperty=function(){for(var e=new NormalPropertyVo,t=0,i=this.tianShuArr.length;i>t;t++){var n=this.tianShuArr[t];if(n.hasBook){var o=MetaTianShuManager.ins.getTianShu(n.id);e.attack+=o.attack,e.defence+=o.defence,e.hp+=o.hp}}return e},e._ins=null,e}();__reflect(TianShuVoManager.prototype,"TianShuVoManager");var VipVo=function(){function e(){this.hasMonthCardBuy=!1,this.hasMonthCardGetReward=!1,this.hasFinalCardBuy=!1,this.hasFinalCardGetReward=!1}return e.prototype.fromServer=function(e){this.hasMonthCardBuy=1==e.monthCard,this.hasMonthCardGetReward=1==e.monthCardTake,this.hasFinalCardBuy=1==e.finalCard,this.hasFinalCardGetReward=1==e.finalCardTake},e}();__reflect(VipVo.prototype,"VipVo");var VipVoManager=function(){function e(){this.vipVo=new VipVo}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.fromServer=function(e){this.vipVo.fromServer(e),Game.HUFU_ADD_REALLY_TIME=Game.HUFU_ADD_TIME-(this.vipVo.hasFinalCardBuy?10:0)-(this.vipVo.hasMonthCardBuy?5:0),EventCenter.ins.send(EventCenter.HUFU_TIMER)},e.prototype.buy=function(e){e==ShopType.YUE_KA?this.vipVo.hasMonthCardBuy=!0:this.vipVo.hasFinalCardBuy=!0,Game.HUFU_ADD_REALLY_TIME=Game.HUFU_ADD_TIME-(this.vipVo.hasFinalCardBuy?10:0)-(this.vipVo.hasMonthCardBuy?5:0),EventCenter.ins.send(EventCenter.VIP_UPDATE),EventCenter.ins.send(EventCenter.HUFU_TIMER)},e._ins=null,e}();__reflect(VipVoManager.prototype,"VipVoManager");var Constants=function(){function e(){}return e.COLOR_NORMAL=5912857,e.COLOR_DYNAMIC=11490830,e.COLOR_WHITE=16711422,e.COLOR_GREEN=888071,e.COLOR_YELLOW=16776960,e.COLOR_GRAY=13421772,e.COLOR_RED=16711680,e.HP_2_FIGHTING=5,e.ATTACK_2_FIGHTING=12,e.DEFENCE_2_FIGHTING=15,e.CRIT_2_FIGHTING=180,e.CRIT_HURT_2_FIGHTING=10,e.DODGE_2_FIGHTING=120,e.WULI_2_FIGHTING=150,e.ZHILI_2_FIGHTING=150,e.NEILI_2_FIGHTING=150,e.TONGSHUAI_2_FIGHTING=150,e.MINJIE_2_FIGHTING=150,e.MEILI_2_FIGHTING=150,e.WUHON_2_FIGHTING=55,e.BILI_2_FIGHTING=200,e.GENGU_2_FIGHTING=200,e.LEVEL_SIX_PRO=1,e.HOZA_SIX_PRO=2,e.CHAT_COUNT=20,e}();__reflect(Constants.prototype,"Constants");var Camp;!function(e){e[e.WEI=1]="WEI",e[e.SHU=2]="SHU",e[e.WU=3]="WU"}(Camp||(Camp={}));var IgnotType;!function(e){e[e.GOLD=1]="GOLD",e[e.SILVER=2]="SILVER"}(IgnotType||(IgnotType={}));var GuideStepNum;!function(e){e[e.SHOP=50]="SHOP",e[e.JUE_SE=100]="JUE_SE",e[e.BI_GUAN=150]="BI_GUAN",e[e.TIAN_SHU=200]="TIAN_SHU",e[e.SHEN_BING=250]="SHEN_BING",e[e.BAO_WU=300]="BAO_WU",e[e.JING_MAI=350]="JING_MAI",e[e.HOU_JIN=400]="HOU_JIN"}(GuideStepNum||(GuideStepNum={}));var Activity;!function(e){e[e.FAN_BEI=1]="FAN_BEI"}(Activity||(Activity={}));var MapType;!function(e){e[e.NORMAL=0]="NORMAL",e[e.MAIN_CITY=1]="MAIN_CITY",e[e.BOSS=2]="BOSS",e[e.TRAIL=3]="TRAIL",e[e.WEI=10]="WEI",e[e.SHU=11]="SHU",e[e.WU=12]="WU",e[e.KUA_FU=50]="KUA_FU",e[e.BIRTH=99]="BIRTH"}(MapType||(MapType={}));var MonsterType;!function(e){e[e.MU_ZHUANG=1]="MU_ZHUANG",e[e.BOSS=2]="BOSS",e[e.BI_GUAN_BOSS=3]="BI_GUAN_BOSS",e[e.MONSTER=4]="MONSTER",e[e.TASK_BOSS=10]="TASK_BOSS"}(MonsterType||(MonsterType={}));var EquipType;!function(e){e[e.WEAPON=1]="WEAPON",e[e.HORSE=2]="HORSE",e[e.CLOTH=3]="CLOTH"}(EquipType||(EquipType={}));var EntityType;!function(e){e[e.PLAYER=1]="PLAYER",e[e.MONSTER=2]="MONSTER",e[e.SELF=3]="SELF",e[e.NPC=4]="NPC",e[e.BOSS=5]="BOSS"}(EntityType||(EntityType={}));var ItemType;!function(e){e[e.MATERIALS=1]="MATERIALS"}(ItemType||(ItemType={}));var MaterialsType;!function(e){e[e.LOW_LEVEL=1]="LOW_LEVEL",e[e.MIDDLE_LEVEL=2]="MIDDLE_LEVEL",e[e.HIGH_LEVEL=3]="HIGH_LEVEL"}(MaterialsType||(MaterialsType={}));var SignType;!function(e){e[e.SIGN=1]="SIGN",e[e.RECHARGE=2]="RECHARGE"}(SignType||(SignType={}));var RechargeRewardType;!function(e){e[e.FIRST_RECHARGE=1]="FIRST_RECHARGE",e[e.DAY_FIRST_RECHARGE=2]="DAY_FIRST_RECHARGE",e[e.RECHARGE=3]="RECHARGE"}(RechargeRewardType||(RechargeRewardType={}));var ColorType;!function(e){e[e.WHITE=1]="WHITE",e[e.GREEN=2]="GREEN",e[e.BLUE=3]="BLUE",e[e.PURPLE=4]="PURPLE",e[e.ORANGE=5]="ORANGE",e[e.RED=6]="RED"}(ColorType||(ColorType={}));var OfficerItemType;!function(e){e[e.NORMAL=1]="NORMAL",e[e.EQUIPED=2]="EQUIPED",e[e.UNEQUIPED=3]="UNEQUIPED"}(OfficerItemType||(OfficerItemType={}));var FunctionId;!function(e){e[e.JIANGHU=101]="JIANGHU",e[e.WUJIANG=102]="WUJIANG",e[e.SHOP=103]="SHOP",e[e.JUESE=104]="JUESE",e[e.MAIL=105]="MAIL",e[e.LI_BAO=106]="LI_BAO",e[e.CHAT=107]="CHAT",e[e.LI_XIAN=108]="LI_XIAN",e[e.YUE_KA=109]="YUE_KA",e[e.GUO_JIA=110]="GUO_JIA",e[e.EQUIP=111]="EQUIP",e[e.SHEN_BING=112]="SHEN_BING",e[e.RANK=113]="RANK",e[e.FU_LI=114]="FU_LI",e[e.SHI_LIAN_TA=115]="SHI_LIAN_TA",e[e.JING_MAI=116]="JING_MAI",e[e.QIE_CUO=117]="QIE_CUO",e[e.HOU_JIN=118]="HOU_JIN",e[e.BI_WU=119]="BI_WU",e[e.TIAN_SHU=120]="TIAN_SHU",e[e.KUA_FU=121]="KUA_FU"}(FunctionId||(FunctionId={}));var ShopType;!function(e){e[e.GOLD_RECHARGE=1]="GOLD_RECHARGE",e[e.YUE_KA=2]="YUE_KA",e[e.YONG_JIU_KA=3]="YONG_JIU_KA"}(ShopType||(ShopType={}));var ResType;!function(e){e[e.OFFICER=1]="OFFICER",e[e.SILVER=2]="SILVER",e[e.GOLD=3]="GOLD",e[e.EQUIP=4]="EQUIP",e[e.PROP=5]="PROP",e[e.WARTH=6]="WARTH",e[e.CULTIVATION=7]="CULTIVATION",e[e.EXP=8]="EXP",e[e.XUEDIAN=9]="XUEDIAN",e[e.CLEAR_SHOP_CD=10]="CLEAR_SHOP_CD",e[e.RENOWN=11]="RENOWN",e[e.FIGHTING_FORCE=12]="FIGHTING_FORCE",e[e.TIANSHU=15]="TIANSHU",e[e.HU_FU=18]="HU_FU",e[e.BI_LI=19]="BI_LI",e[e.GEN_GU=20]="GEN_GU"}(ResType||(ResType={}));var PropType;!function(e){e[e.TIANSHU=4]="TIANSHU"}(PropType||(PropType={}));var BroadcastType;!function(e){e[e.OFFICER_LEVEL_UP=1]="OFFICER_LEVEL_UP",e[e.PLAYER_ONLINE=2]="PLAYER_ONLINE",e[e.SYSTEM=3]="SYSTEM",e[e.KILL_PLAYER=4]="KILL_PLAYER"}(BroadcastType||(BroadcastType={}));var BattleType;!function(e){e[e.NO=0]="NO",e[e.NORMAL=1]="NORMAL",e[e.BIGUAN=2]="BIGUAN",e[e.COUTRY=3]="COUTRY"}(BattleType||(BattleType={}));var PropertyType;!function(e){e[e.HP=1]="HP",e[e.ATTACK=2]="ATTACK",e[e.DEFENCE=3]="DEFENCE",e[e.DODGE=4]="DODGE",e[e.CRIT=5]="CRIT",e[e.CRIT_HURT=6]="CRIT_HURT",e[e.WULI=7]="WULI",e[e.ZHILI=8]="ZHILI",e[e.MINJIE=9]="MINJIE",e[e.MEILI=10]="MEILI",e[e.TONGSHUAI=11]="TONGSHUAI",e[e.NEILI=12]="NEILI",e[e.GENGU=13]="GENGU",e[e.BILI=14]="BILI",e[e.WUHON=15]="WUHON",e[e.SHENGWANG=16]="SHENGWANG"}(PropertyType||(PropertyType={}));var ChatType;!function(e){e[e.CAMP=1]="CAMP",e[e.WORLD=2]="WORLD",e[e.PRIVATE=3]="PRIVATE",e[e.HELP_KILL_BOSS=4]="HELP_KILL_BOSS",e[e.KILL_BOSS=5]="KILL_BOSS",e[e.LOGIN=6]="LOGIN",e[e.KILLED_PLAYER=7]="KILLED_PLAYER",e[e.KILL_PLAYER=8]="KILL_PLAYER",e[e.SYSTEM=9]="SYSTEM"}(ChatType||(ChatType={}));var ChatContentType;!function(e){e[e.ATTACK_BOSS=0]="ATTACK_BOSS",e[e.ONLINE=1]="ONLINE",e[e.KILL_BOSS=2]="KILL_BOSS",e[e.PLAYER=3]="PLAYER",e[e.SYSTEM=4]="SYSTEM"}(ChatContentType||(ChatContentType={}));var AlertType;!function(e){e[e.NORMAL=0]="NORMAL",e[e.ERROR=1]="ERROR",e[e.TIP=2]="TIP",e[e.GET_EXP=3]="GET_EXP",e[e.GET_OFFICER=4]="GET_OFFICER",e[e.GET_EQUIP=5]="GET_EQUIP",e[e.PLAYE_ONLINE=6]="PLAYE_ONLINE",e[e.OFFICER_2_EXP=7]="OFFICER_2_EXP",e[e.PROPERTY_ADD=8]="PROPERTY_ADD",e[e.PROPERTY_REDUCE=9]="PROPERTY_REDUCE",e[e.KILL_PLAYER=10]="KILL_PLAYER"}(AlertType||(AlertType={}));var SkillBuff;!function(e){e[e.ONE_ATTACK=1]="ONE_ATTACK",e[e.TWO_ATTACK=2]="TWO_ATTACK",e[e.MORE_ATTACK=3]="MORE_ATTACK",e[e.SUCK_BLOOD=4]="SUCK_BLOOD",e[e.CURE=5]="CURE",e[e.DIZZY=16]="DIZZY"}(SkillBuff||(SkillBuff={}));var BiWuStep;!function(e){e[e.STEP_1=1]="STEP_1",e[e.STEP_2=2]="STEP_2",e[e.STEP_3=3]="STEP_3",e[e.STEP_4=4]="STEP_4",e[e.STEP_5=5]="STEP_5"}(BiWuStep||(BiWuStep={}));var MapMainCityId;!function(e){e[e.WEI=1001]="WEI",e[e.SHU=2001]="SHU",e[e.WU=3001]="WU"}(MapMainCityId||(MapMainCityId={}));var Game=function(){function e(){}return e.chat=null,e.chatTabIndex=0,e.mapId=-1,e.isSelfDie=!1,e.battleType=0,e.hasEnterGame=!1,e.isKuaFu=!1,e.biwuStep=1,e.hasLoginOffline=!1,e.TASK_MAX_ID=0,e.MAGIC_WEAPON_MAX_ID=0,e.BODY_MAX_ID=0,e.HUFU_ADD_TIME=0,e.HUFU_MAX_COUNT=3e3,e.HUFU_ADD_REALLY_TIME=0,e.BIRTH_MAP_ID=99,e.KUAFU_BIRTH_MAP_ID=9e3,e.MAX_EQUIP_OFFICER_COUNT=6,e.BODY_MAX_COLOR=6,e.BODY_MAX_STAR=5,e.EQUIP_PART_MAX_LEVEL=60,e.MERIDIAN_MAX_TYPE=8,e.MERIDIAN_MAX_STAR=9,e.COUNTRY_CHANGE_TIME=1296e3,e.COUNTRY_CHANGE_GOLD=0,e.BIGUAN_MAX_FLOOR=100,e.KUA_FU_PLAYER_LEVEL=80,e.KUA_FU_BODY_LEVEL=35,e.KUA_FU_HOZA_LEVEL=5,e.FIGHTING_FORCE_INIT=195e3,e.SHOW_BOSS_LEVEL=0,e.selfDizzyObj={beginTime:0,isDizzy:!1},e}();__reflect(Game.prototype,"Game");var GameUtil=function(){function e(){}return e.closeAllUI=function(){UIManager.ins.closeAll()},e.getResObj=function(t,i){void 0===i&&(i=0);var n={};if(n.type=t,n.name=e.getResName(t),t==ResType.SILVER)n.iconResName="yinliang_big_icon";else if(ResType.GOLD==t)n.iconResName="yuanbao_big_icon";else if(ResType.WARTH==t)n.iconResName="zhanyi_big_icon";else if(ResType.CULTIVATION==t)n.iconResName="xiuwei_big_icon";else if(ResType.EXP==t)n.iconResName="jingyan_big_icon";else if(ResType.XUEDIAN==t)n.iconResName="xuedian_big_icon";else if(ResType.RENOWN==t)n.iconResName="shengwang_big_icon";else if(ResType.OFFICER==t){var o=MetaOfficerManager.ins.getOfficerForTypeAndLevel(i);n.iconResName="officer_head_small_icon_"+o.type,n.name=o.name,n.officerType=o.type,n.color=o.quality}else if(ResType.EQUIP==t){var r=MetaEquipManager.ins.getEquip(i);n.iconResName="equip_icon_"+r.id,n.name=r.name,n.color=r.color}else if(ResType.PROP==t){var s=MetaPropMananger.ins.getProp(i);s.type!=PropType.TIANSHU?n.iconResName="prop_"+s.id:n.iconResName="tianshu_icon_"+s.id,n.name=s.name}else ResType.HU_FU==t?n.iconResName="hufu_big_icon":ResType.BI_LI==t?n.iconResName="bili_big_icon":ResType.GEN_GU==t&&(n.iconResName="gengu_big_icon");return n},e.getFunctionBtnRes=function(e){var t="";switch(e){case FunctionId.JIANGHU:t="main_jianghu_btn_up";break;case FunctionId.WUJIANG:t="main_wujiang_btn_up";break;case FunctionId.SHOP:t="main_shop_btn_up";break;case FunctionId.JUESE:t="main_juese_btn_up";break;case FunctionId.MAIL:t="main_youjian_btn_up";break;case FunctionId.LI_BAO:t="main_libao_btn_up";break;case FunctionId.CHAT:t="main_liaotian_btn_up";break;case FunctionId.LI_XIAN:t="main_lixian_btn_up";break;case FunctionId.YUE_KA:t="main_yueka_btn_up";break;case FunctionId.GUO_JIA:t="main_shili_btn_up";break;case FunctionId.EQUIP:t="main_zhuangbei_btn_up";break;case FunctionId.SHEN_BING:t="main_shenbing_btn_up";break;case FunctionId.RANK:t="main_rank_btn_up";break;case FunctionId.SHI_LIAN_TA:t="main_biguan_btn_up";break;case FunctionId.JING_MAI:t="main_jingmai_btn_up";break;case FunctionId.QIE_CUO:t="main_gengu_btn_up";break;case FunctionId.HOU_JIN:t="main_houjin_btn_up";break;case FunctionId.TIAN_SHU:t="main_tianshu_btn_up";break;case FunctionId.KUA_FU:t="main_zhanfu_btn_up"}return t},e.getTaoYuanId=function(){var e=Game.BIRTH_MAP_ID;return Game.isKuaFu&&(e=Game.KUAFU_BIRTH_MAP_ID),e},e.checkCanKill=function(e,t,i){var n=PlayerVoManager.ins.playerInfoVo,o=.001*(e-195e3),r=i.attack;return r=i.level>t?i.attack:i.attack*i.attack/(i.attack+n.defence),o>=r},e.showStopLogin=function(){Game.net.dispose(),GameUIUtil.showServerInfo({type:2,time:""})},e.login=function(e,t){function i(){PingManager.getIns().init();var e=GamePlatform.ins.getLoginParams();e.cmd=BookCmd.ENTER_SEREVER,e.server=PlayerVoManager.ins.playerVo.serverId;var t="";for(var i in e)t+=i+":"+e[i]+",";log("logindata:"+t);Game.net.sendData(e,function(e){if(LoadingIcon.instance.hide(),e.resultCode==GameSocket.RESULT_SUCCES){if(Game.isKuaFu=!1,log(e.dataVo),1==e.dataVo.kf)return Game.isKuaFu=!0,KuaFuVoManager.ins.setKuaFuServer({ip:e.dataVo.kfip,port:e.dataVo.kfport}),void KuaFu.ins.enterKuaFu(!0);if(PlayerVoManager.ins.initFromServer(e.dataVo),Game.hasEnterGame)EventCenter.ins.send(EventCenter.KUA_FU_SURE_OUT),EventCenter.ins.send(EventCenter.KUA_FU_UPDATE);else{var t=PlayerVoManager.ins.playerVo;DataCount.ins.joinGame({plat:GamePlatform.ins.channelName,accountId:t.id,level:t.level,serverId:t.serverId,accountType:0,accountName:t.name}),GamePlatform.ins.savePlayerData(t),GamePlatform.ins.loginComplete(),(new MainScenePre).start()}}else SceneManager.ins.changeScene(new CreateRoleScene)})}Game.net.setUrl(e,t),Game.net.startConnnet(i)},e.checkIsCountryMainCity=function(e,t){return t==Camp.WEI?4001==e||4010==e||4019==e:Camp.SHU==t?4101==e||4110==e||4119==e:Camp.WU==t?4201==e||4210==e||4219==e:!1},e.mapDropTypeChange=function(e){var t=0;switch(e){case 1:t=ResType.GOLD;break;case 2:t=ResType.SILVER;break;case 3:t=ResType.WARTH;break;case 4:t=ResType.CULTIVATION}return t},e.bagTypeChange=function(e){var t=0;switch(e){case 1:t=ResType.OFFICER;break;case 2:t=ResType.SILVER;break;case 3:t=ResType.GOLD;break;case 4:t=ResType.EQUIP;break;case 5:t=ResType.PROP;break;case 6:t=ResType.WARTH;break;case 7:t=ResType.CULTIVATION;break;case 8:t=ResType.EXP;break;case 9:t=ResType.XUEDIAN}return e},e.handleSixProperty=function(t,i){void 0===i&&(i=Constants.LEVEL_SIX_PRO);var n=SixProVoManager.ins.getSixVo(i),o=n.wuli,r=n.zhili,s=n.neili,a=n.tongshuai,h=n.minjie,p=n.meili;SixProVoManager.ins.fromServer(t,i);var l=n.wuli-o,u=n.zhili-r,c=n.neili-s,d=n.tongshuai-a,f=n.minjie-h,g=n.meili-p;e.showPropertyDiff(PropertyType.WULI,l),e.showPropertyDiff(PropertyType.ZHILI,u),e.showPropertyDiff(PropertyType.NEILI,c),e.showPropertyDiff(PropertyType.TONGSHUAI,d),e.showPropertyDiff(PropertyType.MINJIE,f),e.showPropertyDiff(PropertyType.MEILI,g)},e.handleTianShuSix=function(t,i){void 0===i&&(i=!0);TianShuVoManager.ins.getTotalHighProperty(PropertyType.WULI),TianShuVoManager.ins.getTotalHighProperty(PropertyType.ZHILI),TianShuVoManager.ins.getTotalHighProperty(PropertyType.MINJIE),TianShuVoManager.ins.getTotalHighProperty(PropertyType.MEILI),TianShuVoManager.ins.getTotalHighProperty(PropertyType.TONGSHUAI),TianShuVoManager.ins.getTotalHighProperty(PropertyType.NEILI);i?TianShuVoManager.ins.book(t):TianShuVoManager.ins.unBook(t);var n=TianShuVoManager.ins.getTotalHighProperty(PropertyType.WULI),o=TianShuVoManager.ins.getTotalHighProperty(PropertyType.ZHILI),r=TianShuVoManager.ins.getTotalHighProperty(PropertyType.MINJIE),s=TianShuVoManager.ins.getTotalHighProperty(PropertyType.MEILI),a=TianShuVoManager.ins.getTotalHighProperty(PropertyType.TONGSHUAI),h=TianShuVoManager.ins.getTotalHighProperty(PropertyType.NEILI);
e.showPropertyDiff(PropertyType.WULI,n),e.showPropertyDiff(PropertyType.ZHILI,o),e.showPropertyDiff(PropertyType.NEILI,h),e.showPropertyDiff(PropertyType.TONGSHUAI,a),e.showPropertyDiff(PropertyType.MINJIE,r),e.showPropertyDiff(PropertyType.MEILI,s)},e.handleSixProperty2=function(t,i){e.showPropertyDiff(PropertyType.WULI,i.wuli-t.wuli),e.showPropertyDiff(PropertyType.ZHILI,i.zhili-t.zhili),e.showPropertyDiff(PropertyType.NEILI,i.neili-t.neili),e.showPropertyDiff(PropertyType.TONGSHUAI,i.tongshuai-t.tongshuai),e.showPropertyDiff(PropertyType.MINJIE,i.minjie-t.minjie),e.showPropertyDiff(PropertyType.MEILI,i.meili-t.meili)},e.handleNormalProperty=function(t,i){e.showPropertyDiff(PropertyType.ATTACK,i.attack-t.attack),e.showPropertyDiff(PropertyType.DEFENCE,i.defence-t.defence),e.showPropertyDiff(PropertyType.HP,i.hp-t.hp),e.showPropertyDiff(PropertyType.DODGE,i.dodge-t.dodge),e.showPropertyDiff(PropertyType.CRIT,i.crit-t.crit),e.showPropertyDiff(PropertyType.CRIT_HURT,i.critHurt-t.critHurt)},e.handleBags=function(t){if(t){log("====================handleBags begin=========="+t.length+"===============");for(var i in t){var n=t[i];log("key:"+i+",type:"+n.category+",count:"+n.count+",staticId:"+n.staticId)}log("====================handleBags end=========================");for(var o=0,r=t.length;r>o;o++){var s=t[o],a=s.category;if(ResType.OFFICER==a){t.unshift(t.splice(o,1)[0]);break}}for(var h=VoUtil.getTotalSixProperty(),o=0,r=t.length;r>o;o++){var s=t[o],a=s.category;if(ResType.OFFICER==a){var p=MetaOfficerManager.ins.getOfficerForTypeAndLevel(s.staticId,1);p&&(OfficerVoManager.ins.addOfficerPiece(p.type,s.count),Alert.ins.showAlert(AlertType.GET_OFFICER,"",e.getColor(p.quality),p.name+"*"+s.count))}else if(ResType.SILVER==a)Alert.ins.showAlert(AlertType.TIP,"获得了"+Util.handleUnit2(s.count)+"银币");else if(ResType.GOLD==a)Alert.ins.showAlert(AlertType.TIP,"获得了"+Util.handleUnit2(s.count)+"元宝");else if(ResType.EQUIP==a){var l=MetaEquipManager.ins.getEquip(s.staticId);EquipVoMananger.ins.addEquipPiece(l.id,s.count),Alert.ins.showAlert(AlertType.GET_EQUIP,"",e.getColor(l.color),l.name)}else if(ResType.PROP==a){var u=MetaPropMananger.ins.getProp(s.staticId);if(u.type!=PropType.TIANSHU)PropVoManager.ins.operPropCount(s.staticId,s.count,!0);else{var c=MetaTianShuManager.ins.getTianShuForProp(s.staticId);TianShuVoManager.ins.addCount(c.id,s.count)}Alert.ins.showAlert(AlertType.TIP,"获得了"+s.count+"个"+u.name)}else ResType.EXP==a?Alert.ins.showAlert(AlertType.TIP,"获得了"+Util.handleUnit2(s.count)+"经验"):ResType.XUEDIAN==a?(HozaVoManager.ins.operStudyPoint(s.count,!0),Alert.ins.showAlert(AlertType.TIP,"获得了"+Util.handleUnit2(s.count)+"学点")):ResType.WARTH==a?(MagicWeaponVoManager.ins.addWarth(s.count),Alert.ins.showAlert(AlertType.TIP,"获得了"+Util.handleUnit2(s.count)+"战意")):ResType.CULTIVATION==a?(MeridianVoManager.ins.operCount(s.count,!0),Alert.ins.showAlert(AlertType.TIP,"获得了"+Util.handleUnit2(s.count)+"修为")):ResType.RENOWN==a?(RenownVoManager.ins.operRenownVoCount(s.count,!0),Alert.ins.showAlert(AlertType.TIP,"获得了"+Util.handleUnit2(s.count)+"声望")):ResType.HU_FU==a?(HuFuVoManager.ins.operHuFu(s.count,!0),Alert.ins.showAlert(AlertType.TIP,"获得了"+Util.handleUnit2(s.count)+"虎符")):ResType.BI_LI==a?Alert.ins.showAlert(AlertType.TIP,"获得了"+Util.handleUnit2(s.count)+"臂力"):ResType.GEN_GU==a&&Alert.ins.showAlert(AlertType.TIP,"获得了"+Util.handleUnit2(s.count)+"根骨")}var d=VoUtil.getTotalSixProperty();e.handleSixProperty2(h,d)}},e.getPlayerJob=function(t,i){var n="",o=0;return 0==i?(n="士卒",o=5):1==i?(o=1,n=e.getCampName(t)+"王"):i>=2&&3>=i?(n="大将军",o=2):i>=4&&5>=i?(n="大司马",o=3):i>=6&&10>=i?(n="校尉",o=4):i>=11&&(n="士卒",o=5),{name:n,num:o}},e.playBtnSound=function(e){void 0===e&&(e="btn_click_mp3"),SoundManager.ins.playEffect(e)},e.playCloseSound=function(){SoundManager.ins.playEffect("ui_close_mp3")},e.playOpenSound=function(){SoundManager.ins.playEffect("ui_open_mp3")},e.showPropertyDiff=function(t,i){if(void 0===i&&(i=0),0!=i){var n=AlertType.PROPERTY_ADD,o="",r=e.getPropertyName(t);0>i&&(n=AlertType.PROPERTY_REDUCE),o=t==PropertyType.CRIT?r+(i>0?"+":"-")+(.01*Math.abs(i)).toFixed(2)+"%":r+(i>0?"+":"-")+Math.abs(i),Alert.ins.showAlert(n,o)}},e.getChatContent=function(t){var i=new Array,n=(t.ext.split("_"),null);if(t.type<=ChatType.PRIVATE)i.push({text:t.content});else if(t.type==ChatType.SYSTEM)i.push({text:t.content,style:{textColor:16711680}});else if(ChatType.HELP_KILL_BOSS==t.type)i.push({text:e.getCampName(t.camp)+"国 ",style:{textColor:e.getCampColor(t.camp)}}),i.push({text:e.getPlayerJob(t.camp,t.rank).name+t.serverId+"-"}),i.push({text:t.playerName}),i.push({text:"正在前往"}),n=MetaMapManager.ins.getMap(parseInt(t.content)),i.push({text:n.name,style:{textColor:e.getColor(ColorType.ORANGE)}}),i.push({text:"击杀BOSS，"}),i.push({text:"前往助阵",style:{textColor:e.getColor(ColorType.GREEN)}});else if(ChatType.LOGIN==t.type)i.push({text:e.getCampName(t.camp)+"国",style:{textColor:e.getCampColor(t.camp)}}),i.push({text:e.getPlayerJob(t.camp,t.rank).name+t.serverId+"-"}),i.push({text:t.playerName+"上线了"});else if(ChatType.KILL_BOSS==t.type||ChatType.KILL_PLAYER==t.type){i.push({text:e.getCampName(t.camp)+"国",style:{textColor:e.getCampColor(t.camp)}}),i.push({text:e.getPlayerJob(t.camp,t.rank).name+t.serverId+"-"}),i.push({text:t.playerName}),i.push({text:"击败了("+t.content+")"+(t.bags.length>0?",获得了":"。")});for(var o=0,r=t.bags.length;r>o;o++){var s=t.bags[o],a=s.category,h="";if(a==ResType.OFFICER){var p=MetaOfficerManager.ins.getOfficerForTypeAndLevel(s.staticId);i.push({text:p.name,style:{textColor:e.getColor(p.quality)}}),i.push({text:"*"+s.count})}else if(a==ResType.EQUIP){var l=MetaEquipManager.ins.getEquip(s.staticId);i.push({text:l.name,style:{textColor:e.getColor(l.color)}}),i.push({text:"*"+s.count})}else if(a==ResType.PROP){var u=MetaPropMananger.ins.getProp(s.staticId);i.push({text:u.name,style:{textColor:e.getColor(u.color)}}),i.push({text:"*"+s.count})}else i.push({text:Util.handleUnit2(s.count)}),h=e.getResName(a),i.push({text:h});r-1>o&&i.push({text:"、"})}}else ChatType.KILLED_PLAYER==t.type&&log("KILLED_PLAYER。。。。。。。。。。。");return i},e.getQieCuoName=function(e){var t="";switch(e){case 1:t="张飞";break;case 2:t="吕布";break;case 3:t="赵云";break;case 4:t="关羽"}return t},e.sortCountry=function(e,t){return e.cityIcon-t.cityIcon},e.sortCountry2=function(e,t){return e.id-t.id},e.sortHozaDrops=function(e,t){return e.needHozaLevel-t.needHozaLevel},e.sortFetters=function(e,t){return t.hasActivate-e.hasActivate},e.sortEnterMapCd=function(e,t){return t.cd-e.cd},e.sortEquips=function(e,t){return EquipVoMananger.ins.getOneEquipFightingForce(t)-EquipVoMananger.ins.getOneEquipFightingForce(e)},e.sortEquips2=function(e,t){return t.id-e.id},e.sortOfficersForFighting=function(e,t){return OfficerVoManager.ins.getNormalFightingForce(t)-OfficerVoManager.ins.getNormalFightingForce(e)},e.sortOfficersForFighting2=function(e,t){return OfficerVoManager.ins.getNormalFightingForce(e)-OfficerVoManager.ins.getNormalFightingForce(t)},e.sortOfficersForId=function(e,t){return t.metaOfficer.id-e.metaOfficer.id},e.getColorName=function(e){var t="白";switch(e){case ColorType.WHITE:t="白";break;case ColorType.BLUE:t="蓝";break;case ColorType.GREEN:t="绿";break;case ColorType.ORANGE:t="橙";break;case ColorType.PURPLE:t="紫";break;case ColorType.RED:t="红"}return t},e.getColor=function(e){var t=0;switch(e){case ColorType.WHITE:t=16774876;break;case ColorType.BLUE:t=2315229;break;case ColorType.GREEN:t=888071;break;case ColorType.ORANGE:t=13326598;break;case ColorType.PURPLE:t=13768320;break;case ColorType.RED:t=16712194}return t},e.isSafe=function(e){return e.type==MapType.BIRTH},e.getOfficerHeadName=function(e){return"officer_head_icon_"+e},e.getOfficerHeadColorName=function(e){return"officer_head_icon_bg_"+e},e.getOfficerHead=function(t){var i=e.getOfficerHeadName(t);return RES.getRes(i)},e.getOfficerHeadBg=function(e){return RES.getRes("officer_head_icon_bg_"+e)},e.getEquipIcoName=function(e){return"equip_icon_"+e},e.getHead=function(e){return RES.getRes("hero_head_"+e+"_png")},e.getCampIcon=function(e){return RES.getRes("camp_small_"+e)},e.getMagicWeapon=function(e){return RES.getRes("magic_weapon_"+e)},e.getSkillName=function(e){return null},e.getSmallEquipIcon=function(e,t){return RES.getRes("equip_small_icon_"+t+"_"+e)},e.getCampColor=function(e){var t=0;switch(e){case Camp.WEI:t=2667507;break;case Camp.SHU:t=6746920;break;case Camp.WU:t=15965992}return t},e.getisLeftColoe=function(e){var t=0;return t=e?14670507:14406016},e.getMainCityIdForCamp=function(e){var t=0;switch(e){case Camp.WEI:t=MapMainCityId.WEI;break;case Camp.SHU:t=MapMainCityId.SHU;break;case Camp.WU:t=MapMainCityId.WU}return t},e.getCampName=function(e){var t="";switch(e){case Camp.SHU:t="蜀";break;case Camp.WEI:t="魏";break;case Camp.WU:t="吴"}return t},e.getFuliDes=function(e){var t="";switch(e){case 1:t="绝世女将直送5级：蔡琰x46";break;case 2:t="神兵直升5级：战意x10000";break;case 3:t="绝世女将直送5级：马云禄x46";break;case 4:t="千万富豪：银币x8888888";break;case 5:t="绝世女将直送5级：星彩x46";break;case 6:t="耀世奇珍：元宝x1888";break;case 7:t="绝世女将直送5级：黄月英x46"}return t},e.getResName=function(e){var t="";switch(e){case ResType.OFFICER:t="武将";break;case ResType.SILVER:t="银两";break;case ResType.GOLD:t="元宝";break;case ResType.EQUIP:t="宝物";break;case ResType.PROP:t="道具";break;case ResType.WARTH:t="战意";break;case ResType.CULTIVATION:t="修为";break;case ResType.EXP:t="经验";break;case ResType.XUEDIAN:t="学点";break;case ResType.RENOWN:t="声望";break;case ResType.FIGHTING_FORCE:t="战力";break;case ResType.HU_FU:t="虎符";break;case ResType.BI_LI:t="臂力";break;case ResType.GEN_GU:t="根骨"}return t},e.getEquipProperty=function(e){var t={value:0,name:""};return 0!=e.attack?(t.value=e.attack,t.name="攻击"):0!=e.defence?(t.value=e.defence,t.name="防御"):0!=e.hp?(t.value=e.hp,t.name="血量"):0!=e.dodge&&(t.value=e.dodge,t.name="闪避"),t},e.getPropertyName=function(e){var t="";switch(e){case PropertyType.HP:t="生命";break;case PropertyType.ATTACK:t="攻击";break;case PropertyType.DEFENCE:t="防御";break;case PropertyType.DODGE:t="闪避";break;case PropertyType.CRIT:t="暴击";break;case PropertyType.CRIT_HURT:t="暴伤";break;case PropertyType.WULI:t="武力";break;case PropertyType.ZHILI:t="智力";break;case PropertyType.MINJIE:t="敏捷";break;case PropertyType.MEILI:t="魅力";break;case PropertyType.TONGSHUAI:t="统帅";break;case PropertyType.NEILI:t="内力";break;case PropertyType.GENGU:t="根骨";break;case PropertyType.BILI:t="臂力";break;case PropertyType.WUHON:t="武魂";break;case PropertyType.SHENGWANG:t="声望"}return t},e.getPropertyIcon=function(e){var t="";switch(e){case PropertyType.HP:t="hp_icon";break;case PropertyType.ATTACK:t="attack_icon";break;case PropertyType.DEFENCE:t="defence_icon";break;case PropertyType.DODGE:t="shanbi_icon";break;case PropertyType.CRIT:t="crit_icon";break;case PropertyType.CRIT_HURT:t="crit_hurt_icon";break;case PropertyType.WULI:t="wuli_icon";break;case PropertyType.ZHILI:t="zhili_icon";break;case PropertyType.MINJIE:t="minjie_icon";break;case PropertyType.MEILI:t="meili_icon";break;case PropertyType.TONGSHUAI:t="tongshuai_icon";break;case PropertyType.NEILI:t="neili_icon";break;case PropertyType.GENGU:t="gengu_icon";break;case PropertyType.BILI:t="bili_icon";break;case PropertyType.WUHON:t="wuhon_icon";break;case PropertyType.SHENGWANG:t="shengwang_icon"}return t},e.getBiWuWeek=function(e){var t="";return t=6>e?"周"+Util.num2daxie(e):"周末"},e.reLogin=function(){VoUtil.dispose(),Game.net.dispose(),GameEffectMananger.ins.dispose(),PingManager.getIns().dispose(),UIManager.ins.closeAll(),UIUtil.dispose(Guide.ins.container),UIUtil.dispose(Game.loadingContainer),UIUtil.dispose(SceneManager.ins.container),UIUtil.dispose(GameEffectMananger.ins.sceneEffectContainer),UIUtil.dispose(GameEffectMananger.ins.topBroadcastContainer),UIUtil.dispose(GameEffectMananger.ins.uiEffectContainer),Alert.ins.dispose(),UIUtil.dispose(Game.chatContainer),UIUtil.dispose(Game.loadingContainer),GamePlatform.ins.reload(),Game.hasEnterGame=!1,GamePlatform.ins.channelName==GamePlatform.DEBUG?SceneUtil.changeScene(SceneId.LOGIN):SceneUtil.changeScene(SceneId.SERVER_LIST)},e.getGrayFilter=function(){var e=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0];return new egret.ColorMatrixFilter(e)},e.getEquipPartName=function(e){var t="武器";return EquipType.HORSE==e?t="坐骑":EquipType.CLOTH==e&&(t="铠甲"),t},e.getEquipPartPropertyName=function(e){var t="攻击";return EquipType.HORSE==e?t="血量":EquipType.CLOTH==e&&(t="防御"),t},e.getBagsDes=function(t,i){void 0===i&&(i=!0);for(var n=new Array,o=0,r=t.length;r>o;o++){var s=t[o];if(s.category==ResType.SILVER)n.push({text:"银两 × "+Util.handleUnit2(s.count)+(i?"\n":"")});else if(ResType.GOLD==s.category)n.push({text:"元宝 × "+Util.handleUnit2(s.count)+(i?"\n":"")});else if(ResType.WARTH==s.category)n.push({text:"战意 × "+Util.handleUnit2(s.count)+(i?"\n":"")});else if(ResType.CULTIVATION==s.category)n.push({text:"修为 × "+Util.handleUnit2(s.count)+(i?"\n":"")});else if(ResType.EXP==s.category)n.push({text:"经验 × "+Util.handleUnit2(s.count)+(i?"\n":"")});else if(ResType.XUEDIAN==s.category)n.push({text:"学点 × "+Util.handleUnit2(s.count)+(i?"\n":"")});else if(ResType.RENOWN==s.category)n.push({text:"声望 × "+Util.handleUnit2(s.count)+(i?"\n":"")});else if(ResType.OFFICER==s.category){var a=MetaOfficerManager.ins.getOfficerForTypeAndLevel(s.staticId);a&&(n.push({text:a.name,style:{textColor:e.getColor(a.quality)}}),n.push({text:" × "+Util.handleUnit2(s.count)+(i?"\n":"")}))}else if(ResType.EQUIP==s.category){var h=MetaEquipManager.ins.getEquip(s.staticId);n.push({text:h.name,style:{textColor:e.getColor(h.color)}}),n.push({text:" × "+Util.handleUnit2(s.count)+(i?"\n":"")})}else if(ResType.PROP==s.category){var p=MetaPropMananger.ins.getProp(s.staticId);n.push({text:p.name+" × "+Util.handleUnit2(s.count)+(i?"\n":"")})}else ResType.HU_FU==s.category?n.push({text:"虎符 × "+Util.handleUnit2(s.count)+(i?"\n":"")}):ResType.BI_LI==s.category?n.push({text:"臂力 × "+Util.handleUnit2(s.count)+(i?"\n":"")}):ResType.GEN_GU==s.category&&n.push({text:"根骨 × "+Util.handleUnit2(s.count)+(i?"\n":"")})}return n},e}();__reflect(GameUtil.prototype,"GameUtil");var NetUtil=function(){function e(){}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.requestPlayerInfo=function(e,t){void 0===e&&(e=null),void 0===t&&(t=null),LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.PLAYER_INFO_PANEL},function(i){LoadingIcon.instance.hide();var n=i.dataVo;log("武将数量："+n.heroCount),PlayerVoManager.ins.initPlayerInfoVo(n),RenownVoManager.ins.fromServer(n),BodyVoMananger.ins.fromServer({body:n.body}),e&&e.call(t,[i])},this)},e._ins=null,e}();__reflect(NetUtil.prototype,"NetUtil");var Chat=function(e){function t(){var t=e.call(this)||this;return t.privateUI=null,t.tabIndex=-1,t.listIndex=-1,t.skinName="resource/skins/chat/ChatSkin.exml",t.show(),t.tabIndex=Game.chatTabIndex,t}return __extends(t,e),t.prototype.onCreated=function(){e.prototype.onCreated.call(this),this.closeBtn=new DDButton(this.closeBtn,this.onClose,this),this.listCom=new ChatListComponent(this.listComponent),this.inputCom=new ChatInputComponent(this.inputComponent),this.campBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onMenuClick,this),this.worldBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onMenuClick,this),this.privateBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onMenuClick,this),this.setList(this.tabIndex),this.setTab(this.tabIndex),EventCenter.ins.add(EventCenter.CHAT_SEND_MESSAGE,this.onSendMessage,this),EventCenter.ins.add(EventCenter.CHAT_NAME_CLICK,this.onNameClick,this),EventCenter.ins.add(EventCenter.CHAT_CLICK_PRIVATE_ITEM,this.onClickPrivateItem,this),EventCenter.ins.add(EventCenter.CHAT_UPDATE_WORLD_TIMES,this.updateWorldChatCount,this),EventCenter.ins.add(EventCenter.CHAT_UPDATE_NEW_MESSAGE,this.checkChatRed,this),this.countryRedImg.visible=!1,this.worldRedImg.visible=!1,this.privateRedImg.visible=!1},t.prototype.onMenuClick=function(e){var t=e.currentTarget;switch(t.name){case"campBtn":this.setTab(0);break;case"worldBtn":this.setTab(1);break;case"privateBtn":this.setTab(2)}this.setList(this.tabIndex),ChatVoManager.ins.updateNewMessage(this.tabIndex,0)},t.prototype.setTab=function(e){void 0===e&&(e=0),this.tabIndex=e,this.campBtn.currentState="up",this.worldBtn.currentState="up",this.privateBtn.currentState="up",0==this.tabIndex?this.campBtn.currentState="down":1==this.tabIndex?this.worldBtn.currentState="down":2==this.tabIndex&&(this.privateBtn.currentState="down")},t.prototype.checkChatRed=function(e){var i=ChatVoManager.ins.newMessages,n=e.data;n==ChatType.HELP_KILL_BOSS||n==ChatType.LOGIN||ChatType.CAMP==n?(i[0]=1,t.isOpened&&0==this.tabIndex&&(i[0]=0)):n==ChatType.KILL_BOSS?(i[0]=1,i[1]=1,t.isOpened&&(0==this.tabIndex?i[0]=0:1==this.tabIndex&&(i[1]=0))):ChatType.WORLD==n?(i[1]=1,t.isOpened&&1==this.tabIndex&&(i[1]=0)):ChatType.PRIVATE==n&&(i[2]=1,t.isOpened&&2==this.tabIndex&&(i[2]=0)),this.countryRedImg.visible=1==i[0],this.worldRedImg.visible=1==i[1],this.privateRedImg.visible=1==i[2]},t.prototype.onClickPrivateItem=function(e){var t=e.data;ChatVoManager.ins.readPrivate(t),this.listCom.updateList(2,!0);var i=ChatVoManager.ins.getPrivate(t);i&&(ChatPrivateUI.isOpened||(this.privateUI=new ChatPrivateUI(i),this.addChild(this.privateUI)))},t.prototype.onNameClick=function(e){var t=e.data;ChatPrivateUI.isOpened||(this.privateUI=new ChatPrivateUI(t),this.addChild(this.privateUI))},t.prototype.onSendMessage=function(e){var t=BookCmd.CHAT_CAMP;if(1==this.tabIndex){var i=HozaVoManager.ins.hozaVo,n=10*(i.level-1),o=MetaHozaManager.ins.getHoza(i.level);if(1==i.level)return void Alert.ins.showAlert(AlertType.ERROR,"厚劲达到"+o.name+"后，才能在世界频道发言");var r=n-PlayerVoManager.ins.playerVo.chatWorldTimes;if(0>=r)return void Alert.ins.showAlert(AlertType.ERROR,"发言次数不足，请提升厚劲等级");t=BookCmd.CHAT_WORLD}else 0==this.tabIndex&&(t=BookCmd.CHAT_CAMP);Game.net.sendData({cmd:t,content:e.data},null,null)},t.prototype.setList=function(e){void 0===e&&(e=1),this.listIndex=e,0==this.listIndex?this.countryRedImg.visible=!1:1==this.listIndex?this.worldRedImg.visible=!1:2==this.listIndex&&(this.privateRedImg.visible=!1);var t=2==e;this.listCom.updateList(e),this.inputCom.setVisible(!t),this.inputCom.chatIndex=e,t?this.titleLabel.text="私聊":this.titleLabel.text="聊天",this.tipLabel.visible=this.tipNameLabel.visible=!0,0==this.listIndex?this.tipLabel.text="相同国家玩家可在此交流":1==this.listIndex?this.updateWorldChatCount():2==this.listIndex&&(this.tipLabel.visible=this.tipNameLabel.visible=!1)},t.prototype.updateWorldChatCount=function(){var e=HozaVoManager.ins.hozaVo,t=10*(e.level-1),i=MetaHozaManager.ins.getHoza(e.level);if(1==e.level)i=MetaHozaManager.ins.getHoza(e.level+1),this.tipLabel.text="厚劲达到"+i.name+"后，才能在世界频道发言";else{var n=t-PlayerVoManager.ins.playerVo.chatWorldTimes;this.tipLabel.text="少侠厚劲为"+i.name+", 还可以在世界频道发言"+n+"次"}},t.prototype.onClose=function(){Game.chatTabIndex=this.tabIndex,t.isOpened=!1,TweenMax.killTweensOf(this),EventCenter.ins.send(EventCenter.CHAT_UPDATE_NEW_MESSAGE),GameUIUtil.closeChat()},t.prototype.show=function(){t.isOpened=!0,1==this.tabIndex&&this.updateWorldChatCount(),ChatVoManager.ins.updateNewMessage(this.tabIndex,0),TweenMax.killTweensOf(this),TweenMax.to(this,.1,{y:0,alpha:1})},t.prototype.dispose=function(){e.prototype.dispose.call(this),EventCenter.ins.remove(EventCenter.CHAT_NAME_CLICK,this.onNameClick,this),EventCenter.ins.remove(EventCenter.CHAT_SEND_MESSAGE,this.onSendMessage,this),EventCenter.ins.remove(EventCenter.CHAT_CLICK_PRIVATE_ITEM,this.onClickPrivateItem,this),EventCenter.ins.remove(EventCenter.CHAT_UPDATE_WORLD_TIMES,this.updateWorldChatCount,this),EventCenter.ins.remove(EventCenter.CHAT_UPDATE_NEW_MESSAGE,this.checkChatRed,this),this.campBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onMenuClick,this),this.worldBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onMenuClick,this),this.privateBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onMenuClick,this),this.listCom.dispose(),this.listCom=null,this.inputCom.dispose(),this.inputCom=null,this.closeBtn.dispose(),this.closeBtn=null,TweenMax.killTweensOf(this),UIUtil.dispose(this)},t.isOpened=!1,t._ins=null,t}(BaseComponent);__reflect(Chat.prototype,"Chat");var ChatPrivateUI=function(e){function t(t){var i=e.call(this)||this;return i.chatVo=t,i.skinName="ChatPrivateUISkin",i}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),t.isOpened=!0,t.playerId=this.chatVo.playerId,this.bgImg=this.getMc("bgImg"),this.nameLabel=this.getMc("nameLabel"),this.listCom=new ChatListComponent(this.getMc("listComponent"),{playerId:this.chatVo.playerId,playerName:this.chatVo.playerName});var i=this.getMc("inputComponent");this.inputCom=new ChatInputComponent(i),this.listCom.updateList(3),this.bgImg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.nameLabel.text=this.chatVo.playerName,EventCenter.ins.add(EventCenter.CHAT_PRIVATE_MESSAGE,this.onPrivate,this)},t.prototype.onPrivate=function(e){var t=e.data;Game.net.sendData({cmd:BookCmd.CHAT_PRIVATE,content:t,target:this.chatVo.playerId},null,null)},t.prototype.dispose=function(){e.prototype.dispose.call(this),t.isOpened=!1,this.listCom.dispose(),this.listCom=null,this.inputCom.dispose(),this.inputCom=null,EventCenter.ins.remove(EventCenter.CHAT_PRIVATE_MESSAGE,this.onPrivate,this),this.bgImg.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.parent.onClose(),UIUtil.dispose(this)},t.isOpened=!1,t.playerId="",t}(BaseUI);__reflect(ChatPrivateUI.prototype,"ChatPrivateUI");var ChatInputComponent=function(e){function t(t,i){void 0===i&&(i=null);var n=e.call(this,t,i)||this;return n.chatIndex=0,n.orignX=0,n.orignY=0,n}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.inputText=this.getMc("inputText"),this.orignX=this.inputText.x,this.orignY=this.inputText.y,this.sendBtn=UIUtil.getButton("sendBtn",this.skin,this.onSend,this)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.sendBtn.dispose()},t.prototype.onTouch=function(e){},t.prototype.onSend=function(){if(PlayerVoManager.ins.playerVo.isStopChat)return void Alert.ins.showAlert(AlertType.ERROR,"您当前被禁言!");var e=this.inputText.text;if(""!=e){var t=MetaPingBiManager.ins.getPingBi(e);if(""!=t)return void Alert.ins.showAlert(AlertType.ERROR,"聊天内容含有敏感词!");ChatPrivateUI.isOpened?EventCenter.ins.send(EventCenter.CHAT_PRIVATE_MESSAGE,e):EventCenter.ins.send(EventCenter.CHAT_SEND_MESSAGE,e),this.inputText.text=""}},t}(BaseSkin);__reflect(ChatInputComponent.prototype,"ChatInputComponent");var ChatListComponent=function(e){function t(t,i){void 0===i&&(i=null);var n=e.call(this,t,i)||this;return n.index=-1,n.helpMapId=0,n}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.scroller=this.getMc("scroller"),this.scroller.verticalScrollBar=null;this.getMc("group");this.messages=new eui.ArrayCollection,this.list=this.getMc("list"),this.list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onItem,this),this.scroller.viewport=this.list,EventCenter.ins.add(EventCenter.CHAT_ADD_PRIVATE_MESSAGE,this.onChatAddPrivateMessage,this),EventCenter.ins.add(EventCenter.CHAT_ADD,this.onChatAdd,this)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.list.dataProvider=null,this.list.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onItem,this),EventCenter.ins.remove(EventCenter.CHAT_ADD_PRIVATE_MESSAGE,this.onChatAddPrivateMessage,this),EventCenter.ins.remove(EventCenter.CHAT_ADD,this.onChatAdd,this)},t.prototype.updateList=function(e,t){if(void 0===t&&(t=!1),this.index!=e||t)if(this.index=e,2==e?this.list.itemRenderer=ChatPrivateListItem:this.list.itemRenderer=ChatListItem,3==this.index){var i=ChatVoManager.ins.getPrivate(this.argObj.playerId),n=new Array;if(!i||!i.messages)return this.messages=new eui.ArrayCollection(n),void(this.list.dataProvider=this.messages);for(var o=PlayerVoManager.ins.playerVo,r=void 0,s=null,a=0;a<i.messages.length;a++)r=i.messages[a],s={},s.type=ChatType.PRIVATE,r.isSelf?(s.camp=o.camp,s.playerId=o.id,s.serverId=o.serverId,s.playerName=o.name):(s.camp=i.camp,s.playerId=i.playerId,s.serverId=i.serverId,s.playerName=i.playerName),s.content=r.message,n.push(s);this.messages=new eui.ArrayCollection(n),this.list.dataProvider=this.messages}else if(2==this.index){for(var h=ChatVoManager.ins.privates,p=new Array,a=h.length-1;a>=0;a--)p.indexOf(h[a].playerId)>=0?h.splice(a,1):p.push(h[a].playerId);this.messages=new eui.ArrayCollection(h),this.list.dataProvider=this.messages}else{ChatListItem.isCamp=0==this.index;var l=ChatVoManager.ins.getChats(this.index);l.length>Constants.CHAT_COUNT&&l.splice(0,l.length-Constants.CHAT_COUNT),this.messages=new eui.ArrayCollection(l),this.list.dataProvider=this.messages;egret.setTimeout(function(e){var t=this;this.scroller.viewport.validateNow(),egret.callLater(function(){t.list.contentHeight>t.scroller.height?TweenMax.to(t.scroller.viewport,.4,{scrollV:t.list.contentHeight-t.scroller.height}):t.scroller.viewport.scrollV=0},this)},this,.1)}},t.prototype.onChatAdd=function(e){var t=e.data;this.addMessage(t)},t.prototype.onChatAddPrivateMessage=function(e){var t=this;if(3==this.index||2==this.index){var i=e.data;if(3!=this.index){for(var n=ChatVoManager.ins.privates,o=new Array,r=n.length-1;r>=0;r--)o.indexOf(n[r].playerId)>=0?n.splice(r,1):o.push(n[r].playerId);return this.messages=new eui.ArrayCollection(n),void(this.list.dataProvider=this.messages)}if(ChatPrivateUI.playerId==i){ChatVoManager.ins.readPrivate(i);var s=ChatVoManager.ins.getPrivate(i),a=PlayerVoManager.ins.playerVo,h=s.messages[s.messages.length-1],p={};p.type=ChatType.PRIVATE,h.isSelf?(p.camp=a.camp,p.serverId=a.serverId,p.playerName=a.name,p.playerId=a.id):(p.camp=s.camp,p.serverId=s.serverId,p.playerName=s.playerName,p.playerId=s.playerId),p.content=h.message,this.messages.length>=Constants.CHAT_COUNT&&this.messages.removeItemAt(0),this.messages.addItem(p),this.scroller.viewport.validateNow(),egret.callLater(function(){t.list.contentHeight>t.scroller.height?TweenMax.to(t.scroller.viewport,.4,{scrollV:t.list.contentHeight-t.scroller.height}):t.scroller.viewport.scrollV=0},this)}}},t.prototype.onItem=function(e){log("index:"+this.list.selectedIndex);var t=this.list.selectedItem;if(2==this.index)EventCenter.ins.send(EventCenter.CHAT_CLICK_PRIVATE_ITEM,this.list.selectedItem.playerId);else{if(t.playerId==PlayerVoManager.ins.playerVo.id)return;if(t.type==ChatType.HELP_KILL_BOSS){var i=parseInt(t.content),n=MetaMapManager.ins.getMap(i),o=MapVoManager.ins.getMap(i);if(!o)return void Alert.ins.showAlert(AlertType.ERROR,"您还没开启地图"+n.name);if(Game.mapId==i)return void Alert.ins.showAlert(AlertType.NORMAL,"您已经在地图"+n.name+"中!");this.gotoHelpAttack(t)}else(ChatType.CAMP==t.type||ChatType.WORLD==t.type)&&EventCenter.ins.send(EventCenter.CHAT_NAME_CLICK,t)}},t.prototype.gotoHelpAttack=function(e){LoadingIcon.instance.show(),this.helpMapId=parseInt(e.content),Game.net.sendData({cmd:BookCmd.COMMON_MAP_RESULT,map:this.helpMapId},this.onGotoHelpAttack,this)},t.prototype.onGotoHelpAttack=function(e){LoadingIcon.instance.hide();var t=e.dataVo,i=MetaMapManager.ins.getMap(this.helpMapId),n=0;for(var o in t.cds)n++;var r=i.monsterIds.length>n;r?(GameUIUtil.closeChat(),GameUIUtil.showEnterMap(this.helpMapId)):Alert.ins.showAlert(AlertType.ERROR,"地图BOSS已经死亡！")},t.prototype.addMessage=function(e){var t=this;if(e.type==ChatType.CAMP){if(0!=this.index)return}else if(ChatType.WORLD==e.type){if(1!=this.index)return}else if(ChatType.PRIVATE==e.type){if(2!=this.index)return}else if(ChatType.HELP_KILL_BOSS==e.type){if(0!=this.index)return}else if(ChatType.KILL_BOSS==e.type){if(2==this.index||3==this.index)return;if(0==this.index&&e.camp!=PlayerVoManager.ins.playerVo.camp)return}else if(ChatType.LOGIN==e.type&&0!=this.index)return;this.messages.length>=Constants.CHAT_COUNT&&this.messages.removeItemAt(0),this.messages.addItem(e),this.scroller.viewport.validateNow(),egret.callLater(function(){t.list.contentHeight>t.scroller.height?TweenMax.to(t.scroller.viewport,.4,{scrollV:t.list.contentHeight-t.scroller.height}):t.scroller.viewport.scrollV=0},this)},t}(BaseSkin);__reflect(ChatListComponent.prototype,"ChatListComponent");var ChatListItem=function(e){function t(){var t=e.call(this)||this;return t.contentBgOffH=48,t.nameLabelY=8,t.contentBgOffY=-10,t.skinName="resource/skins/chat/list/ChatListItemSkin.exml",t.addEventListener(egret.Event.REMOVED_FROM_STAGE,t.onRemoved,t),t}return __extends(t,e),t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this);var t=this.data;t.type<=ChatType.PRIVATE?this.updatePlayer():ChatType.HELP_KILL_BOSS==t.type?this.updateAttackBoss():ChatType.LOGIN==t.type?this.updateOnLine():ChatType.KILL_BOSS==t.type||ChatType.KILL_PLAYER==t.type?this.updateKillBoss():ChatType.SYSTEM==t.type?this.updateSystem():ChatType.KILLED_PLAYER==t.type&&log("chat.....killedPlayer")},t.prototype.updateSystem=function(){var e=this.data;this.contentBgImg.source="chat_3",this.nameBgImg.x=0,this.nameBgImg.y=0,this.nameLabel.textAlign=egret.HorizontalAlign.LEFT,this.nameLabel.x=this.nameLabel.y=18,this.nameLabel.y=this.contentBgImg.x=72,this.contentLabel.x=86,this.nameLabel.y=this.nameLabelY,this.nameLabel.text="系统消息：",this.nameLabel.textColor=GameUtil.getisLeftColoe(!0),this.contentLabel.textFlow=GameUtil.getChatContent(e),this.contentBgImg.width=this.contentLabel.width+28,this.contentBgImg.height=this.contentLabel.height+this.contentBgOffH},t.prototype.updateKillBoss=function(){var e=this.data;this.contentBgImg.source="chat_3",this.nameBgImg.x=0,this.nameBgImg.y=0,this.nameLabel.textAlign=egret.HorizontalAlign.LEFT,this.nameLabel.x=this.nameLabel.y=18,this.nameLabel.y=this.contentBgImg.x=72,this.contentLabel.x=86,this.nameLabel.y=this.nameLabelY,this.nameLabel.text=t.isCamp?"国家消息":"世界消息",this.nameLabel.textColor=GameUtil.getisLeftColoe(!0),this.contentLabel.textFlow=GameUtil.getChatContent(e),this.contentBgImg.width=this.contentLabel.width+28,this.contentBgImg.height=this.contentLabel.height+this.contentBgOffH,this.contentLabel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onAttackBoss,this)},t.prototype.updateOnLine=function(){var e=this.data;this.contentBgImg.source="chat_3",this.nameBgImg.x=0,this.nameBgImg.y=0,this.nameLabel.textAlign=egret.HorizontalAlign.LEFT,this.nameLabel.x=this.nameLabel.y=18,this.nameLabel.y=this.nameLabelY,this.contentBgImg.x=72,this.contentLabel.x=86,this.nameLabel.text=t.isCamp?"国家消息":"世界消息",this.nameLabel.textColor=GameUtil.getisLeftColoe(!0),this.contentLabel.textFlow=GameUtil.getChatContent(e),this.contentBgImg.width=this.contentLabel.width+28,this.contentBgImg.height=this.contentLabel.height+this.contentBgOffH},t.prototype.updateAttackBoss=function(){var e=this.data;this.contentBgImg.source="chat_3",this.nameBgImg.x=0,this.nameBgImg.y=0,this.nameLabel.textAlign=egret.HorizontalAlign.LEFT,this.nameLabel.x=this.nameLabel.y=18,this.nameLabel.y=this.nameLabelY,this.contentBgImg.x=72,this.contentLabel.x=86,this.nameLabel.text=t.isCamp?"国家消息":"世界消息",this.nameLabel.textColor=GameUtil.getisLeftColoe(!0),this.contentLabel.textFlow=GameUtil.getChatContent(e),this.contentBgImg.width=this.contentLabel.width+28,this.contentBgImg.height=this.contentLabel.height+this.contentBgOffH,this.contentLabel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onAttackBoss,this)},t.prototype.onAttackBoss=function(){log("onAttackBoss............")},t.prototype.updatePlayer=function(){var e=this.data,t=!1;e.playerId==PlayerVoManager.ins.playerVo.id&&(t=!0),log("isRight:>>>>"+t+",time:"+egret.getTimer()),t?(this.contentBgImg.source="chat_2",this.nameBgImg.x=408,this.nameLabel.textAlign=egret.HorizontalAlign.RIGHT,this.contentLabel.textColor=GameUtil.getisLeftColoe(!1),this.nameLabel.y=18,this.nameLabel.y=this.nameLabelY,this.contentBgImg.x=72):(this.contentBgImg.source="chat_3",this.nameBgImg.x=0,this.nameBgImg.y=0,this.nameLabel.textAlign=egret.HorizontalAlign.LEFT,this.nameLabel.x=this.nameLabel.y=18,this.nameLabel.y=this.nameLabelY,this.contentBgImg.x=72,this.contentLabel.x=86);
var i="["+GameUtil.getCampName(e.camp)+"]"+e.serverId+"-"+e.playerName;this.nameLabel.text=i,e.ext="",this.contentLabel.textFlow=GameUtil.getChatContent(e),this.contentBgImg.width=this.contentLabel.width+28,this.contentBgImg.height=this.contentLabel.height+this.contentBgOffH,t&&(this.nameLabel.x=555-this.nameLabel.width,this.contentBgImg.x=490-this.contentBgImg.width,this.contentLabel.x=this.contentBgImg.x+12),this.nameBgImg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onNameTouch,this,!0,-1)},t.prototype.onNameTouch=function(){ChatPrivateUI.isOpened||this.data.playerId!=PlayerVoManager.ins.playerVo.id&&EventCenter.ins.send(EventCenter.CHAT_NAME_CLICK,this.data)},t.prototype.onRemoved=function(e){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this),this.nameBgImg.hasEventListener(egret.TouchEvent.TOUCH_TAP)&&this.nameBgImg.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onNameTouch,this),this.contentLabel.hasEventListener(egret.TouchEvent.TOUCH_TAP)&&this.contentLabel.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onAttackBoss,this)},t.isCamp=!1,t}(eui.ItemRenderer);__reflect(ChatListItem.prototype,"ChatListItem");var ChatPrivateListItem=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/chat/list/ChatPrivateListItemSkin.exml",t}return __extends(t,e),t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.nameLabel.text=this.data.playerName,this.stateLabel.text=1==this.data.state?"全部已读":"未读消息",this.bgImg.texture=RES.getRes(1==this.data.state?"chat_11":"chat_8")},t}(eui.ItemRenderer);__reflect(ChatPrivateListItem.prototype,"ChatPrivateListItem");var ExpEffectData=function(){function e(){this.remainderCount=6}return e}();__reflect(ExpEffectData.prototype,"ExpEffectData");var ExpEffectManager=function(){function e(){this.container=new egret.DisplayObjectContainer,this.effectDatas=new Array,this.mTimer=new egret.Timer(100,-1),this.mTimer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this)}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"targetPos",{set:function(e){this.mTargetPos=e},enumerable:!0,configurable:!0}),e.prototype.onTimer=function(e){0==this.effectDatas.length&&this.mTimer.stop();for(var t=0;t<this.effectDatas.length;t++){var i=this.effectDatas[t];i.remainderCount>=0?(this.makeOneExpEffect(i),i.remainderCount--):(this.effectDatas.splice(t,1),t--)}},e.prototype.makeOneExpEffect=function(e){var t=new egret.Bitmap(RES.getRes("exp_effect_png"));if(t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,t.x=e.startPos.x,t.y=e.startPos.y,this.container.addChild(t),e.remainderCount%2==0){e.startPos.x-80,e.startPos.y+60;TweenMax.to(t,1,{bezier:[{x:e.startPos.x,y:e.startPos.y},{x:e.leftPos.x,y:e.leftPos.y},{x:this.mTargetPos.x,y:this.mTargetPos.y}],orientToBezier:!0,onComplete:this.expEffectEnd,onCompleteParams:[t]})}else{e.startPos.x-60,e.startPos.y-120;TweenMax.to(t,1,{bezier:[{x:e.startPos.x,y:e.startPos.y},{x:e.rightPos.x,y:e.rightPos.y},{x:this.mTargetPos.x,y:this.mTargetPos.y}],orientToBezier:!0,onComplete:this.expEffectEnd,onCompleteParams:[t]})}},e.prototype.showEffect=function(e){if(!Global.isBackground){this.mTimer.running||this.mTimer.start();var t=new ExpEffectData;t.startPos=e,t.leftPos=new egret.Point(this.mTargetPos.x,e.y),t.rightPos=new egret.Point(e.x,this.mTargetPos.y),t.targetPos=this.mTargetPos,this.effectDatas.push(t)}},e.prototype.expEffectEnd=function(e){TweenMax.killTweensOf(e),UIUtil.removeChildFromParent(e)},e.prototype.clear=function(){this.mTimer.stop(),UIUtil.dispose(this.container),this.effectDatas.length=0},e.prototype.dispose=function(){this.mTimer.removeEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this.clear()},e._ins=null,e}();__reflect(ExpEffectManager.prototype,"ExpEffectManager");var LoadingIcon=function(){function e(){this.showCount=0,this.container=new egret.DisplayObjectContainer,this.mAlreadyTickCount=0,this.mOverlay=new egret.Sprite,this.mOverlay.graphics.beginFill(0,.01),this.mOverlay.graphics.drawRect(0,0,Game.stage.stageWidth,Game.stage.stageHeight),this.mOverlay.graphics.endFill(),this.mOverlay.touchEnabled=this.mOverlay.touchChildren=!0,this.mLoadingIcon=new eui.Image,this.mLoadingIcon.source=e.IMG_SOURCE,this.mLoadingIcon.anchorOffsetX=46,this.mLoadingIcon.anchorOffsetY=46,this.mOverlay.addChild(this.mLoadingIcon),this.mLoadingIcon.x=Game.stage.stageWidth>>1,this.mLoadingIcon.y=Game.stage.stageHeight>>1,this.mTimer=new egret.Timer(40,-1),this.mTimer.addEventListener(egret.TimerEvent.TIMER,this.tick,this)}return Object.defineProperty(e,"instance",{get:function(){return null==this.mInstance&&(this.mInstance=new e),this.mInstance},enumerable:!0,configurable:!0}),e.prototype.show=function(){return this.showCount>0?void this.showCount++:(this.showCount++,this.mAlreadyTickCount=0,this.mTimer.start(),this.container.addChild(this.mOverlay),void(this.mLoadingIcon.visible=!1))},e.prototype.hide=function(){this.showCount--,this.showCount>0||(this.mTimer.stop(),this.container.contains(this.mOverlay)&&this.container.removeChild(this.mOverlay))},e.prototype.tick=function(){this.mAlreadyTickCount++,this.mAlreadyTickCount<10||((this.mAlreadyTickCount=10)&&(this.mLoadingIcon.visible=!0),this.mLoadingIcon.rotation+=13)},e.IMG_SOURCE="ring_png",e}();__reflect(LoadingIcon.prototype,"LoadingIcon");var NormalUIBarComponent=function(e){function t(t,i){void 0===i&&(i=null);var n=e.call(this,t,i)||this;return n.mMaxValue=0,n.mValue=0,n}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.mBar=this.getMc("bar"),this.mProgressImg=this.getMc("progressImg"),this.mProgressLabel=this.getMc("progressLabel")},Object.defineProperty(t.prototype,"slideDuration",{set:function(e){this.mBar.slideDuration=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maximum",{set:function(e){this.mBar.maximum=e,this.mMaxValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minimum",{set:function(e){this.mBar.minimum=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{set:function(e){this.mBar.value=e,this.mValue=e,this.updateLabel()},enumerable:!0,configurable:!0}),t.prototype.updateLabel=function(){this.mProgressLabel.text=this.mValue+"/"+this.mMaxValue,this.mProgressLabel.validateSize(),this.mProgressImg.width=this.mProgressLabel.width+30},t.prototype.updateLabelContent=function(e){this.mProgressLabel.text=e,this.mProgressLabel.validateSize(),this.mProgressImg.width=this.mProgressLabel.width+30},t}(BaseSkin);__reflect(NormalUIBarComponent.prototype,"NormalUIBarComponent");var PlayerComponent=function(e){function t(t,i){return void 0===i&&(i=null),e.call(this,t,i)||this}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.nameLabel=this.getMc("nameLabel")},t.prototype.update=function(e){this.argObj=e,this.nameLabel.text=this.argObj.name},t}(BaseSkin);__reflect(PlayerComponent.prototype,"PlayerComponent");var PropItem=function(e){function t(t){var i=e.call(this)||this;return i.itemObj=null,i.itemObj=t,i.skinName="resource/skins/common/PropItemSkin.exml",i.addEventListener(eui.UIEvent.CREATION_COMPLETE,i.onCreated,i),i.addEventListener(egret.Event.REMOVED_FROM_STAGE,i.onRemoved,i),i}return __extends(t,e),t.prototype.onCreated=function(e){var t=GameUtil.getResObj(this.itemObj.type,this.itemObj.staticId);this.iconImg.source=t.iconResName;var i=t.name+"+"+Util.handleUnit2(this.itemObj.count);ResType.OFFICER==this.itemObj.type&&(this.bgImg.source="officer_head_icon_bg_"+t.color,this.bgImg.width=this.bgImg.height=88,this.iconImg.y=5),this.nameLabel.text=i},t.prototype.onRemoved=function(e){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.onCreated,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this)},t}(eui.Component);__reflect(PropItem.prototype,"PropItem");var StarComponent=function(e){function t(t,i){void 0===i&&(i=null);var n=e.call(this,t,i)||this;return n.mStarCount=5,n}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.star_1=this.getMc("star_1"),this.star_2=this.getMc("star_2"),this.star_3=this.getMc("star_3"),this.star_4=this.getMc("star_4"),this.star_5=this.getMc("star_5"),this.mcGroup=this.getMc("mcGroup"),this.argObj&&this.updateStar(this.argObj.star)},Object.defineProperty(t.prototype,"starCount",{set:function(e){this.mStarCount=e,3==this.mStarCount&&(this.star_1.visible=this.star_5.visible=!1)},enumerable:!0,configurable:!0}),t.prototype.updateStar=function(e){var t,i=3==this.mStarCount?2:1;e=e-1+i;for(var n=1;5>=n;n++)t=this["star_"+n],e>=n?t.texture=RES.getRes("star_2"):t.texture=RES.getRes("star_1")},t.prototype.showEffect=function(e){var t=3==this.mStarCount?2+e:1+e;t-=1;var i=this["star_"+t];if(i){var n=new DDMovieClip("stars_effect",1);this.mcGroup.addChild(n),n.x=i.x+i.width/2,n.y=i.y+i.height/2}},t}(BaseSkin);__reflect(StarComponent.prototype,"StarComponent");var UITopComponent=function(e){function t(t,i){return void 0===i&&(i=null),e.call(this,t,i)||this}return __extends(t,e),t.prototype.onAdded=function(){this.headBgImg=this.getMc("headBgImg"),this.expBar=this.getMc("expBar"),this.goldIngotLabel=this.getMc("goldIngotLabel"),this.silverIgnotLabel=this.getMc("silverIgnotLabel"),this.nameLabel=this.getMc("nameLabel"),this.levelLabel=this.getMc("levelLabel"),this.goldAddBtn=UIUtil.getButton("goldAddBtn",this.skin,this.showBuyGold,this),this.silverAddBtn=UIUtil.getButton("silverAddBtn",this.skin,this.showBuySilver,this),EventCenter.ins.add(EventCenter.UPDATE_PLAYER,this.updateView,this),EventCenter.ins.add(EventCenter.UPDATE_PLAYER_EXP,this.updateExp,this),EventCenter.ins.add(EventCenter.LEVEL_UPGRADE,this.updateExp,this),EventCenter.ins.add(EventCenter.KUA_FU_UPDATE,this.updateKuaFu,this),this.headBgImg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHeadClick,this),this.nameLabel.text=PlayerVoManager.ins.playerVo.name,this.updateView(),this.updateExp()},t.prototype.updateKuaFu=function(){},t.prototype.onHeadClick=function(e){GameUIUtil.showGM()},t.prototype.updateExp=function(){var e=PlayerVoManager.ins.playerVo,t=MetaExpManager.ins.getMetaExpByLevel(e.level),i=e.exp;if(e.level==MetaExpManager.ins.maxLevel){MetaExpManager.ins.getMetaExpByLevel(e.level-1);i=Math.min(i,t.exp)}this.expBar.maximum!=t.exp&&(this.expBar.maximum=t.exp),this.expBar.value=i,this.levelLabel.text=e.level+""},t.prototype.showBuyGold=function(){if(ShopUI.isOpened)EventCenter.ins.send(EventCenter.SHOP_GOTO_PART,2);else{if(!VoUtil.checkFunctionOpen(FunctionId.SHOP)){var e=MetaFunctionOpenManager.ins.getOpenForFunctionId(FunctionId.SHOP);return void Alert.ins.showAlert(AlertType.ERROR,"藏宝需要玩家等级达到"+e.openLevel+"级")}GameUIUtil.showShop(2)}},t.prototype.showBuySilver=function(){if(ShopUI.isOpened)EventCenter.ins.send(EventCenter.SHOP_GOTO_PART,3);else{if(!VoUtil.checkFunctionOpen(FunctionId.SHOP)){var e=MetaFunctionOpenManager.ins.getOpenForFunctionId(FunctionId.SHOP);return void Alert.ins.showAlert(AlertType.ERROR,"藏宝需要玩家等级达到"+e.openLevel+"级")}GameUIUtil.showShop(3)}},t.prototype.updateView=function(){var e=PlayerVoManager.ins.playerVo;this.goldIngotLabel.text=Util.handleUnit2(e.gold),this.silverIgnotLabel.text=Util.handleUnit2(e.silver)},t.prototype.dispose=function(){e.prototype.dispose.call(this),EventCenter.ins.remove(EventCenter.UPDATE_PLAYER,this.updateView,this),this.headBgImg.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHeadClick,this),EventCenter.ins.remove(EventCenter.LEVEL_UPGRADE,this.updateExp,this),EventCenter.ins.remove(EventCenter.UPDATE_PLAYER_EXP,this.updateExp,this),EventCenter.ins.remove(EventCenter.KUA_FU_UPDATE,this.updateKuaFu,this),this.silverAddBtn.dispose(),this.silverAddBtn=null,this.goldAddBtn.dispose(),this.goldAddBtn=null},t}(BaseSkin);__reflect(UITopComponent.prototype,"UITopComponent");var log=function(e){Global.isLog&&console.log(e)},Main=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isInitedSDK=!1,t.isThemeLoadEnd=!1,t.isResourceLoadEnd=!1,t.intervalNum=-1,t.intervalCount=0,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this);egret.ImageLoader.crossOrigin="anonymous",EventCenter.ins.add(MyCustomEvent.SDK_INITED,this.onSdkInited,this),egret.lifecycle.addLifecycleListener(function(e){}),egret.lifecycle.onPause=function(){log("isBackground............true"),Global.isBackground=!0,EventCenter.ins.send(EventCenter.GAME_UPDATE_BACKGROUND)},egret.lifecycle.onResume=function(){Global.isBackground=!1,EventCenter.ins.send(EventCenter.GAME_UPDATE_BACKGROUND),log("isBackground............false")},Global.isH5=egret.Capabilities.runtimeType!=egret.RuntimeType.NATIVE,Game.stage=this.stage,this.stage.addEventListener(egret.Event.RESIZE,this.onResizeHandler,this),this.stage.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.dispose,this);var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var i=Global.isH5?window.cdn_path+"resource/default.res.json?v="+window.res_version:"resource/default.res.json";RES.loadConfig(i,window.cdn_path+"resource/")},t.prototype.onResizeHandler=function(){log("onResizeHandler scaleY:"+Global.scaleY+", stageHeight:"+this.stage.stageHeight)},t.prototype.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var t=Global.isH5?window.cdn_path+"resource/default.thm.json?v="+window.thm_version:"resource/default.thm.json",i=new eui.Theme(t,this.stage);i.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},t.prototype.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.createScene()},t.prototype.onResourceLoadComplete=function(e){"preload"==e.groupName&&(this.loadingView.setDes("正在进入游戏..."),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.isResourceLoadEnd=!0,this.createScene())},t.prototype.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.startCreateScene()},t.prototype.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},t.prototype.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},t.prototype.onResourceProgress=function(e){"preload"==e.groupName&&this.loadingView.setProgress(e.itemsLoaded,e.itemsTotal)},t.prototype.startCreateScene=function(){var e=this;if(Global.isH5){var t=egret.getOption("log"),i=0;t&&(i=parseInt(t)),GamePlatform.ins.isLocal()?Global.isLog=!0:Global.isLog=t?1==i:!1}else Global.isLog=!1;e.initGame(),e.initLayer(),DataCount.ins.init(),e.timer=new egret.Timer(1e3),e.timer.addEventListener(egret.TimerEvent.TIMER,e.onTimer,e),e.timer.start(),e.addEventListener(egret.Event.ENTER_FRAME,e.onEnterFrame,e),GamePlatform.ins.isInitSDK&&this.enterGame()},t.prototype.onSdkInited=function(){log("onSdkInited........................."),this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.enterGame()},t.prototype.enterGame=function(){var e=1524838037790,t=new Date(e);log("times1:"+t.toLocaleTimeString()),this.stage.removeChild(this.loadingView),GamePlatform.ins.isDebug?SceneUtil.changeScene(SceneId.LOGIN):GamePlatform.ins.getOpenId(function(){SceneUtil.changeScene(SceneId.SERVER_LIST)})},t.prototype.initGame=function(){Global.scaleY=this.stage.stageHeight/1136,Global.scale=640/1136,ZipRes.initialze(),MetaDataInitHelper.initialize(),Game.eventCenter=EventCenter.ins,this.initSocket(),ZipRes.dispose(),RES.destroyRes("preload"),Game.rootLayer=this},t.prototype.onTimer=function(){TimerManager.ins.run()},t.prototype.onEnterFrame=function(){FrameManager.ins.run()},t.prototype.initLayer=function(){this.addChild(SceneManager.ins.container),this.addChild(GameEffectMananger.ins.sceneEffectContainer),this.addChild(UIManager.ins.container),this.addChild(GameEffectMananger.ins.uiEffectContainer),this.addChild(GameEffectMananger.ins.topBroadcastContainer),Game.chatContainer=new egret.DisplayObjectContainer,this.addChild(Game.chatContainer),this.addChild(Alert.ins.container),this.addChild(Guide.ins.container),Game.loadingContainer=new egret.DisplayObjectContainer,this.addChild(Game.loadingContainer),this.addChild(LoadingIcon.instance.container)},t.prototype.initSocket=function(){var e=new protobuf.Root,t=ZipRes.getProto();protobuf.parse(t,e);var i=new ProtobufHelper(e);Game.net=new GameSocket(i)},t.prototype.dispose=function(e){this.stage.removeEventListener(egret.Event.RESIZE,this.onResizeHandler,this),this.stage.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.dispose,this),UIUtil.dispose(this)},t}(eui.UILayer);__reflect(Main.prototype,"Main");var MapPlayerEntity=function(e){function t(t){var i=e.call(this,t)||this;return i.nowHp=0,i.lastAttackTime=0,i.isSelected=!1,i.nowTargetId=null,i.nowTargetType=null,i.isMoving=!1,i.moveSpeed=null,i.totalFrameCount=0,i.runFrameCount=0,i.nowHp=i.mapEntityVo.hp,i.attackCD=1e3,i}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this)},t.prototype.onClickPlayer=function(){Util.sendEvent(EventCenter.CLICK_MAP_PLAYER_HEAD,this.mapEntityVo)},t.prototype.getCenterPos=function(){return new egret.Point(this.pos.x+this.skin.width/2,this.pos.y+this.skin.height/2)},t.prototype.initVo=function(e){this.mapEntityVo=e,this.nowHp=this.mapEntityVo.hp,this.updateMapEntityVo(this.mapEntityVo)},t.prototype.setTargetId=function(e){if(this.nowTargetId){if(this.nowTargetId==e)return;this.nowTargetId=e}else this.nowTargetId=e},t.prototype.checkAttackCD=function(){return egret.getTimer()-this.lastAttackTime>=this.attackCD?!0:!1},t.prototype.canAttack=function(){var e=this.checkAttackCD();return this.nowHp>0&&e&&null!=this.nowTargetId},t.prototype.subHp=function(e){var t=this.nowHp-e;t=Math.max(0,t),this.nowHp!=t&&(this.nowHp=t,this.updateHp(this.nowHp),!this.isMoving)},t.prototype.updateHp=function(t){this.nowHp=t,e.prototype.updateHp.call(this,t)},t.prototype.attack2Target=function(e){var t=e.subtract(this.getCenterPos());t.normalize(12),this.tl||(this.tl=new TimelineLite),this.tl.clear(),this.tl.to(this,.05,{x:this.pos.x-t.x,y:this.pos.y-t.y}),this.tl.to(this,.05,{x:this.pos.x,y:this.pos.y})},t.prototype.runFrame=function(){return this.runFrameCount>=this.totalFrameCount?(this.x=this.pos.x,this.y=this.pos.y,this.isMoving=!1,void FrameManager.ins.removeFrame(this)):(this.x+=this.moveSpeed.x,this.y+=this.moveSpeed.y,void this.runFrameCount++)},t.prototype.gotoPos=function(e){var t=this;this.isMoving=!0,this.pos=e,TweenMax.killTweensOf(this),TweenMax.to(this,.4,{x:e.x,y:e.y,onComplete:function(){t.isMoving=!1}})},t.prototype.dispose=function(){e.prototype.dispose.call(this),UIUtil.dispose(this),TweenMax.killTweensOf(this),this.tl&&this.tl.clear(!0),delete this.tl},t}(MapPlayerComponent);__reflect(MapPlayerEntity.prototype,"MapPlayerEntity",["IFrame"]);var MapPlayerEquipComponent=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/entity/common/MapPlayerEquipSkin.exml",t}return __extends(t,e),t.prototype.onCreated=function(){e.prototype.onCreated.call(this)},t.prototype.updateEquip=function(e){var t=MetaEquipManager.ins.getEquip(e);this.equipImg.source="equip_small_icon_"+t.part,this.equipBgImg.source="equip_small_bg_"+t.color},t}(BaseComponent);__reflect(MapPlayerEquipComponent.prototype,"MapPlayerEquipComponent");var MyCustomEvent={SDK_INITED:"sdk_inited"},EventCenter=function(){function e(){this._eventDispatcher=new egret.EventDispatcher,window.MyCustomEvent=MyCustomEvent,window.CustomEventDispatcher=this}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.send=function(e,t){void 0===t&&(t=null),this._eventDispatcher.dispatchEventWith(e,!1,t)},e.prototype.add=function(e,t,i){this._eventDispatcher.addEventListener(e,t,i)},e.prototype.remove=function(e,t,i){this._eventDispatcher.removeEventListener(e,t,i)},e.GAME_UPDATE_BACKGROUND="gameUpdateBackground",e.SELECT_SERVER="selectServer",e.UPDATE_PLAYER_EXP="updatePlayerExp",e.LEVEL_UPGRADE="levelUpgrade",e.UPDATE_PLAYER="updatePlayerView",e.UPDATE_PLAYER_RANK="updatePlayerRank",e.UPDATE_OFFICER_PIECE="updateOfficerPiece",e.UPDATE_VO_OFFICER_LEVEL_UP="updateOfficerVoGradeUp",e.SELECT_HERO_ICON="SELECT_HERO_ICON",e.UPDATE_ACTIVITY="UPDATE_ACTIVITY",e.CREATE_ROLE_SHOW_CAMP_SELECT="createRoleShowCampSelect",e.CREATE_ROLE_CAMP_INDEX="createRoleCampIndex",e.CREATE_ROLE_CLOSE_NAME="createRoleCloseName",e.MAP_UNLOCK="mapUnlock",e.GO_AWAY_UPDATE="goAwayUpdate",e.PROP_UPDATE="propUpdate",e.SURE_ENTER_MAP="sureEnterMap",e.RENOWN_COUNT_UPDATE="renownCountUpdate",e.SHOW_MAIN_WORLD_MAP="showMainWorldMap",e.WORLD_MAP_MONSTER_UPDATE="worldMapMonsterUpdate",e.WORLD_MAP_CD_UPDATE="worldMapCDUpdate",e.SHOW_ENTER_MAP_UI="showEnterMapUI",e.ENTER_MAP="enterMap",e.CLICK_MAP_PLAYER_HEAD="clickMapPlayerHead",e.CLICK_PLAYER_HEAD="clickPlayerHead",e.SHOT_MOVE_END="shotMoveEnd",e.BATTLE_PLAYER_DEATH="showBattlePlayerDeath",e.BATTLE_OFFICER_ATTACK="battleOfficerAttack",e.OFFICER_NEW="officerNew",e.CLICK_OFFICER_ITEM="clickOfficerItem",e.CLICK_OFFICER_ITEM_FOR_ITEM_TYPE="clickOfficerItemForItemType",e.UPDATE_OFFICER_LIST="updateOfficerList",e.OFFICER_CHANGE_ITEM="officerChangeItem",e.OFFICER_UI_CLOSE="officerUIClose",e.RECEIVE_BROAD_CAST="receiveBroadcast",e.EQUIP_UI_UPDATE_EQUIPS="equipUIUpdateEquips",e.EQUIP_UPDATE="equipUpdate",e.EQUIP_PART_LEVEL_UP="equipPartLevelUp",e.CHECK_EQUIP_RED="CHECK_EQUIP_RED",e.EQUIP_PROP_ITEM_CLICK="equipPropItemClick",e.BODY_LEVEL_UP="bodyLevelUp",e.BODY_BUY="bodyBuy",e.WARTH_COUNT_UPDATE="warthCountUpdate",e.QIE_CUO_CLICK_ITEM="qieCuoClickItem",e.QIE_CUO_RESULT="qiecuoResult",e.MERIDIAN_LEVEL_UP="meridianLevelUp",e.MERIDIAN_COUNT_UPDATE="meridianCountUpdate",e.HOZA_SHOP_BUY="hozaShopBuy",e.HOZA_UPDATE_STUDY_POINT="hozaUpdateStudyPoint",e.SIX_PROPERTY_UPDATE="sixPropertyUpdate",e.UPDATE_CAMP="updateCamp",e.CHAT_CLICK_SEND_MESSAGE="chatClickSendMessage",e.CHAT_SEND_MESSAGE="chatSendMessage",e.CHAT_UPDATE_NEW_MESSAGE="chatUpdateNewMessage",e.SHOP_GOTO_PART="shopGotoPart",e.SHOP_UPDATE_DRAW="shopUpdateDraw",e.SHOP_UPDATE_DRAW_ITEM="updateShopDrawItem",e.SHOP_UPDATE_DRAW_RESULT="updateShopDrawResult",e.SHOP_SHOW_SILVER_SURE="shopShowSilverSure",e.SHOP_BUY_GOLD="shopBuyGold",e.SHOP_FREE_UPDATE="shopFreeUpdate",e.SHOP_DRAW_ITEM_BTN="shopDrawItemBtn",e.MAIL_UPDATE_LIST="mailUpdateList",e.DAY_BTN_CLICK="dayBtnClick",e.VIP_ITEM_CLICK="vipItemCLick",e.VIP_UPDATE="vipUpdate",e.DAY_CHECK="dayCheck",e.NEWBIE_WELFARE="newbieWelfare",e.OFFICER_ONE_EQUIP="officerOneEquip",e.OFFICER_CLICK_ITEM_SHOW_INFO="officerClickItemShowInfo",e.CHAT_ADD="chatAdd",e.CHAT_NEW_MESSAGE="chatNewMessage",e.CHAT_NAME_CLICK="chatNameClick",e.CHAT_PRIVATE_MESSAGE="chatPrivateMessage",e.CHAT_ADD_PRIVATE_MESSAGE="chatAddPrivateMessage",e.CHAT_CLICK_PRIVATE_ITEM="chatClickPrivateItem",e.CHAT_UPDATE_WORLD_TIMES="chatUpdateWorldTimes",e.BIWU_UPDATE_CHALLENGE_COUNT="biwuUpdateChallengeCount",e.TASK_UPDATE="taskUpdate",e.BIGUAN_UPDATE="biguanUpdate",e.HUFU_SHOP_BUY="hufuShopBuy",e.HUFU_UPDATE="hufuUpdate",e.HUFU_TIMER="hufuTimer",e.UPDATE_FIGHTING_FORCE="updateFightingForce",e.GUIDE_CHECK="guideCheck",e.GOLD_WEAPON_UPDATE="goldWeaponUpdate",e.TIAN_SHU_UPDATE="tianshuUpdate",e.TIAN_SHU_UI_CLOSE="tianshuClose",e.COUNTRY_ITEM_CLICK="countryItemClick",e.KUA_FU_UPDATE="kuaFuUpdate",e.KUA_FU_SURE_OUT="kuaFuSureOut",e.KUA_FU_CITY_CLICK="kuafuCityClick",e.FUNCTION_BTN_OPEN_BTN="functionBtnOpenBtn",e.SHARE_SUCCESS="shareSuccess",e.SHARE_UPDATE="shareUpdate",e.FOLLOW_GET_REWARD="followGetReward",e.CHECK_JIANG_HU_RED="checkWorldRed",e.PLAYER_RANK_UPDATE="playerRankUpdate",e.RECHARGE_REWARD_UPDATE="rechargeRewardUpdate",e.RECHARGE_REWARD_CLICK_ITEM="rechargeRewardClickItem",e.NEWBIE_WELFARE_CLICK="newbie_welfare_click",e.CLISE_GUANG_QUAN="close_guang_quan",e.CANCEL_GOTO_MAP="cancel_goto_map",e.CONFIRM_GOTO_MAP="confirm_goto_map",e.CHECK_RED_POINT="checkRedPoint",e}();__reflect(EventCenter.prototype,"EventCenter");var FunctionBtnGuide=function(e){function t(t){var i=e.call(this)||this;return i.guideObj=t,i.skinName="resource/skins/guide/FunctionBtnGuideSkin.exml",i.addEventListener(eui.UIEvent.CREATION_COMPLETE,i.onCreated,i),i.addEventListener(egret.Event.REMOVED_FROM_STAGE,i.onRemoved,i),i.touchEnabled=!1,i.touchChildren=!1,i}return __extends(t,e),t.prototype.onCreated=function(){this.btn.img.source=GameUtil.getFunctionBtnRes(this.guideObj.functionId),this.btn.x=(Game.stage.stageWidth-this.btn.width)/2,this.btn.y=(Game.stage.stageHeight-this.btn.height)/2,TweenMax.to(this.btn,.4,{delay:1,x:this.guideObj.targetPos.x,y:this.guideObj.targetPos.y,onComplete:this.onComplete.bind(this)})},t.prototype.onComplete=function(e){EventCenter.ins.send(EventCenter.FUNCTION_BTN_OPEN_BTN,this.guideObj.functionId),UIUtil.removeChildFromParent(this)},t.prototype.onRemoved=function(e){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.onCreated,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this),TweenMax.killTweensOf(this.btn)},t}(eui.Component);__reflect(FunctionBtnGuide.prototype,"FunctionBtnGuide");var Guide=function(){function e(){this.isShow=!1,this.nextCallBack=null,this.nextThisObj=null,this._container=new egret.DisplayObjectContainer}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0}),e.prototype.showRect=function(e,t,i){this.show(e.x,e.y,t,i)},e.prototype.show=function(e,t,i,n,o){void 0===o&&(o=0),log("x:"+e+",y:"+t+",w:"+i+",h:"+n),this.clear();var r=.6,s=(Game.stage,new egret.Shape);s.graphics.beginFill(0,r),s.graphics.drawRect(0,0,Game.stage.stageWidth,t),s.graphics.endFill(),this._container.addChild(s),s.touchEnabled=!0;var a=new egret.Shape;a.graphics.beginFill(0,r),a.graphics.drawRect(0,t,e,n),a.graphics.endFill(),this._container.addChild(a),a.touchEnabled=!0;var h=new egret.Shape;h.graphics.beginFill(0,r),h.graphics.drawRect(e+i,t,Game.stage.stageWidth-e-i,n),h.graphics.endFill(),this._container.addChild(h),h.touchEnabled=!0;var p=new egret.Shape;p.graphics.beginFill(0,r),p.graphics.drawRect(0,t+n,Game.stage.stageWidth,Game.stage.stageHeight-t-n),p.graphics.endFill(),this._container.addChild(p),p.touchEnabled=!0,this.selectedImg=new eui.Image("prop_selected"),this._container.addChild(this.selectedImg),this.selectedImg.scale9Grid=new egret.Rectangle(32,32,46,46),this.selectedImg.width=i+12,this.selectedImg.height=n+12,this.selectedImg.anchorOffsetX=this.selectedImg.width/2,this.selectedImg.anchorOffsetY=this.selectedImg.height/2,this.selectedImg.touchEnabled=!1,this._container.setChildIndex(this.selectedImg,this._container.numChildren),this.figureImg=new eui.Image("guide_figure_png"),this._container.addChild(this.figureImg),UIUtil.zoomTween(this.figureImg),this._container.setChildIndex(this.figureImg,this._container.numChildren),this.figureImg.touchEnabled=!1,this.selectedImg.x=e+this.selectedImg.anchorOffsetX-6,this.selectedImg.y=t+this.selectedImg.anchorOffsetY-6,this.figureImg.x=e+i/2,this.figureImg.y=t+n/2,this.figureImg.rotation=0,this.isShow=!0,1==o||2==o||3==o||4==o||5==o?(this.figureImg.rotation=180,this.figureImg.x=e+i/2+10,this.figureImg.y=t+n/2+20):6==o&&(this.figureImg.x=e+i/2-20,this.figureImg.y=t+n/2-20)},e.prototype.showCircle=function(e,t,i){this.clear(),e=Math.floor(e),t=Math.floor(t);var n=Game.stage.stageWidth,o=Game.stage.stageHeight,r=.6,s=new egret.DisplayObjectContainer,a=new egret.Shape;a.graphics.beginFill(0,r),a.graphics.drawRect(0,0,n,o),a.graphics.endFill(),a.touchEnabled=!0;var h=new egret.Shape;h.graphics.beginFill(0,1),h.graphics.drawCircle(e,t,i),h.graphics.endFill(),s.addChild(a),s.addChild(h),h.blendMode=egret.BlendMode.ERASE;var p=new egret.RenderTexture;p.drawToTexture(s);var l=new egret.Bitmap(p);l.touchEnabled=!0,l.pixelHitTest=!0,this._container.addChild(l),this.selectedImg=new eui.Image("prop_selected"),this.selectedImg.scale9Grid=new egret.Rectangle(32,32,46,46),this.selectedImg.width=2*i+28,this.selectedImg.height=this.selectedImg.width,this.selectedImg.anchorOffsetX=this.selectedImg.width/2,this.selectedImg.anchorOffsetY=this.selectedImg.height/2,this._container.addChild(this.selectedImg),this.selectedImg.touchEnabled=!1,this._container.setChildIndex(this.selectedImg,this._container.numChildren),this.selectedImg.x=e+this.selectedImg.anchorOffsetX-14-i,this.selectedImg.y=t+this.selectedImg.anchorOffsetY-14-i,this.isShow=!0},e.prototype.clear=function(){this.isShow=!1,UIUtil.dispose(this._container)},e.prototype.nextStep2=function(e){void 0===e&&(e=1),GuideVoManager.ins.guideVo.nowStep+=e,this.clear(),EventCenter.ins.send(EventCenter.GUIDE_CHECK)},e.prototype.nextStep=function(e,t){void 0===t&&(t=null),this.nextCallBack=e,this.nextThisObj=t,LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.GUIDE_SAVE_STEP,id:GuideVoManager.ins.guideVo.nowStep},this.sureNextStep,this)},e.prototype.sureNextStep=function(e){LoadingIcon.instance.hide(),GuideVoManager.ins.guideVo.nowStep++,log("guide nowStep:"+GuideVoManager.ins.guideVo.nowStep),this.clear(),this.nextCallBack&&this.nextCallBack.call(this.nextThisObj)},e._ins=null,e}();__reflect(Guide.prototype,"Guide");var GuideStep;!function(e){e[e.chengchi=1]="chengchi",e[e.juese=2]="juese",e[e.wujiang=3]="wujiang",e[e.houjing=4]="houjing",e[e.cangbao=5]="cangbao",e[e.tuichu=6]="tuichu"}(GuideStep||(GuideStep={}));var OfficerHeadSmallIconComponent=function(e){function t(t,i){return void 0===i&&(i=null),e.call(this,t,i)||this}return __extends(t,e),t.prototype.onAdded=function(){this.colorImg=this.getMc("colorImg"),this.headImg=this.getMc("headImg"),this.selectedImg=this.getMc("selectedImg"),this.nameImg=this.getMc("nameImg"),this.updateHead(this.argObj),UIUtil.setButton(this.skin,""),this.skin.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},t.prototype.updateHead=function(e){void 0===e&&(e=null),this.argObj=e,this.argObj&&(this.colorImg.source="officer_head_icon_bg_"+this.argObj.color,this.headImg.texture=RES.getRes("officer_head_small_icon_"+this.argObj.head),this.nameImg.texture=RES.getRes("officer_name_"+this.argObj.head))},t.prototype.setSelected=function(e){this.selectedImg.visible=e},t.prototype.onClick=function(e){var t=OfficerVoManager.ins.getOfficerForType(this.argObj.head);OfficerInfoUI.isForLook=!0,GameUIUtil.showOfficerInfoUI(t)},t}(BaseSkin);__reflect(OfficerHeadSmallIconComponent.prototype,"OfficerHeadSmallIconComponent");var KuaFu=function(){function e(){EventCenter.ins.add(EventCenter.KUA_FU_SURE_OUT,this.sureKuaFuOut,this)}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.enterKuaFu=function(e){void 0===e&&(e=!1),e?this.connectKFServer():(LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.KUA_FU_ENTER},this.onKuaFuEnter,this))},e.prototype.onKuaFuEnter=function(e){LoadingIcon.instance.hide(),KuaFuVoManager.ins.setKuaFuServer(e.dataVo),this.connectKFServer()
},e.prototype.connectKFServer=function(e){void 0===e&&(e=!0),Game.net.dispose(),Game.net.setUrl(KuaFuVoManager.ins.kuafuVo.ip,KuaFuVoManager.ins.kuafuVo.port),e?Game.net.startConnnet(this.connectedCallBack,this):Game.net.startConnnet(null,null)},e.prototype.connectedCallBack=function(){var e=GamePlatform.ins.getLoginParams();e.cmd=BookCmd.ENTER_SEREVER,e.server=PlayerVoManager.ins.playerVo.serverId,LoadingIcon.instance.show(),Game.net.sendData(e,this.onEnterKuaFu,this)},e.prototype.onEnterKuaFu=function(e){LoadingIcon.instance.hide(),PlayerVoManager.ins.initFromServer(e.dataVo);var t=PlayerVoManager.ins.playerVo;DataCount.ins.joinGame({plat:GamePlatform.ins.channelName,accountId:t.id,level:t.level,serverId:t.serverId,accountType:0,accountName:t.name}),Game.isKuaFu=!0,Game.hasEnterGame?(EventCenter.ins.send(EventCenter.KUA_FU_UPDATE,!0),LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.ENTER_MAP,map:GameUtil.getTaoYuanId()},this.responseEnterMap,this)):(new MainScenePre).start()},e.prototype.responseEnterMap=function(e){LoadingIcon.instance.hide(),Game.battleType=BattleType.NO,EventCenter.ins.send(EventCenter.SURE_ENTER_MAP),MapEntityVoManager.ins.onEnterMap(e.dataVo),EventCenter.ins.send(EventCenter.ENTER_MAP,GameUtil.getTaoYuanId()),UIManager.ins.closeAll()},e.prototype.outKuaFu=function(){LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.KUA_FU_OUT},this.onKuaFuOut,this)},e.prototype.onKuaFuOut=function(e){LoadingIcon.instance.hide(),Game.net.dispose(),Game.isKuaFu=!1,GameUtil.login(e.dataVo.ip,e.dataVo.port)},e.prototype.sureKuaFuOut=function(e){EventCenter.ins.send(EventCenter.KUA_FU_UPDATE,!0),LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.ENTER_MAP,map:GameUtil.getTaoYuanId()},this.responseEnterMap,this)},e._ins=null,e}();__reflect(KuaFu.prototype,"KuaFu");var Global=function(){function e(){}return e.SOCKET_URL="",e.ZIP_CONFIG_DATA="config_bin",e.PROTO_FILE_NAME="player.proto",e.scaleY=1,e.scale=1,e.os="",e.isH5=!0,e.isLog=!0,e.isBackground=!1,e}();__reflect(Global.prototype,"Global");var ResLoadingBarComponent=function(){function e(e){this.initX=48,this.progressBar=e,this.effectImg=this.progressBar.getChildByName("effectImg"),this.progressBar.value=0}return Object.defineProperty(e.prototype,"minimum",{set:function(e){this.progressBar.minimum=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maximum",{set:function(e){this.progressBar.maximum=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{set:function(e){this.progressBar.value=e,TweenMax.to(this.effectImg,.04,{x:48+530*(e/this.progressBar.maximum)})},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){TweenMax.killTweensOf(this.effectImg)},e}();__reflect(ResLoadingBarComponent.prototype,"ResLoadingBarComponent");var UIResLoading=function(e){function t(){var t=e.call(this)||this;return t.callBack=null,t.thisObj=null,t.isResourceLoadEnd=!1,t.skinName="resource/skins/loading/ui/UIResLoadingSkin.exml",t.addEventListener(egret.Event.REMOVED_FROM_STAGE,t.onRemoved,t),t}return __extends(t,e),t.prototype.onRemoved=function(e){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this),this.loadingBar.dispose()},t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.loadingBar=new ResLoadingBarComponent(this.progressBar)},t.prototype.loadReses=function(e,t,i){if(void 0===i&&(i=null),this.callBack=t,this.thisObj=i,this.groupName=e,RES.isGroupLoaded(e))return void this.createScene();RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this);var n=RES.getGroupByName(e);this.loadingBar.minimum=0,this.loadingBar.maximum=n.length,this.desLabel.text="0/"+n.length,RES.loadGroup(e,0)},t.prototype.onResourceLoadComplete=function(e){log("..........onComplete........"+e.groupName),e.groupName==this.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.isResourceLoadEnd=!0,this.createScene())},t.prototype.createScene=function(){UIUtil.removeChildFromParent(this),this.callBack&&this.callBack.call(this.thisObj)},t.prototype.onItemLoadError=function(e){e.groupName==this.groupName&&console.warn("Url:"+e.resItem.url+" has failed to load")},t.prototype.onResourceLoadError=function(e){e.groupName==this.groupName&&(console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e))},t.prototype.onResourceProgress=function(e){if(e.groupName==this.groupName){var t=e.itemsLoaded/e.itemsTotal*100;this.desLabel.text="Loading... "+t.toFixed(0)+"%",this.loadingBar.value=e.itemsLoaded,log("loading......"+(e.itemsLoaded+"/"+e.itemsTotal))}},t.loadReses=function(e,i,n){void 0===n&&(n=null);var o=new t;Game.loadingContainer.addChild(o),o.loadReses(e,i,n)},t}(eui.Component);__reflect(UIResLoading.prototype,"UIResLoading");var FrameManager=function(){function e(){this.frames=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.run=function(){var e=0;for(this.frames.length;e<this.frames.length;e++)this.frames[e].runFrame()},e.prototype.addFrame=function(e){this.frames.push(e)},e.prototype.removeFrame=function(e){for(var t=0,i=this.frames.length;i>t;t++)if(this.frames[t]==e){this.frames.splice(t,1);break}},e._ins=null,e}();__reflect(FrameManager.prototype,"FrameManager");var GameEffectMananger=function(){function e(){this.uiEffectContainer=new egret.DisplayObjectContainer,this.sceneEffectContainer=new egret.DisplayObjectContainer,this.topBroadcastContainer=new egret.DisplayObjectContainer}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){UIUtil.dispose(this.uiEffectContainer),UIUtil.dispose(this.sceneEffectContainer),UIUtil.dispose(this.topBroadcastContainer)},e._ins=null,e}();__reflect(GameEffectMananger.prototype,"GameEffectMananger");var PingManager=function(){function e(){this.timeIndex=0}return e.getIns=function(){return this._ins||(this._ins=new e),this._ins},e.prototype.init=function(){TimerManager.ins.addTimer(this)},e.prototype.runTimer=function(){this.timeIndex>=10&&(Game.net.ping(),this.timeIndex=0),this.timeIndex++},e.prototype.dispose=function(){TimerManager.ins.removeTimer(this)},e._ins=null,e}();__reflect(PingManager.prototype,"PingManager",["ITimer"]);var SceneManager=function(){function e(){this.nowScene=null,this.container=new eui.UILayer}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.changeScene=function(e){this.nowScene&&UIUtil.removeChildFromParent(this.nowScene),this.nowScene=e,this.container.addChild(this.nowScene)},e._ins=null,e}();__reflect(SceneManager.prototype,"SceneManager");var SoundManager=function(){function e(){this.mIsInBackground=!1}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.pause=function(){this.mIsInBackground=!0,this.bgSound.stop(!1)},e.prototype.resume=function(){this.mIsInBackground=!1,this.playBg()},e.prototype.playBg=function(){this.mIsInBackground||this.bgSound&&this.bgSound.play(!0,0,.4)},e.prototype.stopBg=function(){this.bgSound&&this.bgSound.stop(!1)},e.prototype.playEffect=function(e){if(!this.mIsInBackground){var t=new SoundPlayProxy(e);t.play(!0,1)}},e._ins=null,e}();__reflect(SoundManager.prototype,"SoundManager");var SoundPlayProxy=function(){function e(t,i){void 0===i&&(i=!0),this.mIsInBackground=!1,this.soundName=t,this.resLoadType=e.RES_NOT_LOAD,this.mIsSington=i}return Object.defineProperty(e.prototype,"isDuringPlay",{get:function(){return this.mIsDuringPlay},enumerable:!0,configurable:!0}),e.prototype.play=function(t,i,n){return void 0===i&&(i=0),void 0===n&&(n=1),this.isPlayWhenLoadFinish=t,this.playTime=i,this.volume=n,this.resLoadType!=e.RES_DURING_LOAD?this.resLoadType==e.RES_NOT_LOAD?void this.tryToLoadRes():void this.doPlaySound():void 0},e.prototype.stop=function(e){void 0===e&&(e=!1),null!=this.soundChannel&&(e?TweenMax.to(this.soundChannel,1,{volume:0,onComplete:this.doStopSound,onCompleteScope:this}):this.doStopSound())},e.prototype.doStopSound=function(){null!=this.soundChannel&&(this.mIsDuringPlay=!1,this.soundChannel.stop(),this.soundChannel=null)},e.prototype.tryToLoadRes=function(){this.resLoadType=e.RES_DURING_LOAD,RES.createGroup(this.soundName,[this.soundName]),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup(this.soundName)},e.prototype.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},e.prototype.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load")},e.prototype.onResourceLoadComplete=function(t){t.groupName==this.soundName&&(this.resLoadType=e.RES_LOADED,RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.sound=RES.getRes(this.soundName),this.isPlayWhenLoadFinish&&this.doPlaySound())},e.prototype.doPlaySound=function(){(this.mIsSington||!this.mIsDuringPlay)&&null!=this.sound&&(this.mIsDuringPlay=!0,this.soundChannel=this.sound.play(0,this.playTime),this.soundChannel.volume=this.volume,this.soundChannel.addEventListener(egret.Event.SOUND_COMPLETE,this.onSoundComplete,this))},e.prototype.onSoundComplete=function(e){null!=this.soundChannel&&this.soundChannel.removeEventListener(egret.Event.SOUND_COMPLETE,this.onSoundComplete,this),this.stop()},e.RES_NOT_LOAD=1,e.RES_DURING_LOAD=2,e.RES_LOADED=3,e}();__reflect(SoundPlayProxy.prototype,"SoundPlayProxy");var TimerManager=function(){function e(){this.timers=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.run=function(){for(var e=0,t=this.timers.length;t>e;e++)this.timers[e].runTimer()},e.prototype.addTimer=function(e){for(var t=0,i=this.timers.length;i>t;t++)if(this.timers[t]==e)return;this.timers.push(e)},e.prototype.removeTimer=function(e){for(var t=0,i=this.timers.length;i>t;t++)if(this.timers[t]==e){this.timers.splice(t,1);break}},e._ins=null,e}();__reflect(TimerManager.prototype,"TimerManager");var TweenManager=function(){function e(){this.tweens=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.add=function(e,t){this.tweens.push({target:e,timeLite:t})},e.prototype.getTarget=function(e){for(var t=0,i=this.tweens.length;i>t;t++)if(this.tweens[t].target==e)return this.tweens[t];return null},e.prototype.remove=function(e){for(var t=null,i=0,n=this.tweens.length;n>i;i++)if(t=this.tweens[i],t.target==e){var o=t.timeLite;o.clear(!0),delete this.tweens[i],this.tweens.splice(i,1),TweenMax.killTweensOf(e);break}},e.prototype.dispose=function(){for(var e=null,t=0,i=this.tweens.length;i>t;t++){e=this.tweens[t];var n=e.timelite;n.clear(!0),delete this.tweens[t];break}this.tweens.length=0},e._ins=null,e}();__reflect(TweenManager.prototype,"TweenManager");var UIManager=function(){function e(){this.container=new egret.DisplayObjectContainer,this.uiArr=new Array,this.preArr=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.open=function(e){Guide.ins.isShow||(this.uiArr.push(e),this.container.addChild(e),e.anchorOffsetX=.5*e.skin.width,e.anchorOffsetY=.5*e.skin.height,e.x=Game.stage.stageWidth/2,e.y=Game.stage.stageHeight/2,e.show())},e.prototype.close=function(e){for(var t=0;t<this.uiArr.length;t++)if(this.uiArr[t]==e){this.uiArr.splice(t,1);break}e.close()},e.prototype.closeOther=function(e){for(var t=this.uiArr.length-1;t>=0;t--)e!=this.uiArr[t]&&(this.uiArr[t].close(),this.uiArr.splice(t))},e.prototype.closeAll=function(){for(var e=0;e<this.uiArr.length;e++)this.uiArr[e].close();this.uiArr.length=0},e.prototype.openPre=function(e){this.preArr.push(e)},e.prototype.closePre=function(e){for(var t=0,i=this.preArr.length;i>t;t++)if(this.preArr[t]==e){this.preArr.splice(t,1);break}e=null},e._ins=null,e}();__reflect(UIManager.prototype,"UIManager");var SceneId;!function(e){e[e.LOGIN=0]="LOGIN",e[e.SERVER_LIST=1]="SERVER_LIST"}(SceneId||(SceneId={}));var SceneUtil=function(){function e(){}return e.changeScene=function(e,t){switch(void 0===t&&(t=null),e){case SceneId.LOGIN:(new LoginScenePre).start();break;case SceneId.SERVER_LIST:(new ServerListScenePre).start(t)}},e}();__reflect(SceneUtil.prototype,"SceneUtil");var CreateRoleHeroItem=function(e){function t(t){var i=e.call(this)||this;return i.headIndex=0,i.skinName="resource/skins/scene/createRole/CreateRoleHeroIconItemRender.exml",i.headIndex=t,i.addEventListener(eui.UIEvent.CREATION_COMPLETE,i.onCreated,i),i.addEventListener(egret.Event.REMOVED_FROM_STAGE,i.onRemoved,i),i}return __extends(t,e),t.prototype.onCreated=function(e){this.headImg.source="hero_head_"+this.headIndex+"_png",this.selectBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectedBtn,this)},t.prototype.onSelectedBtn=function(e){Game.eventCenter.send(EventCenter.SELECT_HERO_ICON,this.headIndex)},t.prototype.onRemoved=function(e){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.onCreated,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this),this.selectBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectedBtn,this)},t}(eui.Component);__reflect(CreateRoleHeroItem.prototype,"CreateRoleHeroItem");var CreateRoleScene=function(e){function t(){var t=e.call(this)||this;return t.roleInfo={},t.skinName="CreateRoleSceneSkin",t}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),Game.eventCenter.add(GameSocket.SOCKET_EVENT+BookCmd.ENTER_SEREVER,this.onEnterServer,this),EventCenter.ins.add(EventCenter.CREATE_ROLE_CAMP_INDEX,this.setCamp,this),EventCenter.ins.add(EventCenter.CREATE_ROLE_CLOSE_NAME,this.closeNameCom,this),this.createCampCom=new CreateRoleCampComponent,this.addChild(this.createCampCom)},t.prototype.showCreateNameCom=function(e){void 0===e&&(e=0),this.createNameCom||(this.createNameCom=new CreateRoleNameComponent,this.addChild(this.createNameCom)),this.createNameCom.updateCamp(e),this.createNameCom.show(),this.showCreateCampCom(!1)},t.prototype.closeNameCom=function(e){this.createNameCom&&this.createNameCom.hide(),this.showCreateCampCom(!0)},t.prototype.showCreateCampCom=function(e){e?(TweenMax.killTweensOf(this.createCampCom),TweenMax.to(this.createCampCom,.1,{alpha:1})):(TweenMax.killTweensOf(this.createCampCom),TweenMax.to(this.createCampCom,.1,{alpha:0}))},t.prototype.onEnterServer=function(e){var t=e.data;PlayerVoManager.ins.initFromServer(t),(new MainScenePre).start()},t.prototype.setCamp=function(e){this.roleInfo.camp=e.data,this.showCreateNameCom(this.roleInfo.camp)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.createCampCom&&TweenMax.killTweensOf(this.createCampCom),this.createNameCom&&TweenMax.killTweensOf(this.createNameCom),EventCenter.ins.remove(EventCenter.CREATE_ROLE_CAMP_INDEX,this.setCamp,this),EventCenter.ins.remove(GameSocket.SOCKET_EVENT+BookCmd.ENTER_SEREVER,this.onEnterServer,this),EventCenter.ins.remove(EventCenter.CREATE_ROLE_CLOSE_NAME,this.closeNameCom,this),UIUtil.dispose(this)},t}(BaseScene);__reflect(CreateRoleScene.prototype,"CreateRoleScene");var CreateRoleCampComponent=function(e){function t(){var t=e.call(this)||this;return t.isFirst=!0,t.skinName="resource/skins/scene/createRole/component/CreateRoleCampSkin.exml",t}return __extends(t,e),t.prototype.onCreated=function(){e.prototype.onCreated.call(this),this.camp_1_btn=UIUtil.getButton("camp_1_btn",this,this.handleSelectCamp,this),this.camp_2_btn=UIUtil.getButton("camp_2_btn",this,this.handleSelectCamp,this),this.camp_3_btn=UIUtil.getButton("camp_3_btn",this,this.handleSelectCamp,this),this.randomBtn=UIUtil.getButton("randomBtn",this,this.handleSelectCamp,this,!1),this.setSelectCamp(0)},t.prototype.handleSelectCamp=function(e){var t=e.currentTarget;this.setSelectCamp(parseInt(t.name))},t.prototype.setSelectCamp=function(e){if(this.nowCampBtn);else if(this.isFirst)return void(this.isFirst=!1);EventCenter.ins.send(EventCenter.CREATE_ROLE_CAMP_INDEX,e)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.camp_1_btn.dispose(),this.camp_2_btn.dispose(),this.camp_3_btn.dispose(),this.randomBtn.dispose()},t}(BaseComponent);__reflect(CreateRoleCampComponent.prototype,"CreateRoleCampComponent");var CreateRoleNameComponent=function(e){function t(){var t=e.call(this)||this;return t.nowHeadItem=null,t.camp=0,t.hasClickEnter=!1,t.skinName="resource/skins/scene/createRole/component/CreateRoleNameSkin.exml",t}return __extends(t,e),t.prototype.onCreated=function(){e.prototype.onCreated.call(this),this.randomBtn=UIUtil.getButton("randomBtn",this,this.handleRandomName,this,!1),this.returnBtn=UIUtil.getButton("returnBtn",this,this.onReturn,this,!1),this.enterGameBtn=UIUtil.getButton("enterGameBtn",this,this.onEnterGame,this,!1),this.hasClickEnter=!1,this.setRandomName()},t.prototype.onEnterGame=function(e){if(!this.hasClickEnter){var t=this.nameLabel.text;if(""==t)return void Alert.ins.showAlert(AlertType.ERROR,"玩家昵称不能为空!");var i=MetaPingBiManager.ins.getPingBi(t);if(""!=i)return void Alert.ins.showAlert(AlertType.ERROR,"玩家昵称含有敏感词!");var n=PlayerVoManager.ins.playerVo,o=GamePlatform.ins.getLoginParams();o.cmd=BookCmd.CREATE_ROLE,o.server=n.serverId,o.name=this.nameLabel.text,o.country=this.camp,o.head=0;var r=this;r.hasClickEnter=!0,LoadingIcon.instance.show(),Game.net.sendData(o,this.onCreateNameSuccess,this,this.onCreateNameError)}},t.prototype.onCreateNameSuccess=function(e){if(LoadingIcon.instance.hide(),e.resultCode==GameSocket.RESULT_SUCCES){PlayerVoManager.ins.initFromServer(e.dataVo);var t=(GamePlatform.ins.serverVo,PlayerVoManager.ins.playerVo);GamePlatform.ins.savePlayerData(t),GamePlatform.ins.loginComplete(!0),DataCount.ins.joinGame({plat:GamePlatform.ins.channelName,accountId:t.id,level:t.level,serverId:t.serverId,accountType:0,accountName:t.name}),(new MainScenePre).start()}},t.prototype.onCreateNameError=function(e){this.hasClickEnter=!1},t.prototype.onReturn=function(e){EventCenter.ins.send(EventCenter.CREATE_ROLE_CLOSE_NAME)},t.prototype.updateCamp=function(e){if(this.camp=e,0==e){var t=new Array;t.push({text:'当前选择："随机国家" 会随机分配国家，并奖励'}),t.push({text:MetaConfigManager.ins.getConfig("country_random_reward")+"元宝",style:{textColor:GameUtil.getColor(ColorType.RED)}}),t.push({text:"奖励"}),this.campLabel.textFlow=t}else this.campLabel.text="当前选择："+GameUtil.getCampName(e)+"国";this.setRandomName()},t.prototype.show=function(){TweenMax.killTweensOf(this),this.alpha=0,this.visible=!0,TweenMax.to(this,.1,{alpha:1})},t.prototype.hide=function(){TweenMax.killTweensOf(this),this.visible=!1},t.prototype.handleRandomName=function(e){this.setRandomName()},t.prototype.setRandomName=function(){var e=MetaRandomNameManager.ins.getRandomName();this.nameLabel.text=e.preName+e.name},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.randomBtn.dispose(),this.returnBtn.dispose(),this.enterGameBtn.dispose()},t}(BaseComponent);__reflect(CreateRoleNameComponent.prototype,"CreateRoleNameComponent");var LoginScene=function(e){function t(){var t=e.call(this)||this;return t.skinName="LoginSceneSkin",t}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.regBtn=this.skin.regBtn,this.loginBtn=this.skin.loginBtn,this.accountLabel=this.skin.accountLabel,this.passwordLabel=this.skin.passwordLabel,this.group=this.skin.group,this.ipText=this.skin.ipText,this.portText=this.skin.portText,this.nameText=this.skin.nameText,this.login2Btn=this.skin.login2Btn,this.logoImg=this.skin.logoImg,this.ipText.text="10.100.88.188",this.portText.text="8000",this.logoImg.touchEnabled=!0,this.logoImg.source=GamePlatform.ins.getLogoName()+"_png";this.group.visible=!1,this.accountLabel.text="",this.regBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.handleReg,this),this.loginBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.handleLogin,this),this.login2Btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLogin2,this),this.logoImg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShow,this)},t.prototype.onShow=function(){this.group.visible=!0,this.accountLabel.text="",this.portText.text="8000"},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.regBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.handleReg,this),this.login2Btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onLogin2,this),this.logoImg.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShow,this),this.loginBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.handleLogin,this),UIUtil.dispose(this)},t.prototype.onLogin=function(e){e.data},t.prototype.onReg=function(e){e.data},t.prototype.onLogin2=function(){var e=this.ipText.text,t=parseInt(this.portText.text),i=this.nameText.text;PlayerVoManager.ins.playerVo.openid=i,PlayerVoManager.ins.setServer(1),GamePlatform.ins.setOpenId(i);var n=new ServerListVo;n.ip=e,n.port=t,n.loginTime=1e4,n.serverId=1,n.serverName="测试服务器",n.serverState=1,GamePlatform.ins.setServerData(n),GameUtil.login(e,t)},t.prototype.handleLogin=function(e){var t=this.accountLabel.text,i=(this.passwordLabel.text,new RegExp("^[A-Za-z0-9]+$"));return""==t?(Alert.ins.showAlert(AlertType.ERROR,"账号不能为空!"),void(this.accountLabel.text="")):i.test(t)?(PlayerVoManager.ins.playerVo.openid=t,GamePlatform.ins.setOpenId(t),void SceneUtil.changeScene(SceneId.SERVER_LIST)):(Alert.ins.showAlert(AlertType.ERROR,"账号只能用数字或者字母!"),void(this.accountLabel.text=""))},t.prototype.handleReg=function(e){var t=this.accountLabel.text,i=(this.passwordLabel.text,new RegExp("^[A-Za-z0-9]+$"));return""==t?(Alert.ins.showAlert(AlertType.ERROR,"账号不能为空!"),void(this.accountLabel.text="")):i.test(t)?(PlayerVoManager.ins.playerVo.openid=t,void SceneUtil.changeScene(SceneId.SERVER_LIST)):(Alert.ins.showAlert(AlertType.ERROR,"账号只能用数字或者字母!"),void(this.accountLabel.text=""))},t}(BaseScene);__reflect(LoginScene.prototype,"LoginScene");var LoginScenePre=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.startPre=function(){log("LoginScenePre......startPre"),this.finishPre(new LoginScene)},t}(BaseScenePre);__reflect(LoginScenePre.prototype,"LoginScenePre");var MainScene=function(e){function t(){var t=e.call(this)||this;return t.chatNewType=-1,t.isExpand=!0,t.initBtnGroupY=0,t.gotoMapArr=[],t.gotoMap=null,t.isEnteringWorldMap=!1,t.skinName="MainSceneSkin",t}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),Game.hasEnterGame=!0,this.worldGroup=this.getMc("worldGroup"),this.containerGroup=this.getMc("containerGroup"),this.containerGroup.height*=Global.scaleY;this.getMc("topBoard");this.topCom=new MainTopBoardComponent(this.getMc("topBoard")),this.bottomCom=new MainBottomBoardComponent(this.getMc("bottomBoard")),this.playerInfo=new MainPlayerInfoComponent(this.getMc("playerInfo")),this.mainChatCom=new MainChatComponent(this.getMc("mainChat")),this.playerInfo.init(),this.topBroadcast=new TopBroadcastComponent,GameEffectMananger.ins.topBroadcastContainer.addChild(this.topBroadcast),this.topBroadcast.y=190,this.topBroadcast.x=4,this.shareBtn=UIUtil.getButton("shareBtn",this.skin,this.showShare,this),this.giftBtn=UIUtil.getButton("giftBtn",this.skin,this.showGift,this),this.mailBtn=UIUtil.getButton("mailBtn",this.skin,this.showMail,this),this.followBtn=UIUtil.getButton("followBtn",this.skin,this.follow,this),this.shortCutBtn=UIUtil.getButton("shortCutBtn",this.skin,this.showShortCut,this),this.rechargeTimesBtn=UIUtil.getButton("rechargeTimesBtn",this.skin,this.showRechargeTimes,this),this.rechargeTimesBtn.visible=!1,this.mailRedImg=this.getMc("mailRedImg"),this.mailRedImg.visible=!1,this.giftBtn.visible=GamePlatform.ins.canLiBao,this.shareBtn.visible=GamePlatform.ins.canShare,this.followBtn.visible=GamePlatform.ins.canFollow,this.followBtn.visible&&(this.followBtn.visible=0==ShareVoManager.ins.shareVo.followGetCount),EventCenter.ins.add(EventCenter.SHOW_MAIN_WORLD_MAP,this.onShowWorldMap,this),EventCenter.ins.add(EventCenter.ENTER_MAP,this.onEnterMap,this),EventCenter.ins.add(EventCenter.MAIL_UPDATE_LIST,this.checkMailRed,this),EventCenter.ins.add(EventCenter.LEVEL_UPGRADE,this.onLevelUp,this),EventCenter.ins.add(EventCenter.KUA_FU_UPDATE,this.onKuaFu,this),EventCenter.ins.add(EventCenter.FUNCTION_BTN_OPEN_BTN,this.onFunctionOpen,this),EventCenter.ins.add(EventCenter.SHARE_SUCCESS,this.onShareSuccess,this),EventCenter.ins.add(EventCenter.CANCEL_GOTO_MAP,this.cancelGotoMap,this),EventCenter.ins.add(EventCenter.CONFIRM_GOTO_MAP,this.confirmGotoMap,this),EventCenter.ins.add(EventCenter.CHECK_RED_POINT,this.checkRedPoint,this),EventCenter.ins.add(EventCenter.UPDATE_ACTIVITY,this.updateActivity,this),this.addSocketListeners(),this.enterMap(GameUtil.getTaoYuanId()),this.checkOpen(),this.checkShortCut(),Game.hasLoginOffline&&(GameUIUtil.showOfflineResult(),Game.hasLoginOffline=!1),EventCenter.ins.send(EventCenter.CHECK_JIANG_HU_RED,!1),this.checkRedPoint(),this.checkActivity()},t.prototype.updateActivity=function(){this.checkActivity()},t.prototype.checkActivity=function(){var e=null!=ActivityVoManager.ins.getActivity(Activity.FAN_BEI);e?this.rechargeTimesBtn.visible||(this.rechargeTimesBtn.visible=!0,TweenMax.to(this.rechargeTimesBtn.target,1.2,{scaleX:1.1,scaleY:1.1,yoyo:!0}),TweenMax.to(this.rechargeTimesBtn.target,1.2,{scaleX:.9,scaleY:.9,yoyo:!0})):(this.rechargeTimesBtn.visible=!1,TweenMax.killTweensOf(this.rechargeTimesBtn.target))},t.prototype.checkRedPoint=function(){this.checkMailRed()},t.prototype.checkShortCut=function(){return GamePlatform.ins.hasShortCut()?void(this.shortCutBtn.visible=0==PlayerVoManager.ins.playerVo.wanbaDesk):void(this.shortCutBtn.visible=!1)},t.prototype.addSocketListeners=function(){this.addSocketListener(BookCmd.RESPONSE_EVENT_DATA,this.responseEventData),this.addSocketListener(BookCmd.FIGHT_DROP,this.responseFightDrop),this.addSocketListener(BookCmd.SIX_PROPERTY,this.responseSixPro),this.addSocketListener(BookCmd.CHAT_COMMON,this.onChatCommon),this.addSocketListener(BookCmd.PLAT_RECHARGE_RESULT,this.onPlatRechargeResult),this.addSocketListener(BookCmd.RED_POINT_UPDATE,this.onRedPointUpdate)},t.prototype.onFunctionOpen=function(e){this.checkOpen()},t.prototype.onShareSuccess=function(){var e=GamePlatform.ins.getShareConfig();ShareVoManager.ins.shareVo.shareCount>=e.share.value2||(LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.SHARE_GET_REWARD},this.onGetShareReward,this))},t.prototype.onGetShareReward=function(e){LoadingIcon.instance.hide();var t=e.dataVo,i="分享成功!领取奖励"+t.count+GameUtil.getResName(t.category)+"。";ShareVoManager.ins.addShareCount(),Alert.ins.showAlert(AlertType.NORMAL,i)},t.prototype.onRedPointUpdate=function(e){RedPointManager.ins.fromServer(e.dataVo)},t.prototype.onPlatRechargeResult=function(e){GamePlatform.ins.sureRecharge(e.dataVo)},t.prototype.enterMapFunc=function(e){var t=this;this.gotoMap=new EnterMapPanelUI(e),this.addChild(this.gotoMap),this.gotoMap.x=this.containerGroup.width,this.gotoMap.y=this.containerGroup.height-this.gotoMap.height+this.containerGroup.y-30;TweenMax.to(this.gotoMap,.5,{x:this.containerGroup.width-this.gotoMap.width,onComplete:function(){TweenMax.killTweensOf(t.gotoMap),t.gotoMap.beginTime()}})},t.prototype.cancelGotoMap=function(){var e=this;if(this.gotoMap){TweenMax.to(this.gotoMap,.5,{x:this.containerGroup.width,onComplete:function(){if(e.removeChild(e.gotoMap),e.gotoMap=null,e.gotoMapArr.length>0){var t=e.gotoMapArr.shift();e.enterMapFunc(t)}}})}},t.prototype.confirmGotoMap=function(){this.gotoMapArr=[]},t.prototype.onChatCommon=function(e){var t=e.dataVo;if(t.type!=ChatType.KILLED_PLAYER){var i=ChatVoManager.ins.addChat(t),n=VoUtil.getTotalSixProperty();if(ChatType.SYSTEM==i.type){var o=i.content,r=new Array;r.push({text:o,style:{textColor:16711680}});var s=BroadcastData.create(BroadcastType.SYSTEM,0,"","","",r);EventCenter.ins.send(EventCenter.RECEIVE_BROAD_CAST,s)}else if(i.type==ChatType.HELP_KILL_BOSS){if(t.rank<=5&&t.pid!=PlayerVoManager.ins.playerVo.id){if(Game.mapId==Number(i.content))return;null!=this.gotoMap?this.gotoMapArr.push(i):this.enterMapFunc(i)}}else if(i.type==ChatType.LOGIN){var o=GameUtil.getCampName(i.camp)+"国"+GameUtil.getPlayerJob(i.camp,i.rank).name+i.playerName+"上线了";Alert.ins.showAlert(AlertType.PLAYE_ONLINE,o);var r=new Array,a=GameUtil.getCampName(i.camp)+"国"+GameUtil.getPlayerJob(i.camp,i.rank).name+i.serverId+"-"+i.playerName+"上线了!群雄争霸的时代来了";r.push({text:a});var s=BroadcastData.create(BroadcastType.PLAYER_ONLINE,0,"","","",r);EventCenter.ins.send(EventCenter.RECEIVE_BROAD_CAST,s)}else if(ChatType.KILL_PLAYER==i.type){var r=new Array;if(i.playerId==PlayerVoManager.ins.playerVo.id){r.push({text:"击败了"+i.content}),Alert.ins.showAlert(AlertType.KILL_PLAYER,"",0,"",r);for(var h=0,p=i.bags.length;p>h;h++){var l=i.bags[h],u=l.category,c="";if(r.length=0,r.push({text:"获得对方掉落的"}),u==ResType.OFFICER){var d=MetaOfficerManager.ins.getOfficerForTypeAndLevel(l.staticId);r.push({text:d.name,style:{textColor:GameUtil.getColor(d.quality)}}),r.push({text:"*"+l.count}),Alert.ins.showAlert(AlertType.KILL_PLAYER,"",0,"",r),OfficerVoManager.ins.addOfficerPieceForId(l.staticId,l.count)}else if(u==ResType.EQUIP){var f=MetaEquipManager.ins.getEquip(l.staticId);r.push({text:f.name,style:{textColor:GameUtil.getColor(f.color)}}),r.push({text:"*"+l.count}),Alert.ins.showAlert(AlertType.KILL_PLAYER,"",0,"",r),EquipVoMananger.ins.addEquipPiece(l.staticId,l.count)}else if(u==ResType.PROP){var g=MetaPropMananger.ins.getProp(l.staticId);if(r.push({text:g.name,style:{textColor:GameUtil.getColor(g.color)}}),r.push({text:"*"+l.count}),Alert.ins.showAlert(AlertType.KILL_PLAYER,"",0,"",r),g.type==PropType.TIANSHU){var m=MetaTianShuManager.ins.getTianShuForProp(l.staticId);PlayerVoManager.ins.playerVo.id==i.playerId&&TianShuVoManager.ins.addCount(m.id,l.count)}else PlayerVoManager.ins.playerVo.id==i.playerId&&PropVoManager.ins.operPropCount(l.staticId,l.count,!0)}else r.push({text:Util.handleUnit2(l.count)+GameUtil.getResName(u)}),Alert.ins.showAlert(AlertType.KILL_PLAYER,"",0,"",r)}}var y=new Array;y.push({text:GameUtil.getCampName(i.camp)+"国",style:{textColor:GameUtil.getCampColor(i.camp)}}),y.push({text:GameUtil.getPlayerJob(i.camp,i.rank).name}),y.push({text:i.playerName}),y.push({text:"击败了"+i.content+(i.bags.length>0?",获得了对方掉落的":"。")});for(var h=0,p=i.bags.length;p>h;h++){var l=i.bags[h],u=l.category,c="";if(u==ResType.OFFICER){var d=MetaOfficerManager.ins.getOfficerForTypeAndLevel(l.staticId);y.push({text:d.name,style:{textColor:GameUtil.getColor(d.quality)}}),y.push({text:"*"+l.count})}else if(u==ResType.EQUIP){var f=MetaEquipManager.ins.getEquip(l.staticId);y.push({text:f.name,style:{textColor:GameUtil.getColor(f.color)}}),y.push({text:"*"+l.count})}else if(u==ResType.PROP){var g=MetaPropMananger.ins.getProp(l.staticId);
y.push({text:g.name,style:{textColor:GameUtil.getColor(g.color)}}),y.push({text:"*"+l.count})}else y.push({text:Util.handleUnit2(l.count)}),c=GameUtil.getResName(u),y.push({text:c});p-1>h&&y.push({text:"、"})}var s=BroadcastData.create(BroadcastType.KILL_PLAYER,0,"","","",y);EventCenter.ins.send(EventCenter.RECEIVE_BROAD_CAST,s)}var v=VoUtil.getTotalSixProperty();GameUtil.handleSixProperty2(n,v)}},t.prototype.onEnterMap=function(e){var t=e.data;this.cancelGotoMap(),this.enterMap(t)},t.prototype.enterMap=function(e){if(this.mapComponent){if(Game.mapId==e)return void(this.containerGroup.visible=!0);this.containerGroup.removeChild(this.mapComponent),this.mapComponent=null}log("进入地图:"+e),this.worldGroup.visible=!1,this.mapComponent=new MainMapComponent(e),this.containerGroup.addChild(this.mapComponent),this.mainChatCom.enterMap(e),this.containerGroup.visible=!0,this.mapComponent.x=9,this.mapComponent.y=0,EventCenter.ins.send(EventCenter.CHECK_JIANG_HU_RED,!1),Game.isSelfDie=!1},t.prototype.onShowWorldMap=function(e){if(!this.isEnteringWorldMap)if(this.containerGroup.visible=!1,Game.isKuaFu){if(this.kuaFuMap)return void(this.worldGroup.visible?(this.worldGroup.visible=!1,this.enterMap(Game.mapId)):this.requestWorldMap());this.requestWorldMap()}else{if(this.worldMapComponent)return void(this.worldGroup.visible?(this.worldGroup.visible=!1,this.enterMap(Game.mapId)):this.requestWorldMap());this.requestWorldMap()}},t.prototype.onKuaFu=function(e){this.mapComponent&&this.containerGroup.removeChild(this.mapComponent),this.mapComponent=null,this.containerGroup.visible=!1,this.worldMapComponent&&this.worldGroup.removeChild(this.worldMapComponent),this.worldGroup.visible=!1,this.worldMapComponent=null,this.kuaFuMap&&this.worldGroup.removeChild(this.kuaFuMap),this.kuaFuMap=null,this.worldGroup.visible=!1,e&&e.data&&this.addSocketListeners()},t.prototype.requestWorldMap=function(){this.isEnteringWorldMap||(this.isEnteringWorldMap=!0,Game.net.sendData({cmd:BookCmd.GET_MAP_LIST},this.onRequestWorldMap,this))},t.prototype.onRequestWorldMap=function(e){this.isEnteringWorldMap=!1,MapVoManager.ins.fromServer(e.dataVo.maps),HuFuVoManager.ins.fromServer({count:e.dataVo.hufu}),Game.isKuaFu?(this.kuaFuMap||(this.kuaFuMap=new KuaFuMap,this.worldGroup.addChild(this.kuaFuMap)),this.kuaFuMap.updateCitys(),this.worldGroup.visible=!0):(this.worldMapComponent||(this.worldMapComponent=new MainWorldMapComponents(0),this.worldGroup.addChild(this.worldMapComponent)),this.worldMapComponent.initWorlMap(),this.worldMapComponent.checkGuide(),this.worldGroup.visible=!0),EventCenter.ins.send(EventCenter.CHECK_JIANG_HU_RED,!1)},t.prototype.responseSixPro=function(e){GameUtil.handleSixProperty(e.dataVo,Constants.LEVEL_SIX_PRO)},t.prototype.responseFightDrop=function(e){var t=e.dataVo,i=t.reward;if(1==t.type){if(2==t.tokenState)return void Alert.ins.showAlert(AlertType.ERROR,"虎符不足， 无法获取奖励!");if(1==t.tokenState){var n=MetaMapManager.ins.getMap(t.map);0!=n.consumeHufu&&(Alert.ins.showAlert(AlertType.NORMAL,"扣除"+n.consumeHufu+"虎符"),HuFuVoManager.ins.operHuFu(n.consumeHufu,!1))}}GameUtil.handleBags(i)},t.prototype.responseEventData=function(e){var t=e.dataVo.data,i=this;if(t.gold&&PlayerVoManager.ins.setResForType(ResType.GOLD,parseInt(t.gold)),t.silver&&PlayerVoManager.ins.setResForType(ResType.SILVER,parseInt(t.silver)),t.exp&&PlayerVoManager.ins.updateExp(parseInt(t.exp)),t.lv&&PlayerVoManager.ins.updateLevel(parseInt(t.lv)),t.capacity){var n=parseInt(t.capacity),o=PlayerVoManager.ins.playerVo;if(log("接收到的战力:"+n+",玩家本来战力:"+o.fightingForce),o.fightingForce==n)return;o.fightingForce>n?Alert.ins.showAlert(AlertType.TIP,"减少战力:"+(o.fightingForce-n)):Alert.ins.showAlert(AlertType.TIP,"增加战力:"+(n-o.fightingForce)),PlayerVoManager.ins.updateFightingForce(n)}t.hasOwnProperty("country")&&(Alert.ins.showAlert(AlertType.NORMAL,"已经自动重分阵营，所有玩家都回到桃园!"),PlayerVoManager.ins.setCamp(parseInt(t.country)),i.onKuaFu(null),MainMapUtil.return2Taoyuan())},t.prototype.checkMailRed=function(){var e=VoUtil.checkFunctionOpen(FunctionId.MAIL);this.mailRedImg.visible=e?RedPointManager.ins.check(5):e},t.prototype.showRechargeTimes=function(){GameUIUtil.showShop(2)},t.prototype.showShortCut=function(){var e=new Array;e.push({text:"添加游戏图标到手机桌面即可方便"}),e.push({text:"快速进入",style:{textColor:Constants.COLOR_GREEN}}),e.push({text:"游戏，同时可以获得"});for(var t=MetaConfigManager.ins.getConfig("wb_Collection"),i=t.split("|"),n=new Array,o=0,r=i.length;r>o;o++){var s=i[o],a=s.split(":"),h=new BagVo;h.category=parseInt(a[0]),h.category==ResType.OFFICER||h.category==ResType.PROP?(h.staticId=parseInt(a[1]),h.count=parseInt(a[2])):h.count=parseInt(a[1]),n.push(h)}var p=GameUtil.getBagsDes(n,!1);e=e.concat(p),e.push({text:"奖励!"}),GameUIUtil.showAlertTip(e,this.shortCut,this,null,!0)},t.prototype.shortCut=function(){GamePlatform.ins.setShortCutCallback(this.onShotCut,this),GamePlatform.ins.shortCut()},t.prototype.onShotCut=function(){LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.PLAT_WANBA_GET_SHORT_CUT_REWARD},this.onShortCutGetReward,this)},t.prototype.onShortCutGetReward=function(e){var t=e.dataVo.dtoList;GameUtil.handleBags(t),PlayerVoManager.ins.playerVo.wanbaDesk=1,this.checkShortCut()},t.prototype.follow=function(){return 1==ShareVoManager.ins.shareVo.followGetCount?void Alert.ins.showAlert(AlertType.ERROR,"您已经关注过公众号!"):(GamePlatform.ins.setFollowCallback(this.onFollowSuccess,this),void GamePlatform.ins.follow())},t.prototype.onFollowSuccess=function(){LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.FOLLOW_GET_REWARD},this.onSureFollowReward,this)},t.prototype.onSureFollowReward=function(e){LoadingIcon.instance.hide(),ShareVoManager.ins.shareVo.followGetCount++,GameUtil.handleBags([e.dataVo]),this.followBtn.visible=!1},t.prototype.showShare=function(){GameUIUtil.showShareUI()},t.prototype.showGift=function(){var e=VoUtil.checkFunctionOpen(FunctionId.LI_BAO);if(!e){var t=MetaFunctionOpenManager.ins.getOpenForFunctionId(FunctionId.LI_BAO);return void Alert.ins.showAlert(AlertType.ERROR,"礼包需要玩家达到"+t.openLevel+"级")}GameUIUtil.showGift()},t.prototype.showMail=function(){var e=VoUtil.checkFunctionOpen(FunctionId.MAIL);if(!e){var t=MetaFunctionOpenManager.ins.getOpenForFunctionId(FunctionId.MAIL);return void Alert.ins.showAlert(AlertType.ERROR,"邮件需要玩家达到"+t.openLevel+"级")}GameUIUtil.showMail()},t.prototype.checkOpen=function(){this.giftBtn.filters=VoUtil.checkFunctionOpen(FunctionId.LI_BAO)?null:[GameUtil.getGrayFilter()],this.mailBtn.filters=VoUtil.checkFunctionOpen(FunctionId.MAIL)?null:[GameUtil.getGrayFilter()]},t.prototype.onLevelUp=function(e){if(e.data.levelUp){var t=PlayerVoManager.ins.playerVo;Alert.ins.showAlert(AlertType.TIP,"恭喜您升级到"+t.level+"级!"),this.checkLevel(e.data.lastLevel),GamePlatform.ins.levelUp(t.level)}},t.prototype.checkLevel=function(e){var t=(PlayerVoManager.ins.playerVo,!1),i=!1;for(var n in FunctionId)if(!(n.indexOf("1")>=0)){var o=parseInt(FunctionId[n]);t=VoUtil.checkFunctionOpen(o,e),t||(i=VoUtil.checkFunctionOpen(o),i&&this.showFunctionBtnGuide(o))}},t.prototype.showFunctionBtnGuide=function(e){var t={};t.functionId=e;var i=null;if(!i){if(Game.isKuaFu&&(FunctionId.FU_LI==e||FunctionId.YUE_KA==e||FunctionId.GUO_JIA==e||FunctionId.SHI_LIAN_TA==e))return;i=this.playerInfo.getFunctionBtnPos(e)}if(i||(i=this.bottomCom.getFunctionBtnPos(e)),i||(i=this.getFunctionBtnPos(e)),i||(i=this.topCom.getFunctionBtnPos(e)),i||(i=this.mainChatCom.getFunctionBtnPos(e)),!i){if(e!=FunctionId.LI_XIAN)return;if(!this.mapComponent)return;if(this.mapComponent.metaMap.type!=MapType.MAIN_CITY)return;if(Game.isKuaFu)return;i=this.mapComponent.getFunctionBtnPos(e)}t.targetPos=i;var n=new FunctionBtnGuide(t);this.addChild(n)},t.prototype.getFunctionBtnPos=function(e){var t=this.getFunctionBtn(e);if(!t)return null;var i=UIUtil.local2Global(t.target);return i},t.prototype.getFunctionBtn=function(e){var t=null;switch(e){case FunctionId.MAIL:t=this.mailBtn;break;case FunctionId.LI_BAO:t=this.giftBtn}return t},t.prototype.dispose=function(){e.prototype.dispose.call(this),EventCenter.ins.remove(EventCenter.ENTER_MAP,this.onEnterMap,this),EventCenter.ins.remove(EventCenter.SHOW_MAIN_WORLD_MAP,this.onShowWorldMap,this),EventCenter.ins.remove(EventCenter.MAIL_UPDATE_LIST,this.checkMailRed,this),EventCenter.ins.remove(EventCenter.LEVEL_UPGRADE,this.onLevelUp,this),EventCenter.ins.remove(EventCenter.KUA_FU_UPDATE,this.onKuaFu,this),EventCenter.ins.remove(EventCenter.FUNCTION_BTN_OPEN_BTN,this.onFunctionOpen,this),EventCenter.ins.remove(EventCenter.SHARE_SUCCESS,this.onShareSuccess,this),EventCenter.ins.remove(EventCenter.CANCEL_GOTO_MAP,this.cancelGotoMap,this),EventCenter.ins.remove(EventCenter.CONFIRM_GOTO_MAP,this.confirmGotoMap,this),EventCenter.ins.remove(EventCenter.CHECK_RED_POINT,this.checkRedPoint,this),EventCenter.ins.remove(EventCenter.UPDATE_ACTIVITY,this.updateActivity,this),this.shareBtn.dispose(),this.shareBtn=null,this.giftBtn.dispose(),this.giftBtn=null,this.mailBtn.dispose(),this.mailBtn=null,this.followBtn.dispose(),this.followBtn=null,this.topCom.dispose(),this.topCom=null,this.bottomCom.dispose(),this.bottomCom=null,this.mainChatCom.dispose(),this.mainChatCom=null,this.playerInfo.dispose(),this.playerInfo=null,UIUtil.removeChildFromParent(this.topBroadcast),UIUtil.dispose(this.containerGroup),UIUtil.dispose(this.worldGroup),UIUtil.dispose(this)},t}(BaseScene);__reflect(MainScene.prototype,"MainScene");var MainScenePre=function(e){function t(){var t=e.call(this)||this;t.requests=new Array,t.nowRequestObj=null,t.requests.push({cmd:BookCmd.MAGIC_WEAPON_PANEL}),t.requests.push({cmd:BookCmd.PLAYER_INFO_PANEL}),t.requests.push({cmd:BookCmd.GET_MAP_LIST}),t.requests.push({cmd:BookCmd.GET_OFFICER_LIST}),t.requests.push({cmd:BookCmd.GET_EQUIPE_LIST}),t.requests.push({cmd:BookCmd.ACITVITY_PANEL}),t.requests.push({cmd:BookCmd.HOUJIN_PANEL}),t.requests.push({cmd:BookCmd.SHARE_PANEL}),t.requests.push({cmd:BookCmd.BOOK_PANEL});var i=GameUtil.getTaoYuanId();return t.requests.push({cmd:BookCmd.ENTER_MAP,map:i}),t.requests.push({cmd:BookCmd.FIRST_RECHARGE_PANEL}),t.requests.push({cmd:BookCmd.MONTH_CARD_PANEL}),t.requests.push({cmd:BookCmd.DAY_FIRST_RECHARGE_PANEL}),t.requests.push({cmd:BookCmd.DAY_RECHARGE_PANEL}),t.requests.push({cmd:BookCmd.DAY_PANEL,type:SignType.SIGN}),t.requests.push({cmd:BookCmd.NEWBIE_WELFARE_ORDER}),t.requests.push({cmd:BookCmd.CHECK_RED_POINT}),t}return __extends(t,e),t.prototype.loadDataEnd=function(e){LoadingIcon.instance.hide();var t=(e.resultCode,e.dataVo);if(this.nowRequestObj.cmd==BookCmd.GET_MAP_LIST)MapVoManager.ins.fromServer(t.maps),HuFuVoManager.ins.fromServer({count:t.hufu});else if(BookCmd.GET_OFFICER_LIST==this.nowRequestObj.cmd)OfficerVoManager.ins.initFromServer(t);else if(BookCmd.GET_EQUIPE_LIST==this.nowRequestObj.cmd)EquipVoMananger.ins.fromServer(t.equips),EquipPartVoManager.ins.fromServer(t.pos),PropVoManager.ins.initEquipProps(t.props);else if(BookCmd.GET_MERIDIAN==this.nowRequestObj.cmd)MeridianVoManager.ins.fromServer(t);else if(BookCmd.GET_QIECUO==this.nowRequestObj.cmd)QieCuoVoManager.ins.fromServer(t.qiecuo);else if(BookCmd.HOUJIN_PANEL==this.nowRequestObj.cmd)HozaVoManager.ins.fromServer(t),HozaShopVoManager.ins.fromServer(t.buyTimes),SixProVoManager.ins.fromServer(t.six,Constants.HOZA_SIX_PRO);else if(BookCmd.MAIL_PANEL==this.nowRequestObj.cmd)MailVoManager.ins.fromServer(t.mails);else if(BookCmd.SHOP_PANEL==this.nowRequestObj.cmd)ShopVoManager.ins.fromServer(t);else if(BookCmd.ENTER_MAP==this.nowRequestObj.cmd)MapEntityVoManager.ins.onEnterMap(t);else if(BookCmd.TONG_TIAN_TA_PANEL==this.nowRequestObj.cmd)BiGuanVoManager.ins.fromServer(t);else if(BookCmd.MAGIC_WEAPON_PANEL==this.nowRequestObj.cmd)MagicWeaponVoManager.ins.fromServer(t);else if(BookCmd.RANKE_PANEL==this.nowRequestObj.cmd){RankVoManager.ins.fromServer(t);var i=RankVoManager.ins.getRankVo(PlayerVoManager.ins.playerVo.name);PlayerVoManager.ins.playerVo.rank=i?i.num:0}else BookCmd.MONTH_CARD_PANEL==this.nowRequestObj.cmd?VipVoManager.ins.fromServer(t):BookCmd.PLAYER_INFO_PANEL==this.nowRequestObj.cmd?(PlayerVoManager.ins.initPlayerInfoVo(t),RenownVoManager.ins.fromServer(t),BodyVoMananger.ins.fromServer({body:t.body})):BookCmd.SHARE_PANEL==this.nowRequestObj.cmd?ShareVoManager.ins.fromServer(t):BookCmd.BOOK_PANEL==this.nowRequestObj.cmd?TianShuVoManager.ins.fromServer(t.dtoList):BookCmd.FIRST_RECHARGE_PANEL==this.nowRequestObj.cmd?RechargeRewardVoManager.ins.firstRewardState=t.id:BookCmd.DAY_FIRST_RECHARGE_PANEL==this.nowRequestObj.cmd?RechargeRewardVoManager.ins.dayFirstRewardState=t.id:BookCmd.DAY_RECHARGE_PANEL==this.nowRequestObj.cmd?RechargeRewardVoManager.ins.initDayRechargeReward(t):BookCmd.DAY_PANEL==this.nowRequestObj.cmd?DayVoManager.ins.fromServer(t,SignType.SIGN):BookCmd.NEWBIE_WELFARE_ORDER==this.nowRequestObj.cmd?NewbieWelfareVoManager.ins.fromServer(t):BookCmd.CHECK_RED_POINT==this.nowRequestObj.cmd?RedPointManager.ins.fromServer(t):BookCmd.ACITVITY_PANEL==this.nowRequestObj.cmd&&ActivityVoManager.ins.fromServer(t);this.loadData()},t.prototype.loadData=function(){if(0==this.requests.length){Game.mapId=Game.BIRTH_MAP_ID;var e=this;return void MainResLoading.loadReses("main",function(){e.finishPre(new MainScene)})}this.nowRequestObj=this.requests.shift(),LoadingIcon.instance.show(),Game.net.sendData(this.nowRequestObj,this.loadDataEnd,this)},t.prototype.startPre=function(){this.loadData()},t}(BaseScenePre);__reflect(MainScenePre.prototype,"MainScenePre");var MainHuFuComponent=function(e){function t(t,i){return void 0===i&&(i=null),e.call(this,t,i)||this}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.countLabel=this.getMc("countLabel"),this.addBtn=this.getMc("addBtn"),this.desLabel=this.getMc("addDesLabel"),this.desLabel.text="每"+Game.HUFU_ADD_REALLY_TIME+"秒+1",this.addBtn=UIUtil.getButton("addBtn",this.skin,this.onAdd,this),this.updateCount(),EventCenter.ins.add(EventCenter.HUFU_UPDATE,this.updateCount,this),EventCenter.ins.add(EventCenter.HUFU_TIMER,this.updaHuFuTimer,this)},t.prototype.dispose=function(){e.prototype.dispose.call(this),EventCenter.ins.remove(EventCenter.HUFU_UPDATE,this.updateCount,this),EventCenter.ins.remove(EventCenter.HUFU_TIMER,this.updaHuFuTimer,this),this.addBtn.dispose()},t.prototype.onAdd=function(e){GameUIUtil.showHuFuShop()},t.prototype.updateCount=function(){var e=HuFuVoManager.ins.hufuVo;this.countLabel.text=e.count+"/"+Game.HUFU_MAX_COUNT},t.prototype.updaHuFuTimer=function(){log("每"+Game.HUFU_ADD_REALLY_TIME+"秒+1"),this.desLabel.text="每"+Game.HUFU_ADD_REALLY_TIME+"秒+1"},t}(BaseSkin);__reflect(MainHuFuComponent.prototype,"MainHuFuComponent");var PlayerCircleHeadComponent=function(e){function t(t,i){return void 0===i&&(i=null),e.call(this,t,i)||this}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.headBtn=this.getMc("headBtn"),this.headImg=this.getMc("headImg"),this.updateSkin(this.argObj)},t.prototype.updateSkin=function(e){this.argObj=e,this.argObj&&UIUtil.setImg("hero_head_"+this.argObj.head+"_png",this.headImg,this)},t.prototype.showGrayHead=function(e){if(void 0===e&&(e=!1),e){var t=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],i=new egret.ColorMatrixFilter(t);this.headImg.filters=[i]}else this.headImg.filters=null},t.prototype.showSelected=function(e){if(void 0===e&&(e=!1),e){var t=new egret.GlowFilter(16711680,1,12,12);this.headImg.filters=[t]}else this.headImg.filters=null},t}(BaseSkin);__reflect(PlayerCircleHeadComponent.prototype,"PlayerCircleHeadComponent");var MainBottomBoardComponent=function(e){function t(t,i){void 0===i&&(i=null);var n=e.call(this,t,i)||this;return n.isJiangHuRed=!0,n}return __extends(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this.jianghuBtn.dispose(),this.jueseBtn.dispose(),this.wujiangBtn.dispose(),this.cangBaoBtn.dispose(),EventCenter.ins.remove(EventCenter.OFFICER_NEW,this.onNewOfficer,this),EventCenter.ins.remove(EventCenter.RENOWN_COUNT_UPDATE,this.checkJuese,this),EventCenter.ins.remove(EventCenter.BODY_LEVEL_UP,this.checkJuese,this),EventCenter.ins.remove(EventCenter.UPDATE_OFFICER_PIECE,this.checkJuese,this),EventCenter.ins.remove(EventCenter.CHECK_RED_POINT,this.checkRedPoint,this),EventCenter.ins.remove(EventCenter.UPDATE_OFFICER_PIECE,this.checkWuJiang,this),EventCenter.ins.remove(EventCenter.HOZA_UPDATE_STUDY_POINT,this.checkHouJin,this),EventCenter.ins.remove(EventCenter.LEVEL_UPGRADE,this.checkHouJin,this),EventCenter.ins.remove(EventCenter.SHOP_FREE_UPDATE,this.checkCangbao,this),EventCenter.ins.remove(EventCenter.GUIDE_CHECK,this.checkGuide,this),EventCenter.ins.remove(EventCenter.FUNCTION_BTN_OPEN_BTN,this.onFunctionOpen,this),EventCenter.ins.remove(EventCenter.CHECK_JIANG_HU_RED,this.checkWorldRed,this)},t.prototype.onAdded=function(){this.jianghuBtn=UIUtil.getButton("jianghuBtn",this.skin,this.onShowJiangHu,this),this.jueseBtn=UIUtil.getButton("jueseBtn",this.skin,this.showPlayerInfo,this),this.wujiangBtn=UIUtil.getButton("wujiangBtn",this.skin,this.showOfficer,this),this.houjinBtn=UIUtil.getButton("houjinBtn",this.skin,this.showHouJin,this),this.cangBaoBtn=UIUtil.getButton("cangBaoBtn",this.skin,this.showShop,this),this.jueseRedImg=this.getMc("jueseRedImg"),this.wujiangRedImg=this.getMc("wujiangRedImg"),this.houjinRedImg=this.getMc("houjinRedImg"),this.cangBaoRedImg=this.getMc("cangBaoRedImg"),this.worldRedImg=this.getMc("worldRedImg"),this.cangBaoRedImg.visible=!1,this.worldFigureImg=new eui.Image("guide_figure_png"),this.skin.addChild(this.worldFigureImg),this.worldFigureImg.x=this.jianghuBtn.x+20,this.worldFigureImg.y=this.jianghuBtn.y+20,this.worldFigureImg.rotation=180,UIUtil.zoomTween(this.worldFigureImg),this.worldFigureImg.touchEnabled=!1,EventCenter.ins.add(EventCenter.UPDATE_OFFICER_PIECE,this.checkWuJiang,this),EventCenter.ins.add(EventCenter.OFFICER_NEW,this.onNewOfficer,this),EventCenter.ins.add(EventCenter.UPDATE_OFFICER_PIECE,this.checkJuese,this),EventCenter.ins.add(EventCenter.RENOWN_COUNT_UPDATE,this.checkJuese,this),EventCenter.ins.add(EventCenter.BODY_LEVEL_UP,this.checkJuese,this),EventCenter.ins.add(EventCenter.HOZA_UPDATE_STUDY_POINT,this.checkHouJin,this),EventCenter.ins.add(EventCenter.LEVEL_UPGRADE,this.checkHouJin,this),EventCenter.ins.add(EventCenter.SHOP_FREE_UPDATE,this.checkCangbao,this),EventCenter.ins.add(EventCenter.GUIDE_CHECK,this.checkGuide,this),EventCenter.ins.add(EventCenter.FUNCTION_BTN_OPEN_BTN,this.onFunctionOpen,this),EventCenter.ins.add(EventCenter.CHECK_JIANG_HU_RED,this.checkWorldRed,this),EventCenter.ins.add(EventCenter.CHECK_RED_POINT,this.checkRedPoint,this),this.checkGuide(),this.checkOpen(),this.checkWorldRed(new egret.Event("",!1,!1,!1)),this.jueseRedImg.visible=!1,this.wujiangRedImg.visible=!1,this.houjinRedImg.visible=!1,this.cangBaoRedImg.visible=!1,this.checkRedPoint()},t.prototype.checkRedPoint=function(){this.checkJuese(),this.checkWuJiang(),this.checkHouJin(),this.checkCangbao()},t.prototype.checkOpen=function(){var e=VoUtil.checkFunctionOpen(FunctionId.HOU_JIN);this.houjinBtn.filters=e?null:[GameUtil.getGrayFilter()],this.jianghuBtn.filters=VoUtil.checkFunctionOpen(FunctionId.JIANGHU)?null:[GameUtil.getGrayFilter()],this.wujiangBtn.filters=VoUtil.checkFunctionOpen(FunctionId.WUJIANG)?null:[GameUtil.getGrayFilter()],this.jueseBtn.filters=VoUtil.checkFunctionOpen(FunctionId.JUESE)?null:[GameUtil.getGrayFilter()],this.cangBaoBtn.filters=VoUtil.checkFunctionOpen(FunctionId.SHOP)?null:[GameUtil.getGrayFilter()],this.checkJuese(),this.checkWuJiang(),this.checkHouJin(),this.checkCangbao()},t.prototype.checkWorldRed=function(e){var t=e.data;this.isJiangHuRed!=t&&(this.isJiangHuRed=t,TweenMax.killTweensOf(this.worldRedImg),this.worldRedImg.visible=t,t&&TweenMax.to(this.worldRedImg,.2,{alpha:0,repeatDelay:.8,ease:Linear.easeNone,yoyo:!0,repeat:-1}),this.worldFigureImg.visible=t)},t.prototype.onFunctionOpen=function(e){var t=e.data,i=this.getFunctionBtn(t);i&&(this.checkOpen(),t==FunctionId.SHOP&&(GuideVoManager.ins.guideVo.nowStep=GuideStepNum.SHOP,this.checkGuide()))},t.prototype.getFunctionBtn=function(e){var t=null;switch(e){case FunctionId.JIANGHU:t=this.jianghuBtn;break;case FunctionId.WUJIANG:t=this.wujiangBtn;break;case FunctionId.HOU_JIN:t=this.houjinBtn;break;case FunctionId.JUESE:t=this.jueseBtn;break;case FunctionId.SHOP:t=this.cangBaoBtn}return t},t.prototype.getFunctionBtnPos=function(e){var t=this.getFunctionBtn(e);if(!t)return null;var i=UIUtil.local2Global(t.target);return i},t.prototype.checkGuide=function(){var e=GuideVoManager.ins.guideVo;if(this.checkWorldRed(new egret.Event("",!1,!1,!1)),1==e.nowStep||5==e.nowStep||9==e.nowStep||16==e.nowStep){var t=UIUtil.local2Global(this.jianghuBtn.target);Guide.ins.show(t.x,t.y,this.jianghuBtn.width,this.jianghuBtn.height,GuideStep.chengchi)}else if(13==e.nowStep){GameUtil.closeAllUI();var t=UIUtil.local2Global(this.wujiangBtn.target);Guide.ins.show(t.x,t.y,this.wujiangBtn.width,this.wujiangBtn.height,GuideStep.wujiang)}else if(e.nowStep==GuideStepNum.SHOP){GameUtil.closeAllUI();var t=UIUtil.local2Global(this.cangBaoBtn.target);Guide.ins.show(t.x+8,t.y,this.cangBaoBtn.width,this.cangBaoBtn.height,GuideStep.cangbao)}else if(GuideVoManager.ins.isShopStep(6)){GameUtil.closeAllUI();var t=UIUtil.local2Global(this.wujiangBtn.target);Guide.ins.show(t.x,t.y,this.wujiangBtn.width,this.wujiangBtn.height,GuideStep.wujiang)}else if(GuideVoManager.ins.isShopStep(10)){GameUtil.closeAllUI();var t=UIUtil.local2Global(this.jianghuBtn.target);Guide.ins.show(t.x,t.y,this.jianghuBtn.width,this.jianghuBtn.height,GuideStep.chengchi)}else if(GuideVoManager.ins.isJueseStep(0)){GameUtil.closeAllUI();var t=UIUtil.local2Global(this.jueseBtn.target);Guide.ins.show(t.x,t.y,this.jueseBtn.width,this.jueseBtn.height,GuideStep.juese)}else if(GuideVoManager.ins.isHouJinStep(0)){GameUtil.closeAllUI();var t=UIUtil.local2Global(this.houjinBtn.target);Guide.ins.show(t.x,t.y,this.houjinBtn.width,this.houjinBtn.height,GuideStep.houjing)}},t.prototype.onNewOfficer=function(){this.checkWuJiang()},t.prototype.checkJuese=function(){return VoUtil.checkFunctionOpen(FunctionId.JUESE)?void(this.jueseRedImg.visible=RedPointManager.ins.check(1)):void(this.jueseRedImg.visible=!1)},t.prototype.checkWuJiang=function(){return VoUtil.checkFunctionOpen(FunctionId.WUJIANG)?void(this.wujiangRedImg.visible=RedPointManager.ins.check(2)):void(this.wujiangRedImg.visible=!1)},t.prototype.checkHouJin=function(){if(!VoUtil.checkFunctionOpen(FunctionId.HOU_JIN))return void(this.houjinRedImg.visible=!1);if(this.houjinRedImg.visible=RedPointManager.ins.check(3),this.houjinRedImg.visible&&1==HozaVoManager.ins.hozaVo.level){if(Guide.ins.isShow)return;GuideVoManager.ins.setStep(GuideStepNum.HOU_JIN)}},t.prototype.checkCangbao=function(){return VoUtil.checkFunctionOpen(FunctionId.SHOP)?void(this.cangBaoRedImg.visible=RedPointManager.ins.check(4)):void(this.cangBaoRedImg.visible=!1)},t.prototype.showPlayerInfo=function(){if(!VoUtil.checkFunctionOpen(FunctionId.JUESE)){var e=MetaFunctionOpenManager.ins.getOpenForFunctionId(FunctionId.JUESE);return void Alert.ins.showAlert(AlertType.ERROR,"角色需要玩家等级达到"+e.openLevel+"级")}GuideVoManager.ins.isJueseStep(0)&&Guide.ins.nextStep2(),GameUIUtil.showPlayerInfo()},t.prototype.showShop=function(){if(!VoUtil.checkFunctionOpen(FunctionId.SHOP)){var e=MetaFunctionOpenManager.ins.getOpenForFunctionId(FunctionId.SHOP);return void Alert.ins.showAlert(AlertType.ERROR,"藏宝需要玩家等级达到"+e.openLevel+"级")}GuideVoManager.ins.guideVo.nowStep==GuideStepNum.SHOP&&(GuideVoManager.ins.guideVo.nowStep++,Guide.ins.clear()),GameUIUtil.showShop(1)},t.prototype.showGM=function(){GameUIUtil.showBiGuan()},t.prototype.showHouJin=function(){if(!VoUtil.checkFunctionOpen(FunctionId.HOU_JIN)){var e=MetaFunctionOpenManager.ins.getOpenForFunctionId(FunctionId.HOU_JIN);return void Alert.ins.showAlert(AlertType.ERROR,"厚劲需要玩家等级达到"+e.openLevel+"级")}GuideVoManager.ins.isHouJinStep(0)&&Guide.ins.nextStep2(),GameUIUtil.showHoza()},t.prototype.onShowJiangHu=function(e){if(1==GuideVoManager.ins.guideVo.nowStep||5==GuideVoManager.ins.guideVo.nowStep||9==GuideVoManager.ins.guideVo.nowStep||16==GuideVoManager.ins.guideVo.nowStep){var t=this;Guide.ins.nextStep(function(){Util.sendEvent(EventCenter.SHOW_MAIN_WORLD_MAP,null)},t)}else GuideVoManager.ins.isShopStep(10)?(Guide.ins.nextStep2(),Util.sendEvent(EventCenter.SHOW_MAIN_WORLD_MAP,null)):Util.sendEvent(EventCenter.SHOW_MAIN_WORLD_MAP,null)},t.prototype.showOfficer=function(){if(!VoUtil.checkFunctionOpen(FunctionId.WUJIANG)){var e=MetaFunctionOpenManager.ins.getOpenForFunctionId(FunctionId.WUJIANG);return void Alert.ins.showAlert(AlertType.ERROR,"武将需要玩家等级达到"+e.openLevel+"级")}if(13==GuideVoManager.ins.guideVo.nowStep){var t=this;Guide.ins.nextStep(function(){GameUIUtil.showOfficerUI()},t)}else GuideVoManager.ins.isShopStep(6)?(Guide.ins.nextStep2(),GameUIUtil.showOfficerUI()):GameUIUtil.showOfficerUI()},t}(BaseSkin);__reflect(MainBottomBoardComponent.prototype,"MainBottomBoardComponent");var MainPlayerInfoComponent=function(e){function t(t,i){void 0===i&&(i=null);var n=e.call(this,t,i)||this;return n.btns1X=0,n.btns2X=0,n.hasClick=!1,n}return __extends(t,e),t.prototype.onAdded=function(){this.officer1Skin=new OfficerHeadSmallIconComponent(this.getMc("officer_head_1")),this.officer2Skin=new OfficerHeadSmallIconComponent(this.getMc("officer_head_2")),this.officer3Skin=new OfficerHeadSmallIconComponent(this.getMc("officer_head_3")),this.officer4Skin=new OfficerHeadSmallIconComponent(this.getMc("officer_head_4")),this.officer5Skin=new OfficerHeadSmallIconComponent(this.getMc("officer_head_5")),this.officer6Skin=new OfficerHeadSmallIconComponent(this.getMc("officer_head_6")),this.btns_1_group=this.getMc("btns_1_group"),this.btns_2_group=this.getMc("btns_2_group"),this.btns_1_btns_group=this.getMc("btns_1_btns_group"),this.btns_2_btns_group=this.getMc("btns_2_btns_group"),this.dayFirstRechargeBtn=UIUtil.getButton("dayFirstRechargeBtn",this.skin,this.showDayFirstRecharge,this),this.newbieWelfareBtn=UIUtil.getButton("newbieWelfareBtn",this.skin,this.showNewbieWelfare,this),this.lixianBtn=UIUtil.getButton("lixianBtn",this.skin,this.showDayRecharge,this),this.firstRechargeBtn=UIUtil.getButton("firstRechargeBtn",this.skin,this.showFirstRecharge,this),this.yueKaBtn=UIUtil.getButton("yuekaBtn",this.skin,this.showVip,this),this.guojiaBtn=UIUtil.getButton("shiliBtn",this.skin,this.showShili,this),this.zhuangbeiBtn=UIUtil.getButton("zhuangbeiBtn",this.skin,this.showZhuangbei,this),this.biguanBtn=UIUtil.getButton("biguanBtn",this.skin,this.showBiGuan,this),this.zhanfuBtn=UIUtil.getButton("zhanfuBtn",this.skin,this.showKuaFu,this),this.shenbingBtn=UIUtil.getButton("shenbingBtn",this.skin,this.showShenBing,this),this.jingmaiBtn=UIUtil.getButton("jingmaiBtn",this.skin,this.showJingMai,this),this.qiecuoBtn=UIUtil.getButton("genguBtn",this.skin,this.showQieCuo,this),this.tianshuBtn=UIUtil.getButton("tianshuBtn",this.skin,this.showTianShu,this),this.biguanRedImg=this.getMc("biguanRedImg"),this.jingmaiRedImg=this.getMc("jingmaiRedImg"),this.shenbingRedImg=this.getMc("shenbingRedImg"),this.equipRedImg=this.getMc("equipRedImg"),this.tianshuRedImg=this.getMc("tianshuRedImg"),this.jingmaiRedImg.visible=!1,this.biguanRedImg.visible=!1,this.shenbingRedImg.visible=!1,this.equipRedImg.visible=!1,this.tianshuRedImg.visible=!1,EventCenter.ins.add(EventCenter.UPDATE_OFFICER_LIST,this.updateOfficers,this),EventCenter.ins.add(EventCenter.KUA_FU_UPDATE,this.updateKuaFu,this),EventCenter.ins.add(EventCenter.NEWBIE_WELFARE,this.checkNewbieWelfare,this),EventCenter.ins.add(EventCenter.GUIDE_CHECK,this.checkGuide,this),EventCenter.ins.add(EventCenter.CLISE_GUANG_QUAN,this.closeEffect,this),EventCenter.ins.add(EventCenter.BATTLE_OFFICER_ATTACK,this.officerAttack,this),EventCenter.ins.add(EventCenter.FUNCTION_BTN_OPEN_BTN,this.onFunctionOpen,this),EventCenter.ins.add(EventCenter.RECHARGE_REWARD_UPDATE,this.onRechargeUpdate,this),EventCenter.ins.add(EventCenter.CHECK_RED_POINT,this.checkRedPoint,this),this.lixianBtn.visible=Game.isKuaFu,this.checkOpen(),this.onRechargeUpdate(),this.checkRedPoint(),this.checkGuide()},t.prototype.checkRedPoint=function(){this.checkDayFirstRecharge(),this.checkFirstRecharge(),this.checkNewbieWelfare(),this.checkVip(),this.checkBiguanRed(),this.checkEquipRed(),this.checkJingmaiRed(),this.checkShenbingRed(),this.checkTianShuRed()},t.prototype.onRechargeUpdate=function(e){void 0===e&&(e=null),this.checkDayFirstRecharge(),this.checkFirstRecharge(),this.dayFirstRechargeBtn.visible||this.firstRechargeBtn.visible?this.dayFirstRechargeBtn.visible?this.firstRechargeBtn.visible||(this.btns_2_btns_group.x=0):this.btns_1_btns_group.x=0:(this.btns_1_btns_group.x=0,this.btns_2_btns_group.x=0,this.btns_1_group.x=this.btns_2_group.x=72)},t.prototype.onFunctionOpen=function(e){var t=e.data,i=this.getFunctionBtn(t);if(i&&(this.checkOpen(),t==FunctionId.SHI_LIAN_TA)){if(Guide.ins.isShow)return;GuideVoManager.ins.setStep(GuideStepNum.BI_GUAN)}},t.prototype.getFunctionBtn=function(e){var t=null;switch(e){case FunctionId.YUE_KA:t=this.yueKaBtn;break;case FunctionId.GUO_JIA:t=this.guojiaBtn;break;case FunctionId.SHI_LIAN_TA:t=this.biguanBtn;break;case FunctionId.EQUIP:t=this.zhuangbeiBtn;break;case FunctionId.JING_MAI:t=this.jingmaiBtn;break;case FunctionId.SHEN_BING:t=this.shenbingBtn;break;case FunctionId.TIAN_SHU:t=this.tianshuBtn;break;case FunctionId.QIE_CUO:t=this.qiecuoBtn;break;case FunctionId.FU_LI:t=this.newbieWelfareBtn;break;case FunctionId.KUA_FU:t=this.zhanfuBtn;break;case FunctionId.LI_XIAN:t=this.lixianBtn}return t},t.prototype.getFunctionBtnPos=function(e){var t=this.getFunctionBtn(e);if(!t)return null;var i=UIUtil.local2Global(t.target);return i},t.prototype.checkGuide=function(){GuideVoManager.ins.guideVo;if(GuideVoManager.ins.isBiGuanStep(0)){GameUtil.closeAllUI();var e=UIUtil.local2Global(this.biguanBtn.target);Guide.ins.show(e.x,e.y,this.biguanBtn.target.width,this.biguanBtn.target.height)}else if(GuideVoManager.ins.isShenBingStep(0)){GameUtil.closeAllUI();var e=UIUtil.local2Global(this.shenbingBtn.target);Guide.ins.show(e.x,e.y,this.shenbingBtn.target.width,this.shenbingBtn.target.height)}else if(GuideVoManager.ins.isTianShuStep(0)){GameUtil.closeAllUI();var e=UIUtil.local2Global(this.tianshuBtn.target);Guide.ins.show(e.x,e.y,this.tianshuBtn.target.width,this.tianshuBtn.target.height)}else if(GuideVoManager.ins.isBaoWuStep(0)){GameUtil.closeAllUI();var e=UIUtil.local2Global(this.zhuangbeiBtn.target);Guide.ins.show(e.x,e.y,this.zhuangbeiBtn.target.width,this.zhuangbeiBtn.target.height)}else if(GuideVoManager.ins.isJingMaiStep(0)){GameUtil.closeAllUI();var e=UIUtil.local2Global(this.jingmaiBtn.target);Guide.ins.show(e.x,e.y,this.jingmaiBtn.target.width,this.jingmaiBtn.target.height)}},t.prototype.updateKuaFu=function(){this.checkOpen()},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.firstRechargeBtn.dispose(),this.firstRechargeBtn=null,this.dayFirstRechargeBtn.dispose(),this.dayFirstRechargeBtn=null,this.lixianBtn.dispose(),this.lixianBtn=null,this.zhanfuBtn.dispose(),this.zhanfuBtn=null,this.zhuangbeiBtn.dispose(),this.zhuangbeiBtn=null,this.biguanBtn.dispose(),this.biguanBtn=null,this.jingmaiBtn.dispose(),this.jingmaiBtn=null,this.qiecuoBtn.dispose(),this.qiecuoBtn=null,this.yueKaBtn.dispose(),this.yueKaBtn=null,this.guojiaBtn.dispose(),this.guojiaBtn=null,this.officer1Skin.dispose(),this.officer1Skin=null,this.officer2Skin.dispose(),this.officer2Skin=null,this.officer3Skin.dispose(),this.officer3Skin=null,this.officer4Skin.dispose(),this.officer4Skin=null,this.officer5Skin.dispose(),this.officer5Skin=null,this.officer6Skin.dispose(),this.officer6Skin=null,EventCenter.ins.remove(EventCenter.KUA_FU_UPDATE,this.updateKuaFu,this),EventCenter.ins.remove(EventCenter.UPDATE_OFFICER_LIST,this.updateOfficers,this),EventCenter.ins.remove(EventCenter.BATTLE_OFFICER_ATTACK,this.officerAttack,this),EventCenter.ins.remove(EventCenter.NEWBIE_WELFARE,this.checkNewbieWelfare,this),EventCenter.ins.remove(EventCenter.GUIDE_CHECK,this.checkGuide,this),EventCenter.ins.remove(EventCenter.FUNCTION_BTN_OPEN_BTN,this.onFunctionOpen,this),EventCenter.ins.remove(EventCenter.RECHARGE_REWARD_UPDATE,this.onRechargeUpdate,this),EventCenter.ins.remove(EventCenter.CLISE_GUANG_QUAN,this.closeEffect,this),EventCenter.ins.remove(EventCenter.CHECK_RED_POINT,this.checkRedPoint,this)
},t.prototype.checkOpen=function(){this.newbieWelfareBtn.filters=VoUtil.checkFunctionOpen(FunctionId.FU_LI)?null:[GameUtil.getGrayFilter()],this.zhuangbeiBtn.filters=VoUtil.checkFunctionOpen(FunctionId.EQUIP)?null:[GameUtil.getGrayFilter()],this.lixianBtn.filters=VoUtil.checkFunctionOpen(FunctionId.LI_XIAN)?null:[GameUtil.getGrayFilter()],this.biguanBtn.filters=VoUtil.checkFunctionOpen(FunctionId.SHI_LIAN_TA)?null:[GameUtil.getGrayFilter()],this.shenbingBtn.filters=VoUtil.checkFunctionOpen(FunctionId.SHEN_BING)?null:[GameUtil.getGrayFilter()],this.jingmaiBtn.filters=VoUtil.checkFunctionOpen(FunctionId.JING_MAI)?null:[GameUtil.getGrayFilter()],this.zhanfuBtn.filters=VoUtil.checkFunctionOpen(FunctionId.BI_WU)?null:[GameUtil.getGrayFilter()],this.qiecuoBtn.filters=VoUtil.checkFunctionOpen(FunctionId.QIE_CUO)?null:[GameUtil.getGrayFilter()],this.yueKaBtn.filters=VoUtil.checkFunctionOpen(FunctionId.YUE_KA)?null:[GameUtil.getGrayFilter()],this.guojiaBtn.filters=VoUtil.checkFunctionOpen(FunctionId.GUO_JIA)?null:[GameUtil.getGrayFilter()],this.tianshuBtn.filters=VoUtil.checkFunctionOpen(FunctionId.TIAN_SHU)?null:[GameUtil.getGrayFilter()],this.newbieWelfareBtn.visible=!Game.isKuaFu,this.yueKaBtn.visible=!Game.isKuaFu,this.guojiaBtn.visible=!Game.isKuaFu,this.biguanBtn.visible=!Game.isKuaFu,this.lixianBtn.visible=!Game.isKuaFu,this.checkRedPoint()},t.prototype.checkFirstRecharge=function(){var e=VoUtil.checkFirstRecharge();if(this.firstRechargeBtn.visible=e,e&&FirstRechargeUI.guangQuan){if(this.firstRechargeEffect)return;this.firstRechargeEffect=new DDMovieClip("liuguang",-1),this.firstRechargeBtn.target.parent.addChild(this.firstRechargeEffect),this.firstRechargeEffect.scaleX=this.firstRechargeEffect.scaleY=1.3,this.firstRechargeEffect.x=this.firstRechargeBtn.target.x,this.firstRechargeEffect.y=this.firstRechargeBtn.target.y,this.firstRechargeBtn.visible=!0}else this.firstRechargeEffect&&(UIUtil.removeChildFromParent(this.firstRechargeEffect),this.firstRechargeEffect=null)},t.prototype.checkDayFirstRecharge=function(){var e=VoUtil.checkDayFirstRecharge();if(this.dayFirstRechargeBtn.visible=e,e&&DayFirstRechargeUI.guangQuan){if(this.dayFirstRechargeEffect)return;this.dayFirstRechargeEffect=new DDMovieClip("liuguang",-1),this.dayFirstRechargeBtn.target.parent.addChild(this.dayFirstRechargeEffect),this.dayFirstRechargeEffect.scaleX=this.dayFirstRechargeEffect.scaleY=1.3,this.dayFirstRechargeEffect.x=this.dayFirstRechargeBtn.target.x,this.dayFirstRechargeEffect.y=this.dayFirstRechargeBtn.target.y,this.dayFirstRechargeBtn.visible=!0}else this.dayFirstRechargeEffect&&(UIUtil.removeChildFromParent(this.dayFirstRechargeEffect),this.dayFirstRechargeEffect=null)},t.prototype.checkNewbieWelfare=function(){var e=!0;if(VoUtil.checkFunctionOpen(FunctionId.FU_LI)||(e=!1),e&&(e=RedPointManager.ins.check(6)),e&&this.newbieWelfareBtn.visible){if(this.newbieWelfareEffect)return;this.newbieWelfareEffect=new DDMovieClip("liuguang_huang",-1),this.newbieWelfareBtn.target.parent.addChild(this.newbieWelfareEffect),this.newbieWelfareEffect.scaleX=this.newbieWelfareEffect.scaleY=1.3,this.newbieWelfareEffect.x=this.newbieWelfareBtn.target.x,this.newbieWelfareEffect.y=this.newbieWelfareBtn.target.y}else UIUtil.removeChildFromParent(this.newbieWelfareEffect),this.newbieWelfareEffect=null},t.prototype.checkVip=function(){var e=VoUtil.checkVip();if(e=e?!Game.isKuaFu:e,e&&VipUI.guangQuan){if(this.vipEffect)return;this.vipEffect=new DDMovieClip("liuguang",-1),this.yueKaBtn.target.parent.addChild(this.vipEffect),this.vipEffect.scaleX=this.vipEffect.scaleY=1.3,this.vipEffect.x=this.yueKaBtn.target.x,this.vipEffect.y=this.yueKaBtn.target.y}else this.vipEffect&&(UIUtil.removeChildFromParent(this.vipEffect),this.vipEffect=null)},t.prototype.closeEffect=function(){VipUI.guangQuan||(UIUtil.removeChildFromParent(this.vipEffect),this.vipEffect=null),DayFirstRechargeUI.guangQuan||(UIUtil.removeChildFromParent(this.dayFirstRechargeEffect),this.dayFirstRechargeEffect=null),DayRechargeUI.guangQuan||(UIUtil.removeChildFromParent(this.dayRechargeEffect),this.dayRechargeEffect=null),FirstRechargeUI.guangQuan||(UIUtil.removeChildFromParent(this.firstRechargeEffect),this.firstRechargeEffect=null)},t.prototype.checkTianShuRed=function(){if(!VoUtil.checkFunctionOpen(FunctionId.TIAN_SHU))return void(this.tianshuRedImg.visible=!1);var e=RedPointManager.ins.check(12);if(this.tianshuRedImg.visible=e,e&&TianShuVoManager.ins.isFirst()){if(Guide.ins.isShow)return;GuideVoManager.ins.setStep(GuideStepNum.TIAN_SHU)}},t.prototype.checkEquipRed=function(){var e=VoUtil.checkEquipRed();if(this.equipRedImg.visible=e,e){var t=EquipVoMananger.ins.getEquipsForFirst();if(t.length>0){if(Guide.ins.isShow)return;GuideVoManager.ins.setStep(GuideStepNum.BAO_WU)}}},t.prototype.checkShenbingRed=function(){if(!VoUtil.checkFunctionOpen(FunctionId.SHEN_BING))return void(this.shenbingRedImg.visible=!1);var e=RedPointManager.ins.check(13);if(this.shenbingRedImg.visible=e,e&&1==MagicWeaponVoManager.ins.magicWeaponVo.id){if(Guide.ins.isShow)return;GuideVoManager.ins.setStep(GuideStepNum.SHEN_BING)}},t.prototype.checkBiguanRed=function(){return VoUtil.checkFunctionOpen(FunctionId.SHI_LIAN_TA)?void(this.biguanRedImg.visible=!Game.isKuaFu&&RedPointManager.ins.check(10)):void(this.biguanRedImg.visible=!1)},t.prototype.checkJingmaiRed=function(){if(!VoUtil.checkFunctionOpen(FunctionId.JING_MAI))return void(this.jingmaiRedImg.visible=!1);var e=RedPointManager.ins.check(11);if(this.jingmaiRedImg.visible=e,e&&1==MeridianVoManager.ins.meridianVo.id){if(Guide.ins.isShow)return;GuideVoManager.ins.setStep(GuideStepNum.JING_MAI)}},t.prototype.init=function(){this.updateOfficers()},t.prototype.updateOfficers=function(){for(var e,t=OfficerVoManager.ins.getEquipedOrNoEquiped(!0),i=t.length,n=1;6>=n;n++)if(e=this["officer"+n+"Skin"],n>i)e.setVisible(!1);else{var o=t[n-1];e.setVisible(!0),e.updateHead({color:o.metaOfficer.quality,head:o.metaOfficer.type})}},t.prototype.officerAttack=function(e){},t.prototype.restoreOfficerHeads=function(){for(var e,t=1;6>=t;t++)e=this["officer"+t+"Skin"],e.setSelected(!1)},t.prototype.showFirstRecharge=function(){GameUIUtil.showFirstRecharge()},t.prototype.showDayFirstRecharge=function(){GameUIUtil.showDayFirstRecharge()},t.prototype.showNewbieWelfare=function(){GameUIUtil.showNewbieWelfare()},t.prototype.showDayRecharge=function(){if(!VoUtil.checkFunctionOpen(FunctionId.LI_XIAN)){var e=MetaFunctionOpenManager.ins.getOpenForFunctionId(FunctionId.LI_XIAN);return void Alert.ins.showAlert(AlertType.ERROR,"离线需要玩家等级"+e.openLevel+"级")}GameUIUtil.showOffline()},t.prototype.showVip=function(){if(!VoUtil.checkFunctionOpen(FunctionId.YUE_KA)){var e=MetaFunctionOpenManager.ins.getOpenForFunctionId(FunctionId.YUE_KA);return void Alert.ins.showAlert(AlertType.ERROR,"月卡需要玩家等级达到"+e.openLevel+"级")}GameUIUtil.showVip()},t.prototype.showShili=function(){if(!VoUtil.checkFunctionOpen(FunctionId.GUO_JIA)){var e=MetaFunctionOpenManager.ins.getOpenForFunctionId(FunctionId.GUO_JIA);return void Alert.ins.showAlert(AlertType.ERROR,"国家需要玩家等级达到"+e.openLevel+"级")}GameUIUtil.showCountryUI()},t.prototype.showQiling=function(){},t.prototype.showZhuangbei=function(){if(!VoUtil.checkFunctionOpen(FunctionId.EQUIP)){var e=MetaFunctionOpenManager.ins.getOpenForFunctionId(FunctionId.EQUIP);return void Alert.ins.showAlert(AlertType.ERROR,"宝物需要玩家等级达到"+e.openLevel+"级")}GuideVoManager.ins.isBaoWuStep(0)&&Guide.ins.nextStep2(),GameUIUtil.showEquip()},t.prototype.showBiGuan=function(){if(!VoUtil.checkFunctionOpen(FunctionId.SHI_LIAN_TA)){var e=MetaFunctionOpenManager.ins.getOpenForFunctionId(FunctionId.SHI_LIAN_TA);return void Alert.ins.showAlert(AlertType.ERROR,"闭关需要玩家等级达到"+e.openLevel+"级")}GuideVoManager.ins.isBiGuanStep(0)&&Guide.ins.nextStep2(),GameUIUtil.showBiGuan()},t.prototype.showJingMai=function(){if(this.hasClick=!0,!VoUtil.checkFunctionOpen(FunctionId.JING_MAI)){var e=MetaFunctionOpenManager.ins.getOpenForFunctionId(FunctionId.JING_MAI);return void Alert.ins.showAlert(AlertType.ERROR,"经脉需要玩家等级达到"+e.openLevel+"级")}GuideVoManager.ins.isJingMaiStep(0)&&Guide.ins.nextStep2(),GameUIUtil.showMeridian()},t.prototype.showShenBing=function(){if(this.hasClick=!0,!VoUtil.checkFunctionOpen(FunctionId.SHEN_BING)){var e=MetaFunctionOpenManager.ins.getOpenForFunctionId(FunctionId.SHEN_BING);return void Alert.ins.showAlert(AlertType.ERROR,"神兵需要玩家等级达到"+e.openLevel+"级")}GuideVoManager.ins.isShenBingStep(0)&&Guide.ins.nextStep2(),GameUIUtil.showMagicWeaponUI()},t.prototype.showTianShu=function(){if(this.hasClick=!0,!VoUtil.checkFunctionOpen(FunctionId.TIAN_SHU)){var e=MetaFunctionOpenManager.ins.getOpenForFunctionId(FunctionId.TIAN_SHU);return void Alert.ins.showAlert(AlertType.ERROR,"天书需要玩家等级达到"+e.openLevel+"级")}GuideVoManager.ins.isTianShuStep(0)&&Guide.ins.nextStep2(),GameUIUtil.showTianShu()},t.prototype.showQieCuo=function(){if(this.hasClick=!0,!VoUtil.checkFunctionOpen(FunctionId.QIE_CUO)){var e=MetaFunctionOpenManager.ins.getOpenForFunctionId(FunctionId.QIE_CUO);return void Alert.ins.showAlert(AlertType.ERROR,"根骨需要玩家等级达到"+e.openLevel+"级")}GameUIUtil.showQieCuo()},t.prototype.showBiWu=function(){if(!VoUtil.checkFunctionOpen(FunctionId.BI_WU)){var e=MetaFunctionOpenManager.ins.getOpenForFunctionId(FunctionId.BI_WU);return void Alert.ins.showAlert(AlertType.ERROR,"比武需要玩家等级达到"+e.openLevel+"级")}GameUIUtil.showKuaFu()},t.prototype.showKuaFu=function(){if(!VoUtil.checkFunctionOpen(FunctionId.KUA_FU)){var e=MetaFunctionOpenManager.ins.getOpenForFunctionId(FunctionId.KUA_FU);return void Alert.ins.showAlert(AlertType.ERROR,"战服需要玩家等级达到"+e.openLevel+"级")}GameUIUtil.showKuaFu()},t}(BaseSkin);__reflect(MainPlayerInfoComponent.prototype,"MainPlayerInfoComponent");var MainTopBoardComponent=function(e){function t(t,i){return void 0===i&&(i=null),e.call(this,t,i)||this}return __extends(t,e),t.prototype.onAdded=function(){var e=PlayerVoManager.ins.playerVo;this.topCom=new UITopComponent(this.getMc("topCom")),this.campIconImg=UIUtil.getImage(GameUtil.getCampIcon(e.camp),"campIconImg",this.skin),this.fightingLabel=this.skin.fightingLabel,this.rankLabel=this.skin.rankLabel,this.rankBtn=UIUtil.getButton("rankBtn",this.skin,this.showRank,this),this.rankNameImg=this.skin.rankNameImg,this.updateView(),EventCenter.ins.add(EventCenter.UPDATE_PLAYER,this.updateView,this),EventCenter.ins.add(EventCenter.UPDATE_FIGHTING_FORCE,this.updateFightingForce,this),EventCenter.ins.add(EventCenter.UPDATE_CAMP,this.updateCamp,this),EventCenter.ins.add(EventCenter.KUA_FU_UPDATE,this.updateKuaFu,this),EventCenter.ins.add(EventCenter.FUNCTION_BTN_OPEN_BTN,this.onFunctionOpen,this),EventCenter.ins.add(EventCenter.UPDATE_PLAYER_RANK,this.updateView,this),EventCenter.ins.add(EventCenter.PLAYER_RANK_UPDATE,this.updateRank,this),EventCenter.ins.add(EventCenter.KUA_FU_UPDATE,this.updateCamp,this),this.checkOpen(),this.updateKuaFu()},t.prototype.onFunctionOpen=function(e){var t=e.data,i=this.getFunctionBtn(t);i&&this.checkOpen()},t.prototype.updateKuaFu=function(){this.rankBtn.visible=!Game.isKuaFu,this.rankLabel.visible=!Game.isKuaFu,this.rankNameImg.visible=!Game.isKuaFu},t.prototype.dispose=function(){e.prototype.dispose.call(this),EventCenter.ins.remove(EventCenter.UPDATE_PLAYER,this.updateView,this),EventCenter.ins.remove(EventCenter.UPDATE_PLAYER_RANK,this.updateView,this),EventCenter.ins.remove(EventCenter.UPDATE_FIGHTING_FORCE,this.updateFightingForce,this),EventCenter.ins.remove(EventCenter.UPDATE_CAMP,this.updateCamp,this),EventCenter.ins.remove(EventCenter.KUA_FU_UPDATE,this.updateKuaFu,this),EventCenter.ins.remove(EventCenter.FUNCTION_BTN_OPEN_BTN,this.onFunctionOpen,this),EventCenter.ins.remove(EventCenter.PLAYER_RANK_UPDATE,this.updateRank,this),EventCenter.ins.remove(EventCenter.KUA_FU_UPDATE,this.updateCamp,this),this.rankBtn.dispose(),this.rankBtn=null},t.prototype.getFunctionBtn=function(e){var t=null;switch(e){case FunctionId.RANK:t=this.rankBtn}return t},t.prototype.getFunctionBtnPos=function(e){var t=this.getFunctionBtn(e);if(!t)return null;var i=UIUtil.local2Global(t.target);return i},t.prototype.updateCamp=function(){this.campIconImg.texture=GameUtil.getCampIcon(PlayerVoManager.ins.playerVo.camp)},t.prototype.checkOpen=function(){this.rankBtn.filters=VoUtil.checkFunctionOpen(FunctionId.RANK)?null:[GameUtil.getGrayFilter()]},t.prototype.updateFightingForce=function(){this.fightingLabel.text=PlayerVoManager.ins.playerVo.fightingForce-Game.FIGHTING_FORCE_INIT+""},t.prototype.updateView=function(){this.updateFightingForce(),this.updateRank()},t.prototype.updateRank=function(){var e=PlayerVoManager.ins.playerVo;this.rankLabel.text=e.rank+""},t.prototype.showRank=function(){if(!VoUtil.checkFunctionOpen(FunctionId.RANK)){var e=MetaFunctionOpenManager.ins.getOpenForFunctionId(FunctionId.RANK);return void Alert.ins.showAlert(AlertType.ERROR,"排行榜需要玩家等级达到"+e.openLevel+"级")}GameUIUtil.showRank()},t.prototype.showBuyGold=function(){ShopUI.isOpened?EventCenter.ins.send(EventCenter.SHOP_GOTO_PART,2):GameUIUtil.showShop(2)},t.prototype.showBuySilver=function(){ShopUI.isOpened?EventCenter.ins.send(EventCenter.SHOP_GOTO_PART,3):GameUIUtil.showShop(3)},t}(BaseSkin);__reflect(MainTopBoardComponent.prototype,"MainTopBoardComponent");var MainChatListItemRender=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/scene/main/chat/MainChatListItemSkin.exml",t}return __extends(t,e),t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this);var i=this.data,n=GameUtil.getChatContent(this.data);i.type<=ChatType.PRIVATE?n.unshift({text:i.playerName+"："}):ChatType.HELP_KILL_BOSS==i.type||ChatType.KILL_PLAYER==i.type?n.unshift({text:t.isCamp?"国家消息：":"世界消息："}):(ChatType.LOGIN==i.type||ChatType.HELP_KILL_BOSS==i.type)&&n.unshift({text:"国家消息："}),this.label.textFlow=n},t.isCamp=!1,t}(eui.ItemRenderer);__reflect(MainChatListItemRender.prototype,"MainChatListItemRender");var TopBroadcastComponent=function(e){function t(){var t=e.call(this)||this;return t.messages=new Array,t.showMessages=new Array,t.initX=0,t.skinName="resource/skins/scene/main/broadcast/TopBroadcastSkin.exml",t}return __extends(t,e),t.prototype.onCreated=function(){e.prototype.onCreated.call(this),this.visible=!1,this.maskShape=new egret.Shape,this.maskShape.graphics.beginFill(0,1),this.maskShape.graphics.drawRect(0,0,this.container.width,this.container.height),this.maskShape.graphics.endFill(),this.container.addChild(this.maskShape),this.container.mask=this.maskShape,this.initX=this.container.width,EventCenter.ins.add(EventCenter.RECEIVE_BROAD_CAST,this.addBroadcast,this),FrameManager.ins.addFrame(this)},t.prototype.addBroadcast=function(e){this.messages.push(e.data),this.visible=!0,this.showMsg()},t.prototype.showMsg=function(){if(!(this.showMessages.length>=3)){if(0==this.messages.length)return void(0==this.showMessages.length&&(this.visible=!1));var e=this.messages.shift(),t=new egret.TextField;t.size=20,t.fontFamily="微软雅黑",t.textFlow=this.getTextFlow(e),t.y=.5*(this.container.height-t.height)-2,this.container.addChild(t);var i=this.showMessages.length;if(0==i)t.x=this.initX;else{var n=this.showMessages[i-1];n.x+n.width<this.initX-80?t.x=this.initX:t.x=n.x+n.width+80}this.showMessages.push(t)}},t.prototype.runFrame=function(){if(0!=this.showMessages.length){for(var e,t=this.showMessages.length,i=0;t>i;i++)e=this.showMessages[i],e.x-=3;t>0&&(e=this.showMessages[0],e.x+e.width<0&&(this.container.removeChild(e),this.showMessages.shift(),this.showMsg()))}},t.prototype.getTextFlow=function(e){var t=new Array;if(e.type==BroadcastType.OFFICER_LEVEL_UP){t.push({text:"恭喜玩家:",style:{textColor:16777215}}),t.push({text:"【"+e.camp+"】"+e.playerName,style:{textColor:65280}}),t.push({text:"升级",style:{textColor:16777215}});var i=MetaOfficerManager.ins.getOfficer(e.value);t.push({text:i.name,style:{textColor:GameUtil.getColor(i.quality)}}),t.push({text:"到了",style:{textColor:16777215}}),t.push({text:i.level+"",style:{textColor:16711680}}),t.push({text:"级",style:{textColor:16777215}})}else t=e.contentArr;return t},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.maskShape.graphics.clear(),UIUtil.dispose(this.container),EventCenter.ins.remove(EventCenter.RECEIVE_BROAD_CAST,this.addBroadcast,this),FrameManager.ins.removeFrame(this),this.maskShape.graphics.clear(),this.messages.length=0},t}(BaseComponent);__reflect(TopBroadcastComponent.prototype,"TopBroadcastComponent",["IFrame"]);var BroadcastData=function(){function e(){}return e.create=function(t,i,n,o,r,s){void 0===n&&(n=""),void 0===o&&(o=""),void 0===r&&(r=""),void 0===s&&(s=null);var a=new e;return a.type=t,a.value=i,a.playerName=n,a.camp=o,a.content=r,a.contentArr=s,a},e}();__reflect(BroadcastData.prototype,"BroadcastData");var MainChatComponent=function(e){function t(t,i){void 0===i&&(i=null);var n=e.call(this,t,i)||this;return n.campBtnType=ChatType.CAMP,n.helpMapId=0,n.chatVo=null,n}return __extends(t,e),t.prototype.onAdded=function(){this.chatRedImg=this.getMc("chatRedImg"),this.chatNewLabel=this.getMc("chatNewLabel"),this.worldBtn=UIUtil.getButton("worldBtn",this.skin,this.onCampBtn,this),this.campBtn=UIUtil.getButton("campBtn",this.skin,this.onCampBtn,this),this.chatBtn=UIUtil.getButton("chatBtn",this.skin,this.onChatBtn,this),EventCenter.ins.add(EventCenter.CHAT_UPDATE_NEW_MESSAGE,this.checkChatRed,this),EventCenter.ins.add(EventCenter.CHAT_ADD,this.onChatAdd,this),this.chatRedImg.visible=!1,this.checkChatRed(),this.campBtnType=ChatType.CAMP,this.updateChat(),this.chatNewLabel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),this.checkOpen(),EventCenter.ins.add(EventCenter.FUNCTION_BTN_OPEN_BTN,this.onFunctionOpen,this)},t.prototype.getFunctionBtn=function(e){var t=null;switch(e){case FunctionId.CHAT:t=this.chatBtn}return t},t.prototype.getFunctionBtnPos=function(e){var t=this.getFunctionBtn(e);if(!t)return null;var i=UIUtil.local2Global(t.target);return i},t.prototype.onFunctionOpen=function(e){var t=e.data,i=this.getFunctionBtn(t);i&&this.checkOpen()},t.prototype.checkOpen=function(){return VoUtil.checkFunctionOpen(FunctionId.CHAT)?void(this.chatBtn.filters=null):(this.chatBtn.filters=[GameUtil.getGrayFilter()],void(this.chatRedImg.visible=!1))},t.prototype.onTouch=function(e){if(this.chatVo){var t=this.chatVo;if(t.playerId!=PlayerVoManager.ins.playerVo.id&&ChatType.HELP_KILL_BOSS!=this.chatVo.type)if(t.type==ChatType.HELP_KILL_BOSS){var i=parseInt(t.content),n=MetaMapManager.ins.getMap(i),o=MapVoManager.ins.getMap(i);if(!o)return void Alert.ins.showAlert(AlertType.ERROR,"您还没开启地图"+n.name);if(Game.mapId==i)return void Alert.ins.showAlert(AlertType.NORMAL,"您已经在地图"+n.name+"中!");this.gotoHelpAttack(t)}else(ChatType.CAMP==t.type||ChatType.WORLD==t.type)&&EventCenter.ins.send(EventCenter.CHAT_NAME_CLICK,t)}},t.prototype.gotoHelpAttack=function(e){LoadingIcon.instance.show(),this.helpMapId=parseInt(e.content),Game.net.sendData({cmd:BookCmd.COMMON_MAP_RESULT,map:this.helpMapId},this.onGotoHelpAttack,this)},t.prototype.onGotoHelpAttack=function(e){LoadingIcon.instance.hide();var t=e.dataVo,i=MetaMapManager.ins.getMap(this.helpMapId),n=0;for(var o in t.cds)n++;var r=i.monsterIds.length>n;r?GameUIUtil.showEnterMap(this.helpMapId):Alert.ins.showAlert(AlertType.ERROR,"地图BOSS已经死亡！")},t.prototype.enterMap=function(e){},t.prototype.checkChatRed=function(){if(!VoUtil.checkFunctionOpen(FunctionId.CHAT))return void(this.chatRedImg.visible=!1);for(var e=ChatVoManager.ins.newMessages,t=!1,i=0,n=e.length;n>i;i++)if(e[i]>0){t=!0;break}this.chatRedImg.visible=t},t.prototype.onChatBtn=function(){if(!VoUtil.checkFunctionOpen(FunctionId.CHAT)){var e=MetaFunctionOpenManager.ins.getOpenForFunctionId(FunctionId.CHAT);return void Alert.ins.showAlert(AlertType.ERROR,"聊天需要玩家等级"+e.openLevel+"级")}GameUIUtil.showChat()},t.prototype.onCampBtn=function(){this.campBtnType==ChatType.CAMP?(this.campBtnType=ChatType.WORLD,this.campBtn.btnImg.texture=RES.getRes("main_chat_world_btn"),this.worldBtn.btnImg.texture=RES.getRes("main_chat_camp_btn")):(this.campBtnType=ChatType.CAMP,this.campBtn.btnImg.texture=RES.getRes("main_chat_camp_btn"),this.worldBtn.btnImg.texture=RES.getRes("main_chat_world_btn")),this.updateChat()},t.prototype.onChatAdd=function(e){this.updateChat()},t.prototype.updateChat=function(){this.chatNewLabel.text="";var e=ChatVoManager.ins.getChats(this.campBtnType-1);if(e.length>0){this.chatVo=e[e.length-1];var t=new Array;if(ChatType.HELP_KILL_BOSS==this.chatVo.type)return;this.chatVo.type==ChatType.CAMP?t.push({text:this.chatVo.playerName+"：",style:{textColor:GameUtil.getCampColor(this.chatVo.camp)}}):ChatType.WORLD==this.chatVo.type&&t.push({text:"["+GameUtil.getCampName(this.chatVo.camp)+"]"+this.chatVo.playerName+"：",style:{textColor:GameUtil.getCampColor(this.chatVo.camp)}}),t=t.concat(GameUtil.getChatContent(this.chatVo)),this.chatNewLabel.textColor=GameUtil.getisLeftColoe(!0),this.chatNewLabel.textFlow=t}},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.chatBtn.dispose(),this.chatBtn=null,EventCenter.ins.remove(EventCenter.CHAT_UPDATE_NEW_MESSAGE,this.checkChatRed,this),EventCenter.ins.remove(EventCenter.CHAT_ADD,this.onChatAdd,this),this.chatNewLabel.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),EventCenter.ins.remove(EventCenter.FUNCTION_BTN_OPEN_BTN,this.onFunctionOpen,this)},t}(BaseSkin);__reflect(MainChatComponent.prototype,"MainChatComponent");var KuaFuMap=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/scene/main/kuafuMap/KuaFuMapSkin.exml",t.addEventListener(eui.UIEvent.CREATION_COMPLETE,t.onCreated,t),t.addEventListener(egret.Event.REMOVED_FROM_STAGE,t.onRemoved,t),EventCenter.ins.add(EventCenter.KUA_FU_CITY_CLICK,t.onItemClick,t),t}return __extends(t,e),t.prototype.onCreated=function(){this.citys=new Array,this.hufuCom=new MainHuFuComponent(this.hufuSkin)},t.prototype.onItemClick=function(e){var t=e.data;GameUIUtil.showEnterMap(t)},t.prototype.getCityForId=function(e){for(var t=null,i=0,n=this.citys.length;n>i;i++)if(t=this.citys[i],t.mapVo.metaId==e)return t;return null},t.prototype.updateCitys=function(){UIUtil.dispose(this.group),this.citys.length=0;for(var e=MetaMapManager.ins.getMapForKuaFu(),t=new Array,i=0,n=e.length;n>i;i++){var o=MapVoManager.ins.getMap(e[i].id);o&&t.push(e[i])}t.sort(GameUtil.sortCountry2);for(var r,i=0,n=t.length;n>i;i++)r=new KuaFuCityItem(t[i].id),this.citys.push(r),this.group.addChild(r);this.runTimer(),TimerManager.ins.addTimer(this);var s=this.getCityForId(Game.mapId);s&&s.showPlace(!0)},t.prototype.runTimer=function(){for(var e,t=0,i=this.citys.length;i>t;t++)e=this.citys[t],e.runTime()},t.prototype.onRemoved=function(e){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.onCreated,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this),EventCenter.ins.remove(EventCenter.KUA_FU_CITY_CLICK,this.onItemClick,this),TimerManager.ins.removeTimer(this)},t}(eui.Component);__reflect(KuaFuMap.prototype,"KuaFuMap",["ITimer"]);var KuaFuCityItem=function(e){function t(t){var i=e.call(this)||this;return i.mapVo=MapVoManager.ins.getMap(t),i.skinName="resource/skins/scene/main/kuafuMap/item/KuaFuMapCityItemSkin.exml",i.addEventListener(eui.UIEvent.CREATION_COMPLETE,i.onCreated,i),i.addEventListener(egret.Event.REMOVED_FROM_STAGE,i.onRemoved,i),i.addEventListener(egret.TouchEvent.TOUCH_TAP,i.onTouch,i),i}return __extends(t,e),t.prototype.onCreated=function(){var e=MetaMapManager.ins.getMap(this.mapVo.metaId);this.nameLabel.text=e.name,this.cityImg.source="kuafu_map_icon_"+e.cityIcon+"_png"},t.prototype.showPlace=function(e){this.placeImg.visible=e,TweenMax.killTweensOf(this.placeImg),e&&TweenMax.to(this.placeImg,.6,{y:this.y-4,yoyo:!0,repeat:-1})},t.prototype.runTime=function(){this.mapVo.monsterMinCD>0?(this.timeLabel.visible=!0,this.timeLabel.text=DateUtils.getTimeStr3(this.mapVo.monsterMinCD)):this.timeLabel.visible=!1},t.prototype.onTouch=function(e){this.mapVo.metaId!=GameUtil.getTaoYuanId()&&EventCenter.ins.send(EventCenter.KUA_FU_CITY_CLICK,this.mapVo.metaId)},t.prototype.onRemoved=function(e){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.onCreated,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)},t}(eui.Component);__reflect(KuaFuCityItem.prototype,"KuaFuCityItem");var MainMapComponent=function(e){function t(t){var i=e.call(this)||this;return i.isAutoBattle=!1,i.isCampMode=!0,i.canAttack=!0,i.selectedMapPlayerEntity=null,i.timer=null,i.intervalNum=-1,i.isBuffLeft=!1,i.entityPosCount=0,i.normalEntityCount=0,i.selfDizzyObj={beginTime:0,isDizzy:!1},i.buffSubHpArr=new Array,i.index=0,i.isLeft=!1,i.players=new Array,i.metaMap=MetaMapManager.ins.getMap(t),Game.mapId=t,i.skinName="resource/skins/scene/main/map/MainMapSkin.exml",i.shots=new Array,i}return __extends(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this.timer&&(this.timer.removeEventListener(egret.TimerEvent.TIMER,this.onTimerHandler,this),this.timer.stop(),this.timer=null),-1!=this.intervalNum&&window.clearInterval(this.intervalNum),EventCenter.ins.remove(EventCenter.CLICK_MAP_PLAYER_HEAD,this.onClickPlayer,this),this.autoBtn.dispose(),this.stopAutoBtn.dispose(),this.allModeBtn.dispose(),this.campModeBtn.dispose(),this.rebackBtn.dispose(),this.offlineBtn.dispose(),ExpEffectManager.ins.clear(),UIUtil.dispose(this.playersContainer),UIUtil.dispose(this.effectContainer),this.shots=[],this.players=[],EventCenter.ins.remove(EventCenter.SHOT_MOVE_END,this.onShotMoveEnd,this),EventCenter.ins.remove(EventCenter.BATTLE_PLAYER_DEATH,this.onPlayerDeath,this),this.bgImg.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onMapClick,this,!1),EventCenter.ins.remove(EventCenter.GO_AWAY_UPDATE,this.onGoAwayUpdate,this),EventCenter.ins.remove(EventCenter.FUNCTION_BTN_OPEN_BTN,this.onFunctionOpen,this),Game.selfDizzyObj.isDizzy=!1},t.prototype.onCreated=function(){var e=this;if(e.autoBtn=UIUtil.getButton("autoBtn",e,e.autoHandler,e),e.stopAutoBtn=UIUtil.getButton("stopAutoBtn",e,e.autoHandler,e),e.allModeBtn=UIUtil.getButton("allModeBtn",e,e.modeHandler,e),e.campModeBtn=UIUtil.getButton("campModeBtn",e,e.modeHandler,e),e.rebackBtn=UIUtil.getButton("rebackBtn",e,e.rebackHandler,e),e.offlineBtn=UIUtil.getButton("offlineBtn",e,e.offlineHandler,e),e.mapNameLabel.text=e.metaMap.name,e.playersContainer=new egret.DisplayObjectContainer,e.container.addChild(e.playersContainer),e.effectContainer=new egret.DisplayObjectContainer,e.container.addChild(e.effectContainer),e.effectContainer.addChild(ExpEffectManager.ins.container),ExpEffectManager.ins.targetPos=UIUtil.global2Local(new egret.Point(22,34),ExpEffectManager.ins.container),EventCenter.ins.add(EventCenter.FUNCTION_BTN_OPEN_BTN,e.onFunctionOpen,e),e.metaMap.type!=MapType.MAIN_CITY)if(e.offlineBtn.visible=!1,MapType.BIRTH==e.metaMap.type)e.dropGroup.visible=!1;else{var t=null,i=!1,n=0,o=this.metaMap.monsterIds;0==o.length&&(o=MetaTimingManager.ins.getTimingForMap(this.metaMap.id).monsterIds);for(var r=0,s=o.length;s>r;r++)if(n=o[r],0!=n&&(t=MetaMonsterManager.ins.getMonster(n),0!=t.dropId))for(var a=MetaDropManager.ins.getDropsForGroup(t.dropId),h=0,p=a.length;p>h;h++)if(1==a[h].forceDrop){i=!0;break}e.dropGroup.visible=i}else e.dropGroup.visible=!1;e.initPlayers(),e.initSelfPlayer(),e.metaMap.type==MapType.BIRTH?e.rebackBtn.visible=e.autoBtn.visible=e.stopAutoBtn.visible=e.allModeBtn.visible=e.campModeBtn.visible=e.cdGroup.visible=!1:MapType.MAIN_CITY==e.metaMap.type?e.rebackBtn.visible=!1:1==e.metaMap.kf?(e.campModeBtn.visible=e.allModeBtn.visible=!1,e.rebackBtn.visible=!0):e.rebackBtn.visible=!0,e.refreshAuto(),e.refreshMode(),window.setInterval?e.intervalNum=window.setInterval(function(){e.onTimerHandler()},100):(e.timer=new egret.Timer(100,0),e.timer.addEventListener(egret.TimerEvent.TIMER,e.onTimerHandler,e),e.timer.start()),e.bgImg.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onMapClick,e,!1),EventCenter.ins.add(EventCenter.GO_AWAY_UPDATE,e.onGoAwayUpdate,e),e.onMapCapacityDrop({dataVo:MapEntityVoManager.ins.capacityDrop}),e.checkGuide(),e.checkOpen()},t.prototype.onAdded=function(){e.prototype.onAdded.call(this),EventCenter.ins.add(EventCenter.CLICK_MAP_PLAYER_HEAD,this.onClickPlayer,this),EventCenter.ins.add(EventCenter.SHOT_MOVE_END,this.onShotMoveEnd,this),EventCenter.ins.add(EventCenter.BATTLE_PLAYER_DEATH,this.onPlayerDeath,this),this.addSocketListener(BookCmd.RESPONSE_PLAYER_ENTER_OR_LEAVE_MAP,this.onPlayerEnterOrLeaveMap),this.addSocketListener(BookCmd.RESPONSE_ENTITY_ATTACK,this.onEntityAttack),this.addSocketListener(BookCmd.RESPONSE_UNIT_DIE,this.onEntityDie),this.addSocketListener(BookCmd.RESPONSE_MONSTER_RELIVE,this.monsterRelive),this.addSocketListener(BookCmd.MONSTER_TARGET,this.updateMonsterTarget),this.addSocketListener(BookCmd.MAP_CAPACITY_DROP,this.onMapCapacityDrop)},t.prototype.onFunctionOpen=function(e){var t=e.data,i=this.getFunctionBtn(t);i&&this.checkOpen()},t.prototype.checkOpen=function(){this.offlineBtn.filters=VoUtil.checkFunctionOpen(FunctionId.LI_XIAN)?null:[GameUtil.getGrayFilter()]},t.prototype.getFunctionBtnPos=function(e){var t=this.getFunctionBtn(e);if(!t)return null;var i=UIUtil.local2Global(t.target);return i},t.prototype.getFunctionBtn=function(e){var t=null;switch(e){case FunctionId.LI_XIAN:t=this.offlineBtn}return t},t.prototype.onMapClick=function(e){this.canAttack=!1},t.prototype.onGoAwayUpdate=function(){if(this.metaMap.type!=MapType.BIRTH){var e=GoAwayVoManager.ins.goAwayVo;e.remainderTime>0?(this.cdGroup.visible=!0,this.rebackBtn.visible=!1,this.cdLabel.text=e.remainderTime+"秒"):(this.cdGroup.visible=!1,this.rebackBtn.visible=!0)}},t.prototype.onMapCapacityDrop=function(e){if(e.dataVo){e.dataVo.rank||(e.dataVo.rank=0),e.dataVo.radio||(e.dataVo.radio=0),this.rankLabel.text="排名："+e.dataVo.rank;var t=.1*e.dataVo.radio,i=t.toFixed(3);if("0.000"!=i){for(var n=i.split("."),o=n[1],r=o.split(""),s=r.length-1;s>=0&&"0"==r[s];s--)r.splice(s,1);i=0==r.length?n[0]:n[0]+"."+r.join("")}this.dropRateLabel.text="掉率："+i+"%"}},t.prototype.updateMonsterTarget=function(e){MapEntityVoManager.ins.updateMonsterTarget(e.dataVo);for(var t,i=0,n=this.players.length;n>i;i++)t=this.players[i],t.updateTarget()},t.prototype.checkGuide=function(){if(4==GuideVoManager.ins.guideVo.nowStep){var e=this.getMapPlayerEntity("10001");if(!e)return void GuideVoManager.ins.guideVo.nowStep++;var t=UIUtil.local2Global(e);Guide.ins.show(t.x+10,t.y,e.skin.width,e.skin.height)}else if(8==GuideVoManager.ins.guideVo.nowStep){var e=this.getMapPlayerEntity("10002");if(!e)return void GuideVoManager.ins.guideVo.nowStep++;var t=UIUtil.local2Global(e);Guide.ins.show(t.x+10,t.y,e.skin.width,e.skin.height)}else if(12==GuideVoManager.ins.guideVo.nowStep){var e=this.getMapPlayerEntity("10003");if(!e)return void GuideVoManager.ins.guideVo.nowStep++;var t=UIUtil.local2Global(e);Guide.ins.show(t.x+10,t.y,e.skin.width,e.skin.height)}else if(19==GuideVoManager.ins.guideVo.nowStep){var e=this.getMapPlayerEntity("10004");if(!e)return void GuideVoManager.ins.guideVo.nowStep++;var t=UIUtil.local2Global(e);Guide.ins.show(t.x+10,t.y-2,e.skin.width,e.skin.height)}else if(GuideVoManager.ins.isBiGuanStep(2)){var e=this.getMapPlayerEntity("20001");if(!e)return void GuideVoManager.ins.skipStep(3);var t=UIUtil.local2Global(e);Guide.ins.show(t.x+10,t.y-2,e.skin.width,e.skin.height)}else if(GuideVoManager.ins.isBiGuanStep(4)){var e=this.getMapPlayerEntity("20002");if(!e)return void GuideVoManager.ins.skipStep(1);var t=UIUtil.local2Global(e);Guide.ins.show(t.x+10,t.y-2,e.skin.width,e.skin.height)}},t.prototype.initPlayers=function(){var e=MapEntityVoManager.ins.enemyPlayers;this.metaMap.type==MapType.MAIN_CITY?this.entityPosCount=3:this.entityPosCount=0;for(var t=e.length,i=0;t>i;i++)this.addPlayerEntity(e[i])},t.prototype.addPlayerEntity=function(e){var t=new MapPlayerEntity(e);this.playersContainer.addChild(t);var i=new egret.Point(0,0);if(e.isMonster){t.updateTarget();
var n=MetaMonsterManager.ins.getMonster(parseInt(e.id));1==n.type?(i=this.getPosForPlace(0),i.x-=10):(i=this.getPosForPlace(this.normalEntityCount+this.entityPosCount),this.normalEntityCount++)}else i=this.getPosForPlace(this.normalEntityCount+this.entityPosCount),this.normalEntityCount++;t.x=i.x,t.y=i.y,t.pos=i,this.players.push(t)},t.prototype.refreshPlayerPos=function(){for(var e,t=this.players.length,i=this.entityPosCount,n=0;t>n;n++){if(e=this.players[n],e.mapEntityVo.isMonster){var o=MetaMonsterManager.ins.getMonster(parseInt(e.mapEntityVo.id));if(1==o.type)continue}this.playersContainer.setChildIndex(e,n),e.gotoPos(this.getPosForPlace(i)),i++}},t.prototype.onTimerHandler=function(){if(this.metaMap.id!=GameUtil.getTaoYuanId()){if(null==this.selfPlayerEntity.nowTargetId&&this.isAutoBattle&&this.autoSetNewTarget(this.selfPlayerEntity),this.canAttack&&this.selfPlayerEntity.canAttack()&&this.sendAttackMsg(),Game.selfDizzyObj.isDizzy){var e=egret.getTimer();e-Game.selfDizzyObj.beginTime>=3e3&&(this.rebackBtn.enabled=!0,this.rebackBtn.currentState="up",Game.selfDizzyObj.isDizzy=!1)}this.runBuffSubHp()}},t.prototype.sendAttackMsg=function(){var e={cmd:BookCmd.ATTACK_OTHER_ENTITY,target:this.selfPlayerEntity.nowTargetId,type:this.selfPlayerEntity.nowTargetType};Game.net.sendData(e,null),this.selfPlayerEntity.lastAttackTime=egret.getTimer()},t.prototype.modeHandler=function(e){this.isCampMode=!this.isCampMode,this.refreshMode()},t.prototype.autoHandler=function(e){this.isAutoBattle=!this.isAutoBattle,this.refreshAuto(),this.isAutoBattle?this.autoSetNewTarget(this.selfPlayerEntity):this.selfPlayerEntity.nowTargetId=null},t.prototype.refreshMode=function(){return this.metaMap.canPvp&&1!=this.metaMap.kf?void(MapType.TRAIL==this.metaMap.type?this.campModeBtn.visible=this.allModeBtn.visible=!1:(this.campModeBtn.visible=this.isCampMode,this.allModeBtn.visible=!this.isCampMode)):void(this.campModeBtn.visible=this.allModeBtn.visible=!1)},t.prototype.refreshAuto=function(){MapType.MAIN_CITY==this.metaMap.type||MapType.BOSS==this.metaMap.type?(this.autoBtn.visible=!this.isAutoBattle,this.stopAutoBtn.visible=this.isAutoBattle):this.autoBtn.visible=this.stopAutoBtn.visible=!1},t.prototype.onGoAway=function(e){LoadingIcon.instance.hide();var t=e.dataVo.id;return 0>=t?(Alert.ins.showAlert(AlertType.ERROR,"回城失败!"),GoAwayVoManager.ins.setCD(Math.abs(t)),void this.onGoAwayUpdate()):void MainMapUtil.return2MainCity()},t.prototype.offlineHandler=function(e){if(!VoUtil.checkFunctionOpen(FunctionId.LI_XIAN)){var t=MetaFunctionOpenManager.ins.getOpenForFunctionId(FunctionId.LI_XIAN);return void Alert.ins.showAlert(AlertType.ERROR,"离线需要玩家等级"+t.openLevel+"级")}GameUIUtil.showOffline()},t.prototype.rebackHandler=function(e){if(void 0===e&&(e=null),Game.isKuaFu)return void MainMapUtil.return2Taoyuan();if(Game.battleType==BattleType.BIGUAN)return void MainMapUtil.return2MainCity();if(GoAwayVoManager.ins.goAwayVo.remainderTime>0)return void Alert.ins.showAlert(AlertType.ERROR,"回城CD中,请稍后!");var t={cmd:BookCmd.GO_AWAY};LoadingIcon.instance.show(),Game.net.sendData(t,this.onGoAway,this)},t.prototype.monsterRelive=function(e){if(MapEntityVoManager.ins.removeTarget(parseInt(e.dataVo.id)),!(PlayerVoManager.ins.playerVo.level<=Game.SHOW_BOSS_LEVEL)){var t=MapEntityVoManager.ins.makeEntityVo(e.dataVo,EntityType.MONSTER);this.addPlayerEntity(t),this.refreshPlayerPos()}},t.prototype.onEntityDie=function(e){var t=this.getMapPlayerEntity(e.dataVo.id);t&&(t.mapEntityVo.isSelf?(this.normalEntityCount--,this.metaMap.type==MapType.TRAIL?this.handleTrail(!1):Guide.ins.isShow||(Game.isKuaFu||GameUIUtil.showStrong(),GameUIUtil.showPlayerDeath(e.dataVo)),Game.isSelfDie=!0,MainMapUtil.return2Taoyuan()):(this.selfPlayerEntity.nowHp>0&&this.selfPlayerEntity.nowTargetId==t.mapEntityVo.id&&(this.selfPlayerEntity.nowTargetId=null),t.mapEntityVo.isMonster&&(this.metaMap.type==MapType.TRAIL?((GuideVoManager.ins.isBiGuanStep(2)||GuideVoManager.ins.isBiGuanStep(4))&&Guide.ins.nextStep2(),this.handleTrail(!0)):(t.mapEntityVo.red&&EventCenter.ins.send(EventCenter.CHECK_JIANG_HU_RED,!0),VoUtil.checkTask(this.metaMap.id,parseInt(t.mapEntityVo.id)),(4==GuideVoManager.ins.guideVo.nowStep||8==GuideVoManager.ins.guideVo.nowStep||12==GuideVoManager.ins.guideVo.nowStep||19==GuideVoManager.ins.guideVo.nowStep)&&Guide.ins.nextStep(function(){EventCenter.ins.send(EventCenter.GUIDE_CHECK)})),PlayerVoManager.ins.playerVo.camp==e.dataVo.sourceCountry&&ExpEffectManager.ins.showEffect(t.getCenterPos())),t.isTree||this.normalEntityCount--,this.removePlayerEntity(t),this.refreshPlayerPos()))},t.prototype.handleTrail=function(e){if(e){if(BiGuanVoManager.ins.biguanVo.nowFloor==Game.BIGUAN_MAX_FLOOR-1){var t=new Array;return t.push({text:"恭喜您！ 您今天闭关已达到最高层， 请您明天继续!"}),void GameUIUtil.showAlertTip(t,MainMapUtil.return2Taoyuan,this)}GameUIUtil.showBiGuan()}else MainMapUtil.return2Taoyuan()},t.prototype.onEntityAttack=function(e){if(Game.mapId!=GameUtil.getTaoYuanId()){var t=e.dataVo,i=this.getMapPlayerEntity(t.atter),n=this.getMapPlayerEntity(t.defer);if(n&&i){var o=MainMapUtil.makeAttackData(i,n,t),r=new MainBattleShot(o);this.playersContainer.addChild(r),this.shots.push(r),i.attack2Target(n.getCenterPos());for(var s=o.buffers,a=0,h=s.length;h>a;a++){var p=Number(o.buffers[a].use),l=Number(o.buffers[a].id);if(0==p){this.isBuffLeft=!this.isBuffLeft;var u=MetaSkillBuffManager.ins.getSkill(l);if(Number(u.buff_res)==SkillBuff.SUCK_BLOOD||Number(u.buff_res)==SkillBuff.CURE){var c=new MainBattleSkillEffect(u.buff_res,this.isBuffLeft),d=new MainBattleSuckHpEffect(o.buffers[a].v[0],!0,this.isBuffLeft);this.isBuffLeft?(c.x=o.attackPos.x-140,c.y=o.attackPos.y,d.x=c.x+140,d.y=o.attackPos.y+18):(c.x=o.attackPos.x,c.y=o.attackPos.y,d.x=c.x+110,d.y=o.attackPos.y+18),this.effectContainer.addChild(c),this.effectContainer.addChild(d)}else{var c=new MainBattleSkillEffect(u.buff_res,this.isBuffLeft);c.x=o.attackPos.x,c.y=o.attackPos.y,this.effectContainer.addChild(c)}}}if(i.mapEntityVo.isSelf&&o.metaSkill){var f=new MainBattleSkillEffectComponent(o.metaSkill);this.effectContainer.addChild(f),EventCenter.ins.send(EventCenter.BATTLE_OFFICER_ATTACK,{officerType:t.attHero,skillId:t.attSkill})}if(0!=o.recover){var g=new MainBattleHpEffect(o.recover,!0);g.x=o.attackPos.x,g.y=o.attackPos.y,this.effectContainer.addChild(g),i.updateHp(o.attackerHp)}}}},t.prototype.onPlayerEnterOrLeaveMap=function(e){if(!(PlayerVoManager.ins.playerVo.level<=Game.SHOW_BOSS_LEVEL)){var t=e.dataVo;if(1==t.type){var i=this.getMapPlayerEntity(t.player.id);this.removePlayerEntity(i);var n=MapEntityVoManager.ins.makeEntityVo(t.player,EntityType.PLAYER);this.addPlayerEntity(n)}else{var i=this.getMapPlayerEntity(t.pid);this.removePlayerEntity(i)}this.refreshPlayerPos()}},t.prototype.onClickPlayer=function(e){var t=e.data;if(!t.isSelf){var i=this.getMapPlayerEntity(t.id);if(i){if(GameUtil.isSafe(this.metaMap))return void Alert.ins.showAlert(AlertType.NORMAL,"本地图为安全区，无法攻击其他玩家");if(!t.isMonster){if(!this.metaMap.canPvp)return void Alert.ins.showAlert(AlertType.NORMAL,"本地图不允许PVP");if(this.isCampMode&&i.mapEntityVo.camp==this.selfPlayerEntity.mapEntityVo.camp)return void Alert.ins.showAlert(AlertType.NORMAL,"不能攻击同阵营的玩家!")}this.canAttack=!0,this.setSelectedMapPlayerEntity(i),this.selfPlayerEntity.nowTargetId=i.mapEntityVo.id,this.selfPlayerEntity.nowTargetType=i.mapEntityVo.isMonster?"1":"2"}}},t.prototype.removeShot=function(e){for(var t=0,i=this.shots.length;i>t;t++)if(this.shots[t]==e){this.shots.splice(t,1);break}var n=UIUtil.removeChildFromParent(e);n||e.dispose()},t.prototype.onShotMoveEnd=function(e){var t=e.data,i=t.attackData;if(0!=i.attackEffectResId){var n=new MainBattleAttackEffect(i);this.effectContainer.addChild(n)}this.removeShot(t);var o=this.getMapPlayerEntity(i.targetId);if(o){for(var r=i.buffers,s=0,a=r.length;a>s;s++){var h=Number(i.buffers[s].use),p=Number(i.buffers[s].id),l=MetaSkillBuffManager.ins.getSkill(p);if(1==h)if(Number(l.buff_res)==SkillBuff.ONE_ATTACK||Number(l.buff_res)==SkillBuff.TWO_ATTACK||Number(l.buff_res)==SkillBuff.MORE_ATTACK){var u=r[s].v,c=null;98==i.targetPos.x&&(c=!1),486==i.targetPos.x&&(c=!0);for(var d=0,f=u.length-1;f>d;d++)this.buffSubHpArr.push({nowCount:0,totalCount:u.length,hp:u[d],id:o.mapEntityVo.id,point:{x:i.targetPos.x,y:i.targetPos.y},isLeft:c})}else{var g=new MainBattleSkillEffect(l.buff_res,this.isBuffLeft);g.x=i.targetPos.x,g.y=i.targetPos.y,this.effectContainer.addChild(g),p==SkillBuff.DIZZY&&i.targetId==PlayerVoManager.ins.playerVo.id&&(Game.selfDizzyObj.beginTime=egret.getTimer(),Game.selfDizzyObj.isDizzy=!0,this.rebackBtn.currentState="disabled",this.rebackBtn.enabled=!1)}}if(this.runBuffSubHp(),i.isCrit){var g=new MainBattleCritEffect(i.hurt);g.x=i.targetPos.x,g.y=i.targetPos.y-40,this.effectContainer.addChild(g),o.updateHp(i.targetHp)}else{var m=new MainBattleHpEffect(i.hurt,!1);m.x=i.targetPos.x,m.y=i.targetPos.y,this.effectContainer.addChild(m),o.subHp(o.nowHp-i.targetHp)}}},t.prototype.runBuffSubHp=function(){if(this.index>=this.buffSubHpArr.length)return this.index=0,this.buffSubHpArr.splice(0,this.buffSubHpArr.length),void(this.isLeft=Math.random()>.5);var e=this.buffSubHpArr[this.index];null!=e.isLeft&&(this.isLeft=e.isLeft);var t=new MainBattleSuckHpEffect(e.hp,!1,this.isLeft);t.x=e.point.x,t.y=e.point.y,this.effectContainer.addChild(t),this.index++},t.prototype.autoSetNewTarget=function(e){if(e.mapEntityVo.isSelf&&null==e.nowTargetId)for(var t=void 0,i=0;i<this.players.length;i++)if(t=this.players[i],t.mapEntityVo.isMonster){var n=new egret.Event("");n.data=t.mapEntityVo,this.onClickPlayer(n);break}},t.prototype.onPlayerDeath=function(e){},t.prototype.setSelectedMapPlayerEntity=function(e){this.selectedMapPlayerEntity!=e&&(this.selectedMapPlayerEntity&&this.selectedMapPlayerEntity.showSelected(!1),this.selectedMapPlayerEntity=e,this.selectedMapPlayerEntity.showSelected(!0))},t.prototype.initSelfPlayer=function(){this.selfPlayerEntity=new MapPlayerEntity(MapEntityVoManager.ins.selfEntityVo),this.playersContainer.addChild(this.selfPlayerEntity),this.selfPlayerEntity.x=204,this.selfPlayerEntity.y=494,this.selfPlayerEntity.pos=new egret.Point(this.selfPlayerEntity.x,this.selfPlayerEntity.y)},t.prototype.removePlayerEntity=function(e){if(e){for(var t=this.players.length,i=t-1;i>=0;i--)if(this.players[i]==e){this.players.splice(i,1);break}e.showDeath()}},t.prototype.getMapPlayerEntity=function(e){if(this.selfPlayerEntity.mapEntityVo.id==e)return this.selfPlayerEntity;for(var t=this.players.length,i=0;t>i;i++)if(this.players[i].mapEntityVo.id==e)return this.players[i];return null},t.prototype.getPosForPlace=function(e){var t=new egret.Point(0,0);return t.x=e%3*194,t.y=110*Math.floor(e/3),t},t}(BaseComponent);__reflect(MainMapComponent.prototype,"MainMapComponent");var MainMapUtil=function(){function e(){}return e.getMapPath=function(e){var t="";return t=e.type==MapType.BOSS?"城池":MapType.KUA_FU==e.type?"战服":MapType.TRAIL==e.type?"闭关":"国家",t+" -> "+e.name},e.showEnterMap=function(e,t,i){void 0===t&&(t=null),void 0===i&&(i=null);var n=MetaMapManager.ins.getMap(e);if(1==n.kf){if(!Game.isKuaFu)return void Alert.ins.showAlert(AlertType.ERROR,"请先进入战服!");if(!VoUtil.checkFunctionOpen(FunctionId.KUA_FU))return void Alert.ins.showAlert(AlertType.ERROR,"战服未开启，请先开启战服!")}else if(n.type==MapType.BOSS){if(Game.isKuaFu)return void Alert.ins.showAlert(AlertType.ERROR,"请先退出战服!")}else if((n.type==MapType.WEI||n.type==MapType.SHU||n.type==MapType.WU)&&Game.isKuaFu)return void Alert.ins.showAlert(AlertType.ERROR,"请先退出战服!");var o=MapVoManager.ins.getMap(n.id);return o?(t&&t.call(i),void GameUIUtil.showEnterMap(e)):void Alert.ins.showAlert(AlertType.ERROR,n.name+"未开启!")},e.return2Taoyuan=function(){var e=GameUtil.getTaoYuanId(),t={cmd:BookCmd.ENTER_MAP,map:e};LoadingIcon.instance.show(),Game.net.sendData(t,function(e){LoadingIcon.instance.hide(),MapEntityVoManager.ins.onEnterMap(e.dataVo),Game.battleType=BattleType.NO,EventCenter.ins.send(EventCenter.ENTER_MAP,GameUtil.getTaoYuanId())},null)},e.return2MainCity=function(){var e=GameUtil.getMainCityIdForCamp(PlayerVoManager.ins.playerVo.camp),t={cmd:BookCmd.ENTER_MAP,map:e};LoadingIcon.instance.show(),Game.net.sendData(t,function(t){LoadingIcon.instance.hide(),MapEntityVoManager.ins.onEnterMap(t.dataVo),Game.battleType=BattleType.NO,EventCenter.ins.send(EventCenter.ENTER_MAP,e)},null)},e.getMonsters=function(e){var t=new Array;return t},e.getEntityVo=function(e,t){var i=new MapEntityVo;if(i.id=e.id,i.entityType=t,EntityType.MONSTER==t){var n=MetaMonsterManager.ins.getMonster(parseInt(i.id));i.name=n.name}return i.hp=e.hp,i.maxHp=e.maxHp,i},e.makeAttackData=function(e,t,i){var n=t.getCenterPos().subtract(e.getCenterPos()),o=Math.atan2(n.y,n.x),r=new MainBattleAttackData,s=[201,301,401];if(0!=i.attHero){var a=MetaOfficerManager.ins.getOfficerForTypeAndLevel(i.attHero);a?(0!=a.shotRes?r.shotResId=a.shotRes:r.shotResId=s[Math.floor(Math.random()*s.length)],r.attackEffectResId=a.attackEffect):(r.shotResId=s[Math.floor(Math.random()*s.length)],r.attackEffectResId=0)}else r.shotResId=s[Math.floor(Math.random()*s.length)],r.attackEffectResId=0;return 0!=i.attSkill&&(r.metaSkill=MetaSkillManager.ins.getSkill(i.attSkill)),r.shotRotation=180*o/Math.PI+90,r.attackPos=e.getCenterPos(),r.targetPos=t.getCenterPos(),r.hurt=i.value,r.targetHp=i.defHp,r.isCrit=1==i.m,r.targetId=t.mapEntityVo.id,r.attackId=e.mapEntityVo.id,r.recover=i.recover,r.attackerHp=i.attHp,r.buffers=i.buffers,r.skillDamage=i.attSkill,r},e}();__reflect(MainMapUtil.prototype,"MainMapUtil");var MainBattleCritEffect=function(e){function t(t){var i=e.call(this)||this,n="b-"+t;return i.hpLabel=new egret.BitmapText,i.hpLabel.font=RES.getRes("font_red_fnt"),i.hpLabel.text=n,i.addChild(i.hpLabel),i.anchorOffsetX=i.hpLabel.width/2,i.anchorOffsetY=i.hpLabel.height/2,i.addEventListener(egret.Event.ADDED_TO_STAGE,i.onAdded,i),i.addEventListener(egret.Event.REMOVED_FROM_STAGE,i.onRemoved,i),i}return __extends(t,e),t.prototype.onAdded=function(){this.scaleX=this.scaleY=1;var e=TweenMax.to(this,.1,{scaleX:1.2,scaleY:1.2}),t=TweenMax.to(this,.2,{delay:.4,alpha:0});this.lineLite=new TimelineLite({onComplete:this.onHide.bind(this)}),this.lineLite.append(e),this.lineLite.append(t)},t.prototype.onRemoved=function(e){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAdded,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this),this.lineLite.stop(),this.lineLite.clear(!0),UIUtil.dispose(this),TweenMax.killTweensOf(this)},t.prototype.onHide=function(){TweenMax.killTweensOf(this),UIUtil.removeChildFromParent(this)},t}(egret.DisplayObjectContainer);__reflect(MainBattleCritEffect.prototype,"MainBattleCritEffect");var MainBattleHpEffect=function(e){function t(t,i){void 0===i&&(i=!1);var n=e.call(this)||this,o="font_green",r="+"+t;return i||(o="font_red",r="-"+t),n.hpLabel=new egret.BitmapText,n.hpLabel.font=RES.getRes(o+"_fnt"),n.hpLabel.text=r,n.addChild(n.hpLabel),n.anchorOffsetX=n.hpLabel.width/2,n.anchorOffsetY=n.hpLabel.height/2,n.addEventListener(egret.Event.ADDED_TO_STAGE,n.onAdded,n),n.addEventListener(egret.Event.REMOVED_FROM_STAGE,n.onRemoved,n),n}return __extends(t,e),t.prototype.onAdded=function(){var e=TweenMax.to(this,.4,{y:this.y-40}),t=TweenMax.to(this,.2,{delay:.4,alpha:0});this.lineLite=new TimelineLite({onComplete:this.onHide.bind(this)}),this.lineLite.append(e),this.lineLite.append(t)},t.prototype.onRemoved=function(e){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAdded,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this),this.lineLite.stop(),this.lineLite.clear(!0),UIUtil.dispose(this),TweenMax.killTweensOf(this)},t.prototype.onHide=function(){TweenMax.killTweensOf(this),UIUtil.removeChildFromParent(this)},t}(egret.DisplayObjectContainer);__reflect(MainBattleHpEffect.prototype,"MainBattleHpEffect");var MainBattleSkillEffect=function(e){function t(t,i){var n=e.call(this)||this;n.isLeft=i;var o="skill_buff_"+t;return n.buffLabel=new eui.Image,n.buffLabel.source=o,n.addChild(n.buffLabel),n.buffLabel.scaleX=.7,n.buffLabel.scaleY=.7,n.anchorOffsetX=n.buffLabel.width/2,n.anchorOffsetY=n.buffLabel.height/2,n.addEventListener(egret.Event.ADDED_TO_STAGE,n.onAdded,n),n.addEventListener(egret.Event.REMOVED_FROM_STAGE,n.onRemoved,n),n}return __extends(t,e),t.prototype.onAdded=function(){if(this.scaleX=this.scaleY=1,this.isLeft)var e=TweenMax.to(this,.7,{bezier:[{x:this.x,y:this.y},{x:this.x-80,y:this.y-80},{x:this.x-120,y:this.y}],orientToBezier:!1});else var e=TweenMax.to(this,.7,{bezier:[{x:this.x,y:this.y},{x:this.x+50,y:this.y-80},{x:this.x+90,y:this.y}],orientToBezier:!1});var t=TweenMax.to(this,.7,{delay:.1,alpha:0});this.lineLite=new TimelineLite({onComplete:this.onHide.bind(this)}),this.lineLite.append(e),this.lineLite.append(t)},t.prototype.onRemoved=function(e){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAdded,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this),this.lineLite.stop(),this.lineLite.clear(!0),UIUtil.dispose(this),TweenMax.killTweensOf(this)},t.prototype.onHide=function(){TweenMax.killTweensOf(this),UIUtil.removeChildFromParent(this)},t}(egret.DisplayObjectContainer);__reflect(MainBattleSkillEffect.prototype,"MainBattleSkillEffect");var MainBattleSuckHpEffect=function(e){function t(t,i,n){void 0===i&&(i=!1);var o=e.call(this)||this,r="font_yellow",s="+"+t;return i||(r="font_orange",s="-"+t),o.isLeft=n,o.hpLabel=new egret.BitmapText,o.hpLabel.font=RES.getRes(r+"_fnt"),o.hpLabel.text=s,o.addChild(o.hpLabel),o.hpLabel.scaleX=.8,o.hpLabel.scaleY=.8,o.anchorOffsetX=o.hpLabel.width/2,o.anchorOffsetY=o.hpLabel.height/2,o.addEventListener(egret.Event.ADDED_TO_STAGE,o.onAdded,o),o.addEventListener(egret.Event.REMOVED_FROM_STAGE,o.onRemoved,o),o}return __extends(t,e),t.prototype.onAdded=function(){if(this.isLeft)var e=TweenMax.to(this,.7,{bezier:[{x:this.x,y:this.y},{x:this.x-80,y:this.y-80},{x:this.x-120,y:this.y}],orientToBezier:!1});else var e=TweenMax.to(this,.7,{bezier:[{x:this.x,y:this.y},{x:this.x+80,y:this.y-80},{x:this.x+120,y:this.y}],orientToBezier:!1});var t=TweenMax.to(this,.7,{delay:.1,alpha:0});this.lineLite=new TimelineLite({onComplete:this.onHide.bind(this)}),this.lineLite.append(e),this.lineLite.append(t)},t.prototype.onRemoved=function(e){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAdded,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this),this.lineLite.stop(),this.lineLite.clear(!0),UIUtil.dispose(this),TweenMax.killTweensOf(this)},t.prototype.onHide=function(){TweenMax.killTweensOf(this),UIUtil.removeChildFromParent(this)},t}(egret.DisplayObjectContainer);__reflect(MainBattleSuckHpEffect.prototype,"MainBattleSuckHpEffect");var MainMapHelper=function(){function e(){}return e}();__reflect(MainMapHelper.prototype,"MainMapHelper");var MainMapNameComponent=function(e){function t(t,i){return void 0===i&&(i=null),e.call(this,t,i)||this}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.nameLabel=UIUtil.getLabel(this.argObj,"nameLabel",this.skin)},t}(BaseSkin);__reflect(MainMapNameComponent.prototype,"MainMapNameComponent");var MainBattleSkillEffectComponent=function(e){function t(t){var i=e.call(this)||this;return i.skinName="resource/skins/scene/main/map/skillEffect/MainBattleSkillEffectSkin.exml",i.metaSkill=t,i.addEventListener(egret.Event.REMOVED_FROM_STAGE,i.onRemoved,i),i}return __extends(t,e),t.prototype.onRemoved=function(e){TweenMax.killTweensOf(this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this)},t.prototype.onCreated=function(){this.skillNameImg.source=this.metaSkill.skillNameRes+"_png",this.x=-this.width,this.y=320,TweenMax.to(this,.1,{ease:Linear.easeNone,x:-20,onComplete:this.moveEnded.bind(this)})},t.prototype.moveEnded=function(){TweenMax.to(this,.1,{alpha:0,x:Game.stage.stageWidth,delay:.7,onComplete:this.onHide.bind(this)})},t.prototype.onHide=function(){UIUtil.removeChildFromParent(this)},t.prototype.dispose=function(){e.prototype.dispose.call(this)},t.prototype.onAdded=function(){e.prototype.onAdded.call(this)},t}(BaseComponent);__reflect(MainBattleSkillEffectComponent.prototype,"MainBattleSkillEffectComponent");var MainBattleShot=function(e){function t(t){var i=e.call(this)||this;i.moveSpeed=null,i.totalFrameCount=0,i.runFrameCount=0,i.hasDispatch=!1,i.attackData=t;var n=i.attackData.metaSkill?i.attackData.metaSkill.shotResId:i.attackData.shotResId;i.resName="battle_shot_"+n+"_png";var o=i;return RES.getResAsync(o.resName,function(e){o.initBmp(e)},o),o.addEventListener(egret.Event.REMOVED_FROM_STAGE,o.onRemoved,o),i}return __extends(t,e),t.prototype.initBmp=function(e){this.texture=e,this.anchorOffsetY=this.height/2,this.anchorOffsetX=this.width/2,this.rotation=this.attackData.shotRotation,this.x=this.attackData.attackPos.x,this.y=this.attackData.attackPos.y,FrameManager.ins.addFrame(this);var t=egret.Point.distance(this.attackData.targetPos,this.attackData.attackPos);this.totalFrameCount=Math.ceil(.5*Game.stage.frameRate),this.runFrameCount=0;var i=t/(.5*Game.stage.frameRate);this.moveSpeed=this.attackData.targetPos.subtract(this.attackData.attackPos),this.moveSpeed.normalize(i)},t.prototype.runFrame=function(){return this.runFrameCount>=this.totalFrameCount?(this.x=this.attackData.targetPos.x,this.y=this.attackData.targetPos.y,void this.onMoveEnd()):(this.x+=this.moveSpeed.x,this.y+=this.moveSpeed.y,void this.runFrameCount++)},t.prototype.onRemoved=function(e){this.dispose()},t.prototype.dispose=function(){this.hasEventListener(egret.Event.REMOVED_FROM_STAGE)&&this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this),FrameManager.ins.removeFrame(this),this.hasDispatch=!0},t.prototype.onMoveEnd=function(){this.hasDispatch||(log("dispatchOnMoveEnd....................."),this.hasDispatch=!0,EventCenter.ins.send(EventCenter.SHOT_MOVE_END,this))},t}(egret.Bitmap);__reflect(MainBattleShot.prototype,"MainBattleShot",["IFrame"]);var MainBattleSkill=function(e){function t(t,i){void 0===i&&(i=null);var n=e.call(this,t,i)||this;return n.skillVo=i,n.skillNameImg=n.getMc("skillNameImg"),n.topEffectImg=n.getMc("topEffectImg"),n.bottomEffectImg=n.getMc("bottomEffectImg"),n}return __extends(t,e),t.prototype.move=function(){this.topEffectImg.x=this.skin.width,this.bottomEffectImg.x=0,this.topEffectImg.visible=!0,this.bottomEffectImg.visible=!0,TweenMax.to(this,.6,{x:5,onComplete:this.moveEnded})},t.prototype.moveEnded=function(){var e=this;TweenMax.killTweensOf(this),e.topEffectImg.visible=!0,e.bottomEffectImg.visible=!0,TweenMax.to(this.topEffectImg,.6,{x:-this.skin.width,onComplete:function(){TweenMax.killTweensOf(e.topEffectImg),e.topEffectImg.visible=!1}}),TweenMax.to(this.bottomEffectImg,.6,{x:this.skin.width,onComplete:function(){TweenMax.killTweensOf(e.bottomEffectImg),e.bottomEffectImg.visible=!1}}),TweenMax.to(this,1.2,{autoAlpha:!0,alpha:0})},t.prototype.dispose=function(){e.prototype.dispose.call(this),TweenMax.killTweensOf(this),UIUtil.dispose(this.skin)},t}(BaseSkin);__reflect(MainBattleSkill.prototype,"MainBattleSkill");var MainBattleAttackEffect=function(e){function t(t){var i=e.call(this)||this;return i.attackData=t,i.mvName="skill_effect_"+t.attackEffectResId,UtilMovieClip.loadMc(i.mvName,i.mvName,i.loadMcEnd,i),i.x=t.targetPos.x,i.y=t.targetPos.y,i.addEventListener(egret.Event.REMOVED_FROM_STAGE,i.dispose,i),i}return __extends(t,e),t.prototype.loadMcEnd=function(){this.mc=UtilMovieClip.getMovieClip("skill_effect_"+this.attackData.attackEffectResId+"_json","skill_effect_"+this.attackData.attackEffectResId+"_png","skill_effect_"+this.attackData.attackEffectResId),this.addChild(this.mc),this.mc.play(),this.mc.addEventListener(egret.Event.COMPLETE,this.playEnded,this)},t.prototype.playEnded=function(e){UIUtil.removeChildFromParent(this)},t.prototype.dispose=function(e){this.mc&&this.mc.removeEventListener(egret.Event.COMPLETE,this.playEnded,this),RES.destroyRes(this.mvName+"_json"),RES.destroyRes(this.mvName+"_png"),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.dispose,this),this.mc=null,UIUtil.dispose(this)},t}(egret.DisplayObjectContainer);__reflect(MainBattleAttackEffect.prototype,"MainBattleAttackEffect");var MainBattleAttackData=function(){function e(){this.isCrit=!1,this.recover=0,this.attackerHp=0}return e}();__reflect(MainBattleAttackData.prototype,"MainBattleAttackData");var MainWorldMapComponents=function(e){function t(t){void 0===t&&(t=0);var i=e.call(this)||this;return i.nowIndex=-1,i.camp=0,i.zoomEffect=null,i.camp=t,i.skinName="resource/skins/scene/main/worldMap/MainWorldMapSkin.exml",i}return __extends(t,e),t.prototype.onCreated=function(){this.cityBarObj=new Object,this.cityIconObj=new Object,this.cityObj=new Object,this.boatObj=new Object;for(var e,t=this.mapGroup.numChildren,i=0;t>i;i++){e=this.mapGroup.getChildAt(i);var n=parseInt(e.name.split("_")[2]);e.alpha=.01,e.touchEnabled=!0,e.pixelHitTest=!0,this.cityObj[n+""]=e,e.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this)}t=this.cityIconGroup.numChildren;for(var i=0;t>i;i++){var o=this.cityIconGroup.getChildAt(i),r=parseInt(o.name.split("_")[3]);this.cityIconObj[r+""]=o}t=this.barGroup.numChildren;for(var s,a,h=0,i=0;t>i;i++){var p=this.barGroup.getChildAt(i),l=parseInt(p.name.split("_")[3]);h=l,h=this.changeIdMap2Vo(l),s=MetaMapManager.ins.getMap(h),a=MapVoManager.ins.getMap(h),p.thumb.source="map_city_icon_"+s.cityIcon+"_full",this.cityBarObj[l+""]=p,a?(p.visible=!0,0==a.monsterMinCD?p.value=p.maximum=1:(p.maximum=a.monsterCD,p.value=a.monsterCD-Math.max(0,a.monsterMinCD))):p.visible=!1}t=this.newCityGroup.numChildren;for(var u,c,d,f=1,i=0;t>i;i++){var g=this.newCityGroup.getChildAt(i),m=parseInt(g.name.split("_")[1]),y=10*f,v=3*f;f*=-1,TweenMax.to(g,4,{x:g.x+y,yoyo:!0,delay:.3*i,ease:Linear.easeNone,repeat:-1}),TweenMax.to(g,1,{y:g.y+v,yoyo:!0,delay:.3*i,ease:Linear.easeNone,repeat:-1}),g.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCityTouch,this),c=this.changeIdMap2Vo(m),d=MapVoManager.ins.getMap(c),u=MetaMapManager.ins.getMap(d.metaId);var E="main_map_cd_effect_"+u.cityIcon,C=UtilMovieClip.getMovieClip(E+"_json",E+"_png",E);C.touchEnabled=!1,C.frameRate=8,C.x=-21,C.y=-15,g.addChild(C),C.play(-1),C.visible=!1,this.boatObj[m+""]=C}this.zoomEffect=new DDZoomEffect(new egret.Bitmap(RES.getRes("guide_figure_png"))),this.addChild(this.zoomEffect.dis),this.zoomEffect.visible=!1,this.hufuCom=new MainHuFuComponent(this.hufuSkin),TimerManager.ins.addTimer(this),this.runTimer(),this.checkGuide()},t.prototype.onCityTouch=function(e){var t=e.currentTarget,i=parseInt(t.name.split("_")[1]);GameUIUtil.showEnterMap(i)},t.prototype.checkGuide=function(){if(0==this.camp)if(2==GuideVoManager.ins.guideVo.nowStep){var e=this.cityIconObj[1006],t=UIUtil.local2Global(e);t.x=t.x+e.width/2,t.y=t.y+e.height/2+7,Guide.ins.showCircle(t.x,t.y,38)}else if(6==GuideVoManager.ins.guideVo.nowStep){var e=this.cityIconObj[1007],t=UIUtil.local2Global(e);t.x=t.x+e.width/2,t.y=t.y+e.height/2+6,Guide.ins.showCircle(t.x,t.y,38)}else if(10==GuideVoManager.ins.guideVo.nowStep){var e=this.cityIconObj[2008],t=UIUtil.local2Global(e);t.x=t.x+e.width/2,t.y=t.y+e.height/2+6,Guide.ins.showCircle(t.x,t.y,38)}},t.prototype.runTimer=function(){var e,t=0,i=0;for(var n in this.cityBarObj){var o=this.cityBarObj[n];if(t=parseInt(n),i=this.changeIdMap2Vo(t),e=MapVoManager.ins.getMap(i))if(o.visible=!0,0==e.monsterMinCD){if(o.value=o.maximum=1,1==o.$children.length){var r=MetaMapManager.ins.getMap(e.metaId),s="main_map_cd_effect_"+r.cityIcon,a=UtilMovieClip.getMovieClip(s+"_json",s+"_png",s);a.touchEnabled=!1,a.frameRate=6,o.addChildAt(a,1),a.play(-1),a.anchorOffsetX=40,a.anchorOffsetY=40,a.x=.5*o.width,a.y=.5*o.height,"main_map_cd_effect_1"==s&&(a.x=.5*o.width+2,a.y=.5*o.height+3),"main_map_cd_effect_3"==s&&(a.x=.5*o.width,a.y=.5*o.height+2)}}else{if(o.$children.length>1){var h=o.getChildAt(1);null!=h&&o.removeChild(h)}o.value=e.monsterCD-Math.max(0,e.monsterMinCD)}else o.visible=!1}for(var p in this.boatObj){var l=this.boatObj[p];t=parseInt(p),i=this.changeIdMap2Vo(t),e=MapVoManager.ins.getMap(i),e&&e.monsters.length<2?l.visible=!0:l.visible=!1}},t.prototype.initWorlMap=function(){for(var e in this.cityIconObj){var t=this.cityIconObj[e],i=parseInt(t.name.split("_")[3]),n=i;n=this.changeIdMap2Vo(i);var o=MetaMapManager.ins.getMap(n),r=MapVoManager.ins.getMap(n),s="",a=this.cityBarObj[i+""];r?(s="map_city_icon_"+o.cityIcon+"_no",a.visible=!0,0==r.monsterMinCD?a.value=a.maximum=1:(a.maximum=r.monsterCD,a.value=r.monsterCD-Math.max(0,r.monsterMinCD))):(s="map_city_locked",a.visible=!1),t.texture=RES.getRes(s),this.zoomEffect.rotation=0,r&&r.red&&(this.zoomEffect.visible=!0,this.zoomEffect.x=t.x,this.zoomEffect.y=t.y,"main_city_icon_3009"==t.name&&(this.zoomEffect.rotation=180,this.zoomEffect.x=t.x+35,this.zoomEffect.y=t.y+20))}if(Game.mapId!=GameUtil.getTaoYuanId()){var h=Game.mapId,p=this.cityObj[h+""];this.showNowCityImg(p)}},t.prototype.onTouchEnd=function(e){var t=e.currentTarget;log("img.name:"+t.source);var i=parseInt(String(t.source).split("_")[2]);i=this.changeIdMap2Vo(i);var n=MapVoManager.ins.getMap(i);if(!n)return void Alert.ins.showAlert(AlertType.ERROR,"本地图暂未开启!");var o=MetaMapManager.ins.getMap(i),r=PlayerVoManager.ins.playerVo;if(!Game.isKuaFu&&o.type==MapType.MAIN_CITY){var s=GameUtil.getMainCityIdForCamp(r.camp),a=MetaTaskManager.ins.getTask(TaskVoMananger.ins.taskVo.taskId);if(a.targetMap!=o.id&&s!=i)return void Alert.ins.showAlert(AlertType.ERROR,"您不能去其他国家主城挂机!")}this.setNowCityImg(t)},t.prototype.setNowCityImg=function(e){if(this.showNowCityImg(e),2==GuideVoManager.ins.guideVo.nowStep||6==GuideVoManager.ins.guideVo.nowStep||10==GuideVoManager.ins.guideVo.nowStep){var t=this;Guide.ins.nextStep(function(){t.sureEnterMap()},t)}else this.sureEnterMap()},t.prototype.showNowCityImg=function(e){var t=this.nowCityImg==e;if(!t&&this.nowCityImg&&(TweenMax.to(this.nowCityImg,.04,{alpha:.01}),this.mapGroup.setChildIndex(this.nowCityImg,this.nowIndex)),!t){if(this.nowCityImg=e,!this.nowCityImg)return;TweenMax.to(this.nowCityImg,.04,{alpha:1}),this.nowIndex=this.mapGroup.getChildIndex(this.nowCityImg),this.mapGroup.setChildIndex(this.nowCityImg,this.mapGroup.numChildren)}},t.prototype.sureEnterMap=function(){var e=parseInt(String(this.nowCityImg.source).split("_")[2]);e=this.changeIdMap2Vo(e),7==GuideVoManager.ins.guideVo.nowStep&&(e=1007),GameUIUtil.showEnterMap(e)},t.prototype.changeIdMap2Vo=function(e){return Game.isKuaFu&&(2e3>e?e+=8e3:3e3>e?e+=7009:4e3>e&&(e+=6018)),e},t.prototype.dispose=function(){e.prototype.dispose.call(this),TimerManager.ins.removeTimer(this);for(var t,i=this.mapGroup.numChildren,n=0;i>n;n++)t=this.mapGroup.getChildAt(n),t.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this);i=this.newCityGroup.numChildren;for(var n=0;i>n;n++){var o=this.newCityGroup.getChildAt(n);TweenMax.killTweensOf(o),o.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCityTouch,this)}this.hufuCom.dispose(),UIUtil.dispose(this)},t}(BaseComponent);__reflect(MainWorldMapComponents.prototype,"MainWorldMapComponents",["ITimer"]);var ServerListScene=function(e){function t(){var t=e.call(this)||this;return t.nowServerListVo=null,t.skinName="ServerListSceneSkin",t}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.enterGameBtn=new DDButton(this.getMc("enterGameBtn"),this.enterGame,this),this.changeServerBtn=new DDButton(this.getMc("changeServerBtn"),this.showServerList,this),this.serverNameLabel=this.getMc("serverNameLabel"),this.serverIdLabel=this.getMc("serverIdLabel"),this.stateImg=this.getMc("stateImg"),this.logoImg=this.getMc("logoImg"),this.logoImg.source=GamePlatform.ins.getLogoName()+"_png",EventCenter.ins.add(EventCenter.SELECT_SERVER,this.selectServer,this),GamePlatform.ins.getServerInfo(this.onRequestServerInfo,this)},t.prototype.onRequestServerInfo=function(e){LoadingIcon.instance.hide(),""==e.msg?(LoadingIcon.instance.show(),GamePlatform.ins.getServerList(this.onRequestServerList,this)):(GameUIUtil.showError({type:1,errContent:"  "+e.msg}),this.setNowServer(null))
},t.prototype.onRequestServerList=function(e){LoadingIcon.instance.hide(),ServerListVoManager.ins.initFromServer(e),this.updateServer(),0==ServerListVoManager.ins.recentServers.length&&this.enterGame(null)},t.prototype.updateServer=function(){var e=ServerListVoManager.ins,t=null;t=e.recentServers.length>0?e.recentServers[e.recentServers.length-1]:e.servers[0],this.setNowServer(t)},t.prototype.selectServer=function(e){var t=e.data;this.setNowServer(t)},t.prototype.setNowServer=function(e){return e?void(this.nowServerListVo!=e&&(this.nowServerListVo=e,PlayerVoManager.ins.setServer(this.nowServerListVo.serverId),GamePlatform.ins.setServerData(this.nowServerListVo),this.stateImg.source="server_list_state_"+e.serverState+"_png",this.serverIdLabel.text=e.serverId+"区",this.serverNameLabel.text=e.serverName)):(this.stateImg.source="server_list_state_0_png",this.serverIdLabel.text="",this.serverNameLabel.text="未开启",this.changeServerBtn.enabled=!1,void(this.enterGameBtn.enabled=!1))},t.prototype.enterGame=function(e){LoadingIcon.instance.show(),GamePlatform.ins.setLoginServer(this.nowServerListVo.serverId),GameUtil.login(this.nowServerListVo.ip,this.nowServerListVo.port)},t.prototype.showServerList=function(e){GameUIUtil.showServerList()},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.enterGameBtn.dispose(),this.enterGame=null,this.changeServerBtn.dispose(),this.changeServerBtn=null,EventCenter.ins.remove(EventCenter.SELECT_SERVER,this.selectServer,this),UIUtil.dispose(this)},t}(BaseScene);__reflect(ServerListScene.prototype,"ServerListScene");var ServerListScenePre=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.onRequestServerList=function(e){LoadingIcon.instance.hide(),ServerListVoManager.ins.initFromServer(e.data),this.finishPre(new ServerListScene)},t.prototype.startPre=function(){this.finishPre(new ServerListScene)},t}(BaseScenePre);__reflect(ServerListScenePre.prototype,"ServerListScenePre");var AlertData=function(){function e(){}return e}();__reflect(AlertData.prototype,"AlertData");var AlertItem=function(){function e(){this.step=0,this.speed=3}return e}();__reflect(AlertItem.prototype,"AlertItem");var Alert=function(){function e(){this.canShow=!1,this.initY=0,this.runTime=0,this.container=new egret.DisplayObjectContainer,this.bottomContainer=new egret.DisplayObjectContainer,this.container.addChild(this.bottomContainer),this.middleContainer=new egret.DisplayObjectContainer,this.container.addChild(this.middleContainer),this.topContainer=new egret.DisplayObjectContainer,this.container.addChild(this.topContainer),this.container.touchChildren=!1,this.container.touchEnabled=!1,this.bottomContainer.touchChildren=!1,this.bottomContainer.touchEnabled=!1,this.topContainer.touchChildren=!1,this.topContainer.touchEnabled=!1,this.alertArr=new Array,this.errorArr=new Array,this.items=new Array,this.initY=Game.stage.stageHeight/2-90,FrameManager.ins.addFrame(this)}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.runAlert=function(e){if(void 0===e&&(e=!1),0==this.items.length)return void(this.canShow=!0);this.runTime++;for(var t,i=0;i<this.items.length;i++)t=this.items[i],t.tf.y-=t.speed,3!=t.step?t.step<2&&t.tf.y<this.initY-260&&(t.step=2,TweenMax.to(t.tf,.3,{alpha:0,onComplete:function(e){e.step=3},onCompleteParams:[t]})):(UIUtil.removeChildFromParent(t.tf),this.items.splice(i,1));return 0==this.items.length?void(this.canShow=!0):void(0==t.step&&this.runTime>=18&&(t.step=1,this.runTime=0,this.canShow=!0,this.showAlertTF(e)))},e.prototype.runFrame=function(){this.runAlert(),this.runAlert(!0)},e.prototype.showAlertTF=function(t){if(void 0===t&&(t=!1),this.canShow&&(0!=this.alertArr.length||0!=this.errorArr.length)){this.runTime=0,this.canShow=!1;var i;i=this.errorArr.length>0?this.errorArr.shift():this.alertArr.shift();var n=new AlertItem;n.tf=new egret.TextField,n.tf.textAlign=egret.HorizontalAlign.RIGHT;var o=16777215;n.tf.size=e.ALERT_FONT_SIZE,i.type==AlertType.GET_EQUIP||AlertType.GET_OFFICER==i.type?n.tf.textFlow=i.contentArr:(n.tf.text=i.content,AlertType.ERROR==i.type?(o=16711680,n.tf.size=26):AlertType.NORMAL==i.type?o=16777215:AlertType.TIP==i.type?o=65280:AlertType.OFFICER_2_EXP==i.type?(o=16777215,n.tf.size=24):AlertType.PLAYE_ONLINE==i.type?(o=16776960,n.tf.size=26):AlertType.PROPERTY_ADD==i.type?(o=65280,n.tf.size=24):AlertType.PROPERTY_REDUCE==i.type?(o=16711680,n.tf.size=24):AlertType.KILL_PLAYER==i.type&&(n.tf.textFlow=i.contentArr,n.tf.size=24),n.tf.textColor=o,AlertType.OFFICER_2_EXP!=i.type&&(n.tf.stroke=2,n.tf.strokeColor=0)),n.tf.fontFamily="微软雅黑",n.tf.touchEnabled=!1,AlertType.ERROR==i.type?(this.topContainer.addChild(n.tf),n.speed=2.5):AlertType.OFFICER_2_EXP==i.type?(this.bottomContainer.addChild(n.tf),n.speed=1.5):(this.middleContainer.addChild(n.tf),n.speed=2),n.tf.x=Game.stage.stageWidth-n.tf.width-10,n.tf.y=this.initY,this.items.push(n)}},e.prototype.showAlert=function(t,i,n,o,r){void 0===i&&(i=""),void 0===n&&(n=null),void 0===o&&(o=""),void 0===r&&(r=null);var s=new AlertData;s.type=t,s.content=i,AlertType.GET_EQUIP==t||AlertType.GET_OFFICER==t?(s.contentArr=new Array,s.contentArr.push({text:"获得了",style:{textColor:16776960,size:e.ALERT_FONT_SIZE,stroke:1,strokeColor:0}}),s.contentArr.push({text:o,style:{textColor:n,size:e.ALERT_FONT_SIZE,stroke:1,strokeColor:0}})):AlertType.KILL_PLAYER==t&&(s.contentArr=r),s.value=n,s.name=o,AlertType.ERROR==t?this.errorArr.push(s):this.alertArr.push(s),this.showAlertTF(),this.showAlertTF(!0)},e.prototype.removeAllItems=function(){for(var e=0,t=this.items.length;t>e;e++){var i=this.items[e].tf;TweenMax.killTweensOf(i),UIUtil.removeChildFromParent(i),delete this.items[e]}this.items.length=0},e.prototype.dispose=function(){e._ins=null,FrameManager.ins.removeFrame(this),this.removeAllItems(),this.errorArr.length=0,this.alertArr.length=0},e.ALERT_FONT_SIZE=24,e._ins=null,e}();__reflect(Alert.prototype,"Alert",["IFrame"]);var GameUIUtil=function(){function e(){}return e.showServerList=function(){UIManager.ins.open(new ServerListUI)},e.showEnterMap=function(e){(new EnterMapUIPre).start(e)},e.showPlayerInfo=function(){PlayerInfoUI.isOpened||(new PlayerInfoUIPre).start()},e.showPlayerDeath=function(e){UIManager.ins.open(new PlayerDeathUI(e))},e.showEquipOfficerUI=function(e){UIManager.ins.open(new OfficerEquipUI(e))},e.showPrivateChat=function(e){UIManager.ins.open(new ChatPrivateUI(e))},e.showServerInfo=function(e){UIManager.ins.open(new ServerInfoUI(e))},e.showMagicWeaponUI=function(){(new MagicWeaponUIPre).start()},e.showTianShuUIInfo=function(e){UIManager.ins.open(new TianShuInfoUI(e))},e.showOfficerUI=function(){var e=new OfficerUIPre;UIManager.ins.openPre(e),e.start()},e.showChat=function(){Game.chat||(Game.chat=new Chat,Game.chatContainer.addChild(Game.chat))},e.closeChat=function(){Game.chat&&(Game.chatContainer.removeChild(Game.chat),Game.chat=null)},e.showShareUI=function(){(new ShareUIPre).start()},e.showCountryUI=function(){(new CountryUIPre).start()},e.showOfficerInfoUI=function(e){UIManager.ins.open(new OfficerInfoUI(e))},e.showGM=function(){GamePlatform.ins.canShowGM&&UIManager.ins.open(new GMUI)},e.showRank=function(){(new RankUIPre).start()},e.showEquip=function(){(new EquipUIPre).start()},e.showError=function(e){this.isOpenError||(this.isOpenError=!0,UIManager.ins.open(new NetErrorUI(e)))},e.showShopResult=function(e){(new ShopResultUIPre).start(e)},e.showAlertTip=function(e,t,i,n,o){void 0===t&&(t=null),void 0===i&&(i=null),void 0===n&&(n=null),void 0===o&&(o=!1),UIManager.ins.open(new AlertTipUI({contents:e,callBack:t,callBackThis:i,btnLabel:n,isShowCancel:o}))},e.showMainShare=function(){UIManager.ins.open(new MainShareUI)},e.showStrong=function(){UIManager.ins.open(new StrongUI)},e.showShop=function(e){void 0===e&&(e=1),(new ShopUIPre).start(e)},e.showMeridian=function(){(new MeridianUIPre).start()},e.showFunctionBtnGuide=function(e){},e.showQieCuo=function(){(new QieCuoUIPre).start()},e.showHoza=function(){(new HozaUIPre).start()},e.showMail=function(){(new MailUIPre).start()},e.showMailInfo=function(e){UIManager.ins.open(new MailInfoUI(e))},e.showFirstRecharge=function(){(new FirstRechargeUIPre).start()},e.showDayRecharge=function(){(new DayRechargeUIPre).start()},e.showDayFirstRecharge=function(){(new DayFirstRechargeUIPre).start()},e.showNewbieWelfare=function(){(new NewbieWelfareUIPre).start()},e.showVip=function(){(new VipUIPre).start()},e.showDay=function(){(new EveryDayUIPre).start()},e.showOffline=function(){UIManager.ins.open(new OfflineUI)},e.showOfflineProcess=function(){UIManager.ins.open(new OfflineProcessUI)},e.showOfflineResult=function(){UIManager.ins.open(new OfflineResultUI)},e.showGift=function(){UIManager.ins.open(new GiftExchangeUI)},e.showKuaFu=function(){(new KuaFuUIPre).start()},e.showTianShu=function(){(new TianShuUIPre).start()},e.showBiGuan=function(){(new BiGuanUIPre).start()},e.showHuFuShop=function(){UIManager.ins.open(new HuFuShopUI)},e.isOpenError=!1,e}();__reflect(GameUIUtil.prototype,"GameUIUtil");var AlertTipUI=function(e){function t(t){var i=e.call(this)||this;return i.tipObj=null,i.tipObj=t,i.skinName="AlertTipUISkin",i}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.contentLabel=this.getMc("contentLabel"),this.sureBtn=new DDButton(this.getMc("sureBtn"),this.onSure,this),this.cancelBtn=new DDButton(this.getMc("cancelBtn"),this.onCancel,this),this.tipObj.isShowCancel?this.cancelBtn.visible=!0:(this.sureBtn.target.horizontalCenter=0,this.cancelBtn.visible=!1),this.contentLabel.textFlow=this.tipObj.contents},t.prototype.onCancel=function(){this.close()},t.prototype.onSure=function(){this.tipObj.callBack&&this.tipObj.callBack.call(this.tipObj.callBackThis),this.close()},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.sureBtn.dispose(),this.cancelBtn.dispose(),this.sureBtn=null,this.tipObj=null,UIUtil.dispose(this)},t}(BaseUI);__reflect(AlertTipUI.prototype,"AlertTipUI");var BiGuanUI=function(e){function t(){var t=e.call(this)||this;return t.isEnterTaoYuan=!1,t.skinName="BiGuanUISkin",t}return __extends(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this.oneKeyBtn.dispose(),this.oneKeyBtn=null,this.beginBtn.dispose(),this.beginBtn=null,EventCenter.ins.remove(EventCenter.GUIDE_CHECK,this.checkGuide,this),UIUtil.dispose(this)},t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.oneKeyBtn=UIUtil.getButton("oneKeyBtn",this.skin,this.onOneKey,this),this.beginBtn=UIUtil.getButton("beginBtn",this.skin,this.onBegin,this),this.consumeGoldGroup=this.getMc("consumeGoldGroup");var t=MetaConfigManager.ins.getConfig("shilian_10_cost");UIUtil.getLabel(t+"","goldCountLabel",this.skin),EventCenter.ins.add(EventCenter.GUIDE_CHECK,this.checkGuide,this),this.checkGuide();var i=BiGuanVoManager.ins.biguanVo;i.nowFloor+10>i.maxFloor&&(this.consumeGoldGroup.visible=!1);var n=i.nowFloor+1,o=MetaMapManager.ins.getMapForFloor(n),r=MetaMonsterManager.ins.getMonster(o.monsterIds[0]);UIUtil.getLabel(o.name,"nameLabel",this.skin),UIUtil.getLabel(r.name,"npcLabel",this.skin);for(var s="",a=0;a<o.dropReses.length;a++){var h=o.dropReses[a];s+=Util.handleUnit2(h.count)+GameUtil.getResName(h.type)+" "}UIUtil.getLabel(s,"rewardLabel",this.skin);for(var p=0,l=new Array,a=0,u=o.monsterIds.length;u>a;a++){var c=MetaMonsterManager.ins.getMonster(o.monsterIds[a]);p=c.dropId,l=l.concat(MetaDropManager.ins.getDropsForType(c.dropId,ResType.OFFICER))}l=Util.delSame(l);for(var d=HozaVoManager.ins.hozaVo,f=new Array,a=0;a<l.length;a++){var g=l[a],m=MetaOfficerManager.ins.getOfficerForTypeAndLevel(g.dropId);m&&(f.push({text:m.name,style:{textColor:GameUtil.getColor(m.quality)}}),d.level<g.hozaLevel&&f.push({text:"(厚劲"+g.hozaLevel+"级)",style:{textColor:GameUtil.getColor(ColorType.RED)}}),a!=l.length-1&&f.push({text:"、"}))}var y=this.getMc("maxDropLabel");y.textFlow=f;var v=this.getMc("hozaDropLabel"),E=this.getMc("hozaDesLabel");if(d.level==MetaHozaManager.maxLevel)return v.visible=!1,void(E.visible=!1);var C=MetaDropManager.ins.getDropForHoza(p,d.level+1);if(!C)return v.visible=!1,void(E.visible=!1);var _=MetaHozaManager.ins.getHoza(d.level+1),I="厚劲"+_.id+"级"+_.name+"开启掉落：";E.text=I;var M=MetaOfficerManager.ins.getOfficerForTypeAndLevel(C.dropId,1);M?(v.text=M.name,v.textColor=GameUtil.getColor(M.quality)):v.text=""},t.prototype.checkGuide=function(){if(GuideVoManager.ins.isBiGuanStep(1)){var e=UIUtil.local2Global(this.beginBtn.target);Guide.ins.show(e.x,e.y,this.beginBtn.target.width,this.beginBtn.target.height)}else if(GuideVoManager.ins.isBiGuanStep(3)){var e=UIUtil.local2Global(this.beginBtn.target);Guide.ins.show(e.x,e.y,this.beginBtn.target.width,this.beginBtn.target.height)}},t.prototype.onOneKey=function(){var e=BiGuanVoManager.ins.biguanVo;if(e.nowFloor+10>e.maxFloor)return void Alert.ins.showAlert(AlertType.ERROR,"已通关层数不足十层");var t=PlayerVoManager.ins.getResForType(ResType.GOLD),i=MetaConfigManager.ins.getConfig("shilian_10_cost");return i>=t?void Alert.ins.showAlert(AlertType.ERROR,"元宝不足"):(LoadingIcon.instance.show(),void Game.net.sendData({cmd:BookCmd.TONG_TIAN_TA_ONE_KEY},this.sureOneKey,this))},t.prototype.returnTaoYuan=function(){var e={cmd:BookCmd.ENTER_MAP,map:GameUtil.getTaoYuanId()};LoadingIcon.instance.show(),this.isEnterTaoYuan=!0,Game.net.sendData(e,this.responseEnterMap,this)},t.prototype.sureOneKey=function(e){LoadingIcon.instance.hide(),BiGuanVoManager.ins.fromServer(e.dataVo);var t=BiGuanVoManager.ins.biguanVo,i=t.nowFloor+1;if(i>=Game.BIGUAN_MAX_FLOOR){this.onClose();var n=new Array;return n.push({text:"恭喜您！ 您今天闭关已达到最高层， 请您明天继续!"}),void GameUIUtil.showAlertTip(n,this.returnTaoYuan,this)}this.onBegin()},t.prototype.onBegin=function(){var e=BiGuanVoManager.ins.biguanVo,t=e.nowFloor+1;if(Game.battleType==BattleType.BIGUAN){var i=MetaMapManager.ins.getMap(Game.mapId);if(i.floor==t)return void Alert.ins.showAlert(AlertType.ERROR,"你已在"+t+"层试练塔!")}var n=MetaMapManager.ins.getMapForFloor(t),o={cmd:BookCmd.ENTER_MAP,map:n.id};LoadingIcon.instance.show(),Game.net.sendData(o,this.responseEnterMap,this)},t.prototype.responseEnterMap=function(e){Game.battleType=BattleType.BIGUAN,LoadingIcon.instance.hide(),MapEntityVoManager.ins.onEnterMap(e.dataVo);var t=0;if(this.isEnterTaoYuan)t=GameUtil.getTaoYuanId();else{var i=BiGuanVoManager.ins.biguanVo,n=i.nowFloor+1,o=MetaMapManager.ins.getMapForFloor(n);t=o.id}(GuideVoManager.ins.isBiGuanStep(1)||GuideVoManager.ins.isBiGuanStep(3))&&Guide.ins.nextStep2(),EventCenter.ins.send(EventCenter.ENTER_MAP,t),UIManager.ins.close(this)},t}(BaseUI);__reflect(BiGuanUI.prototype,"BiGuanUI");var BiGuanUIPre=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.startPre=function(){LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.TONG_TIAN_TA_PANEL},this.onTongtianta,this)},t.prototype.onTongtianta=function(e){LoadingIcon.instance.hide();var t=e.dataVo;return BiGuanVoManager.ins.fromServer(t),BiGuanVoManager.ins.biguanVo.nowFloor>=Game.BIGUAN_MAX_FLOOR?void Alert.ins.showAlert(AlertType.TIP,"恭喜您已经达到最高层!"):void this.finishPre(new BiGuanUI)},t}(PreUIBase);__reflect(BiGuanUIPre.prototype,"BiGuanUIPre");var DayFirstRechargeUI=function(e){function t(){var t=e.call(this)||this;return t.skinName="DayFirstRechargeUISkin",t}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.scroller=this.getMc("scroller"),this.group=this.getMc("group"),this.btn=UIUtil.getButton("btn",this.skin,this.onBtn,this),this.updateList(),this.upateBtn()},t.prototype.upateBtn=function(){var e=RechargeRewardVoManager.ins.dayFirstRewardState;0==e?this.btn.btnImg.source="recharge_btn_up":1==e&&(this.btn.btnImg.source="recharge_get_btn_up")},t.prototype.updateList=function(){for(var e,t=MetaRecharRewardManager.ins.getType(RechargeRewardType.DAY_FIRST_RECHARGE),i=t[0],n=0,o=i.rewards.length;o>n;n++)e=new RechargePropItem(i.rewards[n]),this.group.addChild(e)},t.prototype.onBtn=function(e){var t=RechargeRewardVoManager.ins.dayFirstRewardState;if(0==t){if(!VoUtil.checkFunctionOpen(FunctionId.SHOP)){var i=MetaFunctionOpenManager.ins.getOpenForFunctionId(FunctionId.SHOP);return void Alert.ins.showAlert(AlertType.ERROR,"藏宝需要玩家等级达到"+i.openLevel+"级")}GameUIUtil.showShop(2),this.onClose()}else LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.DAY_FIRST_RECHARGE_GET_REWARD},this.onGetReward,this)},t.prototype.onGetReward=function(e){LoadingIcon.instance.hide(),GameUtil.handleBags(e.dataVo.dtoList),RechargeRewardVoManager.ins.updateDayFirst(2),this.onClose()},t.prototype.dispose=function(){e.prototype.dispose.call(this),UIUtil.dispose(this.group),this.group=null,this.btn.dispose(),this.btn=null,UIUtil.destroyRes(t.RES_NAME),UIUtil.dispose(this),t.guangQuan=!1,EventCenter.ins.send(EventCenter.CLISE_GUANG_QUAN)},t.RES_NAME="recharge",t.guangQuan=!0,t}(BaseUI);__reflect(DayFirstRechargeUI.prototype,"DayFirstRechargeUI");var DayFirstRechargeUIPre=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.startPre=function(){UIResLoading.loadReses(DayFirstRechargeUI.RES_NAME,this.onRequestInfo,this)},t.prototype.onRequestInfo=function(){LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.DAY_FIRST_RECHARGE_PANEL},this.onDayFirstRecharge,this)},t.prototype.onDayFirstRecharge=function(e){LoadingIcon.instance.hide(),log("dayFirstRecharge:"+e.dataVo.id),RechargeRewardVoManager.ins.updateDayFirst(e.dataVo.id),this.finishPre(new DayFirstRechargeUI)},t}(PreUIBase);__reflect(DayFirstRechargeUIPre.prototype,"DayFirstRechargeUIPre");var DayRechargeUI=function(e){function t(){var t=e.call(this)||this;return t.skinName="DayRechargeUISkin",t}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.scroller=this.getMc("scroller"),this.group=this.getMc("group"),this.topCom=new UITopComponent(this.skin.topBoard),this.dayRechargeLabel=this.getMc("dayRechargeLabel"),this.noLabel=this.getMc("noLabel"),EventCenter.ins.add(EventCenter.RECHARGE_REWARD_CLICK_ITEM,this.onRechargeRewardClickItem,this),this.dayRechargeLabel.text=RechargeRewardVoManager.ins.dayRechargeRewardVo.dayPayCount+"元 ",this.updateList()},t.prototype.dispose=function(){e.prototype.dispose.call(this),EventCenter.ins.remove(EventCenter.RECHARGE_REWARD_CLICK_ITEM,this.onRechargeRewardClickItem,this),UIUtil.dispose(this.group),this.group=null,UIUtil.destroyRes(t.RES_NAME),UIUtil.dispose(this),t.guangQuan=!1,EventCenter.ins.send(EventCenter.CLISE_GUANG_QUAN)},t.prototype.onRechargeRewardClickItem=function(e){var t=e.data;this.metaId=t.id;var i=RechargeRewardVoManager.ins.dayRechargeRewardVo,n=t.rmb-i.dayPayCount;if(0>=n)LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.DAY_RECHARGE_GET_REWARD,id:t.id},this.onGetReward,this);else{if(!VoUtil.checkFunctionOpen(FunctionId.SHOP)){var o=MetaFunctionOpenManager.ins.getOpenForFunctionId(FunctionId.SHOP);return void Alert.ins.showAlert(AlertType.ERROR,"充值需要玩家等级达到"+o.openLevel+"级")}this.onClose(),GameUIUtil.showShop(2)}},t.prototype.onGetReward=function(e){LoadingIcon.instance.hide(),GameUtil.handleBags(e.dataVo.dtoList),RechargeRewardVoManager.ins.rechargeGetReward(this.metaId),this.updateList()},t.prototype.updateList=function(){UIUtil.dispose(this.group);var e=RechargeRewardVoManager.ins.getDayListGroup(RechargeRewardType.RECHARGE);if(0==e.length)return this.noLabel.visible=!0,void EventCenter.ins.send(EventCenter.RECHARGE_REWARD_UPDATE);for(var t=0,i=e.length;i>t;t++){var n=new DayRechargeListItem(e[t]);this.group.addChild(n)}},t.RES_NAME="recharge",t.guangQuan=!0,t}(BaseUI);__reflect(DayRechargeUI.prototype,"DayRechargeUI");var DayRechargeUIPre=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.startPre=function(){UIResLoading.loadReses("recharge",this.onRequestInfo,this)},t.prototype.onRequestInfo=function(){LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.DAY_RECHARGE_PANEL},this.onDayRecharge,this)},t.prototype.onDayRecharge=function(e){LoadingIcon.instance.hide(),RechargeRewardVoManager.ins.initDayRechargeReward(e.dataVo),this.finishPre(new DayRechargeUI)},t}(PreUIBase);__reflect(DayRechargeUIPre.prototype,"DayRechargeUIPre");var FirstRechargeUI=function(e){function t(){var t=e.call(this)||this;return t.skinName="FirstRechargeUISkin",t}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.scroller=this.getMc("scroller"),this.group=this.getMc("group"),this.btn=UIUtil.getButton("btn",this.skin,this.onBtn,this),this.updateList(),this.updateBtn()},t.prototype.updateBtn=function(){var e=RechargeRewardVoManager.ins.firstRewardState;0==e?(this.btn.btnImg.source="recharge_btn_up",this.btn.btnImg.source.down="recharge_btn_up"):1==e&&(this.btn.btnImg.source="recharge_get_btn_up",this.btn.btnImg.source.down="recharge_get_btn_up")},t.prototype.updateList=function(){for(var e,t=MetaRecharRewardManager.ins.getType(RechargeRewardType.FIRST_RECHARGE),i=t[0],n=0,o=i.rewards.length;o>n;n++)e=new RechargePropItem(i.rewards[n]),this.group.addChild(e)},t.prototype.onBtn=function(e){var t=RechargeRewardVoManager.ins.firstRewardState;if(0==t){if(!VoUtil.checkFunctionOpen(FunctionId.SHOP)){var i=MetaFunctionOpenManager.ins.getOpenForFunctionId(FunctionId.SHOP);return void Alert.ins.showAlert(AlertType.ERROR,"藏宝需要玩家等级达到"+i.openLevel+"级")}GameUIUtil.showShop(2),this.onClose()}else LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.FIRST_RECHARGE_GET_REWARD},this.onGetReward,this)},t.prototype.onGetReward=function(e){LoadingIcon.instance.hide(),RechargeRewardVoManager.ins.updateFirst(2),GameUtil.handleBags(e.dataVo.dtoList),this.onClose()},t.prototype.dispose=function(){e.prototype.dispose.call(this),UIUtil.destroyRes(t.RES_NAME),UIUtil.dispose(this.group),this.group=null,this.btn.dispose(),this.btn=null,UIUtil.dispose(this),t.guangQuan=!1,EventCenter.ins.send(EventCenter.CLISE_GUANG_QUAN)},t.RES_NAME="recharge",t.guangQuan=!0,t}(BaseUI);__reflect(FirstRechargeUI.prototype,"FirstRechargeUI");var FirstRechargeUIPre=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.startPre=function(){UIResLoading.loadReses("recharge",this.onRequestInfo,this)},t.prototype.onRequestInfo=function(){LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.FIRST_RECHARGE_PANEL},this.onFirstRecharge,this)},t.prototype.onFirstRecharge=function(e){LoadingIcon.instance.hide(),RechargeRewardVoManager.ins.updateFirst(e.dataVo.id),log("onFirstRecharge:"+e.dataVo.id),this.finishPre(new FirstRechargeUI)},t}(PreUIBase);__reflect(FirstRechargeUIPre.prototype,"FirstRechargeUIPre");var DayRechargeListItem=function(e){function t(t){var i=e.call(this)||this;return i.metaRechargeReward=t,i.skinName="resource/skins/ui/recharge/list/DayRechargeListItemSkin.exml",i.addEventListener(eui.UIEvent.CREATION_COMPLETE,i.onCreated,i),i.addEventListener(egret.Event.REMOVED_FROM_STAGE,i.onRemoved,i),i}return __extends(t,e),t.prototype.onRemoved=function(e){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.onCreated,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this)},t.prototype.onCreated=function(e){this.operBtn=UIUtil.getButton("btn",this,this.onBtn,this);var t=this.metaRechargeReward.rewards[0],i=GameUtil.getResObj(t.type,t.staticId);this.iconImg.source=i.iconResName;var n=new Array;i.type==ResType.OFFICER||i.type==ResType.EQUIP?(n.push({text:i.name,style:{textColor:GameUtil.getColor(i.color)}}),n.push({text:"+"+Util.handleUnit2(t.count)})):n.push({text:i.name+"+"+Util.handleUnit2(t.count)}),this.titleLabel.textFlow=n,this.updateView()},t.prototype.updateView=function(){var e=(RechargeRewardVoManager.ins.hasRechargeGetReward(this.metaRechargeReward.id),RechargeRewardVoManager.ins.dayRechargeRewardVo),t=e.dayPayCount-this.metaRechargeReward.rmb;t>=0?(this.desLabel.visible=!1,this.operBtn.label="可领取"):(this.desLabel.text="再充值 "+Math.abs(t)+"元 可领取",this.operBtn.label="去充值")},t.prototype.onBtn=function(e){EventCenter.ins.send(EventCenter.RECHARGE_REWARD_CLICK_ITEM,this.metaRechargeReward)},t}(eui.ItemRenderer);__reflect(DayRechargeListItem.prototype,"DayRechargeListItem");var DayRechargeListItemRender=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/ui/recharge/list/DayRechargeListItemSkin.exml",t.addEventListener(eui.UIEvent.CREATION_COMPLETE,t.onCreated,t),t}return __extends(t,e),t.prototype.onCreated=function(){this.operBtn=UIUtil.getButton("btn",this,this.onBtn,this)},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.rewardObj=this.data.rewards[0];var t=GameUtil.getResObj(this.rewardObj.type,this.rewardObj.staticId);this.iconImg.source=t.iconResName;var i=new Array;t.type==ResType.OFFICER||t.type==ResType.EQUIP?(i.push({text:t.name,style:{textColor:GameUtil.getColor(t.color)}}),i.push({text:"+"+Util.handleUnit2(this.rewardObj.count)})):i.push({text:t.name+"+"+Util.handleUnit2(this.rewardObj.count)}),this.titleLabel.textFlow=i;var n=(RechargeRewardVoManager.ins.hasRechargeGetReward(this.data.id),RechargeRewardVoManager.ins.dayRechargeRewardVo),o=n.dayPayCount-this.data.rmb;o>=0?(this.desLabel.visible=!1,this.operBtn.label="可领取"):(this.desLabel.text="再充值 "+Math.abs(o)+"元 可领取",this.operBtn.label="去充值")},t.prototype.onBtn=function(e){EventCenter.ins.send(EventCenter.RECHARGE_REWARD_CLICK_ITEM,this.data)},t}(eui.ItemRenderer);__reflect(DayRechargeListItemRender.prototype,"DayRechargeListItemRender");var RechargePropItem=function(e){function t(t){var i=e.call(this)||this;return i.itemObj=null,i.itemObj=t,i.skinName="resource/skins/ui/recharge/list/RechargePropItemSkin.exml",i.addEventListener(eui.UIEvent.CREATION_COMPLETE,i.onCreated,i),i.addEventListener(egret.Event.REMOVED_FROM_STAGE,i.onRemoved,i),i}return __extends(t,e),t.prototype.onCreated=function(e){var t=GameUtil.getResObj(this.itemObj.type,this.itemObj.staticId);this.iconImg.source=t.iconResName;var i=new Array;t.type==ResType.OFFICER||t.type==ResType.EQUIP?(i.push({text:t.name,style:{textColor:GameUtil.getColor(t.color)}}),i.push({text:"+"+Util.handleUnit2(this.itemObj.count)})):i.push({text:t.name+"+"+Util.handleUnit2(this.itemObj.count)}),this.nameLabel.textFlow=i},t.prototype.onRemoved=function(e){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.onCreated,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this)},t}(eui.Component);__reflect(RechargePropItem.prototype,"RechargePropItem");var CountryUI=function(e){function t(t){var i=e.call(this)||this;return i.remainderTime=t,i.items=new Array,i.skinName="CountryUISkin",i}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.changeCom=new CountryChangeComponent(this.getMc("changeCom"),this.remainderTime),this.changeCom.updateTime(this.remainderTime),this.changeCom.updateBtns(),this.selectedCom=new CountrySelectedComponent(this.getMc("selectedCom")),this.cityGroup=this.getMc("cityGroup"),EventCenter.ins.add(EventCenter.SURE_ENTER_MAP,this.onEnterMap,this),EventCenter.ins.add(EventCenter.UPDATE_CAMP,this.updateCampList,this),EventCenter.ins.add(EventCenter.COUNTRY_ITEM_CLICK,this.onItemClick,this),this.updateCampList(),TimerManager.ins.addTimer(this)},t.prototype.onItemClick=function(e){var t=e.data;GameUIUtil.showEnterMap(t)},t.prototype.getCityForId=function(e){for(var t=null,i=0,n=this.items.length;n>i;i++)if(t=this.items[i],t.mapVo.metaId==e)return t;return null},t.prototype.updateCampList=function(){UIUtil.dispose(this.cityGroup),this.items.length=0;for(var e=MetaMapManager.ins.getMapForCountry(PlayerVoManager.ins.playerVo.camp),t=new Array,i=0,n=e.length;n>i;i++){var o=MapVoManager.ins.getMap(e[i].id);o&&t.push(e[i])}t.sort(GameUtil.sortCountry);for(var r,i=0,n=t.length;n>i;i++)r=new CountryCityListItem(t[i]),this.items.push(r),this.cityGroup.addChild(r);this.runTimer();var s=this.getCityForId(Game.mapId);s&&s.showPlace(!0)},t.prototype.runTimer=function(){for(var e,t=0,i=this.items.length;i>t;t++)e=this.items[t],e.runTime()},t.prototype.onEnterMap=function(e){this.onClose()},t.prototype.dispose=function(){e.prototype.dispose.call(this),EventCenter.ins.remove(EventCenter.SURE_ENTER_MAP,this.onEnterMap,this),EventCenter.ins.remove(EventCenter.UPDATE_CAMP,this.updateCampList,this),EventCenter.ins.remove(EventCenter.COUNTRY_ITEM_CLICK,this.onItemClick,this),UIUtil.dispose(this.cityGroup),this.cityGroup=null,TimerManager.ins.removeTimer(this),this.changeCom.dispose(),this.changeCom=null,this.selectedCom.dispose(),this.selectedCom=null,UIUtil.dispose(this)},t}(BaseUI);__reflect(CountryUI.prototype,"CountryUI",["ITimer"]);var CountryUIPre=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.startPre=function(){LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.GET_MAP_LIST},this.onRequestWorldMap,this)},t.prototype.onRequestWorldMap=function(e){MapVoManager.ins.fromServer(e.dataVo.maps),Game.net.sendData({cmd:BookCmd.COUNTRY_PANEL},this.onCountryPanel,this)},t.prototype.onCountryPanel=function(e){LoadingIcon.instance.hide();var t=e.dataVo;UIManager.ins.open(new CountryUI(t.cd))},t}(PreUIBase);__reflect(CountryUIPre.prototype,"CountryUIPre");var CountryCityListItem=function(e){function t(t){var i=e.call(this)||this;return i.metaMap=t,i.mapVo=MapVoManager.ins.getMap(i.metaMap.id),i.skinName="resource/skins/ui/country/common/CountryCityItemSkin.exml",i.addEventListener(eui.UIEvent.CREATION_COMPLETE,i.onCreated,i),i.addEventListener(egret.Event.REMOVED_FROM_STAGE,i.onRemoved,i),i.addEventListener(egret.TouchEvent.TOUCH_TAP,i.onTouch,i),i}return __extends(t,e),t.prototype.showPlace=function(e){this.placeImg.visible=e,TweenMax.killTweensOf(this.placeImg),e&&TweenMax.to(this.placeImg,.6,{y:this.y-4,yoyo:!0,repeat:-1})},t.prototype.runTime=function(){this.mapVo.monsterMinCD>0?(this.timeLabel.visible=!0,this.timeLabel.text=DateUtils.getTimeStr2(this.mapVo.monsterMinCD)):this.timeLabel.visible=!1},t.prototype.onTouch=function(e){EventCenter.ins.send(EventCenter.COUNTRY_ITEM_CLICK,this.metaMap.id)},t.prototype.onCreated=function(){this.cityImg.source="country_city_icon_"+this.metaMap.cityIcon+"_png",this.nameLabel.text=this.metaMap.name},t.prototype.onRemoved=function(e){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.onCreated,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)},t}(eui.Component);__reflect(CountryCityListItem.prototype,"CountryCityListItem");var CountryChangeComponent=function(e){function t(t,i){void 0===i&&(i=null);var n=e.call(this,t,i)||this;return n.btn1Camp=0,n.btn2Camp=0,n.remainderTime=0,n}return __extends(t,e),t.prototype.runTimer=function(){this.remainderTime--,this.updateTimeLabel()},t.prototype.updateTimeLabel=function(){this.remainderTime<=0?(this.timeLabel.textColor=1048320,this.timeLabel.text="可更换",TimerManager.ins.removeTimer(this)):(this.timeLabel.textColor=16777215,this.timeLabel.text=DateUtils.getTimeStr3(this.remainderTime))},t.prototype.updateTime=function(e){this.remainderTime=Math.floor(.001*e),this.updateTimeLabel()},t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.timeLabel=UIUtil.getLabel("00:00:00","timeLabel",this.skin),this.costLabel=UIUtil.getLabel(Game.COUNTRY_CHANGE_GOLD+"元宝","costLabel",this.skin),this.enter1Btn=UIUtil.getButton("enter1Btn",this.skin,this.onEnter1,this),this.enter2Btn=UIUtil.getButton("enter2Btn",this.skin,this.onEnter2,this),TimerManager.ins.addTimer(this)},t.prototype.updateBtns=function(){var e=PlayerVoManager.ins.playerVo;e.camp==Camp.WEI?(this.enter1Btn.labelDisplay.text="加入吴国",this.enter2Btn.labelDisplay.text="加入蜀国",this.btn1Camp=Camp.WU,this.btn2Camp=Camp.SHU):Camp.SHU==e.camp?(this.enter1Btn.labelDisplay.text="加入吴国",this.enter2Btn.labelDisplay.text="加入魏国",this.btn1Camp=Camp.WU,this.btn2Camp=Camp.WEI):(this.enter1Btn.labelDisplay.text="加入魏国",this.enter2Btn.labelDisplay.text="加入蜀国",this.btn1Camp=Camp.WEI,this.btn2Camp=Camp.SHU)
},t.prototype.onEnter1=function(){this.enterCamp(this.btn1Camp)},t.prototype.onEnter2=function(){this.enterCamp(this.btn2Camp)},t.prototype.enterCamp=function(e){return this.remainderTime>0?void Alert.ins.showAlert(AlertType.ERROR,"更换国家CD未到!"):PlayerVoManager.ins.playerVo.gold<Game.COUNTRY_CHANGE_GOLD?void Alert.ins.showAlert(AlertType.ERROR,"元宝不足!"):(LoadingIcon.instance.show(),void Game.net.sendData({cmd:BookCmd.COUNTRY_CHANGE_RESULT,country:e},this.onEnterCamp,this))},t.prototype.onEnterCamp=function(e){LoadingIcon.instance.hide();var t=e.dataVo,i=GameUtil.getCampName(t.country);Alert.ins.showAlert(AlertType.TIP,"恭喜您成功加入"+i+"国"),PlayerVoManager.ins.setCamp(t.country),this.remainderTime=Math.floor(.001*t.cd),this.updateTimeLabel(),TimerManager.ins.addTimer(this),this.updateBtns()},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.enter1Btn.dispose(),this.enter2Btn.dispose(),TimerManager.ins.removeTimer(this)},t}(BaseSkin);__reflect(CountryChangeComponent.prototype,"CountryChangeComponent",["ITimer"]);var CountrySelectedComponent=function(e){function t(t,i){return void 0===i&&(i=null),e.call(this,t,i)||this}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.countryImg=this.getMc("countryImg"),EventCenter.ins.add(EventCenter.UPDATE_CAMP,this.onUpdateCamp,this),this.updateCountry()},t.prototype.onUpdateCamp=function(){this.updateCountry()},t.prototype.updateCountry=function(){var e=PlayerVoManager.ins.playerVo,t=this.countryImg.source;RES.destroyRes(t),this.countryImg.source="camp_"+e.camp+"_bg_png"},t.prototype.dispose=function(){e.prototype.dispose.call(this);var t=this.countryImg.source;RES.destroyRes(t)},t}(BaseSkin);__reflect(CountrySelectedComponent.prototype,"CountrySelectedComponent");var CountryCityListItemRender=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/ui/country/common/CountryCityItemSkin.exml",t}return __extends(t,e),t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this);var t=this.data;this.cityImg.source="country_city_icon_"+t.cityIcon+"_png",this.nameLabel.text=t.name},t}(eui.ItemRenderer);__reflect(CountryCityListItemRender.prototype,"CountryCityListItemRender");var EveryDayUI=function(e){function t(){var t=e.call(this)||this;return t.operIndex=-1,t.btnIndex=0,t.signId=0,t.skinName="EveryDayUISkin",t}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.topCom=new UITopComponent(this.skin.topBoard),this.continueDesLabel=UIUtil.getLabel("","continueDesLabel",this.skin),this.continueValueLabel=UIUtil.getLabel("","continueValueLabel",this.skin),this.rewardDesLabel=UIUtil.getLabel("","rewardDesLabel",this.skin),this.signBtn=UIUtil.getButton("signBtn",this.skin,this.onMenuClick,this),this.rechargeBtn=UIUtil.getButton("rechargeBtn",this.skin,this.onMenuClick,this),this.adImg=this.getMc("adImg"),this.list=this.getMc("list"),this.list.itemRenderer=EveryDayListItemRender,this.updateList(),this.setBtnState(),EventCenter.ins.add(EventCenter.DAY_BTN_CLICK,this.onDayClick,this)},t.prototype.setBtnState=function(e){void 0===e&&(e=0),this.signBtn.currentState="up",this.rechargeBtn.currentState="up",0==e?this.signBtn.currentState="down":this.rechargeBtn.currentState="down"},t.prototype.onMenuClick=function(e){var t=e.currentTarget;switch(t.name){case"signBtn":this.updateList(0),this.btnIndex=0,this.adImg.source="day_3_png";break;case"rechargeBtn":this.updateList(1),this.btnIndex=1,this.adImg.source="day_2_png"}this.setBtnState(this.btnIndex)},t.prototype.updateList=function(e){void 0===e&&(e=0),this.operIndex!=e&&(this.operIndex=e,0==this.operIndex?(this.continueDesLabel.text="当前连续签到：",this.continueValueLabel.text=DayVoManager.ins.dayVo.signedDay+"天",this.rewardDesLabel.text="中断签到将重新累计天数"):1==this.operIndex&&(this.continueDesLabel.text="当前连续充值：",this.continueValueLabel.text=DayVoManager.ins.dayVo.rechargeDay+"天",this.rewardDesLabel.text="当天充值任意金额可领取奖励"),this.list.dataProvider=new eui.ArrayCollection(MetaDayManager.ins.getDaysForType(this.operIndex+1)))},t.prototype.onDayClick=function(e){this.signId=e.data;var t=MetaDayManager.ins.getDay(this.signId);return 2==t.type?(this.onClose(),void GameUIUtil.showShop(2)):(LoadingIcon.instance.show(),void Game.net.sendData({cmd:BookCmd.DAY_SIGN_OR_RECHARGE,type:t.type},this.onSign,this))},t.prototype.onSign=function(e){LoadingIcon.instance.hide(),log("onSign........signid:"+this.signId);var t=e.dataVo.dtoList;GameUtil.handleBags(t),DayVoManager.ins.sign(this.signId),this.operIndex=-1,this.updateList(this.btnIndex)},t.prototype.dispose=function(){e.prototype.dispose.call(this),EventCenter.ins.remove(EventCenter.DAY_BTN_CLICK,this.onDayClick,this),this.signBtn.dispose(),this.signBtn=null,this.rechargeBtn.dispose(),this.rechargeBtn=null,this.list.dataProvider=null,this.topCom.dispose(),this.topCom=null,UIUtil.destroyRes(t.RES_NAME),UIUtil.dispose(this)},t.RES_NAME="day",t}(BaseUI);__reflect(EveryDayUI.prototype,"EveryDayUI");var EveryDayUIPre=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.startPre=function(){UIResLoading.loadReses(EveryDayUI.RES_NAME,this.onRequestInfo,this)},t.prototype.onRequestInfo=function(){LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.DAY_PANEL,type:SignType.SIGN},this.onSignPanel,this)},t.prototype.onSignPanel=function(e){DayVoManager.ins.fromServer(e.dataVo,SignType.SIGN),Game.net.sendData({cmd:BookCmd.DAY_PANEL,type:SignType.RECHARGE},this.onRechargePanel,this)},t.prototype.onRechargePanel=function(e){LoadingIcon.instance.hide(),DayVoManager.ins.fromServer(e.dataVo,SignType.RECHARGE),this.finishPre(new EveryDayUI)},t}(PreUIBase);__reflect(EveryDayUIPre.prototype,"EveryDayUIPre");var EveryDayListItemRender=function(e){function t(){var t=e.call(this)||this;return t.hasDo=!0,t.skinName="resource/skins/ui/day/list/EveryDayListItemSkin.exml",t.addEventListener(eui.UIEvent.CREATION_COMPLETE,t.onCreated,t),t.addEventListener(egret.Event.REMOVED_FROM_STAGE,t.dispose,t),t}return __extends(t,e),t.prototype.dispose=function(e){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.onCreated,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.dispose,this),this.btn.dispose()},t.prototype.onCreated=function(){this.btn=UIUtil.getButton("btn",this,this.onBtn,this)},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this);var t=this.data,i="gold_icon_recharge",n=GameUtil.getResName(t.rewardType),o=new Array;t.type==SignType.SIGN?(o.push({text:"连续签到"}),o.push({text:t.needDay+"天",style:{textColor:Constants.COLOR_GREEN}}),o.push({text:"可领取"}),this.titleLabel.textFlow=o):SignType.RECHARGE==t.type&&(o.push({text:"连续充值"}),o.push({text:t.needDay+"天",style:{textColor:Constants.COLOR_GREEN}}),o.push({text:"可领取"}),this.titleLabel.textFlow=o),o=new Array,ResType.GOLD==t.rewardType?(i="yuanbao_big_icon",o.push({text:t.rewardCount+n})):ResType.WARTH==t.rewardType?(i="zhanyi_big_icon",o.push({text:t.rewardCount+n})):0==t.rewardType?(o.push({text:GameUtil.getColorName(ColorType.RED)+"色",style:{textColor:GameUtil.getColor(ColorType.RED)}}),o.push({text:"神将卡*"+t.rewardOfficerCount,style:{textColor:GameUtil.getColor(ColorType.RED)}}),i="random_big_wujiang"):ResType.SILVER==t.rewardType&&(i="yinliang_big_icon",o.push({text:t.rewardCount+n})),this.desLabel.textFlow=o,this.iconImg.source=i;var r=DayVoManager.ins.dayVo;if(t.type==SignType.RECHARGE){var s=r.rechargeDay;if(0==s)return void(1==t.needDay?(this.btn.label="去充值",this.btn.enabled=!0):(this.btn.label="未达成",this.btn.enabled=!1));s>t.needDay?(this.btn.label="已领取",this.btn.enabled=!1):s==t.needDay?r.hasRecharge:s<t.needDay&&(s+1==t.needDay?r.hasRecharge?(this.btn.label="未达成",this.btn.enabled=!1):(this.btn.label="去充值",this.btn.enabled=!0):(this.btn.label="未达成",this.btn.enabled=!1))}else{var a=r.signedDay;if(0==a)return void(1==t.needDay?(this.btn.label="签到",this.btn.enabled=!0):(this.btn.label="未达成",this.btn.enabled=!1));a>=t.needDay?(this.btn.label="已签到",this.btn.enabled=!1):a+1==t.needDay?r.hasSigned?(this.btn.label="未达成",this.btn.enabled=!1):(this.btn.label="签到",this.btn.enabled=!0):(this.btn.label="未达成",this.btn.enabled=!1)}},t.prototype.onBtn=function(e){EventCenter.ins.send(EventCenter.DAY_BTN_CLICK,this.data.id)},t}(eui.ItemRenderer);__reflect(EveryDayListItemRender.prototype,"EveryDayListItemRender");var EnterMapPanelUI=function(e){function t(t){var i=e.call(this)||this;return i.beginLogTime=!1,i.timeIndex=0,i.campBtnType=ChatType.CAMP,i.helpMapId=0,i.chatVo=t,i.skinName=EnterMapPanelSkin,i.once(egret.Event.ADDED_TO_STAGE,i.initView,i),i.once(egret.Event.REMOVED_FROM_STAGE,i.onRemoved,i),i}return __extends(t,e),t.prototype.onRemoved=function(){this.removeEventListener(eui.UIEvent.COMPLETE,this.initView,this),DisposeHelper.ins.disposeMc(this),this.confirm_btn.dispose(),this.confirm_btn=null,this.cancel_btn.dispose(),this.cancel_btn=null,TimerManager.ins.removeTimer(this)},t.prototype.initView=function(){this.touchEnabled=!1,this.confirm_btn=UIUtil.getButton("confirm_btn",this,this.gotoMapHandler,this),this.cancel_btn=UIUtil.getButton("cancel_btn",this,this.cancelHandler,this);var e=this.chatVo,t=new Array,i=null;t.push({text:GameUtil.getCampName(e.camp)+"国",style:{textColor:GameUtil.getCampColor(e.camp)}}),t.push({text:GameUtil.getPlayerJob(e.camp,e.rank).name+e.serverId+"-"}),t.push({text:e.playerName}),t.push({text:"进入了"}),i=MetaMapManager.ins.getMap(parseInt(e.content)),t.push({text:i.name,style:{textColor:GameUtil.getColor(ColorType.ORANGE)}}),t.push({text:"，是否跟随？"}),this.heroEnterLabel.textFlow=t,TimerManager.ins.addTimer(this)},t.prototype.runTimer=function(){this.beginLogTime&&(this.timeIndex++,3==this.timeIndex&&this.cancelHandler())},t.prototype.beginTime=function(){this.beginLogTime=!0,this.timeIndex=0},t.prototype.cancelHandler=function(){this.beginLogTime=!1,this.timeIndex=0,EventCenter.ins.send(EventCenter.CANCEL_GOTO_MAP)},t.prototype.gotoMapHandler=function(e){var t=this.chatVo,i=parseInt(t.content),n=MetaMapManager.ins.getMap(i),o=MapVoManager.ins.getMap(i);return o?Game.mapId==i?void Alert.ins.showAlert(AlertType.NORMAL,"您已经在地图"+n.name+"中!"):(this.gotoHelpAttack(t),void EventCenter.ins.send(EventCenter.CONFIRM_GOTO_MAP)):void Alert.ins.showAlert(AlertType.ERROR,"您还没开启地图"+n.name)},t.prototype.gotoHelpAttack=function(e){LoadingIcon.instance.show(),this.helpMapId=parseInt(e.content),Game.net.sendData({cmd:BookCmd.COMMON_MAP_RESULT,map:this.helpMapId},this.onGotoHelpAttack,this)},t.prototype.onGotoHelpAttack=function(e){LoadingIcon.instance.hide();e.dataVo;GameUIUtil.showEnterMap(this.helpMapId)},t}(eui.Component);__reflect(EnterMapPanelUI.prototype,"EnterMapPanelUI",["ITimer"]);var EnterMapUI=function(e){function t(t){var i=e.call(this)||this;return i.isEntermap=!1,i.timeItems=new Array,i.mapId=t,i.skinName="EnterMapUISkin",i}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.metaMap=MetaMapManager.ins.getMap(this.mapId),this.mapVo=MapVoManager.ins.getMap(this.metaMap.id);PlayerVoManager.ins.playerVo;this.desLabel=this.getMc("desLabel"),this.consumeGroup=this.getMc("consumeGroup"),this.cdLabel=this.getMc("cdLabel"),this.nameLabel=UIUtil.getLabel(this.metaMap.name,"nameLabel",this.skin),this.enterBtn=UIUtil.getButton("enterBtn",this.skin,this.onEnterMap,this);for(var t=new Array,i="",n=new Array,o=0;o<this.metaMap.dropReses.length;o++){var r=this.metaMap.dropReses[o];i+=1==o?Util.handleUnit2(r.count)+GameUtil.getResName(r.type)+"\n":Util.handleUnit2(r.count)+GameUtil.getResName(r.type)+(o%2==0?"、":"")}this.metaMap.dropReses.length>0&&(n.push({text:i}),t.push({name:"固定奖励：",value:n}));var s=new Array,a=new Array,h=new Array;this.monsterIds=this.metaMap.monsterIds,0==this.monsterIds.length&&(this.monsterIds=MetaTimingManager.ins.getTimingForMap(this.metaMap.id).monsterIds);for(var o=0,p=this.monsterIds.length;p>o;o++){var l=MetaMonsterManager.ins.getMonster(this.monsterIds[o]);s=s.concat(MetaDropManager.ins.getDropsForType(l.dropId,ResType.EQUIP)),a=a.concat(MetaDropManager.ins.getDropsForType(l.dropId,ResType.OFFICER)),h=h.concat(MetaDropManager.ins.getDropsForType(l.dropId,ResType.PROP))}s=Util.delSame(s),a=Util.delSame(a),h=Util.delSame(h);for(var u=HozaVoManager.ins.hozaVo,c=null,d=new Array,o=0;o<a.length;o++){c=a[o];var f=MetaOfficerManager.ins.getOfficerForTypeAndLevel(c.dropId);f&&(d.push({text:f.name,style:{textColor:GameUtil.getColor(f.quality)}}),u.level<c.hozaLevel&&d.push({text:"(厚劲"+c.hozaLevel+"级)",style:{textColor:GameUtil.getColor(ColorType.RED)}}),o!=a.length-1&&d.push({text:"、"}))}a.length>0&&t.push({name:"武将掉落：",value:d});for(var g=new Array,o=0;o<s.length;o++){c=s[o];var m=MetaEquipManager.ins.getEquip(c.dropId);m&&(g.push({text:m.name,style:{textColor:GameUtil.getColor(m.color)}}),u.level<c.hozaLevel&&g.push({text:"(厚劲"+c.hozaLevel+"级)",style:{textColor:GameUtil.getColor(ColorType.RED)}}),o!=s.length-1&&g.push({text:"、"}))}s.length>0&&t.push({name:"装备掉落：",value:g});for(var y=new Array,o=0;o<h.length;o++){c=h[o];var v=MetaPropMananger.ins.getProp(c.dropId);if(v){if(v.type==PropType.TIANSHU){var E=MetaTianShuManager.ins.getTianShuForProp(v.id);y.push({text:v.name,style:{textColor:GameUtil.getColor(E.quality)}})}else y.push({text:v.name});u.level<c.hozaLevel&&y.push({text:"(厚劲"+c.hozaLevel+"级)",style:{textColor:GameUtil.getColor(ColorType.RED)}}),o!=h.length-1&&y.push({text:"、"})}}h.length>0&&t.push({name:"道具掉落：",value:y}),this.dropList=this.getMc("dropList"),this.dropList.itemRenderer=EnterMapDropListItemRender,this.dropList.dataProvider=new eui.ArrayCollection(t),this.metaMap.type!=MapType.MAIN_CITY?this.desLabel.text="厚劲等级越高，掉落武将和装备的概率也会越大":this.desLabel.y=452,this.updateTimes();var C=this.getMc("consumeTokenLabel"),_=HuFuVoManager.ins.hufuVo;C.text=this.metaMap.consumeHufu+"",C.textColor=_.count>=this.metaMap.consumeHufu?Constants.COLOR_DYNAMIC:16711680,this.runTimer(),TimerManager.ins.addTimer(this),this.checkGuide()},t.prototype.checkGuide=function(){if(3==GuideVoManager.ins.guideVo.nowStep||7==GuideVoManager.ins.guideVo.nowStep||11==GuideVoManager.ins.guideVo.nowStep||18==GuideVoManager.ins.guideVo.nowStep){var e=UIUtil.local2Global(this.enterBtn.target);Guide.ins.showRect(e,this.enterBtn.width,this.enterBtn.height)}},t.prototype.updateTimes=function(){for(var e=0;e<this.timeItems.length;e++)this.removeChild(this.timeItems[e]);if(this.timeItems.length=0,this.mapVo){this.mapVo.monsters.sort(GameUtil.sortEnterMapCd);for(var e=0;e<this.mapVo.monsters.length;e++)if(0!=this.mapVo.monsters[e].cd){var t=MetaMonsterManager.ins.getMonster(this.mapVo.monsters[e].monsterId),i=new EnterMapBossTimeComponent(t);i.updateTime(this.mapVo.monsters[e].cd),this.addChild(i),i.x=138,i.y=690+32*e,this.timeItems.push(i)}}},t.prototype.runTimer=function(){if(!this.mapVo)return void Alert.ins.showAlert(AlertType.ERROR,"找不到mapVo");for(var e=!1,t=0,i=this.timeItems.length;i>t;t++){var n=this.mapVo.monsters[t].cd,o=this.timeItems[t];o.updateTime(n),0==n&&(e=!0)}e&&this.updateTimes(),this.mapVo.cd<=0?(this.consumeGroup.visible=!0,this.cdLabel.visible=!1,this.enterBtn.currentState="up"):(this.cdLabel.visible=!0,this.consumeGroup.visible=!1,this.cdLabel.text=DateUtils.getTimeStr2(this.mapVo.cd),this.enterBtn.currentState="disabled")},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.dropList.dataProvider=null,TimerManager.ins.removeTimer(this),this.enterBtn.dispose(),this.enterBtn=null,UIUtil.dispose(this)},t.prototype.onClose=function(){this.isEntermap=!1,e.prototype.onClose.call(this)},t.prototype.onEnterMap=function(e){if(Game.selfDizzyObj.isDizzy)return void Alert.ins.showAlert(AlertType.NORMAL,"眩晕效果结束前无法进入本地图!");if(Game.mapId==this.mapId)return this.isEntermap=!0,EventCenter.ins.send(EventCenter.SURE_ENTER_MAP),void UIManager.ins.close(this);if(this.mapVo.cd>0)return void Alert.ins.showAlert(AlertType.NORMAL,"您刚离开本地图，"+this.mapVo.cd+"秒后才能再次进入");this.isEntermap=!0;var t={cmd:BookCmd.ENTER_MAP,map:this.mapId};LoadingIcon.instance.show(),Game.net.sendData(t,this.responseEnterMap,this)},t.prototype.responseEnterMap=function(e){LoadingIcon.instance.hide(),Game.battleType=BattleType.NO,EventCenter.ins.send(EventCenter.SURE_ENTER_MAP,this.mapId),MapEntityVoManager.ins.onEnterMap(e.dataVo);for(var t=0,i=e.dataVo.monsters,n=0,o=i.length;o>n;n++){var r=MetaMonsterManager.ins.getMonster(parseInt(i[n].id));if(r.type==MonsterType.TASK_BOSS){t=r.id;break}}if(0!=t){var s=VoUtil.getTaskForMap(this.mapId,t);s&&DataCount.ins.onMissionBegin({missionId:s.id})}if(3==GuideVoManager.ins.guideVo.nowStep||7==GuideVoManager.ins.guideVo.nowStep||11==GuideVoManager.ins.guideVo.nowStep||18==GuideVoManager.ins.guideVo.nowStep){var a=this;Guide.ins.nextStep(function(){UIManager.ins.close(a)})}else UIManager.ins.close(this)},t.prototype.onCloseEnd=function(){this.isEntermap&&Util.sendEvent(EventCenter.ENTER_MAP,this.mapId),e.prototype.onCloseEnd.call(this)},t}(BaseUI);__reflect(EnterMapUI.prototype,"EnterMapUI",["ITimer"]);var EnterMapUIPre=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.startPre=function(){this.finishPre(new EnterMapUI(this.arg))},t}(PreUIBase);__reflect(EnterMapUIPre.prototype,"EnterMapUIPre");var EnterMapBossTimeComponent=function(e){function t(t){var i=e.call(this)||this;return i.remainderTime=0,i.metaMonster=t,i.skinName="resource/skins/ui/enterMap/component/EnterMapBossTimeSkin.exml",i}return __extends(t,e),t.prototype.onCreated=function(){e.prototype.onAdded.call(this),this.nameLabel.text=this.metaMonster.name,this.nameLabel.textColor=GameUtil.getColor(this.metaMonster.quality)},t.prototype.updateTime=function(e){this.timeLabel.text=DateUtils.getBossTime(e)},t}(BaseComponent);__reflect(EnterMapBossTimeComponent.prototype,"EnterMapBossTimeComponent");var EnterMapDropListItemRender=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/ui/enterMap/list/EnterMapDropItemSkin.exml",t}return __extends(t,e),t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.nameLabel.text=this.data.name,this.valueLabel.textFlow=this.data.value},t}(eui.ItemRenderer);__reflect(EnterMapDropListItemRender.prototype,"EnterMapDropListItemRender");var EquipUI=function(e){function t(){var t=e.call(this)||this;return t.operType=-1,t.equipType=-1,t.skinName="EquipUISkin",t}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.topBoard=new UITopComponent(this.skin.topBoard),this.equipTab=this.getMc("equipTab"),this.container=this.getMc("container"),this.equipedBtn=this.getMc("equipedBtn"),this.dazaoBtn=this.getMc("dazaoBtn"),this.magicWeaponBtn=this.getMc("magicWeaponBtn"),this.tujianBtn=this.getMc("tujianBtn"),this.dressRedImg=this.getMc("dressRedImg"),this.qianghuaRedImg=this.getMc("qianghuaRedImg"),this.weaponRedImg=this.getMc("weaponRedImg"),this.zuoqiRedImg=this.getMc("zuoqiRedImg"),this.tianshuRedImg=this.getMc("tianshuRedImg"),this.equipTab.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onEquipClick,this),this.equipTab.selectedIndex=0,EventCenter.ins.add(EventCenter.EQUIP_UI_UPDATE_EQUIPS,this.onUpdateEquips,this),EventCenter.ins.add(EventCenter.EQUIP_UPDATE,this.onUpdateEquips,this),EventCenter.ins.add(EventCenter.CHECK_EQUIP_RED,this.checkRed,this),EventCenter.ins.add(EventCenter.GUIDE_CHECK,this.checkGuide,this),this.equipedBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onMenuClick,this),this.dazaoBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onMenuClick,this),this.magicWeaponBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onMenuClick,this),this.tujianBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onMenuClick,this),this.setTab(),this.checkGuide()},t.prototype.checkRed=function(){for(var e=!1,t=!1,i=EquipType.WEAPON;i<=EquipType.CLOTH;i++){var n=EquipVoMananger.ins.checkCanDress(i),o=EquipPartVoManager.ins.getPart(i),r=PropVoManager.ins.getPropsForPart(i).length>0&&o.level<Game.EQUIP_PART_MAX_LEVEL;n&&(e=!0),r&&(t=!0),0==this.operType?i==EquipType.WEAPON?this.weaponRedImg.visible=n:EquipType.HORSE==i?this.zuoqiRedImg.visible=n:EquipType.CLOTH==i&&(this.tianshuRedImg.visible=n):1==this.operType&&(i==EquipType.WEAPON?this.weaponRedImg.visible=r:EquipType.HORSE==i?this.zuoqiRedImg.visible=r:EquipType.CLOTH==i&&(this.tianshuRedImg.visible=r))}return this.dressRedImg.visible=e,this.qianghuaRedImg.visible=t,2==this.operType||3==this.operType?(this.weaponRedImg.visible=!1,this.zuoqiRedImg.visible=!1,void(this.tianshuRedImg.visible=!1)):void 0},t.prototype.checkGuide=function(){if(GuideVoManager.ins.isBaoWuStep(1)){var e=EquipVoMananger.ins.getEquipsForFirst();if(0==e.length||0!=this.operType)return void Guide.ins.nextStep2();var t=e[0];if(t==this.equipTab.selectedIndex+1)return void Guide.ins.nextStep2();var i=this.equipTab.getVirtualElementAt(t-1);i.x+=(t-1)*i.width;var n=UIUtil.local2Global(i);Guide.ins.show(n.x,n.y,i.width,i.height)}},t.prototype.onMenuClick=function(e){var t=e.currentTarget;switch(t.name){case"equipedBtn":this.setTab(0);break;case"dazaoBtn":this.setTab(1);break;case"magicWeaponBtn":this.setTab(2);break;case"tujianBtn":this.setTab(3)}},t.prototype.setTab=function(e){void 0===e&&(e=0),this.operType!=e&&(this.operType=e,this.equipedBtn.currentState="up",this.dazaoBtn.currentState="up",this.magicWeaponBtn.currentState="up",this.tujianBtn.currentState="up",0==this.operType?this.equipedBtn.currentState="down":1==this.operType?this.dazaoBtn.currentState="down":2==this.operType?this.magicWeaponBtn.currentState="down":3==this.operType&&(this.tujianBtn.currentState="down"),this.equipEquipCom&&this.container.removeChild(this.equipEquipCom),this.equipLevelUpCom&&this.container.removeChild(this.equipLevelUpCom),this.handbookCom&&this.container.removeChild(this.handbookCom),this.equipEquipCom=null,this.equipLevelUpCom=null,this.handbookCom=null,this.equipType=-1,this.equipTab.selectedIndex=0,this.equipTab.visible=!0,0==this.operType?(this.equipEquipCom=new EquipEquipComponent,this.container.addChild(this.equipEquipCom),this.updateEquip(this.equipTab.selectedIndex)):1==this.operType?(this.equipLevelUpCom=new EquipLevelUpComponent(this.equipType+1),this.container.addChild(this.equipLevelUpCom),this.updateLevelUp(this.equipTab.selectedIndex)):2==this.operType?this.equipTab.visible=!1:3==this.operType&&(this.handbookCom=new EquipHandbookComponent,this.container.addChild(this.handbookCom),this.handbookCom.x=10,this.handbookCom.y=234),this.checkRed())},t.prototype.onUpdateEquips=function(e){this.equipEquipCom.updateEquip(this.equipType+1)},t.prototype.updateEquip=function(e){this.equipType!=e&&(this.equipType=e,this.equipEquipCom.updateEquip(this.equipType+1))},t.prototype.updateLevelUp=function(e){this.equipType!=e&&(this.equipType=e,this.equipLevelUpCom.updatePart(this.equipType+1))},t.prototype.onEquipClick=function(e){0==this.operType?this.updateEquip(this.equipTab.selectedIndex):1==this.operType?this.updateLevelUp(this.equipTab.selectedIndex):3==this.operType&&this.updateHandbook(this.equipTab.selectedIndex),GuideVoManager.ins.isBaoWuStep(1)&&Guide.ins.nextStep2()},t.prototype.updateHandbook=function(e){this.handbookCom.updateEquips(e)},t.prototype.dispose=function(){e.prototype.dispose.call(this),EventCenter.ins.remove(EventCenter.EQUIP_UI_UPDATE_EQUIPS,this.onUpdateEquips,this),EventCenter.ins.remove(EventCenter.EQUIP_UPDATE,this.onUpdateEquips,this),EventCenter.ins.remove(EventCenter.CHECK_EQUIP_RED,this.checkRed,this),this.equipTab.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onEquipClick,this),EventCenter.ins.remove(EventCenter.GUIDE_CHECK,this.checkGuide,this),UIUtil.destroyRes(t.RES_NAME),this.equipedBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onMenuClick,this),this.dazaoBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onMenuClick,this),this.magicWeaponBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onMenuClick,this),this.tujianBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onMenuClick,this),this.topBoard.dispose(),this.topBoard=null},t.RES_NAME="equip",t}(BaseUI);__reflect(EquipUI.prototype,"EquipUI");var EquipUIPre=function(e){function t(){var t=e.call(this)||this;return t.requests=new Array,t}return __extends(t,e),t.prototype.startPre=function(){this.requests.push({cmd:BookCmd.GET_EQUIPE_LIST}),this.loadData()},t.prototype.loadDataEnd=function(e){LoadingIcon.instance.hide();var t=(e.resultCode,e.dataVo);this.nowRequestObj.cmd==BookCmd.GET_EQUIPE_LIST?(EquipVoMananger.ins.fromServer(t.equips),EquipPartVoManager.ins.fromServer(t.pos),PropVoManager.ins.initEquipProps(t.props)):BookCmd.MAGIC_WEAPON_PANEL==this.nowRequestObj.cmd&&MagicWeaponVoManager.ins.fromServer(t),this.loadData()},t.prototype.loadData=function(){if(0==this.requests.length){var e=this;return void UIResLoading.loadReses(EquipUI.RES_NAME,function(){e.finishPre(new EquipUI)})}this.nowRequestObj=this.requests.shift(),LoadingIcon.instance.show(),Game.net.sendData(this.nowRequestObj,this.loadDataEnd,this)},t}(PreUIBase);__reflect(EquipUIPre.prototype,"EquipUIPre");var EquipEquipComponent=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/ui/equip/component/EquipEquipSkin.exml",t}return __extends(t,e),t.prototype.onCreated=function(){e.prototype.onCreated.call(this),this.listScroller.verticalScrollBar=null,this.listScroller.horizontalScrollBar=null,this.listScroller.viewport=this.equipGroup,this.items=new Array,EventCenter.ins.add(EventCenter.GUIDE_CHECK,this.checkGuide,this),this.checkGuide()},t.prototype.dispose=function(){e.prototype.dispose.call(this),EventCenter.ins.remove(EventCenter.GUIDE_CHECK,this.checkGuide,this),this.equipGroup=null,this.items.length=0},t.prototype.checkGuide=function(){if(GuideVoManager.ins.isBaoWuStep(2)){var e=EquipVoMananger.ins.getEquipsForFirst();if(0==e.length)return void Guide.ins.nextStep2();var t=e[0],i=EquipVoMananger.ins.getNoEquipedForPart(t);if(0==i.length)return void Guide.ins.nextStep2();var n=i[0],o=this.getItem(n.metaEquip.id);if(!o)return void Guide.ins.nextStep2();var r=(this.items.length,this.listScroller.height,this.equipGroup.contentHeight-this.listScroller.height),s=r/(o.height+2),a=this.getItemIndex(n.metaEquip.id),h=0;h=a>s?s*(o.height+2):a*(o.height+2),this.listScroller.viewport.scrollV=h;var p=UIUtil.local2Global(o.operBtn.target);Guide.ins.show(p.x-2,p.y,o.operBtn.target.width+4,o.operBtn.target.height)}},t.prototype.getItem=function(e){for(var t,i=0,n=this.items.length;n>i;i++)if(t=this.items[i],t.data.metaId==e)return t;return null},t.prototype.getItemIndex=function(e){for(var t,i=0,n=this.items.length;n>i;i++)if(t=this.items[i],t.data.metaId==e)return i;return-1},t.prototype.updateEquip=function(e){UIUtil.dispose(this.equipGroup),this.items.length=0;var t=MetaEquipManager.ins.getEquipsForPart(e);t.sort(GameUtil.sortEquips2);var i=0,n=0,o=0,r=0,s=0,a=0,h=EquipPartVoManager.ins.getPart(e),p=null;h&&(p=MetaEquipIntensifyManager.ins.getEquipIntensifyForPart(h.part,h.level));for(var l=new Array,u=0,c=t.length;c>u;u++){var d=t[u],f=EquipVoMananger.ins.getEquip(d.id);f?(l.push({has:!0,isEquiped:f.isEquiped,count:f.count,metaId:d.id}),f.isEquiped?(r+=Math.floor(d.hp*f.count*(p?p.hp/100:1)),a+=Math.floor(d.defence*f.count*(p?p.defence/100:1)),s+=Math.floor(d.attack*f.count*(p?p.attack/100:1))):(i+=d.hp*f.count,o+=d.defence*f.count,n+=d.attack*f.count)):l.push({has:!1,metaId:d.id})}for(var g,u=0,c=l.length;c>u;u++)g=new EquipItemRender(l[u]),this.equipGroup.addChild(g),g.y=(g.height+4)*u,this.items.push(g);this.equipGroup.validateNow();var m=Math.floor(.1*i),y=Math.floor(.1*n),v=Math.floor(.1*o);m+=r,y+=s,v+=a,this.attackLabel.text=y+"",this.defenceLabel.text=v+"",this.hpLabel.text=m+""},t}(BaseComponent);__reflect(EquipEquipComponent.prototype,"EquipEquipComponent");var EquipHandbookComponent=function(e){function t(){var t=e.call(this)||this;return t.index=-1,t.skinName="resource/skins/ui/equip/component/EquipHandbookSkin.exml",t}return __extends(t,e),t.prototype.onCreated=function(){e.prototype.onCreated.call(this),this.scroller.verticalScrollBar=null,this.updateEquips(0)},t.prototype.updateEquips=function(e){if(this.index!=e){this.index=e,UIUtil.dispose(this.group);for(var t=6;t>=1;t--){var i=new EquipHandbookItemComponent({type:this.index+1,color:t});this.group.addChild(i)}}},t}(BaseComponent);__reflect(EquipHandbookComponent.prototype,"EquipHandbookComponent");var EquipHandbookItemComponent=function(e){function t(t){var i=e.call(this)||this;return i.arg=t,i.skinName="resource/skins/ui/equip/component/EquipHandbookItemSkin.exml",i}return __extends(t,e),t.prototype.onCreated=function(){e.prototype.onCreated.call(this);var t=GameUtil.getColorName(this.arg.color),i="武器";2==this.arg.type?i="坐骑":3==this.arg.type&&(i="天书"),this.nameLabel.text=t+"色"+i,this.nameLabel.textColor=GameUtil.getColor(this.arg.color);for(var n=MetaEquipManager.ins.getEquipsForTypeColor(this.arg.type,this.arg.color),o=0,r=n.length;r>o;o++){var s=new EquipHandbookEquipItem(n[o]);this.group.addChild(s)}},t}(BaseComponent);__reflect(EquipHandbookItemComponent.prototype,"EquipHandbookItemComponent");var EquipLevelUpComponent=function(e){function t(t){var i=e.call(this)||this;return i.isFirst=!1,i.skinName="resource/skins/ui/equip/component/EquipLevelUpSkin.exml",i.part=t,i}return __extends(t,e),t.prototype.onCreated=function(){this.prop1Item=new EquipPropItemRender(this.prop_1),this.prop2Item=new EquipPropItemRender(this.prop_2),this.prop3Item=new EquipPropItemRender(this.prop_3),this.scroller.verticalScrollBar=null,this.scroller.horizontalScrollBar=null,this.expBar.slideDuration=0,this.oneKeyBtn=UIUtil.getButton("oneKeyBtn",this,this.onOnekey,this),EventCenter.ins.add(EventCenter.EQUIP_PROP_ITEM_CLICK,this.onItemClick,this),EventCenter.ins.add(EventCenter.PROP_UPDATE,this.updateProps,this),this.shopCom=new EquipLevelUpShopComponent(this.shopComponent),this.shopCom.updateList(EquipType.WEAPON)},t.prototype.updatePart=function(e,t){void 0===t&&(t=!1),(t||this.part!=e)&&(this.part=e,this.updateLevel(),this.updateProps(),this.shopCom.updateList(this.part))},t.prototype.onItemClick=function(e){var t=e.data;if(0==t.count)return void Alert.ins.showAlert(AlertType.ERROR,t.metaProp.name+"不足!");var i={cmd:BookCmd.LEVEL_UP_ONE_EUQIP_PART,id:this.part,prop:t.metaProp.id};LoadingIcon.instance.show(),Game.net.sendData(i,this.sureLevelUpOneEquipPart,this)},t.prototype.sureLevelUpOneEquipPart=function(e){LoadingIcon.instance.hide();var t=e.dataVo,i=EquipPartVoManager.ins.getPart(this.part);this.showAlert(i.level,t.lv);var n=i.level;EquipPartVoManager.ins.updateVo(t.id,t.lv,t.exp),PropVoManager.ins.updateVo(t.prop,t.propCount),i=EquipPartVoManager.ins.getPart(this.part);var o=i.level,r=new DDMovieClip(o==n?"equip_use_prop_effect":"equip_level_up_effect",1);this.group.addChild(r),r.x=324,r.y=246,EventCenter.ins.send(EventCenter.CHECK_EQUIP_RED),EventCenter.ins.send(EventCenter.EQUIP_PART_LEVEL_UP),this.updatePart(this.part,!0)},t.prototype.onOnekey=function(e){var t=EquipPartVoManager.ins.getPart(this.part);if(t.level==Game.EQUIP_PART_MAX_LEVEL){var i=GameUtil.getEquipPartName(this.part);return void Alert.ins.showAlert(AlertType.ERROR,i+"部位已经达到最大级!")}var n=PropVoManager.ins.getPropsForPart(this.part);if(0==n.length)return void Alert.ins.showAlert(AlertType.ERROR,"材料不足!");var o={cmd:BookCmd.LEVEL_UP_ALL_EUQIP_PARTS,type:this.part};LoadingIcon.instance.show(),Game.net.sendData(o,this.sureLevelUpAllEquipPart,this)},t.prototype.sureLevelUpAllEquipPart=function(e){LoadingIcon.instance.hide();var t=e.dataVo,i=EquipPartVoManager.ins.getPart(this.part),n=i.level;EquipPartVoManager.ins.fromServer(t.pos),PropVoManager.ins.initEquipProps(t.props),EventCenter.ins.send(EventCenter.CHECK_EQUIP_RED),i=EquipPartVoManager.ins.getPart(this.part);var o=new DDMovieClip(n==i.level?"equip_use_prop_effect":"equip_level_up_effect",1);this.group.addChild(o),o.x=324,o.y=246,this.showAlert(n,i.level),this.updatePart(this.part,!0)},t.prototype.showAlert=function(e,t){if(e!=t){var i=MetaEquipIntensifyManager.ins.getEquipIntensifyForPart(this.part,e),n=MetaEquipIntensifyManager.ins.getEquipIntensifyForPart(this.part,t),o=n.attack-i.attack,r=n.defence-i.defence,s=n.hp-i.hp,a="";
if(EquipType.WEAPON==i.part){if(0==o)return;a="武器攻击力提升"+o+"%",Alert.ins.showAlert(AlertType.TIP,a);var h=EquipVoMananger.ins.getEquipedForPart(this.part);if(h){var p=Math.floor(.01*o*h.metaEquip.attack*h.count);Alert.ins.showAlert(AlertType.TIP,"攻击力提升"+p)}}else if(EquipType.HORSE==i.part){a="坐骑血量提升"+s+"%",Alert.ins.showAlert(AlertType.TIP,a);var h=EquipVoMananger.ins.getEquipedForPart(this.part);if(h){var p=Math.floor(.01*s*h.metaEquip.hp*h.count);Alert.ins.showAlert(AlertType.TIP,"血量提升"+p)}}else if(EquipType.CLOTH==i.part){a="铠甲防御提升"+r+"%",Alert.ins.showAlert(AlertType.TIP,a);var h=EquipVoMananger.ins.getEquipedForPart(this.part);if(h){var p=Math.floor(.01*r*h.metaEquip.defence*h.count);Alert.ins.showAlert(AlertType.TIP,"防御提升"+p)}}}},t.prototype.updateProps=function(){for(var e,t,i,n=MetaPropMananger.ins.getPropsForPart(this.part),o=1;o<=n.length;o++)e=this["prop"+o+"Item"],i=n[o-1],t=PropVoManager.ins.getProp(i.id),t?e.update(t):e.update({count:0,metaProp:i});this.updateBtn()},t.prototype.updateBtn=function(){this.oneKeyBtn.currentState="up";var e=EquipPartVoManager.ins.getPart(this.part);if(e.level==Game.EQUIP_PART_MAX_LEVEL)return void(this.oneKeyBtn.currentState="disabled");var t=PropVoManager.ins.getPropsForPart(this.part);this.oneKeyBtn.currentState=t.length>0?"up":"disabled"},t.prototype.getMainPropertyObj=function(e){var t={};return 0!=e.attack?(t.type=PropertyType.ATTACK,t.value=e.attack,t.name="攻击"):0!=e.defence?(t.type=PropertyType.DEFENCE,t.value=e.defence,t.name="防御"):0!=e.hp&&(t.type=PropertyType.HP,t.value=e.hp,t.name="血量"),t},t.prototype.getPartName=function(e){var t="";return e==EquipType.WEAPON?t="武器":EquipType.HORSE==e?t="坐骑":EquipType.CLOTH==e&&(t="铠甲"),t},t.prototype.updateLevel=function(){var e=EquipPartVoManager.ins.getPart(this.part);if(e){var t=MetaEquipIntensifyManager.ins.getEquipIntensifyForPart(this.part,e.level),i=MetaEquipIntensifyManager.ins.getEquipIntensifyForPart(this.part,e.level+1),n=this.getMainPropertyObj(t);if(this.nowEquipPropertyLabel.text=this.getPartName(this.part)+n.name,this.nowEquipPropertyValueLabel.text="×"+n.value+"%",i)if(i.level==Game.EQUIP_PART_MAX_LEVEL)this.nextEquipPropertyLabel.text=this.getPartName(this.part)+"部位",this.nextEquipPropertyValueLabel.text="  已满级";else{var o=this.getMainPropertyObj(i);this.nextEquipPropertyLabel.text=this.getPartName(this.part)+o.name,this.nextEquipPropertyValueLabel.text="×"+o.value+"%"}else this.nextEquipPropertyLabel.text=this.getPartName(this.part)+n.name,this.nextEquipPropertyValueLabel.text="满级";this.levelLabel.text="Lv."+e.level,this.expBar.minimum=0,this.expBar.maximum=t.needExp,this.expBar.value=Math.min(e.exp,t.needExp),this.expBar.validateNow(),e.level>=Game.EQUIP_PART_MAX_LEVEL&&(this.expBar.labelDisplay.text="满级")}},t.prototype.dispose=function(){e.prototype.dispose.call(this),EventCenter.ins.remove(EventCenter.PROP_UPDATE,this.updateProps,this),EventCenter.ins.remove(EventCenter.EQUIP_PROP_ITEM_CLICK,this.onItemClick,this)},t}(BaseComponent);__reflect(EquipLevelUpComponent.prototype,"EquipLevelUpComponent");var EquipLevelUpShopComponent=function(e){function t(t,i){return void 0===i&&(i=null),e.call(this,t,i)||this}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.list=this.getMc("list"),this.list.itemRenderer=EquipLevelUpShopListItem},t.prototype.updateList=function(e){var t=MetaEquipShopGoodsManager.ins.getGoodsForType(e);this.list.dataProvider=new eui.ArrayCollection(t)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.list.dataProvider=null},t}(BaseSkin);__reflect(EquipLevelUpShopComponent.prototype,"EquipLevelUpShopComponent");var EquipHandbookEquipItem=function(e){function t(t){var i=e.call(this)||this;return i.metaEquip=t,i.skinName="resource/skins/ui/equip/itemRender/EquipHandbookEquipItemSkin.exml",i}return __extends(t,e),t.prototype.onCreated=function(){this.nameLabel.text=this.metaEquip.name;var e=GameUtil.getEquipProperty(this.metaEquip);this.propertyLabel.text=e.name,this.propertyValueLabel.text=e.value,this.iconImg.texture=RES.getRes(GameUtil.getEquipIcoName(this.metaEquip.id));var t=EquipVoMananger.ins.getEquipForMetaId(this.metaEquip.id);t?(this.noLabel.text="已获得",this.noLabel.textColor=Constants.COLOR_GREEN):(this.noLabel.text="未获得",this.noLabel.textColor=Constants.COLOR_GRAY)},t}(BaseComponent);__reflect(EquipHandbookEquipItem.prototype,"EquipHandbookEquipItem");var EquipItemRender=function(e){function t(t){var i=e.call(this)||this;return i.data=null,i.data=t,i.skinName="resource/skins/ui/equip/itemRender/EquipItemRenderSkin.exml",i.addEventListener(eui.UIEvent.CREATION_COMPLETE,i.onCreated,i),i.addEventListener(egret.Event.REMOVED_FROM_STAGE,i.dispose,i),i}return __extends(t,e),t.prototype.onCreated=function(){this.operBtn=UIUtil.getButton("operBtn",this,this.onOper,this),this.dataChanged()},t.prototype.onOper=function(){if(this.data.isEquiped)Alert.ins.showAlert(AlertType.ERROR,"已经穿戴!");else{var e=MetaEquipManager.ins.getEquip(this.data.metaId),t=EquipVoMananger.ins.getEquipedForPart(e.part),i=null==t?0:t.id,n={cmd:BookCmd.EQUIP_EQUIP,id:this.data.metaId,target:i};LoadingIcon.instance.show(),Game.net.sendData(n,this.onEquiped,this)}},t.prototype.onEquiped=function(e){LoadingIcon.instance.hide();var t=e.dataVo,i=EquipVoMananger.ins.getSixProperty(),n=EquipVoMananger.ins.getTotalNormalProperty(),o=MetaEquipManager.ins.getEquip(this.data.metaId);EquipVoMananger.ins.equip(t.source,o.part);var r=EquipVoMananger.ins.getSixProperty(),s=EquipVoMananger.ins.getTotalNormalProperty();GameUtil.handleSixProperty2(i,r),GameUtil.handleNormalProperty(n,s),EventCenter.ins.send(EventCenter.CHECK_EQUIP_RED),EventCenter.ins.send(EventCenter.EQUIP_UI_UPDATE_EQUIPS),GuideVoManager.ins.isBaoWuStep(2)&&Guide.ins.nextStep2()},t.prototype.dataChanged=function(){if(this.data){var e=this.data,t=MetaEquipManager.ins.getEquip(e.metaId),i=0;e.has?(i=e.count,this.operBtn.visible=!0,e.isEquiped?(this.operBtn.currentState="disabled",this.operBtn.label="已穿戴"):(this.operBtn.currentState="up",this.operBtn.label="穿戴"),this.countLabel.text="+"+i,this.noImg.visible=!1):(this.countLabel.text="",this.operBtn.visible=!1,this.noImg.visible=!0),this.iconImg.texture=RES.getRes(GameUtil.getEquipIcoName(t.id)),this.nameLabel.text=t.name,this.nameLabel.textColor=GameUtil.getColor(t.color),this.effectLabel.text=t.effect;var n=EquipPartVoManager.ins.getPart(t.part),o=null;n&&(o=MetaEquipIntensifyManager.ins.getEquipIntensifyForPart(n.part,n.level));var r="";if(t.part==EquipType.WEAPON){var s=t.attack,a=t.head,h=t.foot;e.has&&(s*=i,e.isEquiped&&(s*=o?o.attack/100:1),s=Math.floor(s)),r+="攻击+"+s,r+=" 武力+"+a,r+=" 内力+"+h}else if(EquipType.HORSE==t.part){var p=t.hp,l=t.force,u=t.fly;e.has&&(p*=i,e.isEquiped&&(p*=o?o.hp/100:1),p=Math.floor(p)),r+="血量+"+p,r+=" 统帅+"+l,r+=" 敏捷+"+u}else if(EquipType.CLOTH==t.part){var c=t.defence,d=t.hand,f=t.pre;e.has&&(c*=i,e.isEquiped&&(c*=o?o.defence/100:1),c=Math.floor(c)),r+="防御+"+c,r+=" 智力+"+d,r+=" 魅力+"+f}this.propertyLabel.text=r}},t.prototype.dispose=function(){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.onCreated,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.dispose,this),this.operBtn.dispose()},t}(eui.Component);__reflect(EquipItemRender.prototype,"EquipItemRender");var EquipLevelUpShopListItem=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(eui.UIEvent.COMPLETE,t.onComplete,t),t.addEventListener(egret.Event.REMOVED_FROM_STAGE,t.onRemoved,t),t.skinName="resource/skins/ui/equip/itemRender/EquipShopItemSkin.exml",t}return __extends(t,e),t.prototype.onComplete=function(){this.buyBtn=UIUtil.getButton("buyBtn",this,this.onBuy,this)},t.prototype.onBuy=function(e){var t=this.data;return t.gold>PlayerVoManager.ins.playerVo.gold?void Alert.ins.showAlert(AlertType.ERROR,"元宝不足"):(LoadingIcon.instance.show(),void Game.net.sendData({cmd:BookCmd.EQUIP_BUY_PROP,id:t.id},this.onResponseBuy,this))},t.prototype.onResponseBuy=function(e){LoadingIcon.instance.hide();var t=this.data,i=MetaPropMananger.ins.getProp(t.propId);PropVoManager.ins.operPropCount(t.propId,t.count,!0),DataCount.ins.onItemPurchase({item:i.name+"_"+t.count,itemNum:1,itemPrice:t.gold}),Alert.ins.showAlert(AlertType.TIP,"获得"+t.count+"个"+i.name)},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this);var t=this.data,i=MetaPropMananger.ins.getProp(t.propId);this.iconImg.source=i.res,this.nameLabel.text=t.name,this.priceLabel.text=t.gold+"元宝"},t.prototype.onRemoved=function(e){this.removeEventListener(eui.UIEvent.COMPLETE,this.onComplete,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this),this.buyBtn.dispose()},t}(eui.ItemRenderer);__reflect(EquipLevelUpShopListItem.prototype,"EquipLevelUpShopListItem");var EquipMagicWeaponItem=function(e){function t(t,i){return void 0===i&&(i=null),e.call(this,t,i)||this}return __extends(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this.bgImg.dispose(),this.nameImg.dispose(),this.weaponImg.dispose(),this.starCom.dispose(),this.attackCom.dispose(),this.critCom.dispose(),this.critHurtCom.dispose()},t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.bgImg=new DDImage(this.getMc("bgImg"),""),this.nameImg=new DDImage(this.getMc("nameImg"),""),this.weaponImg=new DDImage(this.getMc("weaponImg"),""),this.starCom=new StarComponent(this.getMc("starCom")),this.starCom.starCount=3,this.titleImg=this.getMc("titleImg"),this.attackCom=new OfficerPropertyItemComponent(this.getMc("attackCom"),{icon:PropertyType.ATTACK,value:0}),this.critCom=new OfficerPropertyItemComponent(this.getMc("critCom"),{icon:PropertyType.CRIT,value:0}),this.critHurtCom=new OfficerPropertyItemComponent(this.getMc("critHurtCom"),{icon:PropertyType.CRIT_HURT,value:0})},t.prototype.updateView=function(e){var t=MetaMagicWeaponManager.ins.getWeapon(e);this.nameImg.source="ui_gold_weapon_name_"+t.type+"_png",this.weaponImg.source="ui_gold_weapon_"+t.type+"_png";var i=MagicWeaponVoManager.ins.magicWeaponVo;i.id==e?(this.bgImg.source="equip_gold_weapon_5_png",this.titleImg.texture=RES.getRes("equip_gold_weapon_7")):(this.bgImg.source="equip_gold_weapon_6_png",this.titleImg.texture=RES.getRes("equip_gold_weapon_8")),this.starCom.updateStar(t.star),this.attackCom.updateValue(t.attack),this.critCom.updateValue((.01*t.crit).toFixed(2)),this.critHurtCom.updateValue(t.critAttack)},t}(BaseSkin);__reflect(EquipMagicWeaponItem.prototype,"EquipMagicWeaponItem");var EquipPropItemRender=function(e){function t(t,i){return void 0===i&&(i=null),e.call(this,t,i)||this}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.iconImg=this.getMc("iconImg"),this.countLabel=this.getMc("countLabel"),this.expLabel=this.getMc("expLabel"),this.update(this.argObj),this.skin.hasEventListener(egret.TouchEvent.TOUCH_TAP)||this.skin.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)},t.prototype.onTouch=function(e){EventCenter.ins.send(EventCenter.EQUIP_PROP_ITEM_CLICK,this.argObj)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.skin.hasEventListener(egret.TouchEvent.TOUCH_TAP)&&this.skin.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)},t.prototype.update=function(e){void 0===e&&(e=null),this.argObj=e,this.argObj&&(this.iconImg.source=this.argObj.metaProp.res,this.countLabel.text=this.argObj.count+"",UIUtil.getLabel("经验:"+this.argObj.metaProp.effectValue*this.argObj.count,"expLabel",this.skin))},t}(BaseSkin);__reflect(EquipPropItemRender.prototype,"EquipPropItemRender");var NetErrorUI=function(e){function t(t){var i=e.call(this)||this;return i.errObj=t,i.skinName="NetErrorUISkin",i}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),UIUtil.getLabel(this.errObj.errContent,"errorLabel",this.skin),this.operBtn=UIUtil.getButton("operBtn",this.skin,this.onOper,this),1==this.errObj.type?this.operBtn.label="确定":this.operBtn.label="重新登录"},t.prototype.onOper=function(){GameUIUtil.isOpenError=!1,1==this.errObj.type?e.prototype.onClose.call(this):GameUtil.reLogin()},t.prototype.onClose=function(){GameUIUtil.isOpenError=!1,e.prototype.onClose.call(this),UIUtil.dispose(this)},t}(BaseUI);__reflect(NetErrorUI.prototype,"NetErrorUI");var GiftExchangeUI=function(e){function t(){var t=e.call(this)||this;return t.skinName="GiftExchangeUISkin",t}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.getBtn=UIUtil.getButton("getBtn",this.skin,this.onGetGift,this),this.codeInputText=this.getMc("codeInputText"),this.qqGroupLabel=this.getMc("qqGroupLabel"),this.serviceQQLabel=this.getMc("serviceQQLabel"),this.giftNameLabel=this.getMc("giftNameLabel"),this.desLabel=this.getMc("desLabel"),this.close2Btn=UIUtil.getButton("close2Btn",this.skin,this.onClose,this);var t=GamePlatform.ins.getCSInfo();this.qqGroupLabel.text=t.qq,this.giftNameLabel.text=t.name,this.desLabel.text=t.des,this.qqGroupLabel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLabelClick,this),this.serviceQQLabel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLabelClick,this)},t.prototype.onLabelClick=function(e){},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.getBtn.dispose(),this.getBtn=null,this.close2Btn.dispose(),this.close2Btn=null,UIUtil.dispose(this)},t.prototype.onGetGift=function(e){var t=this.codeInputText.text;return""==t?void Alert.ins.showAlert(AlertType.ERROR,"礼品码不能为空!"):(LoadingIcon.instance.show(),void Game.net.sendData({cmd:BookCmd.LI_BAO_GET,code:t},this.onLiBaoGet,this))},t.prototype.onLiBaoGet=function(e){LoadingIcon.instance.hide(),GameUtil.handleBags(e.dataVo.dtoList),this.onClose()},t}(BaseUI);__reflect(GiftExchangeUI.prototype,"GiftExchangeUI");var GMUI=function(e){function t(){var t=e.call(this)||this;return t.skinName="GMUISkin",t}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.sureBtn=UIUtil.getButton("sureBtn",this.skin,this.onSure,this),this.gmText=this.getMc("gmText")},t.prototype.onSure=function(){log("gmText:"+this.gmText.text);var e={cmd:BookCmd.GM_ORDER,data:this.gmText.text};Game.net.sendData(e,null,null)},t}(BaseUI);__reflect(GMUI.prototype,"GMUI");var HozaUI=function(e){function t(){var t=e.call(this)||this;return t.skinName="HozaUISkin",t}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.scroller=this.getMc("scroller"),this.scroller.verticalScrollBar=null,this.scroller.bounces=!1,this.topBoard=new UITopComponent(this.getMc("topBoard")),this.infoCom=new HozaInfoComponent(this.getMc("infoCom")),this.infoCom.updateView(),this.levelCom=new HozaLevelComponent(this.getMc("levelCom")),this.levelCom.updateView(),this.shopCom=new HozaShopComponent(this.getMc("shopCom")),this.shopCom.updateShops()},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.topBoard.dispose(),this.topBoard=null,this.infoCom.dispose(),this.infoCom=null,this.levelCom.dispose(),this.levelCom=null,this.shopCom.dispose(),this.shopCom=null,UIUtil.destroyRes(t.RES_NAME),UIUtil.dispose(this)},t.RES_NAME="hoza",t}(BaseUI);__reflect(HozaUI.prototype,"HozaUI");var HozaUIPre=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.startPre=function(){UIResLoading.loadReses(HozaUI.RES_NAME,this.requestInfo,this)},t.prototype.requestInfo=function(){LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.HOUJIN_PANEL},this.onHoza,this)},t.prototype.onHoza=function(e){LoadingIcon.instance.hide();var t=e.dataVo;HozaVoManager.ins.fromServer(t),HozaShopVoManager.ins.fromServer(t.buyTimes),SixProVoManager.ins.fromServer(t.six,Constants.HOZA_SIX_PRO),this.finishPre(new HozaUI)},t}(PreUIBase);__reflect(HozaUIPre.prototype,"HozaUIPre");var HozaLevelInfoComponent=function(e){function t(t,i){return void 0===i&&(i=null),e.call(this,t,i)||this}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.levelLabel=this.getMc("levelLabel")},t.prototype.updateLevel=function(e){this.levelLabel.text=e+"",e>=100?this.levelLabel.x=13:e>=10?this.levelLabel.x=27:this.levelLabel.x=38},t}(BaseSkin);__reflect(HozaLevelInfoComponent.prototype,"HozaLevelInfoComponent");var HozaPropertyInfoComponent=function(e){function t(t,i){return void 0===i&&(i=null),e.call(this,t,i)||this}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.nameLabel=this.getMc("nameLabel"),this.wuliCom=new HozaPropertyInfoItemComponent(this.getMc("wuliCom")),this.zhiliCom=new HozaPropertyInfoItemComponent(this.getMc("zhiliCom")),this.neiliCom=new HozaPropertyInfoItemComponent(this.getMc("neiliCom")),this.tongshuaiCom=new HozaPropertyInfoItemComponent(this.getMc("tongshuaiCom")),this.minjieCom=new HozaPropertyInfoItemComponent(this.getMc("minjieCom")),this.meiliCom=new HozaPropertyInfoItemComponent(this.getMc("meiliCom"))},t.prototype.update=function(e,t){void 0===t&&(t=!1);var i=t?e.level+1:e.level,n=MetaHozaManager.ins.getHoza(i);this.nameLabel.text="厚劲"+i+"级"+n.name,this.nameLabel.textColor=t?65280:16777215;var o=SixProVoManager.ins.getSixVo(Constants.HOZA_SIX_PRO);this.wuliCom.updateInfo(PropertyType.WULI,o.wuli,t),this.zhiliCom.updateInfo(PropertyType.ZHILI,o.zhili,t),this.neiliCom.updateInfo(PropertyType.NEILI,o.neili,t),this.tongshuaiCom.updateInfo(PropertyType.TONGSHUAI,o.tongshuai,t),this.minjieCom.updateInfo(PropertyType.MINJIE,o.minjie,t),this.meiliCom.updateInfo(PropertyType.MEILI,o.meili,t)},t}(BaseSkin);__reflect(HozaPropertyInfoComponent.prototype,"HozaPropertyInfoComponent");var HozaPropertyInfoItemComponent=function(e){function t(t,i){return void 0===i&&(i=null),e.call(this,t,i)||this}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.iconImg=this.getMc("iconImg"),this.nameLabel=this.getMc("nameLabel"),this.valueLabel=this.getMc("valueLabel")},t.prototype.updateInfo=function(e,t,i){void 0===i&&(i=!1),this.iconImg.texture=RES.getRes(GameUtil.getPropertyIcon(e)),this.nameLabel.text=GameUtil.getPropertyName(e)+"：",this.valueLabel.text=t+(i?"+?":""),this.valueLabel.textColor=i?65280:16777215},t}(BaseSkin);__reflect(HozaPropertyInfoItemComponent.prototype,"HozaPropertyInfoItemComponent");var HozaInfoComponent=function(e){function t(t,i){return void 0===i&&(i=null),e.call(this,t,i)||this}return __extends(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this.levelUpBtn.dispose(),this.propertyInfoCom.dispose(),this.nextPropertyInfoCom.dispose(),EventCenter.ins.remove(EventCenter.HOZA_UPDATE_STUDY_POINT,this.onStudyPoint,this),EventCenter.ins.remove(EventCenter.LEVEL_UPGRADE,this.updateBtn,this),EventCenter.ins.remove(EventCenter.UPDATE_PLAYER,this.updateBtn,this),EventCenter.ins.remove(EventCenter.GUIDE_CHECK,this.checkGuide,this)},t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.levelUpBtn=UIUtil.getButton("levelUpBtn",this.skin,this.onLevelUp,this),this.propertyInfoCom=new HozaPropertyInfoComponent(this.getMc("propertyInfoCom")),this.nextPropertyInfoCom=new HozaPropertyInfoComponent(this.getMc("nextPropertyInfoCom")),this.arrowImg=this.getMc("arrowImg"),this.needLevelLabel=this.getMc("needLevelLabel"),this.needStudyPointLabel=this.getMc("needStudyPointLabel"),this.nowStudyPointCountLabel=this.getMc("nowStudyPointCountLabel"),this.levelUpConditionGroup=this.getMc("levelUpConditionGroup"),this.maxLevelLabel=this.getMc("maxLevelLabel"),EventCenter.ins.add(EventCenter.HOZA_UPDATE_STUDY_POINT,this.onStudyPoint,this),EventCenter.ins.add(EventCenter.LEVEL_UPGRADE,this.updateBtn,this),EventCenter.ins.add(EventCenter.UPDATE_PLAYER,this.updateBtn,this),EventCenter.ins.add(EventCenter.GUIDE_CHECK,this.checkGuide,this),this.updateView(),this.checkGuide()},t.prototype.checkGuide=function(){if(GuideVoManager.ins.isHouJinStep(1)){var e=UIUtil.local2Global(this.levelUpBtn.target);Guide.ins.show(e.x,e.y,this.levelUpBtn.width,this.levelUpBtn.height)}},t.prototype.onStudyPoint=function(){var e=HozaVoManager.ins.hozaVo;this.nowStudyPointCountLabel.text=e.studyPoint+"";var t=MetaHozaManager.ins.getHoza(e.level);this.nowStudyPointCountLabel.textColor=e.studyPoint>=t.cost?65280:16711680,this.updateBtn()},t.prototype.updateView=function(){var e=HozaVoManager.ins.hozaVo,t=MetaHozaManager.ins.getHoza(e.level);if(this.levelUpConditionGroup.visible=!0,this.maxLevelLabel.visible=!1,this.propertyInfoCom.update(e,!1),e.level==MetaHozaManager.maxLevel)this.nextPropertyInfoCom.setVisible(!1),this.arrowImg.visible=!1,this.propertyInfoCom.skin.x=204,this.needLevelLabel.text="----",this.needStudyPointLabel.text="----",this.nowStudyPointCountLabel.text="----",this.levelUpConditionGroup.visible=!1,this.maxLevelLabel.visible=!0;else{MetaHozaManager.ins.getHoza(e.level+1);this.nextPropertyInfoCom.update(e,!0);var i=PlayerVoManager.ins.playerVo;this.needLevelLabel.text=t.needLevel+"",this.needLevelLabel.textColor=t.needLevel>i.level?16711680:65280,this.needStudyPointLabel.text=t.cost+"",this.nowStudyPointCountLabel.text=e.studyPoint+"",this.nowStudyPointCountLabel.textColor=e.studyPoint>=t.cost?65280:16711680}this.updateBtn()},t.prototype.onLevelUp=function(){var e=HozaVoManager.ins.hozaVo,t=MetaHozaManager.ins.getHoza(e.level);if(e.level==MetaHozaManager.maxLevel)return void Alert.ins.showAlert(AlertType.ERROR,"已经最高级!");var i=PlayerVoManager.ins.playerVo;return t.needLevel>i.level?void Alert.ins.showAlert(AlertType.ERROR,"玩家等级不够!"):e.studyPoint<t.cost?void Alert.ins.showAlert(AlertType.ERROR,"所需学点不足!"):(LoadingIcon.instance.show(),void Game.net.sendData({cmd:BookCmd.HOUJIN_UPGRADE},this.sureLevelUp,this))},t.prototype.sureLevelUp=function(e){LoadingIcon.instance.hide();var t=e.dataVo,i=HozaVoManager.ins.hozaVo;i.level=t.houjin,i.studyPoint=t.xuedian,EventCenter.ins.send(EventCenter.HOZA_UPDATE_STUDY_POINT),GameUtil.handleSixProperty(t.six,Constants.HOZA_SIX_PRO),this.updateView(),GuideVoManager.ins.isHouJinStep(1)&&Guide.ins.nextStep2()},t.prototype.updateBtn=function(){var e=!0,t=HozaVoManager.ins.hozaVo,i=MetaHozaManager.ins.getHoza(t.level);this.levelUpBtn.visible=!0,t.level==MetaHozaManager.maxLevel&&(this.levelUpBtn.visible=!1,e=!1);var n=PlayerVoManager.ins.playerVo;i.needLevel>n.level&&(e=!1),t.studyPoint<i.cost&&(e=!1),this.levelUpBtn.currentState=e?"up":"disabled",this.needLevelLabel.textColor=i.needLevel>n.level?16711680:65280},t}(BaseSkin);__reflect(HozaInfoComponent.prototype,"HozaInfoComponent");var HozaLevelComponent=function(e){function t(t,i){return void 0===i&&(i=null),e.call(this,t,i)||this}return __extends(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),EventCenter.ins.remove(EventCenter.LEVEL_UPGRADE,this.updateBtn,this),EventCenter.ins.remove(EventCenter.UPDATE_PLAYER,this.updateBtn,this),this.exchangeBtn.dispose(),this.nowLevelInfoCom.dispose(),this.nextLevelInfoCom.dispose()},t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.exchangeBtn=UIUtil.getButton("exchangeBtn",this.skin,this.onExchange,this),this.nowLevelInfoCom=new HozaLevelInfoComponent(this.getMc("nowLevelInfoCom")),this.nextLevelInfoCom=new HozaLevelInfoComponent(this.getMc("nextLevelInfoCom")),this.arrowImg=this.getMc("arrowImg"),this.exchageStudyPointLabel=this.getMc("exchageStudyPointLabel"),this.exchangeConsumeLabel=this.getMc("exchangeConsumeLabel"),this.exchangeCountLabel=this.getMc("exchangeCountLabel"),EventCenter.ins.add(EventCenter.LEVEL_UPGRADE,this.updateBtn,this),EventCenter.ins.add(EventCenter.UPDATE_PLAYER,this.updateBtn,this)},t.prototype.updateBtn=function(){var e=!0;1==PlayerVoManager.ins.playerVo.level&&(e=!1);var t=HozaVoManager.ins.hozaVo;0==t.remainderExchangeCount&&(e=!1),PlayerVoManager.ins.playerVo.silver<t.exchangeSilver&&(e=!1),this.exchangeBtn.currentState=e?"up":"disabled"},t.prototype.updateView=function(){var e=PlayerVoManager.ins.playerVo;this.nowLevelInfoCom.updateLevel(e.level);var t=HozaVoManager.ins.hozaVo;if(this.updateBtn(),this.exchangeCountLabel.text=t.remainderExchangeCount+"",1==e.level){this.nextLevelInfoCom.setVisible(!1),this.arrowImg.visible=!1;var i=this.nowLevelInfoCom.skin;return i.horizontalCenter="0",this.exchageStudyPointLabel.text="0",void(this.exchangeConsumeLabel.text="0")}this.nextLevelInfoCom.updateLevel(e.level-1),this.exchageStudyPointLabel.text=t.exchangeXueDian+"",this.exchangeConsumeLabel.text=t.exchangeSilver+"银两"},t.prototype.onExchange=function(){var e=PlayerVoManager.ins.getResForType(ResType.SILVER);if(1==PlayerVoManager.ins.playerVo.level)return void Alert.ins.showAlert(AlertType.ERROR,"等级为1，不能再兑换");var t=HozaVoManager.ins.hozaVo;return 0==t.remainderExchangeCount?void Alert.ins.showAlert(AlertType.ERROR,"今日兑换次数已达上限"):e<t.exchangeSilver?void Alert.ins.showAlert(AlertType.ERROR,"银两不足，无法兑换"):(LoadingIcon.instance.show(),void Game.net.sendData({cmd:BookCmd.HOUJIN_EXCHANGE_LEVEL},this.sureExchange,this))},t.prototype.sureExchange=function(e){LoadingIcon.instance.hide();var t=e.dataVo,i=(PlayerVoManager.ins.playerVo,MetaRoleManager.ins.metaRole),n=HozaVoManager.ins.hozaVo;Alert.ins.showAlert(AlertType.TIP,"获取"+n.exchangeXueDian+"学点"),GameUtil.showPropertyDiff(PropertyType.HP,-1*i.hpAdd),GameUtil.showPropertyDiff(PropertyType.ATTACK,-1*i.attackAdd),GameUtil.showPropertyDiff(PropertyType.DEFENCE,-1*i.defenceAdd),HozaVoManager.ins.fromServer(t),SixProVoManager.ins.fromServer(t.six,Constants.HOZA_SIX_PRO),this.updateView(),EventCenter.ins.send(EventCenter.HOZA_UPDATE_STUDY_POINT)},t}(BaseSkin);__reflect(HozaLevelComponent.prototype,"HozaLevelComponent");var HozaShopComponent=function(e){function t(t,i){return void 0===i&&(i=null),e.call(this,t,i)||this}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),EventCenter.ins.add(EventCenter.HOZA_SHOP_BUY,this.onBuy,this),this.shopGroup=this.getMc("shopGroup")},t.prototype.updateShops=function(){UIUtil.dispose(this.shopGroup);for(var e=MetaHozaShopManager.ins.shops,t=0,i=e.length;i>t;t++){var n=new HozaShopItem(e[t]);this.shopGroup.addChild(n),n.y=t*n.height}},t.prototype.onBuy=function(e){var t=e.data,i=MetaHozaShopManager.ins.getShop(t),n=PlayerVoManager.ins.getResForType(ResType.GOLD);if(n<i.cost)return void Alert.ins.showAlert(AlertType.ERROR,"元宝不足!");var o=HozaShopVoManager.ins.getShop(t);if(o.count<=0)return void Alert.ins.showAlert(AlertType.ERROR,"购买次数不够！");var r={cmd:BookCmd.HOUJIN_BUY,id:t};LoadingIcon.instance.show(),Game.net.sendData(r,this.sureBuy,this)},t.prototype.sureBuy=function(e){LoadingIcon.instance.hide();var t=e.dataVo,i=t.id,n=MetaHozaShopManager.ins.getShop(i);Alert.ins.showAlert(AlertType.TIP,"增加学点"+n.zhanyi),HozaShopVoManager.ins.buy(i),HozaVoManager.ins.updateStudyPoint(t.xuedian),DataCount.ins.onItemPurchase({item:"[厚劲]"+n.name,itemNum:1,itemPrice:n.cost}),this.updateShops()},t.prototype.dispose=function(){e.prototype.dispose.call(this),EventCenter.ins.remove(EventCenter.HOZA_SHOP_BUY,this.onBuy,this)},t}(BaseSkin);__reflect(HozaShopComponent.prototype,"HozaShopComponent");var HozaShopItem=function(e){function t(t){var i=e.call(this)||this;return i.metaShop=t,i.skinName="resource/skins/ui/hoza/common/HozaShopItemSkin.exml",i}return __extends(t,e),t.prototype.onCreated=function(){e.prototype.onCreated.call(this),UIUtil.setImg("hoza_dan_"+this.metaShop.id,this.iconImg,this);var t=MetaHozaShopManager.ins.getShop(this.metaShop.id);this.nameLabel.text=t.name,this.studyPointLabel.text="",this.goldLabel.text=t.cost+"元宝";var i=HozaShopVoManager.ins.getShop(this.metaShop.id),n=null==i?t.limitCount:i.count;this.countLabel.text=n+"",this.buyBtn=UIUtil.getButton("buyBtn",this,this.onBuy,this),this.buyBtn.currentState=n>0?"up":"disabled"},t.prototype.onBuy=function(e){var t=MetaHozaShopManager.ins.getShop(this.metaShop.id),i=HozaShopVoManager.ins.getShop(this.metaShop.id),n=null==i?t.limitCount:i.count;return 0>=n?void Alert.ins.showAlert(AlertType.ERROR,"今天购买次数已用完!"):void EventCenter.ins.send(EventCenter.HOZA_SHOP_BUY,this.metaShop.id)},t}(BaseComponent);__reflect(HozaShopItem.prototype,"HozaShopItem");var HuFuShopUI=function(e){function t(){var t=e.call(this)||this;return t.metaHuFuId=0,t.skinName="HuFuShopUISkin",t}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),EventCenter.ins.add(EventCenter.HUFU_SHOP_BUY,this.onHuFuBuy,this),this.list=this.getMc("list"),this.lookLabel=this.getMc("lookLabel"),this.list.itemRenderer=HuFuShopItemRender,this.lookLabel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showVip,this),this.updateList()},t.prototype.showVip=function(){GameUIUtil.showVip()},t.prototype.updateList=function(){this.list.dataProvider=new eui.ArrayCollection(MetaHuFuShopManager.ins.hufus)},t.prototype.onHuFuBuy=function(e){var t=e.data;this.metaHuFuId=t;var i=MetaHuFuShopManager.ins.getHuFu(t),n=PlayerVoManager.ins.getResForType(ResType.GOLD);return n<i.gold?void Alert.ins.showAlert(AlertType.ERROR,"元宝不足!"):(LoadingIcon.instance.show(),void Game.net.sendData({cmd:BookCmd.HUFU_BUY,id:t},this.sureOnHuFuBuy,this))},t.prototype.sureOnHuFuBuy=function(e){LoadingIcon.instance.hide();var t=e.dataVo.id,i=MetaHuFuShopManager.ins.getHuFu(this.metaHuFuId);return i?(HuFuVoManager.ins.setHuFuCount(t),DataCount.ins.onItemPurchase({item:"虎符_"+i.count,itemNum:1,itemPrice:i.gold}),EventCenter.ins.send(EventCenter.HUFU_UPDATE),void Alert.ins.showAlert(AlertType.TIP,"获得"+i.count+"虎符")):void Alert.ins.showAlert(AlertType.ERROR,"购买虎符ID:"+this.metaHuFuId+"出错!")},t.prototype.dispose=function(){e.prototype.dispose.call(this),EventCenter.ins.remove(EventCenter.HUFU_SHOP_BUY,this.onHuFuBuy,this),this.lookLabel.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.showVip,this),this.list.dataProvider=null,UIUtil.dispose(this)},t}(BaseUI);__reflect(HuFuShopUI.prototype,"HuFuShopUI");var HuFuShopItemRender=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/ui/hufuShop/HuFuShopItemSkin.exml",t.addEventListener(eui.UIEvent.CREATION_COMPLETE,t.onCreated,t),t.addEventListener(egret.Event.REMOVED_FROM_STAGE,t.onRemoved,t),t}return __extends(t,e),t.prototype.onCreated=function(e){this.buyBtn=UIUtil.getButton("buyBtn",this,this.onBuy,this)},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this);var t=this.data;this.iconImg.source=t.icon+"_png",this.countLabel.text=t.count+"",this.priceLabel.text=t.gold+"元宝"},t.prototype.onBuy=function(e){EventCenter.ins.send(EventCenter.HUFU_SHOP_BUY,this.data.id)},t.prototype.onRemoved=function(e){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.onCreated,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this),this.buyBtn.dispose()},t}(eui.ItemRenderer);__reflect(HuFuShopItemRender.prototype,"HuFuShopItemRender");var KuaFuUI=function(e){function t(){var t=e.call(this)||this;return t.cd=0,t.changeCd=0,t.skinName="KuaFuUISkin",t}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.enterBtn=UIUtil.getButton("enterBtn",this.skin,this.onEnterKuaFu,this),this.timeLabel=this.getMc("timeLabel"),this.cdLabel=this.getMc("cdLabel"),this.enterBtn.label=Game.isKuaFu?"离开战服":"进入战服",this.conditionLabel=this.getMc("conditionLabel");var t=new Array;t.push({text:"3、需要玩家等级"});var i=PlayerVoManager.ins.playerVo,n=HozaVoManager.ins.hozaVo,o=BodyVoMananger.ins.bodyVo;t.push({text:Game.KUA_FU_PLAYER_LEVEL+"",style:{textColor:i.level>=Game.KUA_FU_PLAYER_LEVEL?Constants.COLOR_DYNAMIC:Constants.COLOR_RED}}),t.push({text:"级、厚劲"}),t.push({text:Game.KUA_FU_HOZA_LEVEL+"",style:{textColor:n.level>=Game.KUA_FU_HOZA_LEVEL?Constants.COLOR_DYNAMIC:Constants.COLOR_RED}}),t.push({text:"级、角色形象"}),t.push({text:Game.KUA_FU_BODY_LEVEL+"",style:{textColor:o.id>=Game.KUA_FU_BODY_LEVEL?Constants.COLOR_DYNAMIC:Constants.COLOR_RED}}),t.push({text:"级才可进入跨服。"}),this.conditionLabel.textFlow=t,this.cdLabel.visible=!1,this.cd=KuaFuVoManager.ins.kuafuVo.enterCD,this.updateBtn(),this.runTimer(),TimerManager.ins.addTimer(this),this.timeLabel.text=KuaFuVoManager.ins.kuafuVo.remainderChangeCampTime},t.prototype.updateBtn=function(){if(Game.isKuaFu)return this.enterBtn.currentState="up",void(this.cdLabel.visible=!1);
var e=this.cd<=0;e=e?PlayerVoManager.ins.playerVo.level>=Game.KUA_FU_PLAYER_LEVEL:e,e=e?BodyVoMananger.ins.bodyVo.id>=Game.KUA_FU_BODY_LEVEL:e,e=e?HozaVoManager.ins.hozaVo.level>=Game.KUA_FU_HOZA_LEVEL:e,this.enterBtn.currentState=e?"up":"disabled"},t.prototype.runTimer=function(){Game.isKuaFu||(this.cd>0?(this.cdLabel.text=DateUtils.getTimeStr2(this.cd),this.cdLabel.visible=!0,this.cd--):(this.cdLabel.visible=!1,this.updateBtn()))},t.prototype.onEnterKuaFu=function(e){if(Game.isKuaFu)return void KuaFu.ins.outKuaFu();if(PlayerVoManager.ins.playerVo.level<Game.KUA_FU_PLAYER_LEVEL)return void Alert.ins.showAlert(AlertType.ERROR,"进入战服需要玩家等级"+Game.KUA_FU_PLAYER_LEVEL+"级!");if(BodyVoMananger.ins.bodyVo.id<Game.KUA_FU_BODY_LEVEL)return void Alert.ins.showAlert(AlertType.ERROR,"进入战服需要角色形象"+Game.KUA_FU_BODY_LEVEL+"级!");var t=HozaVoManager.ins.hozaVo;return t.level<Game.KUA_FU_HOZA_LEVEL?void Alert.ins.showAlert(AlertType.ERROR,"进入战服需要厚劲"+Game.KUA_FU_HOZA_LEVEL+"级!"):this.cd>0?void Alert.ins.showAlert(AlertType.ERROR,"进入战服还需要"+this.cd+"秒"):void KuaFu.ins.enterKuaFu()},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.enterBtn.dispose()},t}(BaseUI);__reflect(KuaFuUI.prototype,"KuaFuUI",["ITimer"]);var KuaFuUIPre=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.startPre=function(){LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.KUA_FU_PANEL},this.onKuaFuPanel,this)},t.prototype.onKuaFuPanel=function(e){LoadingIcon.instance.hide(),KuaFuVoManager.ins.fromServer({cd:e.dataVo.cd,changeCD:e.dataVo.time}),this.finishPre(new KuaFuUI)},t}(PreUIBase);__reflect(KuaFuUIPre.prototype,"KuaFuUIPre");var MagicWeaponUI=function(e){function t(){var t=e.call(this)||this;return t.isFirstUpdate=!0,t.isRequesting=!1,t.hasRequest=!1,t.skinName="MagicWeaponUISkin",t}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this);var t=this.skin.scroller;t.verticalScrollBar=null,this.scrollerGroup=this.getMc("scrollerGroup",t),this.topCom=new UITopComponent(this.getMc("topCom")),this.expBar=new NormalUIBarComponent(this.getMc("levelUpBar")),this.nowItem=new EquipMagicWeaponItem(this.getMc("nowWeaponItem")),this.nextItem=new EquipMagicWeaponItem(this.getMc("nextWeaponItem")),this.levelUpBtn=UIUtil.getButton("levelUpBtn",this.skin,this.onLevelUp,this),this.arrow_1=this.getMc("arrow_1",this.scrollerGroup),this.arrow_2=this.getMc("arrow_2",this.scrollerGroup),this.remainderTimeLabel=this.getMc("remainderTimeLabel",this.scrollerGroup),EventCenter.ins.add(EventCenter.BODY_BUY,this.onBuy,this),this.desLabel=this.getMc("desLabel");var i=new Array;i.push({text:"击败BOSS("}),i.push({text:"无限制",style:{textColor:Constants.COLOR_DYNAMIC}}),i.push({text:")和击败玩家(每天"}),i.push({text:MetaConfigManager.ins.getConfig("zhanyi_pk_time")+"",style:{textColor:Constants.COLOR_DYNAMIC}}),i.push({text:"次)获得战意值"}),this.desLabel.textFlow=i,this.buy1Com=new MagicWathBuyItemComponent(this.getMc("buy1Com",this.scrollerGroup)),this.buy2Com=new MagicWathBuyItemComponent(this.getMc("buy2Com",this.scrollerGroup)),this.buy1Com.update(MetaBodyShopManager.ins.getShop(1)),this.buy2Com.update(MetaBodyShopManager.ins.getShop(2)),this.updateRemainderTime(),TimerManager.ins.addTimer(this),this.updateView(),this.checkGuide(),EventCenter.ins.add(EventCenter.GUIDE_CHECK,this.checkGuide,this)},t.prototype.checkGuide=function(){if(GuideVoManager.ins.isShenBingStep(1)){if(!VoUtil.checkMagicWeaponLevelUp())return void Guide.ins.nextStep2();var e=UIUtil.local2Global(this.levelUpBtn.target);Guide.ins.show(e.x,e.y,this.levelUpBtn.target.width,this.levelUpBtn.target.height)}else GuideVoManager.ins.isShenBingStep(2)&&Guide.ins.nextStep2()},t.prototype.updateView=function(){var e=MagicWeaponVoManager.ins.magicWeaponVo;this.nowItem.updateView(e.id);var t=MetaMagicWeaponManager.ins.getWeapon(e.id);return this.isFirstUpdate||this.nowItem.starCom.showEffect(t.star),this.isFirstUpdate=!1,e.id==Game.MAGIC_WEAPON_MAX_ID?(this.arrow_1.visible=!1,this.arrow_2.visible=!1,this.nextItem.setVisible(!1),this.nowItem.skin.x=166,this.expBar.maximum=1,this.expBar.value=1,this.expBar.updateLabelContent("已满级"),this.levelUpBtn.visible=!1,void(this.levelUpBtn.enabled=!1)):(this.nextItem.updateView(t.id+1),this.expBar.maximum=t.needZhanyi,this.expBar.slideDuration=0,this.expBar.value=MagicWeaponVoManager.ins.magicWeaponVo.zhanyi,void(this.levelUpBtn.currentState=VoUtil.checkMagicWeaponLevelUp()?"up":"disabled"))},t.prototype.onLevelUp=function(){return VoUtil.checkMagicWeaponLevelUp()?(LoadingIcon.instance.show(),void Game.net.sendData({cmd:BookCmd.MAGIC_WEAPON_LEVEL_UP},this.sureLevelUp,this)):void Alert.ins.showAlert(AlertType.ERROR,"战意不足!")},t.prototype.sureLevelUp=function(e){LoadingIcon.instance.hide();var t=MagicWeaponVoManager.ins.getTotalNormalProperty(),i=MagicWeaponVoManager.ins.magicWeaponVo;i.id=e.dataVo.id1,MagicWeaponVoManager.ins.setWarthCount(e.dataVo.id2);var n=MagicWeaponVoManager.ins.getTotalNormalProperty();GameUtil.handleNormalProperty(t,n),EventCenter.ins.send(EventCenter.CHECK_EQUIP_RED),EventCenter.ins.send(EventCenter.GOLD_WEAPON_UPDATE),this.updateView(),GuideVoManager.ins.isShenBingStep(1)&&Guide.ins.nextStep2()},t.prototype.onBuy=function(e){var t=e.data;if(t.cost>PlayerVoManager.ins.playerVo.gold)return void Alert.ins.showAlert(AlertType.ERROR,"元宝不够!");var i={cmd:BookCmd.MAGIC_WEAPON_BUY,id:t.id};LoadingIcon.instance.show(),Game.net.sendData(i,this.sureBuy,this)},t.prototype.sureBuy=function(e){LoadingIcon.instance.hide();var t=e.dataVo,i=MetaBodyShopManager.ins.getShop(t.id);Alert.ins.showAlert(AlertType.TIP,"购买战意"+Util.handleUnit2(i.zhanyi)+"成功!"),DataCount.ins.onItemPurchase({item:"战意_"+i.zhanyi,itemNum:1,itemPrice:i.cost}),MagicWeaponVoManager.ins.magicWeaponVo.zhanyi+=i.zhanyi,this.updateWarth()},t.prototype.updateWarth=function(){var e=MagicWeaponVoManager.ins.magicWeaponVo,t=MetaMagicWeaponManager.ins.getWeapon(e.id),i=t.needZhanyi;t.id==Game.MAGIC_WEAPON_MAX_ID?(this.expBar.maximum=1,this.expBar.value=1,this.expBar.updateLabelContent("已满级")):(this.expBar.maximum=i,this.expBar.value=e.zhanyi),this.levelUpBtn.currentState=VoUtil.checkMagicWeaponLevelUp()?"up":"disabled"},t.prototype.runTimer=function(){if(MagicWeaponVoManager.ins.runRemainderTime(),this.updateRemainderTime(),0==MagicWeaponVoManager.ins.magicWeaponVo.cd){if(this.isRequesting||this.hasRequest)return;this.requestMagicWeapon()}else this.hasRequest=!1},t.prototype.requestMagicWeapon=function(){this.isRequesting=!0,this.hasRequest=!0,Game.net.sendData({cmd:BookCmd.MAGIC_WEAPON_PANEL},this.onRequestMagicWeapon,this)},t.prototype.onRequestMagicWeapon=function(e){MagicWeaponVoManager.ins.fromServer(e.dataVo),this.isFirstUpdate=!0,this.updateView(),this.updateWarth(),this.isRequesting=!1,this.hasRequest=!1,this.updateRemainderTime(),this.checkGuide()},t.prototype.updateRemainderTime=function(){this.remainderTimeLabel.text=DateUtils.getTimeStr3(MagicWeaponVoManager.ins.magicWeaponVo.cd)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.topCom.dispose(),this.topCom=null,this.expBar.dispose(),this.expBar=null,this.nowItem.dispose(),this.nowItem=null,this.nextItem.dispose(),this.nextItem=null,this.levelUpBtn.dispose(),this.levelUpBtn=null,this.buy1Com.dispose(),this.buy1Com=null,this.buy2Com.dispose(),this.buy2Com=null,TimerManager.ins.removeTimer(this),EventCenter.ins.remove(EventCenter.BODY_BUY,this.onBuy,this),EventCenter.ins.remove(EventCenter.GUIDE_CHECK,this.checkGuide,this),UIUtil.destroyRes(t.RES_NAME),GuideVoManager.ins.isShenBingStep(2)&&Guide.ins.nextStep2(),UIUtil.dispose(this)},t.RES_NAME="magicWeapon",t}(BaseUI);__reflect(MagicWeaponUI.prototype,"MagicWeaponUI",["ITimer"]);var MagicWeaponUIPre=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.startPre=function(){UIResLoading.loadReses(MagicWeaponUI.RES_NAME,this.requestInfo,this)},t.prototype.requestInfo=function(){LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.MAGIC_WEAPON_PANEL},this.onMagicWeapon,this)},t.prototype.onMagicWeapon=function(e){LoadingIcon.instance.hide();var t=e.dataVo;MagicWeaponVoManager.ins.fromServer(t),this.finishPre(new MagicWeaponUI)},t}(PreUIBase);__reflect(MagicWeaponUIPre.prototype,"MagicWeaponUIPre");var MagicWathBuyItemComponent=function(e){function t(t,i){return void 0===i&&(i=null),e.call(this,t,i)||this}return __extends(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this.buyBtn.dispose()},t.prototype.onAdded=function(){this.iconImg=this.getMc("iconImg"),this.nameLabel=this.getMc("nameLabel"),this.priceLabel=this.getMc("priceLabel"),this.buyBtn=UIUtil.getButton("buyBtn",this.skin,this.onBuy,this)},t.prototype.update=function(e){this.argObj=e;var t=1==this.argObj.id?"body_6":"body_7";this.iconImg.texture=RES.getRes(t),this.nameLabel.text=this.argObj.name,this.priceLabel.text=this.argObj.cost+"元宝"},t.prototype.onBuy=function(){EventCenter.ins.send(EventCenter.BODY_BUY,this.argObj)},t}(BaseSkin);__reflect(MagicWathBuyItemComponent.prototype,"MagicWathBuyItemComponent");var MailInfoUI=function(e){function t(t){var i=e.call(this)||this;return i.mailVo=t,i.skinName="MailInfoUISkin",i}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),UIUtil.getLabel(this.mailVo.title,"titleLabel",this.skin),UIUtil.getLabel(this.mailVo.sender,"senderLabel",this.skin);var t=new Date(this.mailVo.sendTime);UIUtil.getLabel(t.getFullYear()+"年"+(t.getMonth()+1)+"月"+t.getDate()+"日","sendTimeLabel",this.skin),UIUtil.getLabel(this.mailVo.content,"contentLabel",this.skin);var i=GameUtil.getBagsDes(this.mailVo.rewards),n=this.getMc("rewardLabel");n.textFlow=i,this.getBtn=UIUtil.getButton("getBtn",this.skin,this.onGetReward,this),this.mailVo.rewards.length>0?this.getBtn.label="领取":this.getBtn.label="删除"},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.getBtn.dispose(),this.getBtn=null,UIUtil.dispose(this)},t.prototype.onGetReward=function(){LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.MAIL_GET_REWARD,id:this.mailVo.id},this.sureGetReward,this)},t.prototype.sureGetReward=function(e){LoadingIcon.instance.hide(),GameUtil.handleBags(this.mailVo.rewards),MailVoManager.ins.delMail(this.mailVo.id),this.onClose()},t}(BaseUI);__reflect(MailInfoUI.prototype,"MailInfoUI");var MailUI=function(e){function t(){var t=e.call(this)||this;return t.skinName="MailUISkin",t}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this);var t=this.getMc("scroller");t.verticalScrollBar=null,this.noMailLabel=this.getMc("noMailLabel"),this.list=this.getMc("list",this.skin),this.list.itemRenderer=MailListItemRender,this.list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListClick,this),this.updateMailList(),EventCenter.ins.add(EventCenter.MAIL_UPDATE_LIST,this.updateMailList,this)},t.prototype.onListClick=function(e){var t=this.list.selectedItem;GameUIUtil.showMailInfo(t)},t.prototype.updateMailList=function(){0==MailVoManager.ins.mails.length?this.noMailLabel.visible=!0:this.noMailLabel.visible=!1,this.list.dataProvider=new eui.ArrayCollection(MailVoManager.ins.mails)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.list.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListClick,this),EventCenter.ins.remove(EventCenter.MAIL_UPDATE_LIST,this.updateMailList,this),UIUtil.destroyRes(t.RES_NAME),UIUtil.dispose(this)},t.RES_NAME="youjian",t}(BaseUI);__reflect(MailUI.prototype,"MailUI");var MailUIPre=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.startPre=function(){UIResLoading.loadReses(MailUI.RES_NAME,this.requestInfo,this)},t.prototype.requestInfo=function(){LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.MAIL_PANEL},this.onMail,this)},t.prototype.onMail=function(e){LoadingIcon.instance.hide();var t=e.dataVo;MailVoManager.ins.fromServer(t.mails),this.finishPre(new MailUI)},t}(PreUIBase);__reflect(MailUIPre.prototype,"MailUIPre");var MailListItemRender=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/ui/mail/list/MailListItemSkin.exml",t}return __extends(t,e),t.prototype.dataChanged=function(){var e=this.data;this.titleLabel.text=e.title;var t=86400,i=new Date(e.sendTime);this.senderLabel.text=e.sender+"("+(i.getFullYear()+"年"+(i.getMonth()+1)+"月"+i.getDate()+"日)"),this.remainderDayLabel.text="(剩余"+Math.ceil(.001*e.remainderTime/t)+"天)"},t}(eui.ItemRenderer);__reflect(MailListItemRender.prototype,"MailListItemRender");var MainShareUI=function(e){function t(){var t=e.call(this)||this;return t.skinName="MainShareUISkin",t}return __extends(t,e),t}(BaseUI);__reflect(MainShareUI.prototype,"MainShareUI");var MeridianUI=function(e){function t(){var t=e.call(this)||this;return t.skinName="MeridianUISKin",t}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.nameImg=this.getMc("nameImg"),this.topCom=new UITopComponent(this.getMc("topBoard")),this.bottomCom=new MeridianBottomComponent(this.getMc("bottomCom")),this.bodyCom=new MeridianBodyComponent,this.addChild(this.bodyCom),this.updateLevelUp(),this.bodyCom.x=45,this.bodyCom.y=135,EventCenter.ins.add(EventCenter.MERIDIAN_LEVEL_UP,this.updateLevelUp,this)},t.prototype.updateLevelUp=function(e){void 0===e&&(e=null);var t=MeridianVoManager.ins.meridianVo,i=MetaMeridianManager.ins.getMeridianForId(t.id);0==i.type?this.nameImg.visible=!1:(this.nameImg.visible=!0,this.nameImg.texture=RES.getRes("jm_name_2_"+i.type)),this.bodyCom.updateBody(),this.bodyCom.levelUp(e)},t.prototype.dispose=function(){e.prototype.dispose.call(this),EventCenter.ins.remove(EventCenter.MERIDIAN_LEVEL_UP,this.updateLevelUp,this),this.topCom.dispose(),this.topCom=null,this.bottomCom.dispose(),this.bottomCom=null,this.removeChild(this.bodyCom),this.bodyCom=null,UIUtil.dispose(this)},t.RES_NAME="jingmai",t}(BaseUI);__reflect(MeridianUI.prototype,"MeridianUI");var MeridianUIPre=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.startPre=function(){UIResLoading.loadReses(MeridianUI.RES_NAME,this.requestInfo,this)},t.prototype.requestInfo=function(){Game.net.sendData({cmd:BookCmd.GET_MERIDIAN},this.onMeridian,this)},t.prototype.onMeridian=function(e){var t=e.dataVo;MeridianVoManager.ins.fromServer(t),this.finishPre(new MeridianUI)},t}(PreUIBase);__reflect(MeridianUIPre.prototype,"MeridianUIPre");var MeridianBodyComponent=function(e){function t(){var t=e.call(this)||this;return t.body=0,t}return __extends(t,e),t.prototype.changeBody=function(e){e!=this.body&&(this.body=e,this.createSkin())},t.prototype.createSkin=function(){UIUtil.dispose(this);var e="MeridianBody_"+this.body+"_Skin";this.skin=UIUtil.getSkin(e),this.addChild(this.skin),this.roleImg=this.getMc("roleImg"),this.jmIcon1=this.getMc("jm_icon_1"),this.jmIcon2=this.getMc("jm_icon_2"),this.jmIcon3=this.getMc("jm_icon_3"),this.jmIcon4=this.getMc("jm_icon_4"),this.jmIcon5=this.getMc("jm_icon_5"),this.jmIcon6=this.getMc("jm_icon_6"),this.jmIcon7=this.getMc("jm_icon_7"),this.jmIcon8=this.getMc("jm_icon_8"),this.jmIcon9=this.getMc("jm_icon_9")},t.prototype.getMc=function(e,t){return void 0===t&&(t=null),t?t[e]?t[e]:t.getChildByName(e):this.skin[e]?this.skin[e]:void 0},t.prototype.updateBody=function(){var e=MeridianVoManager.ins.meridianVo,t=MetaMeridianManager.ins.getMeridianForId(e.id),i=Math.max(1,t.type);this.changeBody(i),this.updateStar()},t.prototype.updateStar=function(){for(var e,t=MeridianVoManager.ins.meridianVo,i=MetaMeridianManager.ins.getMeridianForId(t.id),n=1;9>=n;n++)e=this["jmIcon"+n],e.visible=!0,n<i.star?e.texture=RES.getRes("jm_state_0"):n==i.star?e.texture=RES.getRes("jm_state_1"):e.visible=!1},t.prototype.levelUp=function(e){if(e){var t=e.data,i=MetaMeridianManager.ins.getMeridianForId(t),n=this["jmIcon"+i.star],o=new DDMovieClip("jingmai_effect_1",1);this.skin.addChild(o),o.x=n.x+n.width/2,o.y=n.y+n.height/2}},t}(egret.DisplayObjectContainer);__reflect(MeridianBodyComponent.prototype,"MeridianBodyComponent");var MeridianBottomComponent=function(e){function t(t,i){return void 0===i&&(i=null),e.call(this,t,i)||this}return __extends(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this.levelUpBtn.dispose(),this.nowMeridianCom.dispose(),this.nextMeridianCom.dispose(),EventCenter.ins.remove(EventCenter.GUIDE_CHECK,this.checkGuide,this)},t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.levelUpBtn=UIUtil.getButton("levelUpBtn",this.skin,this.onLevelUp,this),this.nowMeridianCom=new MeridianBottomInfoComponent(this.getMc("nowMeridianCom")),this.nextMeridianCom=new MeridianBottomInfoComponent(this.getMc("nextMeridianCom")),this.expBar=new NormalUIBarComponent(this.getMc("expBar")),this.arrawImg=this.getMc("arrawImg"),this.updateLevel(),EventCenter.ins.add(EventCenter.GUIDE_CHECK,this.checkGuide,this),this.checkGuide()},t.prototype.checkGuide=function(){if(GuideVoManager.ins.isJingMaiStep(1)){var e=UIUtil.local2Global(this.levelUpBtn.target);Guide.ins.show(e.x,e.y,this.levelUpBtn.target.width,this.levelUpBtn.target.height)}},t.prototype.updateBtn=function(){this.levelUpBtn.currentState=MeridianVoManager.ins.canLevelUp()?"up":"disabled"},t.prototype.onLevelUp=function(){var e=MeridianVoManager.ins.meridianVo,t=MetaMeridianManager.ins.getMeridianForId(e.id);return e.count<t.costCultivation?void Alert.ins.showAlert(AlertType.ERROR,"修为不足!"):e.id==MetaMeridianManager.maxId?void Alert.ins.showAlert(AlertType.ERROR,"已经满级!"):(LoadingIcon.instance.show(),void Game.net.sendData({cmd:BookCmd.MERIDIAN_LEVEL_UP},this.sureLevelUp,this))},t.prototype.sureLevelUp=function(e){LoadingIcon.instance.hide();var t=e.dataVo,i=MeridianVoManager.ins.meridianVo,n=MetaMeridianManager.ins.getMeridianForId(i.id),o=MetaMeridianManager.ins.getMeridianForId(i.id+1),r=o.wuhon-n.wuhon;Alert.ins.showAlert(AlertType.TIP,"增加"+r+"武魂"),MeridianVoManager.ins.fromServer(t),EventCenter.ins.send(EventCenter.MERIDIAN_LEVEL_UP,o.id),this.updateLevel(),GuideVoManager.ins.isJingMaiStep(1)&&Guide.ins.nextStep2()},t.prototype.updateLevel=function(){this.updateBtn();var e=MeridianVoManager.ins.meridianVo,t=MetaMeridianManager.ins.getMeridianForId(e.id);if(this.nowMeridianCom.updateInfo(t),e.id==MetaMeridianManager.maxId)return this.arrawImg.visible=!1,this.nextMeridianCom.setVisible(!1),this.nowMeridianCom.skin.x=264,this.levelUpBtn.visible=!1,this.expBar.maximum=1,this.expBar.value=1,void this.expBar.updateLabelContent("已满级");var i=MetaMeridianManager.ins.getMeridianForId(e.id+1);this.nextMeridianCom.updateInfo(i),this.expBar.maximum=t.costCultivation,this.expBar.minimum=0,this.expBar.value=e.count},t}(BaseSkin);__reflect(MeridianBottomComponent.prototype,"MeridianBottomComponent");var MeridianBottomInfoComponent=function(e){function t(t,i){return void 0===i&&(i=null),e.call(this,t,i)||this}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.wuhonLabel=this.getMc("wuhonLabel"),this.nameImg=this.getMc("nameImg"),this.starImg=this.getMc("starImg")},t.prototype.updateInfo=function(e){0==e.type?this.nameImg.visible=!1:this.nameImg.texture=RES.getRes("jm_name_1_"+e.type),this.starImg.texture=RES.getRes("jm_star_"+e.star),this.wuhonLabel.text="+"+e.wuhon},t}(BaseSkin);__reflect(MeridianBottomInfoComponent.prototype,"MeridianBottomInfoComponent");var NewbieWelfareUI=function(e){function t(){var t=e.call(this)||this;return t.operIndex=-1,t.btnIndex=0,t.signDayId=0,t.signId=0,t.skinName="NewbieWelfareUISkin",t}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.topCom=new UITopComponent(this.skin.topBoard),this.titleImage=this.getMc("titleImage"),this.signBtn=this.getMc("signBtn"),this.payBtn=this.getMc("payBtn"),this.welfareBtn=this.getMc("welfareBtn"),this.noLabel=this.getMc("noLabel"),this.adImg=this.getMc("adImg"),this.dayRecharg=this.getMc("dayRecharg"),this.list=this.getMc("list"),this.everyDay=this.getMc("everyDay"),this.dayRecharge=this.getMc("dayRecharge"),this.title_gr=this.getMc("title_gr"),this.continueValueLabel=UIUtil.getLabel("","continueValueLabel",this.skin),this.continueValueLabel.text=DayVoManager.ins.dayVo.signedDay+"天",this.dayRechargeLabel=this.getMc("dayRechargeLabel"),this.dayRechargeLabel.text=RechargeRewardVoManager.ins.dayRechargeRewardVo.dayPayCount+"元 ",this.list.itemRenderer=EveryDayListItemRender,this.signBtn.currentState="down",this.updateList(t.tabIndex),EventCenter.ins.add(EventCenter.DAY_BTN_CLICK,this.onSignClick,this),EventCenter.ins.add(EventCenter.RECHARGE_REWARD_CLICK_ITEM,this.onRechargeRewardClickItem,this),EventCenter.ins.add(EventCenter.NEWBIE_WELFARE_CLICK,this.onDayClick,this),EventCenter.ins.add(EventCenter.NEWBIE_WELFARE,this.checkNewbieWelfare,this),this.signBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onMenuClick,this),this.payBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onMenuClick,this),this.welfareBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onMenuClick,this);var i=VoUtil.checkNewbieWelfare();i[0]||this.checkNewbieWelfare()},t.prototype.onMenuClick=function(e){var t=e.currentTarget;switch(t.name){case"signBtn":this.titleImage.source="day_1_jpg",this.setTab(0);break;case"payBtn":this.titleImage.source="day_1_jpg",this.setTab(1);break;case"welfareBtn":this.titleImage.source="newbiewTitle_jpg",this.setTab(2)}},t.prototype.setTab=function(e){void 0===e&&(e=0),e!=t.tabIndex&&(t.tabIndex=e,this.signBtn.currentState="up",this.payBtn.currentState="up",this.welfareBtn.currentState="up",this.dayRecharge.visible=!1,this.everyDay.visible=!1,this.title_gr.visible=!1,this.adImg.visible=!1,this.dayRecharg.visible=!1,0==t.tabIndex?(this.signBtn.currentState="down",this.everyDay.visible=!0,this.adImg.visible=!0,LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.DAY_PANEL,type:SignType.SIGN},this.onRequestRankList,this)):1==t.tabIndex?(this.payBtn.currentState="down",this.dayRecharge.visible=!0,this.dayRecharg.visible=!0,LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.DAY_RECHARGE_PANEL},this.onRequestRankList,this)):2==t.tabIndex&&(this.welfareBtn.currentState="down",this.title_gr.visible=!0,LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.NEWBIE_WELFARE_ORDER},this.onRequestRankList,this)))},t.prototype.onRequestRankList=function(e){switch(LoadingIcon.instance.hide(),t.tabIndex){case 0:this.list.itemRenderer=EveryDayListItemRender,DayVoManager.ins.fromServer(e.dataVo,SignType.SIGN),this.noLabel.visible=!1;break;case 1:this.list.itemRenderer=DayRechargeListItemRender,RechargeRewardVoManager.ins.initDayRechargeReward(e.dataVo);break;case 2:this.list.itemRenderer=NewbieWelfareListItemRender,NewbieWelfareVoManager.ins.fromServer(e.dataVo),this.noLabel.visible=!1}this.updateList(t.tabIndex)},t.prototype.updateList=function(e){if(1==e){this.dayRechargeLabel.text=RechargeRewardVoManager.ins.dayRechargeRewardVo.dayPayCount+"元 ";var t=RechargeRewardVoManager.ins.getDayListGroup(RechargeRewardType.RECHARGE);return void(this.list.dataProvider=new eui.ArrayCollection(t))}this.list.dataProvider=new eui.ArrayCollection(MetaDayManager.ins.getDaysForType(e+1))},t.prototype.onSignClick=function(e){this.signDayId=e.data;var t=MetaDayManager.ins.getDay(this.signDayId);return 2==t.type?(this.onClose(),void GameUIUtil.showShop(2)):(LoadingIcon.instance.show(),void Game.net.sendData({cmd:BookCmd.DAY_SIGN_OR_RECHARGE,type:t.type},this.onSignII,this))},t.prototype.onSignII=function(e){LoadingIcon.instance.hide(),log("onSign........signid:"+this.signDayId);var t=e.dataVo.dtoList;GameUtil.handleBags(t),DayVoManager.ins.sign(this.signDayId),this.operIndex=-1,this.continueValueLabel.text=DayVoManager.ins.dayVo.signedDay+"天",this.updateList(this.btnIndex)},t.prototype.onRechargeRewardClickItem=function(e){var t=e.data;this.metaId=t.id;var i=RechargeRewardVoManager.ins.dayRechargeRewardVo,n=t.rmb-i.dayPayCount;if(0>=n)LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.DAY_RECHARGE_GET_REWARD,id:t.id},this.onGetReward,this);else{if(!VoUtil.checkFunctionOpen(FunctionId.SHOP)){var o=MetaFunctionOpenManager.ins.getOpenForFunctionId(FunctionId.SHOP);return void Alert.ins.showAlert(AlertType.ERROR,"藏宝需要玩家等级达到"+o.openLevel+"级")}this.onClose(),GameUIUtil.showShop(2)}},t.prototype.onGetReward=function(e){LoadingIcon.instance.hide(),GameUtil.handleBags(e.dataVo.dtoList),RechargeRewardVoManager.ins.rechargeGetReward(this.metaId),this.updateDayList()},t.prototype.updateDayList=function(){var e=RechargeRewardVoManager.ins.getDayListGroup(RechargeRewardType.RECHARGE);return 0==e.length?(this.noLabel.visible=!0,void EventCenter.ins.send(EventCenter.RECHARGE_REWARD_UPDATE)):void(this.list.dataProvider=new eui.ArrayCollection(e))},t.prototype.onDayClick=function(e){this.signId=e.data;var t=MetaDayManager.ins.getDay(this.signId);LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.GET_NEWBIE_WELFARE_ORDER,id:t.needDay},this.onSign,this)},t.prototype.onSign=function(e){LoadingIcon.instance.hide(),log("onSign........signid:"+this.signId);var t=e.dataVo.reward;GameUtil.handleBags(t),this.operIndex=-1,this.updateList(this.btnIndex),NewbieWelfareVoManager.ins.sign(e.dataVo.id)},t.prototype.checkNewbieWelfare=function(){var e=VoUtil.checkNewbieWelfare()[0];e||(this.welfareBtn.visible=!1,this.titleImage.source="day_1_jpg",this.setTab(0))},t.prototype.dispose=function(){e.prototype.dispose.call(this),t.tabIndex=0,EventCenter.ins.remove(EventCenter.DAY_BTN_CLICK,this.onSignClick,this),EventCenter.ins.remove(EventCenter.RECHARGE_REWARD_CLICK_ITEM,this.onRechargeRewardClickItem,this),EventCenter.ins.remove(EventCenter.NEWBIE_WELFARE_CLICK,this.onDayClick,this),EventCenter.ins.remove(EventCenter.NEWBIE_WELFARE,this.checkNewbieWelfare,this),this.list.dataProvider=null,this.topCom.dispose(),this.topCom=null,UIUtil.destroyRes(t.RES_NAME),UIUtil.destroyRes("recharge"),UIUtil.dispose(this)},t.RES_NAME="day",t.tabIndex=0,t}(BaseUI);__reflect(NewbieWelfareUI.prototype,"NewbieWelfareUI");var NewbieWelfareUIPre=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.startPre=function(){UIResLoading.loadReses("recharge",null,this),UIResLoading.loadReses(EveryDayUI.RES_NAME,this.onRequestInfo,this)},t.prototype.onRequestInfo=function(){LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.DAY_PANEL,type:SignType.SIGN},this.onSignPanel,this)},t.prototype.onSignPanel=function(e){LoadingIcon.instance.hide(),DayVoManager.ins.fromServer(e.dataVo,SignType.SIGN),this.finishPre(new NewbieWelfareUI)},t}(PreUIBase);__reflect(NewbieWelfareUIPre.prototype,"NewbieWelfareUIPre");var NewbieWelfareListItemRender=function(e){function t(){var t=e.call(this)||this;return t.hasDo=!0,t.skinName="resource/skins/ui/newbieWelfare/list/NewbieWelfareListItemSkin.exml",t.addEventListener(eui.UIEvent.CREATION_COMPLETE,t.onCreated,t),t.addEventListener(egret.Event.REMOVED_FROM_STAGE,t.dispose,t),t}return __extends(t,e),t.prototype.dispose=function(e){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.onCreated,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.dispose,this),this.btn.dispose()},t.prototype.onCreated=function(){this.btn=UIUtil.getButton("btn",this,this.onBtn,this)},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this);var t=this.data,i="gold_icon_recharge";this.titleLabel.text="第"+t.needDay+"天";GameUtil.getResName(t.rewardType);ResType.GOLD==t.rewardType?i="yuanbao_big_icon":ResType.WARTH==t.rewardType?i="zhanyi_big_icon":0==t.rewardType?i=GameUtil.getOfficerHeadName(t.rewardOfficerType):ResType.SILVER==t.rewardType&&(i="yinliang_big_icon"),this.desLabel.text=GameUtil.getFuliDes(t.needDay),this.iconImg.source=i;var n=NewbieWelfareVoManager.ins.newbieWelfareVo,o=n.nowDay;if(o>t.needDay){var r=NewbieWelfareVoManager.ins.hasGet(t.needDay);this.btn.label=r?"已领取":"未达成",this.btn.enabled=!1}else o==t.needDay?n.hasGet?(this.btn.label="已领取",this.btn.enabled=!1):(this.btn.label="领取",this.btn.enabled=!0):(this.btn.label="未达成",this.btn.enabled=!1)},t.prototype.onBtn=function(e){EventCenter.ins.send(EventCenter.NEWBIE_WELFARE_CLICK,this.data.id)},t}(eui.ItemRenderer);__reflect(NewbieWelfareListItemRender.prototype,"NewbieWelfareListItemRender");var OfficerEquipUI=function(e){function t(t){var i=e.call(this)||this;return i.nowItem=null,i.initPos=new egret.Point(312,906),i.officerVo=t,i.skinName="OfficerEquipUISkin",i}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.equipOfficer=new OfficerEquipedOfficerComponent(this.skin.equipOfficerSkin,{type:OfficerItemType.EQUIPED}),this.officerItem=new OfficerItemRenderComponent({has:!0,officer:this.officerVo}),this.officerItem.itemType=OfficerItemType.UNEQUIPED,this.addChild(this.officerItem),this.officerItem.x=this.initPos.x,this.officerItem.y=this.initPos.y,TweenMax.from(this.officerItem,.5,{y:this.officerItem.y+60}),this.items=this.equipOfficer.items,EventCenter.ins.add(EventCenter.CLICK_OFFICER_ITEM_FOR_ITEM_TYPE,this.clickItem,this),this.officerItem.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onItemBegin,this),this.officerItem.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onItemMove,this),this.officerItem.addEventListener(egret.TouchEvent.TOUCH_END,this.onItemEnded,this)},t.prototype.dispose=function(){e.prototype.dispose.call(this),EventCenter.ins.remove(EventCenter.CLICK_OFFICER_ITEM_FOR_ITEM_TYPE,this.clickItem,this),this.officerItem.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onItemBegin,this),this.officerItem.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onItemMove,this),this.officerItem.removeEventListener(egret.TouchEvent.TOUCH_END,this.onItemEnded,this),TweenMax.killTweensOf(this.officerItem),this.removeChild(this.officerItem),this.officerItem=null,this.equipOfficer.dispose(),this.equipOfficer=null,this.nowItem.dispose(),this.nowItem=null},t.prototype.onItemBegin=function(e){var t=new egret.Point;this.globalToLocal(e.stageX,e.stageY,t),TweenMax.killTweensOf(this.officerItem),TweenMax.to(this.officerItem,.08,{x:t.x,y:t.y})},t.prototype.onItemMove=function(e){var t=new egret.Point;this.globalToLocal(e.stageX,e.stageY,t),this.officerItem.x=t.x,this.officerItem.y=t.y;var i=this.getItem(e.stageX,e.stageY);this.setNowItem(i)},t.prototype.setNowItem=function(e){e?(this.nowItem&&this.nowItem!=e&&this.nowItem.showScale(!1),this.nowItem=e,this.nowItem.showScale(!0)):(this.nowItem&&this.nowItem.showScale(!1),this.nowItem=null)},t.prototype.onItemEnded=function(e){this.nowItem?this.sendEquipOfficer(this.nowItem.officerObj.officer,this.officerVo):(TweenMax.killTweensOf(this.officerItem),TweenMax.to(this.officerItem,.1,{x:this.initPos.x,y:this.initPos.y}))},t.prototype.getItem=function(e,t){var i=new egret.Point;this.equipOfficer.officersGroup.globalToLocal(e,t,i);for(var n,o=0,r=this.items.length;r>o;o++)if(n=this.items[o],n.checkContain(i))return n;return null},t.prototype.clickItem=function(e){var t=e.data;OfficerItemType.EQUIPED==t.itemType&&this.sendEquipOfficer(t.value,this.officerVo)},t.prototype.sendEquipOfficer=function(e,t){var i={cmd:BookCmd.EQUIP_ONE_OFFICER,id:t.metaOfficer.type,target:e.metaOfficer.type};LoadingIcon.instance.show(),Game.net.sendData(i,this.sureEquipOfficer,this)},t.prototype.sureEquipOfficer=function(e){LoadingIcon.instance.hide();var t=e.dataVo,i=t.target;OfficerVoManager.ins.equipOfficer(OfficerVoManager.ins.getOfficerForType(i),this.officerVo),EventCenter.ins.send(EventCenter.UPDATE_OFFICER_LIST,{type:2}),EventCenter.ins.send(EventCenter.OFFICER_CHANGE_ITEM,{targetType:i,sourceType:this.officerVo.id}),this.onClose()},t}(BaseUI);__reflect(OfficerEquipUI.prototype,"OfficerEquipUI");var OfficerInfoUI=function(e){function t(t){var i=e.call(this)||this;return i.metaMap=null,i.officerVo=t,i.skinName="OfficerInfoUISkin",i}return __extends(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),UIUtil.dispose(this.consumeGroup),this.enterMapLabel.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEnterMap,this),this.exchangeSilverLabel.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.showExchangeSilver,this),EventCenter.ins.remove(EventCenter.UPDATE_PLAYER,this.updateLevelUp,this),this.fetterList.dataProvider=null,this.levelUpBtn.dispose(),this.levelUpBtn=null,this.equipBtn.dispose(),this.equipBtn=null
},t.prototype.onAdded=function(){e.prototype.onAdded.call(this);var i=this.officerVo.metaOfficer;this.itemComponent=new OfficerItemRenderComponent({has:!0,officer:this.officerVo}),this.itemComponent.touchEnabled=!1,this.itemComponent.touchChildren=!1,this.addChild(this.itemComponent),this.itemComponent.x=160,this.itemComponent.y=277,this.colorLabel=UIUtil.getLabel(GameUtil.getColorName(i.quality),"colorLabel",this.skin),this.colorLabel.textColor=GameUtil.getColor(i.quality);var n=UIUtil.getLabel(i.needLevel+"","levelLabel",this.skin);if(n.textColor=PlayerVoManager.ins.playerVo.level>=i.needLevel?GameUtil.getColor(ColorType.GREEN):GameUtil.getColor(ColorType.RED),0==i.skillId)UIUtil.getLabel("无","skillNameLabel",this.skin),UIUtil.getLabel("","desLabel",this.skin),this.skin.skillProbabilityLabel.visible=!1,this.skin.skillProbabilityIILabel.visible=!1;else{var o=MetaSkillManager.ins.getSkill(i.skillId);UIUtil.getLabel(o.name,"skillNameLabel",this.skin),UIUtil.getLabel(o.des,"desLabel",this.skin),UIUtil.getLabel(o.weight+"%","skillProbabilityLabel",this.skin)}this.mapNameLabel=this.getMc("mapNameLabel"),this.exchangeSilverLabel=this.getMc("exchangeSilverLabel");var r=OfficerVoManager.ins.getNormalFightingForce(this.officerVo);UIUtil.getBitmapLabel(r+"","fightingLabel",this.skin),this.hpLabel=this.getMc("hpLabel"),this.hpLabel.text=OfficerVoManager.ins.getOneOfficerProperty(this.officerVo,PropertyType.HP,!0)+"",this.attackLabel=this.getMc("attackLabel"),this.attackLabel.text=OfficerVoManager.ins.getOneOfficerProperty(this.officerVo,PropertyType.ATTACK,!0)+"",this.defenceLabel=this.getMc("defenceLabel"),this.defenceLabel.text=OfficerVoManager.ins.getOneOfficerProperty(this.officerVo,PropertyType.DEFENCE,!0)+"",this.fetterList=this.getMc("fetterList"),this.enterMapLabel=this.getMc("enterMapLabel"),this.fetterList.itemRenderer=OfficerFetterItemRender;for(var s=MetaOfficerFetterManager.ins.getFettersForType(i.type),a=new Array,h=0,p=s.length;p>h;h++)a.push(this.getFetterDes(s[h]));a.sort(GameUtil.sortFetters),this.fetterList.dataProvider=new eui.ArrayCollection(a),this.consumeGroup=this.skin.consumeGroup,this.levelUpBtn=UIUtil.getButton("levelUpBtn",this.skin,this.onLevelUp,this),this.equipBtn=UIUtil.getButton("equipBtn",this.skin,this.onEquip,this);var l="无";if(0!=i.mapIds.length){var p=i.mapIds.length;if(p>1)for(var h=0;p>h&&(this.metaMap=MetaMapManager.ins.getMap(i.mapIds[h]),this.metaMap.type!=PlayerVoManager.ins.playerVo.camp+9);h++);else this.metaMap=MetaMapManager.ins.getMap(i.mapIds[0]);l=MainMapUtil.getMapPath(this.metaMap)}if(this.mapNameLabel.text=l,this.enterMapLabel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEnterMap,this),this.exchangeSilverLabel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showExchangeSilver,this),t.isForLook)return this.levelUpBtn.visible=this.consumeGroup.visible=!1,void(this.equipBtn.visible=!1);var u=this.getMc("consumeLabel",this.consumeGroup);if(u.text=Util.handleUnit2(i.consumeCoin),VoUtil.canLevelUpOfficer(this.officerVo)){var c=VoUtil.canLevelUpOfficerForSilver(this.officerVo);u.textColor=c?Constants.COLOR_DYNAMIC:16711680,this.exchangeSilverLabel.visible=!c}else this.levelUpBtn.currentState="disabled";this.equipBtn.currentState=VoUtil.canEquipOfficerForLevel(this.officerVo)?"up":"disabled",EventCenter.ins.add(EventCenter.UPDATE_PLAYER,this.updateLevelUp,this)},t.prototype.updateLevelUp=function(e){if(!t.isForLook){var i=this.getMc("consumeLabel",this.consumeGroup),n=this.officerVo.metaOfficer;if(i.text=Util.handleUnit2(n.consumeCoin),VoUtil.canLevelUpOfficer(this.officerVo)){var o=VoUtil.canLevelUpOfficerForSilver(this.officerVo);i.textColor=o?Constants.COLOR_DYNAMIC:16711680,this.exchangeSilverLabel.visible=!o}else this.levelUpBtn.currentState="disabled"}},t.prototype.showExchangeSilver=function(e){GameUIUtil.showShop(3)},t.prototype.onEnterMap=function(e){this.metaMap&&MainMapUtil.showEnterMap(this.metaMap.id,this.closeUI,this)},t.prototype.closeUI=function(){this.onClose(),EventCenter.ins.send(EventCenter.OFFICER_UI_CLOSE)},t.prototype.getFetterDes=function(e){for(var t=new Array,i=e.officers,n=OfficerVoManager.ins.getEquipedOrNoEquiped(!0),o=!0,r=new Array,s=i.length,a=0,h=null,p=0;s>p;p++)if(h=OfficerVoManager.ins.getOfficerForType(i[p]),h&&(a+=h.level),i[p]!=this.officerVo.metaOfficer.type){for(var l=!1,u=0,c=n.length;c>u;u++)if(n[u].metaOfficer.type==i[p]){r.push(n[u].metaOfficer),l=!0;break}l||(o=!1,r.push(MetaOfficerManager.ins.getOfficerForTypeAndLevel(i[p],1)))}var d=4013373;this.officerVo.isEquiped||(o=!1);var f=(o?Constants.COLOR_DYNAMIC:d,new Array);t.push({text:"与",style:{textColor:o?Constants.COLOR_NORMAL:d}});for(var g,p=0,m=r.length;m>p;p++)g=r[p],t.push({text:g.name,style:{textColor:o?GameUtil.getColor(g.quality):d}}),p!=m-1&&t.push({text:",",style:{textColor:o?Constants.COLOR_NORMAL:d}});t.push({text:"一起出战"+(o?"激活":"最高可激活"),style:{textColor:o?Constants.COLOR_NORMAL:d}});var y=a/(10*s);if(0!=e.addAttack)if(o){var v=e.addAttack*y;v=Math.floor(v),f.push({property:PropertyType.ATTACK,value:v});var E="攻击+"+v+(e.addDefence||e.addHp?",":"");t.push({text:E,style:{textColor:o?GameUtil.getColor(ColorType.GREEN):d}})}else t.push({text:"攻击+"+e.addAttack+",",style:{textColor:d}});if(0!=e.addDefence)if(o){var C=e.addDefence*y;C=Math.floor(C),f.push({property:PropertyType.DEFENCE,value:C});var E="防御+"+C+(e.addHp?",":"");t.push({text:E,style:{textColor:o?GameUtil.getColor(ColorType.GREEN):d}})}else t.push({text:"防御+"+e.addDefence+",",style:{textColor:d}});if(0!=e.addHp)if(o){var _=e.addHp*y;_=Math.floor(_),f.push({property:PropertyType.HP,value:_});var E="血量+"+_;t.push({text:E,style:{textColor:o?GameUtil.getColor(ColorType.GREEN):d}})}else t.push({text:"血量+"+e.addHp,style:{textColor:d}});return{hasActivate:o?1:0,texts:t,addPropertys:f,fetterName:e.name}},t.prototype.onLevelUp=function(){if(!VoUtil.canLevelUpOfficer(this.officerVo)){MetaOfficerManager.ins.getOfficerMaxLevel(this.officerVo.metaOfficer.type);if(10==this.officerVo.level)return void Alert.ins.showAlert(AlertType.ERROR,"武将已经升到满级!");if(this.officerVo.pieceCount<this.officerVo.metaOfficer.consumeChip)return void Alert.ins.showAlert(AlertType.ERROR,"武将碎片不足!")}if(!VoUtil.canLevelUpOfficerForSilver(this.officerVo))return void Alert.ins.showAlert(AlertType.ERROR,"银币不足!");var e={cmd:BookCmd.LEVEL_UP_ONE_OFFICER,id:this.officerVo.metaOfficer.type};LoadingIcon.instance.show(),Game.net.sendData(e,this.sureLevelUp,this)},t.prototype.sureLevelUp=function(e){LoadingIcon.instance.hide();var t=e.dataVo,i=OfficerVoManager.ins.getNormalPropertyVo(),n=OfficerVoManager.ins.getOfficerForType(t.id);n&&(n.level=t.lv,n.pieceCount=t.count,n.metaOfficer=MetaOfficerManager.ins.getOfficerForTypeAndLevel(t.id,t.lv));var o=OfficerVoManager.ins.getNormalPropertyVo();GameUtil.handleNormalProperty(i,o),UIManager.ins.close(this);var r=new Array,s=new Array;n.isEquiped?r.push(n.id):s.push(n.id),EventCenter.ins.send(EventCenter.UPDATE_OFFICER_LIST,{type:1,equipedOfficers:r,noEquipedOfficers:s}),EventCenter.ins.send(EventCenter.UPDATE_OFFICER_PIECE)},t.prototype.onEquip=function(){return this.officerVo.isEquiped?void Alert.ins.showAlert(AlertType.ERROR,this.officerVo.metaOfficer.name+"已经装备!"):VoUtil.canEquipOfficerForLevel(this.officerVo)?(EventCenter.ins.send(EventCenter.OFFICER_ONE_EQUIP,this.officerVo),void UIManager.ins.close(this)):void Alert.ins.showAlert(AlertType.ERROR,"玩家等级需要达到"+this.officerVo.metaOfficer.needLevel)},t.isForLook=!1,t}(BaseUI);__reflect(OfficerInfoUI.prototype,"OfficerInfoUI");var OfficerUI=function(e){function t(){var t=e.call(this)||this;return t.startY=0,t.nowItem=null,t.initPos=new egret.Point(312,906),t.skinName="OfficerUISkin",t.hasOpenEffect=t.hasCloseEffect=!1,t}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.topBoard=new UITopComponent(this.skin.topBoard),this.contentScroller=this.getMc("contentScroller"),this.equipGroup=this.getMc("equipGroup"),this.contentScroller.verticalScrollBar=null;this.contentScroller.viewport;this.contentScroller.bounces=!1,this.contentScroller.throwSpeed=.3,eui.Scroller.scrollThreshold=5,this.equipedOfficerCom=new OfficerEquipedOfficerComponent(this.getMc("equipedOfficerSkin")),this.bagOfficersCom=new OfficerBagOfficerComponent(this.getMc("bagOfficersSkin")),this.exchangeSilverLabel=this.getMc("exchangeSilverLabel"),this.exchangeSilverLabel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showExchangeSilver,this),this.levelUpBtn=UIUtil.getButton("levelUpBtn",this.skin,this.onLevelUp,this),this.equipBtn=UIUtil.getButton("equipBtn",this.skin,this.onOneEquip,this),EventCenter.ins.add(EventCenter.UPDATE_OFFICER_LIST,this.updateBtns,this),EventCenter.ins.add(EventCenter.OFFICER_CHANGE_ITEM,this.onOfficerChangeItem,this),EventCenter.ins.add(EventCenter.OFFICER_ONE_EQUIP,this.onEquipOneOfficer,this),EventCenter.ins.add(EventCenter.OFFICER_CLICK_ITEM_SHOW_INFO,this.onClickItemShowInfo,this),this.contentScroller.addEventListener(eui.UIEvent.CHANGE_END,this.onChangeEnded,this),this.contentScroller.addEventListener(eui.UIEvent.CHANGE,this.onChange,this),EventCenter.ins.add(EventCenter.GUIDE_CHECK,this.checkGuide,this),EventCenter.ins.add(EventCenter.OFFICER_UI_CLOSE,this.onClose,this),EventCenter.ins.add(EventCenter.UPDATE_PLAYER,this.updateLevelUp,this),this.updateBtns(),this.showEquipOfficer(!1),this.onChangeEnded(null),this.checkGuide(),this.startY=this.contentScroller.viewport.scrollV},t.prototype.onChange=function(e){var t=this.contentScroller.viewport.scrollV,i=t-this.startY;Math.abs(i)>60&&(this.onChangeEnded(null),this.startY=t)},t.prototype.showExchangeSilver=function(e){GameUIUtil.showShop(3)},t.prototype.onChangeEnded=function(e){this.equipedOfficerCom.updateVisible(),this.bagOfficersCom.refreshPage()},t.prototype.onOfficerChangeItem=function(e){this.contentScroller.viewport.scrollH=0},t.prototype.onClickItemShowInfo=function(e){this.selectedOfficerItem&&this.selectedOfficerItem.showSelected(!1);var t=e.data;1==t.type?this.selectedOfficerItem=this.equipedOfficerCom.getItem(t.officerVo.id):this.selectedOfficerItem=this.bagOfficersCom.getOfficerItem(t.officerVo.id),this.selectedOfficerItem&&this.selectedOfficerItem.showSelected(!0),GameUIUtil.showOfficerInfoUI(t.officerVo)},t.prototype.checkGuide=function(){if(14==GuideVoManager.ins.guideVo.nowStep){var e=UIUtil.local2Global(this.equipBtn.target);Guide.ins.show(e.x,e.y,this.equipBtn.width,this.equipBtn.height)}else if(15==GuideVoManager.ins.guideVo.nowStep){var e=UIUtil.local2Global(this.closeBtn.target);Guide.ins.show(e.x,e.y,this.closeBtn.width,this.closeBtn.height,GuideStep.tuichu)}else if(GuideVoManager.ins.isShopStep(7)){if(!this.levelUpBtn.enabled)return void Guide.ins.nextStep2();var e=UIUtil.local2Global(this.levelUpBtn.target);Guide.ins.show(e.x,e.y,this.levelUpBtn.width,this.levelUpBtn.height)}else if(GuideVoManager.ins.isShopStep(8)){if(!this.equipBtn.enabled)return void Guide.ins.nextStep2();var e=UIUtil.local2Global(this.equipBtn.target);Guide.ins.show(e.x,e.y,this.equipBtn.width,this.equipBtn.height)}else if(GuideVoManager.ins.isShopStep(9)){var e=UIUtil.local2Global(this.closeBtn.target);Guide.ins.show(e.x,e.y,this.closeBtn.width,this.closeBtn.height,GuideStep.tuichu)}},t.prototype.onClose=function(){if(15==GuideVoManager.ins.guideVo.nowStep){var t=this;Guide.ins.nextStep(function(){EventCenter.ins.send(EventCenter.GUIDE_CHECK),t.closeForGuide()})}else GuideVoManager.ins.isShopStep(9)?(e.prototype.onClose.call(this),Guide.ins.nextStep2()):e.prototype.onClose.call(this)},t.prototype.closeForGuide=function(){e.prototype.onClose.call(this)},t.prototype.updateBtns=function(){var e=VoUtil.canOneKeyLevelUpOfficer();if(this.equipBtn.enabled=VoUtil.canOfficerOneKeyEquip(),this.levelUpBtn.enabled=e,e)return void(this.exchangeSilverLabel.visible=!1);for(var t=!1,i=OfficerVoManager.ins.officers,n=0;n<i.length;n++){var o=i[n];if(VoUtil.canLevelUpOfficer(o)){t=!0;break}}this.exchangeSilverLabel.visible=t},t.prototype.updateLevelUp=function(e){this.updateBtns()},t.prototype.onLevelUp=function(){var e={cmd:BookCmd.LEVEL_UP_ALL_OFFICER};LoadingIcon.instance.show(),Game.net.sendData(e,this.sureLevelUp,this)},t.prototype.sureLevelUp=function(e){LoadingIcon.instance.hide();var t=OfficerVoManager.ins.getOfficersLevel(!0),i=OfficerVoManager.ins.getOfficersLevel(!1),n=OfficerVoManager.ins.getNormalPropertyVo();OfficerVoManager.ins.initFromServer(e.dataVo);var o=OfficerVoManager.ins.getNormalPropertyVo();GameUtil.handleNormalProperty(n,o);for(var r=OfficerVoManager.ins.getOfficersLevel(!0),s=OfficerVoManager.ins.getOfficersLevel(!1),a=new Array,h=0,p=t.length;p>h;h++)for(var l=t[h],u=0,c=r.length;c>u;u++){var d=r[u];if(l.type==d.type){l.level!=d.level&&a.push(l.type);break}}for(var f=new Array,h=0,p=i.length;p>h;h++)for(var l=i[h],u=0,c=s.length;c>u;u++){var d=s[u];if(l.type==d.type){l.level!=d.level&&f.push(l.type);break}}EventCenter.ins.send(EventCenter.UPDATE_OFFICER_LIST,{type:1,equipedOfficers:a,noEquipedOfficers:f}),EventCenter.ins.send(EventCenter.UPDATE_OFFICER_PIECE),GuideVoManager.ins.isShopStep(7)&&Guide.ins.nextStep2()},t.prototype.onOneEquip=function(){var e={cmd:BookCmd.EQUIP_OFFICERS};LoadingIcon.instance.show(),Game.net.sendData(e,this.sureOneEquip,this)},t.prototype.sureOneEquip=function(e){LoadingIcon.instance.hide();var t=e.dataVo,i=t.fight,n=t.other,o=(OfficerVoManager.ins.getEquipedOrNoEquiped(!0),OfficerVoManager.ins.getNormalPropertyVo());OfficerVoManager.ins.oneKeyEquipOfficer(i,n);var r=OfficerVoManager.ins.getNormalPropertyVo();GameUtil.handleNormalProperty(o,r),EventCenter.ins.send(EventCenter.UPDATE_OFFICER_LIST,null),EventCenter.ins.send(EventCenter.UPDATE_OFFICER_PIECE);var s=this;14==GuideVoManager.ins.guideVo.nowStep?Guide.ins.nextStep(function(){s.checkGuide()},s):GuideVoManager.ins.isShopStep(8)&&Guide.ins.nextStep2()},t.prototype.onEquipOneOfficer=function(e){this.equipOfficerVo=e.data,this.showEquipOfficer(!0),this.initPos=new egret.Point(this.equipGroup.width/2,this.equipGroup.height/2),this.equipOfficerItem=new OfficerItemRenderComponent(this.selectedOfficerItem.officerObj),this.equipGroup.addChild(this.equipOfficerItem),this.equipOfficerItem.x=this.initPos.x,this.equipOfficerItem.y=this.initPos.y,this.equipOfficerItem.itemType=3,TweenMax.from(this.equipOfficerItem,.5,{y:this.equipOfficerItem.y+60}),this.contentScroller.viewport.scrollV=0,this.onChangeEnded(null),this.equipOfficerItem.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onItemBegin,this),this.equipOfficerItem.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onItemMove,this),this.equipOfficerItem.addEventListener(egret.TouchEvent.TOUCH_END,this.onItemEnded,this)},t.prototype.onItemBegin=function(e){var t=new egret.Point;this.equipGroup.globalToLocal(e.stageX,e.stageY,t),TweenMax.killTweensOf(this.equipOfficerItem),TweenMax.to(this.equipOfficerItem,.08,{x:t.x,y:t.y})},t.prototype.onItemMove=function(e){var t=new egret.Point;this.equipGroup.globalToLocal(e.stageX,e.stageY,t),this.equipOfficerItem.x=t.x,this.equipOfficerItem.y=t.y;var i=this.getItem(e.stageX,e.stageY);this.setNowItem(i)},t.prototype.getItem=function(e,t){var i=new egret.Point;this.equipedOfficerCom.officersGroup.globalToLocal(e,t,i);for(var n,o=this.equipedOfficerCom.items,r=0,s=o.length;s>r;r++)if(n=o[r],n.checkContain(i))return n;return null},t.prototype.setNowItem=function(e){e?(this.nowItem&&this.nowItem!=e&&this.nowItem.showScale(!1),this.nowItem=e,this.nowItem.showScale(!0)):(this.nowItem&&this.nowItem.showScale(!1),this.nowItem=null)},t.prototype.onItemEnded=function(e){this.nowItem?this.sendEquipOfficer(this.nowItem.officerObj.officer,this.equipOfficerVo):(TweenMax.killTweensOf(this.equipOfficerItem),TweenMax.to(this.equipOfficerItem,.1,{x:this.initPos.x,y:this.initPos.y,onComplete:this.cancelEquip,onCompleteParams:[this]}))},t.prototype.cancelEquip=function(e){TweenMax.killTweensOf(e.equipOfficerItem),e.showEquipOfficer(!1),EventCenter.ins.send(EventCenter.UPDATE_OFFICER_LIST,{type:2})},t.prototype.sendEquipOfficer=function(e,t){var i={cmd:BookCmd.EQUIP_ONE_OFFICER,id:t.metaOfficer.type,target:e.metaOfficer.type};LoadingIcon.instance.show(),Game.net.sendData(i,this.sureEquipOfficer,this)},t.prototype.sureEquipOfficer=function(e){LoadingIcon.instance.hide();var t=e.dataVo,i=t.target,n=UIUtil.local2Global2(this.nowItem.parent,new egret.Point(this.nowItem.x,this.nowItem.y)),o=UIUtil.global2Local(n,this.equipGroup);TweenMax.to(this.equipOfficerItem,.1,{x:o.x,y:o.y}),n=UIUtil.local2Global2(this.equipGroup,this.initPos),o=UIUtil.global2Local(n,this.equipedOfficerCom.officersGroup),TweenMax.to(this.nowItem,.1,{x:o.x,y:o.y,onComplete:this.onEquipEnd,onCompleteParams:[this,i]})},t.prototype.onEquipEnd=function(e,t){var i=OfficerVoManager.ins.getNormalPropertyVo();OfficerVoManager.ins.equipOfficer(OfficerVoManager.ins.getOfficerForType(t),e.equipOfficerVo);var n=OfficerVoManager.ins.getNormalPropertyVo();GameUtil.handleNormalProperty(i,n),e.equipedOfficerCom.updateOneItem(e.equipOfficerVo,OfficerVoManager.ins.getOfficerForType(t)),EventCenter.ins.send(EventCenter.UPDATE_OFFICER_LIST,{type:2}),e.showEquipOfficer(!1)},t.prototype.showEquipOfficer=function(e){e?(this.bagOfficersCom.setVisible(!1),this.levelUpBtn.visible=this.equipBtn.visible=!1,this.equipGroup.visible=!0):(this.bagOfficersCom.setVisible(!0),this.levelUpBtn.visible=this.equipBtn.visible=!0,this.equipGroup.visible=!1,this.equipOfficerItem&&(TweenMax.killTweensOf(this.equipOfficerItem),this.equipOfficerItem.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onItemBegin,this),this.equipOfficerItem.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onItemMove,this),this.equipOfficerItem.removeEventListener(egret.TouchEvent.TOUCH_END,this.onItemEnded,this),this.equipGroup.removeChild(this.equipOfficerItem),this.equipOfficerItem=null),this.nowItem&&(TweenMax.killTweensOf(this.nowItem),this.nowItem=null))},t.prototype.close=function(){this.onCloseEnd()},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.topBoard.dispose(),this.topBoard=null,this.equipedOfficerCom.dispose(),this.equipedOfficerCom=null,this.bagOfficersCom.dispose(),this.bagOfficersCom=null,this.levelUpBtn.dispose(),this.levelUpBtn=null,this.equipBtn.dispose(),this.equipBtn=null,this.exchangeSilverLabel.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.showExchangeSilver,this),UIUtil.destroyRes(t.RES_NAME),EventCenter.ins.remove(EventCenter.UPDATE_OFFICER_LIST,this.updateBtns,this),EventCenter.ins.remove(EventCenter.OFFICER_CHANGE_ITEM,this.onOfficerChangeItem,this),EventCenter.ins.remove(EventCenter.OFFICER_ONE_EQUIP,this.onEquipOneOfficer,this),EventCenter.ins.remove(EventCenter.OFFICER_CLICK_ITEM_SHOW_INFO,this.onClickItemShowInfo,this),EventCenter.ins.remove(EventCenter.GUIDE_CHECK,this.checkGuide,this),EventCenter.ins.remove(EventCenter.OFFICER_UI_CLOSE,this.onClose,this),this.contentScroller.removeEventListener(eui.UIEvent.CHANGE_END,this.onChangeEnded,this),this.contentScroller.removeEventListener(eui.UIEvent.CHANGE,this.onChange,this),EventCenter.ins.remove(EventCenter.UPDATE_PLAYER,this.updateLevelUp,this)},t.RES_NAME="officer",t}(BaseUI);__reflect(OfficerUI.prototype,"OfficerUI");var OfficerUIPre=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.startPre=function(){UIResLoading.loadReses(OfficerUI.RES_NAME,this.requestInfo,this)},t.prototype.requestInfo=function(){LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.GET_OFFICER_LIST},this.onGetOfficerList,this)},t.prototype.onGetOfficerList=function(e){LoadingIcon.instance.hide();var t=e.dataVo;OfficerVoManager.ins.initFromServer(t),this.finishPre(new OfficerUI)},t}(PreUIBase);__reflect(OfficerUIPre.prototype,"OfficerUIPre");var OfficerBagData=function(){function e(){this.isLevelUp=!1}return e}();__reflect(OfficerBagData.prototype,"OfficerBagData");var OfficerBagOfficerComponent=function(e){function t(t,i){void 0===i&&(i=null);var n=e.call(this,t,i)||this;return n.lineHeight=188,n.nowScrollerY=0,n.beginLineNum=0,n.endLineNum=0,n.isInited=!1,n.totalLineCount=0,n}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.hpLabel=this.getMc("hpLabel"),this.attackLabel=this.getMc("attackLabel"),this.defenceLabel=this.getMc("defenceLabel"),this.officersGroup=this.getMc("officersGroup"),this.bgImg=this.getMc("bgImg"),this.allOfficers=new Array,this.lines=new Array,this.updateAllOfficers(),EventCenter.ins.add(EventCenter.UPDATE_OFFICER_LIST,this.updateOfficers,this)},t.prototype.updateAllOfficers=function(){this.allOfficers.length=0,this.lineHeight=188;var e=OfficerVoManager.ins.getEquipedOrNoEquiped(!1);e.sort(GameUtil.sortOfficersForId);for(var t=0,i=e.length;i>t;t++)this.allOfficers.push({has:!0,officer:e[t]});for(var n=OfficerVoManager.ins.getNoOfficers(),t=0,i=n.length;i>t;t++)this.allOfficers.push({has:!1,officer:n[t]});this.totalLineCount=Math.ceil(this.allOfficers.length/3),this.officersGroup.height=this.totalLineCount*this.lineHeight,this.bgImg.height=this.officersGroup.height+14,this.hpLabel.text=OfficerVoManager.ins.getOfficerProperty(!1,PropertyType.HP)+"",this.attackLabel.text=OfficerVoManager.ins.getOfficerProperty(!1,PropertyType.ATTACK)+"",this.defenceLabel.text=OfficerVoManager.ins.getOfficerProperty(!1,PropertyType.DEFENCE)+""},t.prototype.getOfficerItem=function(e){for(var t=null,i=null,n=0,o=this.lines.length;o>n&&(i=this.lines[n],!(t=i.getItemForType(e)));n++);return t},t.prototype.getLineOfficers=function(e){for(var t=new Array,i=3*(e-1),n=this.allOfficers.length,o=0;3>o;o++){var r=i+o;if(r>=n)break;t.push(this.allOfficers[r])}return t},t.prototype.refreshPage=function(){var e=this,t=UIUtil.local2Global(e.skin).y,i=Game.stage.stageHeight-t-72,n=Math.ceil(i/this.lineHeight),o=1;if(0>t){var r=Math.floor(Math.abs(t-72)/this.lineHeight);o=r+1,n=n-r+o}if(n=Math.min(n,Math.ceil(this.allOfficers.length/3)),!this.isInited){for(var s=o;n>=s;s++)this.addLine(s);return this.beginLineNum=o,this.endLineNum=n,void(this.isInited=!0)}o>this.beginLineNum?this.removeLine(this.beginLineNum):o<this.beginLineNum&&this.addLine(o),n>this.endLineNum?this.addLine(n):n<this.endLineNum&&this.removeLine(this.endLineNum),this.beginLineNum=o,this.endLineNum=n},t.prototype.addLine=function(e){var t=this.getLineItem(e);if(t)return void(t.visible=!0);var i=this.getLineOfficers(e),n=new OfficerGroupItem(i,e);this.officersGroup.addChild(n),this.lines.push(n),n.lineNum=e,n.y=(e-1)*this.lineHeight},t.prototype.removeLine=function(e){var t=this.getLineItem(e);t&&(t.visible=!1)},t.prototype.getLineItem=function(e){for(var t=0,i=this.lines.length;i>t;t++){var n=this.lines[t];if(n.lineNum==e)return n}return null},t.prototype.updateOfficers=function(e){void 0===e&&(e=null),UIUtil.dispose(this.officersGroup),this.updateAllOfficers(),this.lines.length=0,this.officersGroup.height=0,this.isInited=!1,this.refreshPage();var t=new Array;e&&e.data&&1==e.data.type&&(t=e.data.noEquipedOfficers);for(var i=0,n=t.length;n>i;i++){var o=this.getOfficerItem(t[i]);o&&o.showLevelUp()}},t.prototype.dispose=function(){e.prototype.dispose.call(this),EventCenter.ins.remove(EventCenter.UPDATE_OFFICER_LIST,this.updateOfficers,this),UIUtil.dispose(this.officersGroup)},t}(BaseSkin);__reflect(OfficerBagOfficerComponent.prototype,"OfficerBagOfficerComponent");var OfficerEquipedOfficerComponent=function(e){function t(t,i){return void 0===i&&(i=null),e.call(this,t,i)||this}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.fightingLabel=this.getMc("fightingLabel"),this.hpLabel=this.getMc("hpLabel"),this.attackLabel=this.getMc("attackLabel"),this.defenceLabel=this.getMc("defenceLabel"),this.officersGroup=this.getMc("officersGroup"),this.items=new Array,this.officers=new Array,this.updateOfficers(),EventCenter.ins.add(EventCenter.UPDATE_OFFICER_LIST,this.updateOfficers,this)},t.prototype.updateVisible=function(){var e=UIUtil.local2Global(this.skin);e.y+this.skin.height<=0?this.skin.visible=!1:this.skin.visible=!0},t.prototype.updateOneItem=function(e,t){for(var i=0,n=this.officers.length;n>i;i++)t.id==this.officers[i].id&&(this.officers[i]=e);this.updateView([])},t.prototype.updateOfficers=function(e){if(void 0===e&&(e=null),!e||!e.data||2!=e.data.type){UIUtil.dispose(this.officersGroup),this.items.length=0,this.officers=OfficerVoManager.ins.getEquipedOrNoEquiped(!0),this.officers.sort(GameUtil.sortOfficersForFighting);var t=new Array;e&&e.data&&(t=e.data.equipedOfficers),this.updateView(t)}},t.prototype.updateView=function(e){this.fightingLabel.text=OfficerVoManager.ins.getTotalFightingForce()+"",this.hpLabel.text=OfficerVoManager.ins.getOfficerProperty(!0,PropertyType.HP)+"",this.attackLabel.text=OfficerVoManager.ins.getOfficerProperty(!0,PropertyType.ATTACK)+"",this.defenceLabel.text=OfficerVoManager.ins.getOfficerProperty(!0,PropertyType.DEFENCE)+"";var t,i=this.argObj?this.argObj.type:1;UIUtil.dispose(this.officersGroup),this.items.length=0;for(var n=0,o=this.officers.length;o>n;n++){var r=e.indexOf(this.officers[n].id)>=0;t=new OfficerItemRenderComponent({has:!0,officer:this.officers[n],isLevelUp:r}),t.itemType=i,t.x=n%3*(t.width+10)+t.width/2,t.y=Math.floor(n/3)*(t.height+10)+t.height/2,this.officersGroup.addChild(t),this.items.push(t)}},t.prototype.getItem=function(e){for(var t,i=0,n=this.items.length;n>i;i++)if(t=this.items[i],t.officerObj.officer.id==e)return t;return null},t.prototype.dispose=function(){e.prototype.dispose.call(this),EventCenter.ins.remove(EventCenter.UPDATE_OFFICER_LIST,this.updateOfficers,this),UIUtil.dispose(this.officersGroup)},t}(BaseSkin);__reflect(OfficerEquipedOfficerComponent.prototype,"OfficerEquipedOfficerComponent");var OfficerPropertyItemComponent=function(e){function t(t,i){return void 0===i&&(i=null),e.call(this,t,i)||this}return __extends(t,e),t.prototype.onAdded=function(){var e="";switch(this.argObj.icon){case PropertyType.HP:e="hp_icon";break;case PropertyType.ATTACK:e="attack_icon";break;case PropertyType.DEFENCE:e="defence_icon";break;case PropertyType.DODGE:e="shanbi_icon";break;case PropertyType.CRIT:e="crit_icon";break;case PropertyType.CRIT_HURT:e="crit_hurt_icon";break;case PropertyType.WULI:e="wuli_icon";break;case PropertyType.ZHILI:e="zhili_icon";break;case PropertyType.MINJIE:e="minjie_icon";break;case PropertyType.MEILI:e="meili_icon";break;case PropertyType.TONGSHUAI:e="tongshuai_icon";break;case PropertyType.NEILI:e="neili_icon";break;case PropertyType.GENGU:e="gengu_icon";break;case PropertyType.BILI:e="bili_icon";break;case PropertyType.WUHON:e="wuhon_icon"}this.iconImg=this.getMc("iconImg"),this.valueLabel=this.getMc("valueLabel"),UIUtil.getLabel(GameUtil.getPropertyName(this.argObj.icon)+"：","nameLabel",this.skin),this.iconImg.texture=RES.getRes(e),this.updateValue(this.argObj.value)},t.prototype.updateValue=function(e){this.argObj.value=e,this.argObj.icon==PropertyType.CRIT?this.valueLabel.text=e+"%":this.valueLabel.text=e+""},t}(BaseSkin);__reflect(OfficerPropertyItemComponent.prototype,"OfficerPropertyItemComponent");var OfficerFetterItemRender=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/ui/officer/itemRender/OfficerFetterItemSkin.exml",t}return __extends(t,e),t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.stateImg.visible=1==this.data.hasActivate?!0:!1,this.label.textFlow=this.data.texts;var t=1==this.data.hasActivate?Constants.COLOR_DYNAMIC:4013373;this.nameLabel.textColor=t,this.nameLabel.text="["+this.data.fetterName+"]"},t}(eui.ItemRenderer);__reflect(OfficerFetterItemRender.prototype,"OfficerFetterItemRender");var OfficerGroupItem=function(e){function t(t,i){var n=e.call(this)||this;return n.lineNum=0,n.officers=t,n.lineNum=i,n.skinName="resource/skins/ui/officer/itemRender/OfficerGroupItemSkin.exml",n.addEventListener(eui.UIEvent.CREATION_COMPLETE,n.onCreated,n),n.addEventListener(egret.Event.REMOVED_FROM_STAGE,n.onRemoved,n),n}return __extends(t,e),t.prototype.onCreated=function(e){this.officer1=new OfficerGroupOfficerItem(this.item1),this.officer2=new OfficerGroupOfficerItem(this.item2),this.officer3=new OfficerGroupOfficerItem(this.item3),this.officer1.itemType=1,this.officer2.itemType=1,this.officer3.itemType=1,this.updateOfficers(this.officers)},t.prototype.updateOfficers=function(e){this.officers=e,this.officer1.setVisible(!1),this.officer2.setVisible(!1),this.officer3.setVisible(!1);for(var t=1,i=this.officers.length;i>=t;t++){var n=this["officer"+t];n.updateData(this.officers[t-1]),n.setVisible(!0)}},t.prototype.getItemForType=function(e){for(var t=1;3>=t;t++){var i=this["officer"+t];if(i.visible&&i.officerType==e)return i}return null},t.prototype.onRemoved=function(e){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.onCreated,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this),this.officer1.dispose(),this.officer2.dispose(),this.officer3.dispose()},t}(eui.Component);__reflect(OfficerGroupItem.prototype,"OfficerGroupItem");var OfficerGroupOfficerItem=function(e){function t(t,i){void 0===i&&(i=null);var n=e.call(this,t,i)||this;return n.itemType=1,n.isPressed=!1,n.officerObj=null,n.isScale=!1,n.beginY=0,n.headIconImg=n.getMc("headIconImg"),n.headIconName=n.getMc("headIconName"),n.colorImg=n.getMc("colorImg"),n.progressBar=n.getMc("progressBar"),n.levelLabel=n.getMc("levelLabel"),n.levelUpImg=n.getMc("levelUpImg"),n.progressLabel=n.getMc("progressLabel"),n.selectedImg=n.getMc("selectedImg"),n.skin.addEventListener(egret.TouchEvent.TOUCH_TAP,n.onTouch,n),n}return __extends(t,e),Object.defineProperty(t.prototype,"officerType",{get:function(){return this.officerObj.has?this.officerObj.officer.metaOfficer.type:this.officerObj.officer.type},enumerable:!0,configurable:!0}),t.prototype.updateData=function(e){this.officerObj=e,this.updateOfficerItem()},t.prototype.updateOfficerItem=function(){var e=null;if(this.officerObj.has)e=this.officerObj.officer.metaOfficer,this.skin.filters=null;else{e=this.officerObj.officer;var t=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],i=new egret.ColorMatrixFilter(t);this.skin.filters=[i]}this.headIconImg.texture=RES.getRes(GameUtil.getOfficerHeadName(e.type)),this.headIconName.source=RES.getRes("officer_name_"+e.type),this.colorImg.texture=RES.getRes(GameUtil.getOfficerHeadColorName(e.quality)),this.progressBar.slideDuration=0,this.updateView()},t.prototype.showLevelUp=function(){var e=new DDMovieClip("officer_level_up");e.x=this.skin.width/2,e.y=this.skin.height/2,this.skin.addChild(e)},t.prototype.showSelected=function(e){this.selectedImg.visible=e},t.prototype.onTouch=function(){this.officerObj.has&&(OfficerInfoUI.isForLook=!1,EventCenter.ins.send(EventCenter.OFFICER_CLICK_ITEM_SHOW_INFO,{officerVo:this.officerObj.officer,type:2}))},t.prototype.checkContain=function(e){var t=new egret.Rectangle(this.skin.x-this.skin.width/2,this.skin.y-this.skin.height/2,this.skin.width,this.skin.height);return t.containsPoint(e)},t.prototype.updateView=function(){var e=null;this.officerObj.has?(e=this.officerObj.officer.metaOfficer,this.progressBar.minimum=0,this.progressBar.maximum=e.consumeChip,this.progressBar.value=this.officerObj.officer.pieceCount):(e=this.officerObj.officer,this.progressBar.minimum=0,this.progressBar.maximum=e.consumeChip,this.progressBar.value=0);var t=MetaOfficerManager.ins.getOfficerMaxLevel(e.type);this.officerObj.has?(this.officerObj.officer.level==t?(this.progressLabel.text="满级",this.progressBar.minimum=0,this.progressBar.maximum=1,this.progressBar.value=1):this.progressLabel.text=this.officerObj.officer.pieceCount+"/"+e.consumeChip,this.levelLabel.text=this.officerObj.officer.level+"级"):(this.levelUpImg.visible=!1,this.progressBar.minimum=0,this.progressBar.maximum=e.consumeChip,this.progressBar.value=0,this.progressLabel.text="0/"+e.consumeChip,this.levelLabel.text="0级"),this.officerObj.has&&(VoUtil.canLevelUpOfficer(this.officerObj.officer)?(this.jumpMc=new GameJumpMc(this.levelUpImg,.4),this.jumpMc.show()):this.levelUpImg.visible=!1)
},t.prototype.dispose=function(){this.skin.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),e.prototype.dispose.call(this),this.jumpMc&&this.jumpMc.dispose()},t}(BaseSkin);__reflect(OfficerGroupOfficerItem.prototype,"OfficerGroupOfficerItem");var OfficerItemRenderComponent=function(e){function t(t){var i=e.call(this)||this;return i.itemType=1,i.isPressed=!1,i.officerObj=null,i.isScale=!1,i.beginY=0,i.hasMoved=!1,i.skinName="resource/skins/ui/officer/itemRender/OfficerItemSkin.exml",i.officerObj=t,i}return __extends(t,e),t.prototype.updateItem=function(e){var t=OfficerVoManager.ins.getOfficer(e);t&&(this.officerObj.has=!0,this.officerObj.isLevelUp=VoUtil.canLevelUpOfficer(t),this.officerObj.officer=t,this.updateOfficerItem())},t.prototype.updateOfficerItem=function(){var e=null;if(this.officerObj.has)e=this.officerObj.officer.metaOfficer,this.filters=null;else{e=this.officerObj.officer,this.noImg.visible=!1;var t=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],i=new egret.ColorMatrixFilter(t);this.filters=[i]}if(UIUtil.setImg(GameUtil.getOfficerHeadName(e.type),this.headIconImg),UIUtil.setImg(GameUtil.getOfficerHeadColorName(e.quality),this.colorImg),this.headIconName.source=RES.getRes("officer_name_"+e.type),this.progressBar.slideDuration=0,this.updateView(),this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2,this.officerObj.isLevelUp){var n=new DDMovieClip("officer_level_up");n.x=this.anchorOffsetX,n.y=this.anchorOffsetY,this.addChild(n)}},t.prototype.showSelected=function(e){this.selectedImg.visible=e},t.prototype.onCreated=function(){e.prototype.onCreated.call(this),this.updateOfficerItem(),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)},t.prototype.onTouchMove=function(e){this.officerObj.has&&(this.hasMoved=!0)},t.prototype.onCancel=function(){this.officerObj.has&&(this.isPressed=!1,this.scaleX=this.scaleY=1)},t.prototype.onBegin=function(e){this.officerObj.has&&(this.hasMoved=!1,this.isPressed=!0,this.beginPos=new egret.Point(e.stageX,e.stageY),this.scaleX=this.scaleY=.94)},t.prototype.onTouch=function(){this.officerObj.has&&(this.isPressed=!1,1==this.itemType?(OfficerInfoUI.isForLook=!1,EventCenter.ins.send(EventCenter.OFFICER_CLICK_ITEM_SHOW_INFO,{officerVo:this.officerObj.officer,type:1})):2==this.itemType?EventCenter.ins.send(EventCenter.CLICK_OFFICER_ITEM_FOR_ITEM_TYPE,{itemType:this.itemType,value:this.officerObj.officer}):3==this.itemType)},t.prototype.checkContain=function(e){var t=new egret.Rectangle(this.x-this.width/2,this.y-this.height/2,this.width,this.height);return t.containsPoint(e)},t.prototype.updateView=function(){var e=null;this.officerObj.has?(e=this.officerObj.officer.metaOfficer,this.progressBar.minimum=0,this.progressBar.maximum=e.consumeChip,this.progressBar.value=this.officerObj.officer.pieceCount):(e=this.officerObj.officer,this.progressBar.minimum=0,this.progressBar.maximum=e.consumeChip,this.progressBar.value=0);var t=MetaOfficerManager.ins.getOfficerMaxLevel(e.type);this.officerObj.has?(this.officerObj.officer.level==t?(this.progressLabel.text="满级",this.progressBar.minimum=0,this.progressBar.maximum=1,this.progressBar.value=1):this.progressLabel.text=this.officerObj.officer.pieceCount+"/"+e.consumeChip,this.levelLabel.text=this.officerObj.officer.level+"级"):(this.levelUpImg.visible=!1,this.progressBar.minimum=0,this.progressBar.maximum=e.consumeChip,this.progressBar.value=0,this.progressLabel.text="0/"+e.consumeChip,this.levelLabel.text="0级"),this.officerObj.has&&(VoUtil.canLevelUpOfficer(this.officerObj.officer)?(this.jumpMc=new GameJumpMc(this.levelUpImg,.4),this.jumpMc.show()):this.levelUpImg.visible=!1)},t.prototype.showScale=function(e){this.isScale!=e&&(this.isScale=e,TweenMax.killTweensOf(this),this.isScale?TweenMax.to(this,.1,{scaleX:1.12,scaleY:1.12}):TweenMax.to(this,.1,{scaleX:1,scaleY:1}))},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.jumpMc&&this.jumpMc.dispose(),this.jumpMc=null,this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)},t}(BaseComponent);__reflect(OfficerItemRenderComponent.prototype,"OfficerItemRenderComponent");var OfficerListItemRender=function(e){function t(){var t=e.call(this)||this;return t.itemType=1,t.isPressed=!1,t.officerObj=null,t.isScale=!1,t.beginY=0,t}return __extends(t,e),t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.officerObj=this.data,this.updateOfficerItem()},t.prototype.updateItem=function(e){var t=OfficerVoManager.ins.getOfficer(e);t&&(this.officerObj.has=!0,this.officerObj.isLevelUp=VoUtil.canLevelUpOfficer(t),this.officerObj.officer=t,this.updateOfficerItem())},t.prototype.updateVisible=function(){var e=UIUtil.local2Global(this);e.y+this.skin.height<=0?this.visible=!1:this.visible=!0},t.prototype.updateOfficerItem=function(){var e=null;if(this.officerObj.has)e=this.officerObj.officer.metaOfficer,this.filters=null;else{e=this.officerObj.officer;var t=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],i=new egret.ColorMatrixFilter(t);this.filters=[i]}if(UIUtil.setImg(GameUtil.getOfficerHeadName(e.type),this.headIconImg),this.headIconName.source=RES.getRes("officer_name_"+e.type),UIUtil.setImg(GameUtil.getOfficerHeadColorName(e.quality),this.colorImg),this.progressBar.slideDuration=0,this.updateView(),this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2,this.officerObj.isLevelUp){var n=new DDMovieClip("officer_level_up");n.x=this.anchorOffsetX,n.y=this.anchorOffsetY,this.addChild(n)}},t.prototype.showSelected=function(e){this.selectedImg.visible=e},t.prototype.checkContain=function(e){var t=new egret.Rectangle(this.x-this.width/2,this.y-this.height/2,this.width,this.height);return t.containsPoint(e)},t.prototype.updateView=function(){var e=null;this.officerObj.has?(e=this.officerObj.officer.metaOfficer,this.progressBar.minimum=0,this.progressBar.maximum=e.consumeChip,this.progressBar.value=this.officerObj.officer.pieceCount):(e=this.officerObj.officer,this.progressBar.minimum=0,this.progressBar.maximum=e.consumeChip,this.progressBar.value=0);var t=MetaOfficerManager.ins.getOfficerMaxLevel(e.type);this.officerObj.has?(this.officerObj.officer.level==t?(this.progressLabel.text="满级",this.progressBar.minimum=0,this.progressBar.maximum=1,this.progressBar.value=1):this.progressLabel.text=this.officerObj.officer.pieceCount+"/"+e.consumeChip,this.levelLabel.text=this.officerObj.officer.level+"级"):(this.levelUpImg.visible=!1,this.progressBar.minimum=0,this.progressBar.maximum=e.consumeChip,this.progressBar.value=0,this.progressLabel.text="0/"+e.consumeChip,this.levelLabel.text="0级"),this.officerObj.has&&(VoUtil.canLevelUpOfficer(this.officerObj.officer)?(this.jumpMc=new GameJumpMc(this.levelUpImg,.4),this.jumpMc.show()):this.levelUpImg.visible=!1)},t.prototype.showScale=function(e){this.isScale!=e&&(this.isScale=e,TweenMax.killTweensOf(this),this.isScale?TweenMax.to(this,.1,{scaleX:1.12,scaleY:1.12}):TweenMax.to(this,.1,{scaleX:1,scaleY:1}))},t.prototype.dispose=function(){this.jumpMc&&this.jumpMc.dispose(),this.jumpMc=null},t}(eui.ItemRenderer);__reflect(OfficerListItemRender.prototype,"OfficerListItemRender");var OfflineProcessUI=function(e){function t(){var t=e.call(this)||this;return t.skinName="OfflineProcessUISkin",t}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.topCom=new UITopComponent(this.getMc("topCom")),this.stopBtn=UIUtil.getButton("stopBtn",this.skin,this.onStop,this),this.offlineMc=new DDMovieClip("guaji01",-1),this.addChild(this.offlineMc),this.offlineMc.x=318,this.offlineMc.y=394},t.prototype.onStop=function(){this.onClose(),Game.net.sendData({cmd:BookCmd.OFFLINE_PANE},this.onOfflineEnd,this)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.stopBtn.dispose(),this.stopBtn=null,this.topCom.dispose(),this.topCom=null,UIUtil.dispose(this)},t.prototype.onOfflineEnd=function(e){OfflineVoManager.ins.fromServer(e.dataVo),GameUIUtil.showOfflineResult()},t}(BaseUI);__reflect(OfflineProcessUI.prototype,"OfflineProcessUI");var OfflineResultUI=function(e){function t(){var t=e.call(this)||this;return t.resultVo=null,t.exp=0,t.skinName="OfflineResultUISkin",t}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this);var t=OfflineVoManager.ins.offlineVo;this._offlineVo=t;var i=MetaMapManager.ins.getMap(t.mapId);this.noRewardGroup=this.getMc("noRewardGroup"),UIUtil.getLabel(i.name,"mapNameLabel",this.skin),UIUtil.getLabel(t.runTime+"分钟","timeLabel",this.skin),UIUtil.getLabel(Util.handleUnit2(t.gold)+"元宝","goldLabel",this.skin);var n=this.getMc("rewardLabel"),o="",r=0,s=0;GameUtil.handleBags(t.rewards);for(var a=0,h=t.rewards.length;h>a;a++){var p=t.rewards[a];ResType.OFFICER==p.category?r++:ResType.PROP==p.category?s++:(ResType.EXP==p.category&&(this.exp=p.count),o+=GameUtil.getResName(p.category)+" × "+Util.handleUnit2(p.count)+" \n")}r>0&&(o+=GameUtil.getResName(ResType.OFFICER)+" × "+Util.handleUnit2(r)+" \n"),s>0&&(o+=GameUtil.getResName(ResType.PROP)+" × "+Util.handleUnit2(s)+" \n"),n.text=o,this.sureBtn=UIUtil.getButton("sureBtn",this.skin,this.onClose,this),this.noRewardGroup.visible=0==t.runTime,this.timesGroup=this.getMc("timesGroup"),this.times1Label=this.getMc("times1Label"),this.times2Label=this.getMc("times2Label"),this.times3Label=this.getMc("times3Label"),this.times2Btn=UIUtil.getButton("times2Btn",this.skin,this.OffLineHandler,this),this.times3Btn=UIUtil.getButton("times3Btn",this.skin,this.OffLineHandler,this),this.times5Btn=UIUtil.getButton("times5Btn",this.skin,this.OffLineHandler,this),0==t.type&&t.runTime>=1&&(this.timesGroup.visible=!0,this.sureBtn.visible=!1,this.times1Label.text="消耗"+1*t.runTime+"元宝",this.times2Label.text="消耗"+3*t.runTime+"元宝",this.times3Label.text="消耗"+10*t.runTime+"元宝")},t.prototype.OffLineHandler=function(e){var t=e.currentTarget,i=parseInt(t.name);Game.net.sendData({cmd:BookCmd.OFF_LINE_TYPE,type:i,remain:this._offlineVo.runTime,addExp:this.exp},this.getTypeReward,this)},t.prototype.getTypeReward=function(e){LoadingIcon.instance.hide(),GameUtil.handleBags(e.dataVo.dtoList),this.close()},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.sureBtn.dispose()},t}(BaseUI);__reflect(OfflineResultUI.prototype,"OfflineResultUI");var OfflineUI=function(e){function t(){var t=e.call(this)||this;return t.skinName="OfflineUISkin",t}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.offline1Btn=UIUtil.getButton("offline1Btn",this.skin,this.onOffline,this),this.offline2Btn=UIUtil.getButton("offline2Btn",this.skin,this.onOffline,this),this.offline3Btn=UIUtil.getButton("offline3Btn",this.skin,this.onOffline,this)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.offline1Btn.dispose(),this.offline2Btn.dispose(),this.offline3Btn.dispose()},t.prototype.onOffline=function(e){var t=e.currentTarget,i=parseInt(t.name.split("_")[1]);LoadingIcon.instance.show();var n=GameUtil.getMainCityIdForCamp(PlayerVoManager.ins.playerVo.camp);Game.net.sendData({cmd:BookCmd.OFFLINE_BEGIN,type:i,map:n},this.onOfflineBegin,this)},t.prototype.onOfflineBegin=function(e){LoadingIcon.instance.hide(),this.return2Taoyuan(),GameUIUtil.showOfflineProcess(),this.onClose()},t.prototype.return2Taoyuan=function(){var e=GameUtil.getTaoYuanId(),t={cmd:BookCmd.ENTER_MAP,map:e};LoadingIcon.instance.show(),Game.net.sendData(t,this.responseEnterMap,this)},t.prototype.responseEnterMap=function(e){LoadingIcon.instance.hide(),MapEntityVoManager.ins.onEnterMap(e.dataVo),Game.battleType=BattleType.NO,Game.eventCenter.send(EventCenter.ENTER_MAP,GameUtil.getTaoYuanId())},t}(BaseUI);__reflect(OfflineUI.prototype,"OfflineUI");var PlayerDeathUI=function(e){function t(t){var i=e.call(this)||this;return i.skinName="PlayerDeathUISkin",i.deathObj=t,i}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.contentLabel=this.getMc("contentLabel"),this.bgImg=this.getMc("bgImg");var t=new Array;if(t.push({text:"你不幸被【"}),t.push({text:this.deathObj.sourceName,style:{textColor:Constants.COLOR_DYNAMIC}}),t.push({text:"】击败了!"}),1==this.deathObj.targetType){var i=this.deathObj.drop;0==i.length?t.push({text:"没有掉落"}):t.push({text:"身上掉落了"});for(var n=VoUtil.getTotalSixProperty(),o=0,r=i.length;r>o;o++){var s=i[o],a=s.category;if(ResType.OFFICER==a){var h=MetaOfficerManager.ins.getOfficerForTypeAndLevel(s.staticId,1);h&&(OfficerVoManager.ins.reduceOfficerPiece(h.type,s.count),t.push({text:s.count+"个",style:{textColor:Constants.COLOR_DYNAMIC}}),t.push({text:h.name,style:{textColor:GameUtil.getColor(h.quality)}}),t.push({text:"碎片"}))}else if(ResType.SILVER==a)t.push({text:Util.handleUnit2(s.count)+"银币",style:{textColor:Constants.COLOR_DYNAMIC}});else if(ResType.GOLD==a)t.push({text:Util.handleUnit2(s.count)+"元宝",style:{textColor:Constants.COLOR_DYNAMIC}});else if(ResType.EQUIP==a){var p=MetaEquipManager.ins.getEquip(s.staticId);t.push({text:s.count+"个",style:{textColor:Constants.COLOR_DYNAMIC}}),t.push({text:p.name,style:{textColor:GameUtil.getColor(p.color)}}),t.push({text:"碎片"}),EquipVoMananger.ins.reduceEquipPiece(p.id,s.count)}else if(ResType.PROP==a){var l=MetaPropMananger.ins.getProp(s.staticId);if(l.type!=PropType.TIANSHU)PropVoManager.ins.operPropCount(s.staticId,s.count,!1),t.push({text:s.count+"个",style:{textColor:Constants.COLOR_DYNAMIC}}),t.push({text:l.name});else{var u=MetaTianShuManager.ins.getTianShuForProp(s.staticId);TianShuVoManager.ins.reduceCount(u.id,s.count),t.push({text:s.count+"个",style:{textColor:Constants.COLOR_DYNAMIC}}),t.push({text:l.name,style:{textColor:GameUtil.getColor(l.color)}})}}else ResType.CULTIVATION==a?(MeridianVoManager.ins.operCount(s.count,!1),t.push({text:s.count+"",style:{textColor:Constants.COLOR_DYNAMIC}}),t.push({text:"修为"})):ResType.EXP==a?(t.push({text:s.count+"",style:{textColor:Constants.COLOR_DYNAMIC}}),t.push({text:"经验"})):ResType.XUEDIAN==a?HozaVoManager.ins.operStudyPoint(s.count,!1):ResType.RENOWN==a&&RenownVoManager.ins.operRenownVoCount(s.count,!1);t.push({text:o==r-1?"":"、"})}t.push({text:"，运气真衰!"});var c=VoUtil.getTotalSixProperty();GameUtil.handleSixProperty2(n,c)}this.contentLabel.textFlow=t,this.bgImg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)},t.prototype.onTouch=function(e){this.onClose()},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.bgImg.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),UIUtil.dispose(this)},t}(BaseUI);__reflect(PlayerDeathUI.prototype,"PlayerDeathUI");var PlayerInfoUI=function(e){function t(){var t=e.call(this)||this;return t.skinName="PlayerInfoUISkin",t}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),t.isOpened=!0,this.playerVo=PlayerVoManager.ins.playerVo,this.topBoard=new UITopComponent(this.getMc("topBoard")),this.bodyCom=new PlayerBodyComponent(this.getMc("bodyCom")),this.attackProperty=new OfficerPropertyItemComponent(this.getMc("attackCom"),{icon:PropertyType.ATTACK,value:this.getProperty(PropertyType.ATTACK)}),this.defenceProperty=new OfficerPropertyItemComponent(this.getMc("defenceCom"),{icon:PropertyType.DEFENCE,value:this.getProperty(PropertyType.DEFENCE)}),this.hpProperty=new OfficerPropertyItemComponent(this.getMc("hpCom"),{icon:PropertyType.HP,value:this.getProperty(PropertyType.HP)}),this.critProperty=new OfficerPropertyItemComponent(this.getMc("critCom"),{icon:PropertyType.CRIT,value:(.01*this.getProperty(PropertyType.CRIT)).toFixed(2)}),this.critHurtProperty=new OfficerPropertyItemComponent(this.getMc("critHurtCom"),{icon:PropertyType.CRIT_HURT,value:this.getProperty(PropertyType.CRIT_HURT)}),this.dodgeProperty=new OfficerPropertyItemComponent(this.getMc("dodgeCom"),{icon:PropertyType.DODGE,value:this.getProperty(PropertyType.DODGE)}),this.wuliCom=new OfficerPropertyItemComponent(this.getMc("wuliCom"),{icon:PropertyType.WULI,value:this.getProperty(PropertyType.WULI)}),this.zhiliCom=new OfficerPropertyItemComponent(this.getMc("zhiliCom"),{icon:PropertyType.ZHILI,value:this.getProperty(PropertyType.ZHILI)}),this.minjieCom=new OfficerPropertyItemComponent(this.getMc("minjieCom"),{icon:PropertyType.MINJIE,value:this.getProperty(PropertyType.MINJIE)}),this.meiliCom=new OfficerPropertyItemComponent(this.getMc("meiliCom"),{icon:PropertyType.MEILI,value:this.getProperty(PropertyType.MEILI)}),this.tongshuaiCom=new OfficerPropertyItemComponent(this.getMc("tongshuaiCom"),{icon:PropertyType.TONGSHUAI,value:this.getProperty(PropertyType.TONGSHUAI)}),this.neiliCom=new OfficerPropertyItemComponent(this.getMc("neiliCom"),{icon:PropertyType.NEILI,value:this.getProperty(PropertyType.NEILI)}),this.genguCom=new OfficerPropertyItemComponent(this.getMc("genguCom"),{icon:PropertyType.GENGU,value:this.getProperty(PropertyType.GENGU)}),this.biliCom=new OfficerPropertyItemComponent(this.getMc("biliCom"),{icon:PropertyType.BILI,value:this.getProperty(PropertyType.BILI)}),this.wuhonCom=new OfficerPropertyItemComponent(this.getMc("wuhonCom"),{icon:PropertyType.WUHON,value:this.getProperty(PropertyType.WUHON)}),this.renownLevelLabel=this.getMc("renownLevelLabel"),this.expBar=new NormalUIBarComponent(this.getMc("expBar")),this.levelLabel=this.getMc("levelLabel"),this.nameLabel=this.getMc("nameLabel"),this.idLabel=this.getMc("idLabel"),this.renownDesLabel=this.getMc("renownDesLabel"),this.idLabel.text=PlayerVoManager.ins.playerVo.id,this.nameLabel.text=PlayerVoManager.ins.playerVo.name,this.needRenownLabel=UIUtil.getLabel("","needRenownLabel",this.skin),this.levelUpBtn=UIUtil.getButton("levelUpBtn",this.skin,this.onLevelUpRenown,this),this.updateRenown(),this.updateExp(),EventCenter.ins.add(EventCenter.UPDATE_PLAYER_EXP,this.updateExp,this),EventCenter.ins.add(EventCenter.LEVEL_UPGRADE,this.updateExp,this),EventCenter.ins.add(EventCenter.GUIDE_CHECK,this.checkGuide,this),this.renownDesLabel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onDesTouch,this),this.checkGuide()},t.prototype.onDesTouch=function(e){GuideVoManager.ins.isJueseStep(1)&&Guide.ins.nextStep2()},t.prototype.checkGuide=function(){if(GuideVoManager.ins.isJueseStep(1)){var e=UIUtil.local2Global(this.renownDesLabel);Guide.ins.show(e.x-12,e.y-12,this.renownDesLabel.width+18,this.renownDesLabel.height+18)}else if(GuideVoManager.ins.isJueseStep(2))if(RenownVoManager.ins.canLevelUp()){var e=UIUtil.local2Global(this.levelUpBtn.target);Guide.ins.show(e.x-2,e.y-2,this.levelUpBtn.target.width+4,this.levelUpBtn.target.height+4)}else Guide.ins.nextStep2();else GuideVoManager.ins.isJueseStep(4)&&Guide.ins.nextStep2()},t.prototype.updateExp=function(){var e=PlayerVoManager.ins.playerVo,t=MetaExpManager.ins.getMetaExpByLevel(e.level),i=e.exp;e.level==MetaExpManager.ins.maxLevel&&(i=Math.min(i,t.exp)),this.expBar.maximum!=t.exp&&(this.expBar.maximum=t.exp),this.expBar.value=i,this.levelLabel.text=e.level+""},t.prototype.getProperty=function(e){return PlayerVoManager.ins.playerInfoVo.getProp(e)},t.prototype.dispose=function(){e.prototype.dispose.call(this),t.isOpened=!1,this.attackProperty.dispose(),this.attackProperty=null,this.defenceProperty.dispose(),this.defenceProperty=null,this.hpProperty.dispose(),this.hpProperty=null,this.critProperty.dispose(),this.critProperty=null,this.critHurtProperty.dispose(),this.critHurtProperty=null,this.dodgeProperty.dispose(),this.dodgeProperty=null,this.wuliCom.dispose(),this.wuliCom=null,this.zhiliCom.dispose(),this.zhiliCom=null,this.minjieCom.dispose(),this.minjieCom=null,this.meiliCom.dispose(),this.meiliCom=null,this.tongshuaiCom.dispose(),this.tongshuaiCom=null,this.neiliCom.dispose(),this.neiliCom=null,this.genguCom.dispose(),this.genguCom=null,this.biliCom.dispose(),this.biliCom=null,this.topBoard.dispose(),this.topBoard=null,this.levelUpBtn.dispose(),this.levelUpBtn=null,this.wuhonCom.dispose(),this.wuhonCom=null,this.bodyCom.dispose(),this.bodyCom=null,UIUtil.destroyRes(t.RES_NAME),this.renownDesLabel.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onDesTouch,this),EventCenter.ins.remove(EventCenter.GUIDE_CHECK,this.checkGuide,this),EventCenter.ins.remove(EventCenter.LEVEL_UPGRADE,this.updateExp,this),EventCenter.ins.remove(EventCenter.UPDATE_PLAYER_EXP,this.updateExp,this),GuideVoManager.ins.isJueseStep(4)&&Guide.ins.nextStep2(),UIUtil.dispose(this)},t.prototype.updateRenown=function(){var e=RenownVoManager.ins.renownVo;this.renownLevelLabel.text=e.level+"";var t=MetaRenownManager.ins.getMetaRenown(e.level),i=new Array;i.push({text:e.count+"",style:{textColor:e.count<t.needCount?16711680:16777215}}),i.push({text:"/"+t.needCount}),this.needRenownLabel.textFlow=i;var n=this.getProperty(PropertyType.WUHON);this.wuhonCom.updateValue(n),this.levelUpBtn.currentState=RenownVoManager.ins.canLevelUp()?"up":"disabled"},t.prototype.onLevelUpRenown=function(){var e=RenownVoManager.ins.renownVo;if(e.level>=MetaRenownManager.ins.maxLevel)return void Alert.ins.showAlert(AlertType.ERROR,"声望已达到最高级别!");var t=MetaRenownManager.ins.getMetaRenown(e.level);return e.count<t.needCount?void Alert.ins.showAlert(AlertType.ERROR,"声望点不够!"):(LoadingIcon.instance.show(),void Game.net.sendData({cmd:BookCmd.RENOWN_RESULT},this.onRenownResult,this))},t.prototype.onRenownResult=function(e){LoadingIcon.instance.hide();var t=new DDMovieClip("shengwang_level_up");this.addChild(t),t.x=Game.stage.stageWidth/2,t.y=Game.stage.stageHeight/2-80,RenownVoManager.ins.levelUpResult(e.dataVo),PlayerVoManager.ins.playerInfoVo.wuhon=e.dataVo.wuhun,this.updateRenown(),GuideVoManager.ins.isJueseStep(2)&&Guide.ins.nextStep2()},t.RES_NAME="playerInfo",t.isOpened=!1,t}(BaseUI);__reflect(PlayerInfoUI.prototype,"PlayerInfoUI");var PlayerInfoUIPre=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.startPre=function(){var e=this;UIResLoading.loadReses(PlayerInfoUI.RES_NAME,e.requestInfo,e)},t.prototype.requestInfo=function(){LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.PLAYER_INFO_PANEL},this.onRequestInfo,this)},t.prototype.onRequestInfo=function(e){LoadingIcon.instance.hide();var t=e.dataVo;PlayerVoManager.ins.initPlayerInfoVo(t),RenownVoManager.ins.fromServer(t),BodyVoMananger.ins.fromServer({body:t.body}),this.finishPre(new PlayerInfoUI)},t}(PreUIBase);__reflect(PlayerInfoUIPre.prototype,"PlayerInfoUIPre");var PlayerBodyComponent=function(e){function t(t,i){void 0===i&&(i=null);var n=e.call(this,t,i)||this;return n.isFirstUpdate=!0,n}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.fightingLabel=this.getMc("fightingLabel"),this.playerCom=new PlayerBodyPlayerInfoItemCom(this.getMc("playerCom")),this.playerCom.isNow=!0,this.nextPlayerCom=new PlayerBodyPlayerInfoItemCom(this.getMc("nextPlayerCom")),this.nextPlayerCom.isNow=!1,this.arrow2Img=this.getMc("arrow2Img"),this.arrow1Img=this.getMc("arrow1Img"),this.expBar=new NormalUIBarComponent(this.getMc("expBar")),this.levelUpBtn=UIUtil.getButton("levelUpBtn",this.skin,this.onLevelUp,this,!1),this.isFirstUpdate=!0,this.updatePlayer(),this.updateBody(),this.onUpdateFightingForce(),EventCenter.ins.add(EventCenter.UPDATE_FIGHTING_FORCE,this.onUpdateFightingForce,this),EventCenter.ins.add(EventCenter.GUIDE_CHECK,this.checkGuide,this)},t.prototype.checkGuide=function(){if(GuideVoManager.ins.isJueseStep(3)){var e=!0,t=BodyVoMananger.ins.bodyVo,i=MetaBodyManager.ins.getMetaBody(t.color,t.star);i.id==Game.BODY_MAX_ID&&(e=!1);var n=PlayerVoManager.ins.playerInfoVo.heroCount;if(n<i.needHeroCount&&(e=!1),e){var o=UIUtil.local2Global(this.levelUpBtn.target);Guide.ins.show(o.x,o.y,this.levelUpBtn.target.width,this.levelUpBtn.target.height)}else Guide.ins.nextStep2()}},t.prototype.onUpdateFightingForce=function(){this.fightingLabel.text=PlayerVoManager.ins.playerVo.fightingForce-Game.FIGHTING_FORCE_INIT+""},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.levelUpBtn.dispose(),this.playerCom.dispose(),this.nextPlayerCom.dispose(),EventCenter.ins.remove(EventCenter.UPDATE_FIGHTING_FORCE,this.onUpdateFightingForce,this),EventCenter.ins.remove(EventCenter.GUIDE_CHECK,this.checkGuide,this)},t.prototype.onLevelUp=function(){var e=BodyVoMananger.ins.bodyVo,t=MetaBodyManager.ins.getMetaBody(e.color,e.star);if(t.id==Game.BODY_MAX_ID)return void Alert.ins.showAlert(AlertType.ERROR,"身法已达到最高等级!");var i=PlayerVoManager.ins.playerInfoVo.heroCount;return i<t.needHeroCount?void Alert.ins.showAlert(AlertType.ERROR,"武将数量不足!"):(LoadingIcon.instance.show(),void Game.net.sendData({cmd:BookCmd.LEVEL_UP_BODY},this.sureLevelUp,this))},t.prototype.sureLevelUp=function(e){LoadingIcon.instance.hide();var t=BodyVoMananger.ins.getNormalProperty(),i=e.dataVo;BodyVoMananger.ins.levelUp(i.body,i.zhanyi),EventCenter.ins.send(EventCenter.BODY_LEVEL_UP);var n=BodyVoMananger.ins.getNormalProperty();GameUtil.handleNormalProperty(t,n),this.updatePlayer(),this.updateBody(),GuideVoManager.ins.isJueseStep(3)&&Guide.ins.nextStep2()},t.prototype.updateBody=function(){var e=BodyVoMananger.ins.bodyVo,t=MetaBodyManager.ins.getMetaBody(e.color,e.star);t.needHeroCount;t.id==Game.BODY_MAX_ID?(this.expBar.maximum=1,this.expBar.value=1,this.expBar.updateLabelContent("已满级")):(this.expBar.maximum=t.needHeroCount,this.expBar.value=PlayerVoManager.ins.playerInfoVo.heroCount),this.levelUpBtn.currentState=VoUtil.canLevelUpBody()?"up":"disabled"},t.prototype.updatePlayer=function(){var e=BodyVoMananger.ins.bodyVo;if(this.playerCom.updateInfo({color:e.color,star:e.star}),this.isFirstUpdate||this.playerCom.starCom.showEffect(e.star),this.isFirstUpdate=!1,e.color==Game.BODY_MAX_COLOR&&e.star==Game.BODY_MAX_STAR)this.nextPlayerCom.setVisible(!1),this.arrow1Img.visible=this.arrow2Img.visible=!1,this.playerCom.skin.x=168;else{var t=e.color,i=e.star;i==Game.BODY_MAX_STAR?(t+=1,i=1):i+=1,this.nextPlayerCom.setVisible(!0),this.nextPlayerCom.updateInfo({color:t,star:i})}},t}(BaseSkin);__reflect(PlayerBodyComponent.prototype,"PlayerBodyComponent");var PlayerBodyPlayerInfoItemCom=function(e){function t(t,i){void 0===i&&(i=null);var n=e.call(this,t,i)||this;return n.mIsNow=!1,n}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.starCom=new StarComponent(this.getMc("starCom")),this.bgImg=this.getMc("bodyBgImg"),this.titleImg=this.getMc("titleImg"),this.showCom=new PlayerInfoBodyShowComponent(this.getMc("playerCom")),this.attackCom=new OfficerPropertyItemComponent(this.getMc("attackCom"),{icon:PropertyType.ATTACK,value:0}),this.critCom=new OfficerPropertyItemComponent(this.getMc("critCom"),{icon:PropertyType.DEFENCE,value:0}),this.critHurtCom=new OfficerPropertyItemComponent(this.getMc("critHurtCom"),{icon:PropertyType.HP,value:0})},Object.defineProperty(t.prototype,"isNow",{set:function(e){e?(this.titleImg.source="body_3",this.bgImg.source="body_1_png"):(this.titleImg.source="body_4",this.bgImg.source="body_2_png")},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){e.prototype.dispose.call(this),this.starCom.dispose(),this.attackCom.dispose(),this.critCom.dispose(),this.critHurtCom.dispose(),UIUtil.dispose(this.skin)},t.prototype.updateInfo=function(e){this.argObj=e;var t=(PlayerVoManager.ins.playerVo,VoUtil.getSelfEntityVo()),i=MetaBodyManager.ins.getMetaBody(this.argObj.color,this.argObj.star);t.body=i.id,this.showCom.updateInfo(t),this.starCom.updateStar(this.argObj.star),this.attackCom.updateValue(i.attack),this.critCom.updateValue(i.defence),this.critHurtCom.updateValue(i.hp)},t}(BaseSkin);__reflect(PlayerBodyPlayerInfoItemCom.prototype,"PlayerBodyPlayerInfoItemCom");var PlayerInfoBodyShowComponent=function(e){function t(t,i){return void 0===i&&(i=null),e.call(this,t,i)||this}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.levelLabel=this.getMc("levelLabel"),this.colorImg=this.getMc("colorImg"),this.nameLabel=this.getMc("nameLabel")},t.prototype.updateInfo=function(e){this.argObj=e,this.nameLabel.text=e.name,this.levelLabel.text=e.body+"级";var t=MetaBodyManager.ins.getBody(e.body);this.colorImg.texture=RES.getRes("entity_player_"+t.color)},t}(BaseSkin);__reflect(PlayerInfoBodyShowComponent.prototype,"PlayerInfoBodyShowComponent");var QieCuoUI=function(e){function t(){var t=e.call(this)||this;return t.skinName="QieCuoUISkin",t}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.topCom=new UITopComponent(this.getMc("topBoard")),this.listCom=new QieCuoListComponent(this.getMc("listCom")),this.pkMc=UtilMovieClip.getMovieClip("qiecuo_mv_1_json","qiecuo_mv_1_png","qiecuo_mv_1"),this.addChild(this.pkMc),this.pkMc.gotoAndStop(this.pkMc.totalFrames),this.pkMc.x=310,this.pkMc.y=256,EventCenter.ins.add(EventCenter.QIE_CUO_RESULT,this.onQieCuoResult,this)},t.prototype.onQieCuoResult=function(e){this.pkMc.gotoAndPlay(0,3)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.topCom.dispose(),this.topCom=null,this.listCom.dispose(),this.listCom=null,UIUtil.destroyRes(t.RES_NAME),EventCenter.ins.remove(EventCenter.QIE_CUO_RESULT,this.onQieCuoResult,this),UIUtil.dispose(this)},t.RES_NAME="qiecuo",t}(BaseUI);__reflect(QieCuoUI.prototype,"QieCuoUI");var QieCuoUIPre=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.startPre=function(){UIResLoading.loadReses(QieCuoUI.RES_NAME,this.requestInfo,this)},t.prototype.requestInfo=function(){LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.GET_QIECUO},this.onQieCuo,this)},t.prototype.onQieCuo=function(e){LoadingIcon.instance.hide();var t=e.dataVo;QieCuoVoManager.ins.fromServer(t.qiecuo),this.finishPre(new QieCuoUI)},t}(PreUIBase);__reflect(QieCuoUIPre.prototype,"QieCuoUIPre");var QieCuoListComponent=function(e){function t(t,i){return void 0===i&&(i=null),e.call(this,t,i)||this}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.listGroup=this.getMc("listGroup"),EventCenter.ins.add(EventCenter.QIE_CUO_CLICK_ITEM,this.onClickItem,this),this.updateList()},t.prototype.updateList=function(){UIUtil.dispose(this.listGroup);for(var e=MetaQieCuoManager.ins.qiecuos,t=0,i=e.length;i>t;t++){var n=e[t],o=new QieCuoListItem(n.id);this.listGroup.addChild(o)}},t.prototype.onQieCuo=function(e){LoadingIcon.instance.hide(),EventCenter.ins.send(EventCenter.QIE_CUO_RESULT);var t=e.dataVo,i=MetaQieCuoManager.ins.getQieCuo(t.id),n=1==i.consume.type?ResType.GOLD:ResType.SILVER,o=1==t.result?!0:!1,r="";if(ResType.GOLD==n&&DataCount.ins.onItemPurchase({item:"[切磋]"+GameUtil.getQieCuoName(i.type)+"=>"+(o?"胜利":"失败"),itemNum:1,itemPrice:i.consume.value}),o){var s=QieCuoVoManager.ins.getQieCuo(t.id),a=t.value-s.rewardCount;r+="战胜"+GameUtil.getQieCuoName(i.type)+"，获得了"+a+(1==i.maxReward.type?"臂力":"根骨"),QieCuoVoManager.ins.qiecuoResult(t.id,t.value)}else r+="被"+GameUtil.getQieCuoName(i.type)+"打败,获得了"+Util.handleUnit2(i.rewardExp)+"经验";this.updateList(),Alert.ins.showAlert(AlertType.NORMAL,r)},t.prototype.onClickItem=function(e){var t=e.data,i=MetaQieCuoManager.ins.getQieCuo(t),n=1==i.consume.type?ResType.GOLD:ResType.SILVER,o=PlayerVoManager.ins.getResForType(n);GameUtil.getResName(n);return o<i.consume.value?void(n==ResType.GOLD?Alert.ins.showAlert(AlertType.ERROR,"元宝不足!"):ResType.SILVER==n&&Alert.ins.showAlert(AlertType.ERROR,"银两不足，可以去藏宝兑换!")):(LoadingIcon.instance.show(),void Game.net.sendData({cmd:BookCmd.QIECUO_DO,id:t},this.onQieCuo,this))},t.prototype.dispose=function(){e.prototype.dispose.call(this),EventCenter.ins.remove(EventCenter.QIE_CUO_CLICK_ITEM,this.onClickItem,this),UIUtil.dispose(this.listGroup)},t}(BaseSkin);__reflect(QieCuoListComponent.prototype,"QieCuoListComponent");var QieCuoListItem=function(e){function t(t){var i=e.call(this)||this;return i.id=t,i.skinName="resource/skins/ui/qiecuo/list/QieCuoListItemSkin.exml",i}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this)},t.prototype.onCreated=function(){e.prototype.onCreated.call(this),this.btn=UIUtil.getButton("btn",this,this.onTouch,this);var t=QieCuoVoManager.ins.getQieCuo(this.id),i=MetaQieCuoManager.ins.getQieCuo(this.id),n=MetaOfficerManager.ins.getOfficerForTypeAndLevel(parseInt(i.pic),1);
this.nameLabel.text="与"+n.name+"切磋",this.successCountLabel.text=null!=t?t.successCount+"":"0";var o=1==i.minReward.type?"臂力":"根骨";this.rewardDesLabel.text="获得"+o+"：",this.rewardLabel.text=null!=t?t.rewardCount+"":"0",this.iconImg.texture=RES.getRes("officer_head_small_icon_"+n.type);var r=1==i.consume.type?ResType.GOLD:ResType.SILVER;r==ResType.GOLD?(this.resIconImg.texture=RES.getRes("gold_ingot"),this.btn.label="元宝切磋"):(this.resIconImg.texture=RES.getRes("silver_ingot"),this.btn.label="银两切磋"),this.consumeLabel.text=Util.handleUnit2(i.consume.value)},t.prototype.onTouch=function(e){EventCenter.ins.send(EventCenter.QIE_CUO_CLICK_ITEM,this.id)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.btn.dispose()},t}(BaseComponent);__reflect(QieCuoListItem.prototype,"QieCuoListItem");var RankUI=function(e){function t(){var t=e.call(this)||this;return t.isFirst=!0,t.skinName="RankUISkin",t}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.allBtn=this.getMc("allBtn"),this.weiBtn=this.getMc("weiBtn"),this.shuBtn=this.getMc("shuBtn"),this.wuBtn=this.getMc("wuBtn"),this.allBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onMenuClick,this),this.weiBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onMenuClick,this),this.shuBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onMenuClick,this),this.wuBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onMenuClick,this),t.tabIndex=0,this.listCom=new RankListComponent(this.getMc("listCom")),this.listCom.updateRank(0),this.selfItem=new RankSelfCampItem(this.getMc("selfItem")),this.selfItem.setVisible(!1),this.allBtn.currentState="down"},t.prototype.onMenuClick=function(e){var t=e.currentTarget;switch(t.name){case"allBtn":this.setTab(0);break;case"weiBtn":this.setTab(1);break;case"shuBtn":this.setTab(2);break;case"wuBtn":this.setTab(3)}},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.listCom.dispose(),this.listCom=null,this.selfItem.dispose(),this.selfItem=null,UIUtil.destroyRes(t.RES_NAME),this.allBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onMenuClick,this),this.weiBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onMenuClick,this),this.shuBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onMenuClick,this),this.wuBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onMenuClick,this),UIUtil.dispose(this)},t.prototype.setTab=function(e){void 0===e&&(e=0),e!=t.tabIndex&&(t.tabIndex=e,this.allBtn.currentState="up",this.weiBtn.currentState="up",this.shuBtn.currentState="up",this.wuBtn.currentState="up",0==t.tabIndex?this.allBtn.currentState="down":1==t.tabIndex?this.weiBtn.currentState="down":2==t.tabIndex?this.shuBtn.currentState="down":3==t.tabIndex&&(this.wuBtn.currentState="down"),this.requestRankList(t.tabIndex))},t.prototype.requestRankList=function(e){LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.RANKE_PANEL,type:e},this.onRequestRankList,this)},t.prototype.onRequestRankList=function(e){LoadingIcon.instance.hide(),RankVoManager.ins.fromServer(e.dataVo),this.listCom.updateRank(t.tabIndex),t.tabIndex==PlayerVoManager.ins.playerVo.camp?(this.selfItem.setVisible(!0),this.selfItem.updateRank(RankVoManager.ins.selfVo)):this.selfItem.setVisible(!1)},t.RES_NAME="rank",t.tabIndex=-1,t}(BaseUI);__reflect(RankUI.prototype,"RankUI");var RankUIPre=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.startPre=function(){UIResLoading.loadReses(RankUI.RES_NAME,this.requestInfo,this)},t.prototype.requestInfo=function(){LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.RANKE_PANEL,type:0},this.onRankPanel,this)},t.prototype.onRankPanel=function(e){RankVoManager.ins.fromServer(e.dataVo),Game.net.sendData({cmd:BookCmd.RANKE_PANEL,type:PlayerVoManager.ins.playerVo.camp},this.onSelfRank,this)},t.prototype.onSelfRank=function(e){LoadingIcon.instance.hide();for(var t=PlayerVoManager.ins.playerVo.name,i=e.dataVo.rankers,n=!1,o=0,r=i.length;r>o;o++)if(i[o].name==t){PlayerVoManager.ins.updateRank(i[o].rank),RankVoManager.ins.updateSelf(i[o]),n=!0;break}if(!n){var s={};s.rank=0,s.name=PlayerVoManager.ins.playerVo.name,s.country=PlayerVoManager.ins.playerVo.camp,s.capacity=PlayerVoManager.ins.playerVo.fightingForce,s.houjin=HozaVoManager.ins.hozaVo.level,s.lv=PlayerVoManager.ins.playerVo.level,RankVoManager.ins.updateSelf(s)}UIManager.ins.open(new RankUI)},t}(PreUIBase);__reflect(RankUIPre.prototype,"RankUIPre");var RankListComponent=function(e){function t(t,i){void 0===i&&(i=null);var n=e.call(this,t,i)||this;return n.tabIndex=-1,n}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.list=this.getMc("list"),this.menuGroup=this.getMc("menuGroup"),this.campMenuGroup=this.getMc("campMenuGroup")},t.prototype.updateRank=function(e){if(this.tabIndex!=e){RankUI.tabIndex=e,this.tabIndex=e,0==this.tabIndex?(this.list.itemRenderer=RankListItemRender,this.menuGroup.visible=!0,this.campMenuGroup.visible=!1):(this.list.itemRenderer=RankCampListItemRender,this.menuGroup.visible=!1,this.campMenuGroup.visible=!0);var t=new eui.ArrayCollection(RankVoManager.ins.ranks);this.list.dataProvider=t}},t.prototype.dispose=function(){e.prototype.dispose.call(this),UIUtil.dispose(this.menuGroup),UIUtil.dispose(this.campMenuGroup),this.list.dataProvider=null},t}(BaseSkin);__reflect(RankListComponent.prototype,"RankListComponent");var RankSelfCampItem=function(e){function t(t,i){return void 0===i&&(i=null),e.call(this,t,i)||this}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.numLabel=this.getMc("numLabel"),this.nameLabel=this.getMc("nameLabel"),this.attackForceLabel=this.getMc("attackForceLabel"),this.positionLabel=this.getMc("positionLabel"),this.levelLabel=this.getMc("levelLabel"),this.bgImg=this.getMc("bgImg"),this.bgImg.texture=RES.getRes("phb_16"),this.jobImg=this.getMc("jobImg"),this.hozaLabel=this.getMc("hozaLabel")},t.prototype.updateRank=function(e){var t=16777215;1==e.num?(t=15884828,this.numLabel.text="a"):2==e.num?(t=2453966,this.numLabel.text="b"):3==e.num?(t=6267199,this.numLabel.text="c"):0==e.num?this.numLabel.text="无":this.numLabel.text=e.num+"",this.nameLabel.textColor=t,this.attackForceLabel.textColor=t,this.positionLabel.textColor=t,this.levelLabel.textColor=t,this.nameLabel.text=e.name,this.attackForceLabel.text=e.attackForce-Game.FIGHTING_FORCE_INIT+"";var i=MetaHozaManager.ins.getHoza(e.hoza);this.levelLabel.text=e.level+"";var n=GameUtil.getPlayerJob(RankUI.tabIndex,e.num);this.positionLabel.text=n.name,this.jobImg.texture=RES.getRes("phb_job_"+n.num),this.hozaLabel.text=i.id+"级"},t}(BaseSkin);__reflect(RankSelfCampItem.prototype,"RankSelfCampItem");var RankCampListItemRender=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/ui/rank/list/RankCampListItemSkin.exml",t}return __extends(t,e),t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this);var t=this.data,i=16777215;t.num<=3?1==t.num?(i=15884828,this.numLabel.text="a"):2==t.num?(i=2453966,this.numLabel.text="b"):3==t.num&&(i=6267199,this.numLabel.text="c"):this.numLabel.text=t.num+"",this.nameLabel.textColor=i,this.attackForceLabel.textColor=i,this.positionLabel.textColor=i,this.levelLabel.textColor=i,this.nameLabel.text=t.name,this.attackForceLabel.text=t.attackForce-Game.FIGHTING_FORCE_INIT+"";var n=MetaHozaManager.ins.getHoza(t.hoza);this.levelLabel.text=t.level+"";var o=GameUtil.getPlayerJob(RankUI.tabIndex,t.num);this.positionLabel.text=o.name,this.jobImg.texture=RES.getRes("phb_job_"+o.num),this.hozaLabel.text=n.id+"级"},t}(eui.ItemRenderer);__reflect(RankCampListItemRender.prototype,"RankCampListItemRender");var RankListItemRender=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/ui/rank/list/RankListItemSkin.exml",t}return __extends(t,e),t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this);var t=this.data,i=16777215;t.num<=3?1==t.num?(i=15884828,this.numLabel.text="a"):2==t.num?(i=2453966,this.numLabel.text="b"):3==t.num&&(i=6267199,this.numLabel.text="c"):this.numLabel.text=t.num+"",this.nameLabel.textColor=i,this.attackForceLabel.textColor=i,this.renownLabel.textColor=i,this.levelLabel.textColor=i,this.nameLabel.text=t.name,this.campImg.texture=RES.getRes("camp_small_"+t.camp),this.attackForceLabel.text=t.attackForce-Game.FIGHTING_FORCE_INIT+"";var n=MetaHozaManager.ins.getHoza(t.hoza);this.renownLabel.text=n.id+"级",this.levelLabel.text=t.level+""},t}(eui.ItemRenderer);__reflect(RankListItemRender.prototype,"RankListItemRender");var ServerInfoUI=function(e){function t(t){var i=e.call(this)||this;return i.serverInfo=t,i.skinName="ServerInfoSkin",i}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.contentLabel=this.getMc("contentLabel");var t=new Array;1==this.serverInfo.type?t.push({text:"服务器维护中!\n维护时间:"}):t.push({text:"您已经被禁止登陆游戏!\n"}),t.push({text:this.serverInfo.time,style:{textColor:Constants.COLOR_DYNAMIC}}),this.contentLabel.textFlow=t},t}(BaseUI);__reflect(ServerInfoUI.prototype,"ServerInfoUI");var ServerListUI=function(e){function t(){var t=e.call(this)||this;return t.skinName="ServerListUISkin",t}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.serverListScroller=this.skin.serverListScroller,this.recentGroup=this.getMc("recentGroup"),EventCenter.ins.add(EventCenter.SELECT_SERVER,this.selectServer,this),this.initRecentServers(),this.initServerList()},t.prototype.dispose=function(){e.prototype.dispose.call(this),EventCenter.ins.remove(EventCenter.SELECT_SERVER,this.selectServer,this),UIUtil.dispose(this.recentGroup),this.recentGroup=null,UIUtil.dispose(this.listContainer),this.listContainer=null,UIUtil.dispose(this)},t.prototype.initRecentServers=function(){for(var e=ServerListVoManager.ins.recentServers.reverse(),t=Math.min(e.length,4),i=null,n=null,o=0;t>o;o++)i=e[o],n=new ServerListItem(i),this.recentGroup.addChild(n),n.x=o%2*n.width,n.y=Math.floor(o/2)*n.height},t.prototype.initServerList=function(){this.listContainer=new eui.Group;for(var e,t=ServerListVoManager.ins,i=t.servers,n=i.length,o=0;n>o;o++)e=new ServerListItem(i[o]),this.listContainer.addChild(e),e.x=o%2*267,e.y=61*Math.floor(o/2);this.serverListScroller.viewport=this.listContainer},t.prototype.selectServer=function(e){UIManager.ins.close(this)},t}(BaseUI);__reflect(ServerListUI.prototype,"ServerListUI");var ServerListItem=function(e){function t(t){var i=e.call(this)||this;return i.skinName="resource/skins/ui/serverList/list/ServerListUIItemRenderSkin.exml",i.serverListVo=t,i.addEventListener(eui.UIEvent.CREATION_COMPLETE,i.onCreated,i),i.addEventListener(egret.Event.REMOVED_FROM_STAGE,i.onRemoved,i),i}return __extends(t,e),t.prototype.onCreated=function(e){this.serverBtn.label=this.serverListVo.serverId+"区   "+this.serverListVo.serverName,this.stateImg.source="server_list_state_"+this.serverListVo.serverState+"_png",this.serverBtn=UIUtil.getButton("serverBtn",this,this.selectServer,this,!1)},t.prototype.selectServer=function(e){Game.eventCenter.send(EventCenter.SELECT_SERVER,this.serverListVo)},t.prototype.onRemoved=function(e){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.onCreated,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this),this.serverBtn.dispose()},t}(eui.Component);__reflect(ServerListItem.prototype,"ServerListItem");var ShareUI=function(e){function t(){var t=e.call(this)||this;return t.operType=0,t.skinName="ShareUISkin",t}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.invateBtn=UIUtil.getButton("invateBtn",this.skin,this.onInvate,this),this.invateRewardCountLabel=this.getMc("invateRewardCountLabel"),this.getRewardCountLabel=this.getMc("getRewardCountLabel"),this.shareConfig=GamePlatform.ins.getShareConfig(),this.invateRewardCountLabel.text=this.shareConfig.share.value1+"",this.updateCount(),EventCenter.ins.add(EventCenter.SHARE_UPDATE,this.updateCount,this)},t.prototype.updateCount=function(){var e=(MetaConfigManager.ins.getConfig("invate_max_count"),ShareVoManager.ins.shareVo);this.getRewardCountLabel.text=e.shareCount+"次"},t.prototype.onInvate=function(e){GamePlatform.ins.setShareCallback(this.onShare,this),GamePlatform.ins.share()},t.prototype.onShare=function(){EventCenter.ins.send(EventCenter.SHARE_SUCCESS)},t.prototype.onGetReward=function(){var e=ShareVoManager.ins.shareVo;if(e.invateGetCount>=e.invateCount){var t=GamePlatform.ins.getShareConfig();return e.invateGetCount>=t.share.value2?void Alert.ins.showAlert(AlertType.ERROR,"今天领取次数已用完,请您明天邀请领取!"):void Alert.ins.showAlert(AlertType.ERROR,"请您先邀请好友进入游戏!")}LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.SHARE_GET_INVATED_REWARD},this.onSureGetReward,this)},t.prototype.onSureGetReward=function(e){LoadingIcon.instance.hide(),ShareVoManager.ins.shareVo.invateGetCount++,GameUtil.handleBags([e.dataVo]),this.updateCount()},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.invateBtn.dispose(),this.invateBtn=null,EventCenter.ins.remove(EventCenter.SHARE_UPDATE,this.updateCount,this),UIUtil.dispose(this)},t}(BaseUI);__reflect(ShareUI.prototype,"ShareUI");var ShareUIPre=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.startPre=function(){LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.SHARE_PANEL},this.onSharePanel,this)},t.prototype.onSharePanel=function(e){LoadingIcon.instance.hide(),ShareVoManager.ins.fromServer(e.dataVo),this.finishPre(new ShareUI)},t}(PreUIBase);__reflect(ShareUIPre.prototype,"ShareUIPre");var ShopResultUI=function(e){function t(t){var i=e.call(this)||this;return i.resultObj=null,i.intervalNum=-1,i.tenIndex=1,i._showTenSpeed=200,i.resultObj=t,i.skinName="ShopResultUISkin",i}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.oneOfficerCom=new ShopResultItem(this.getMc("oneOfficerCom")),this.tenOfficer1Com=new ShopResultItem(this.getMc("tenOfficer1Com")),this.tenOfficer2Com=new ShopResultItem(this.getMc("tenOfficer2Com")),this.tenOfficer3Com=new ShopResultItem(this.getMc("tenOfficer3Com")),this.tenOfficer4Com=new ShopResultItem(this.getMc("tenOfficer4Com")),this.tenOfficer5Com=new ShopResultItem(this.getMc("tenOfficer5Com")),this.tenOfficer6Com=new ShopResultItem(this.getMc("tenOfficer6Com")),this.tenOfficer7Com=new ShopResultItem(this.getMc("tenOfficer7Com")),this.tenOfficer8Com=new ShopResultItem(this.getMc("tenOfficer8Com")),this.tenOfficer9Com=new ShopResultItem(this.getMc("tenOfficer9Com")),this.tenOfficer10Com=new ShopResultItem(this.getMc("tenOfficer10Com")),this.drawBtn=UIUtil.getButton("drawBtn",this.skin,this.drawAgain,this),EventCenter.ins.add(EventCenter.SHOP_UPDATE_DRAW_RESULT,this.updateResult,this),EventCenter.ins.add(EventCenter.GUIDE_CHECK,this.checkGuide,this),this.updateResultView(),this.checkGuide()},t.prototype.checkGuide=function(){if(GuideVoManager.ins.isShopStep(2)){var e=UIUtil.local2Global(this.drawBtn.target);Guide.ins.show(e.x-4,e.y-4,this.drawBtn.width+8,this.drawBtn.height+8)}else if(GuideVoManager.ins.isShopStep(3)){var e=UIUtil.local2Global(this.drawBtn.target);Guide.ins.show(e.x-4,e.y-4,this.drawBtn.width+8,this.drawBtn.height+8)}else if(GuideVoManager.ins.isShopStep(4)){var e=UIUtil.local2Global(this.closeBtn.target);Guide.ins.show(e.x-4,e.y-4,this.closeBtn.width+8,this.closeBtn.height+8)}},t.prototype.onClose=function(){e.prototype.onClose.call(this)},t.prototype.updateResultView=function(){this.tenIndex=1;var e=null;if(this.resultObj.isOne)this.oneOfficerCom.closeEffect(),e=MetaOfficerManager.ins.getOfficerForTypeAndLevel(this.resultObj.officers[0].hero),this.oneOfficerCom.updateOfficer(e),this.oneOfficerCom.setVisible(!0),this.oneOfficerCom.showEffect(),this.drawBtn.label="再抽一次";else{for(var t=null,i=0,n=0,o=this.resultObj.officers.length;o>n;n++){var r=this["tenOfficer"+(n+1)+"Com"];r.setVisible(!1),r.closeEffect(),t=this.resultObj.officers[n],e=MetaOfficerManager.ins.getOfficerForTypeAndLevel(t.hero),r.updateOfficer(e),1==t.full&&(i+=e.addExp)}0!=i&&Alert.ins.showAlert(AlertType.TIP,"增加经验:"+i),-1!=this.intervalNum&&egret.clearInterval(this.intervalNum),this.intervalNum=egret.setInterval(this.showTen,this,this._showTenSpeed),this.showTen(),this.drawBtn.label="再抽十次"}},t.prototype.updateResult=function(e){this.resultObj=e.data,this.updateResultView(),GuideVoManager.ins.isShopStep(2)?Guide.ins.nextStep2():GuideVoManager.ins.isShopStep(3)&&Guide.ins.nextStep2()},t.prototype.drawAgain=function(){ShopUtil.draw(this.resultObj.drawId,this.resultObj.isOne,!0)},t.prototype.showTen=function(){return this.tenIndex>10?(egret.clearInterval(this.intervalNum),void(this.intervalNum=-1)):(this.showOneTen(this.tenIndex),void this.tenIndex++)},t.prototype.showOneTen=function(e){var t=this["tenOfficer"+e+"Com"];t.setVisible(!0),t.showEffect()},t.prototype.dispose=function(){e.prototype.dispose.call(this),-1!=this.intervalNum&&(egret.clearInterval(this.intervalNum),this.intervalNum=-1),this.drawBtn.dispose(),this.oneOfficerCom.dispose(),this.oneOfficerCom=null,this.tenOfficer1Com.dispose(),this.tenOfficer1Com=null,this.tenOfficer2Com.dispose(),this.tenOfficer2Com=null,this.tenOfficer3Com.dispose(),this.tenOfficer3Com=null,this.tenOfficer4Com.dispose(),this.tenOfficer4Com=null,this.tenOfficer5Com.dispose(),this.tenOfficer5Com=null,this.tenOfficer6Com.dispose(),this.tenOfficer6Com=null,this.tenOfficer7Com.dispose(),this.tenOfficer7Com=null,this.tenOfficer8Com.dispose(),this.tenOfficer8Com=null,this.tenOfficer9Com.dispose(),this.tenOfficer9Com=null,this.tenOfficer10Com.dispose(),this.tenOfficer10Com=null,EventCenter.ins.remove(EventCenter.SHOP_UPDATE_DRAW_RESULT,this.updateResult,this),EventCenter.ins.remove(EventCenter.GUIDE_CHECK,this.checkGuide,this),GuideVoManager.ins.isShopStep(4)&&Guide.ins.nextStep2(),UIUtil.dispose(this)},t}(BaseUI);__reflect(ShopResultUI.prototype,"ShopResultUI");var ShopResultUIPre=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.startPre=function(){this.finishPre(new ShopResultUI(this.arg))},t}(PreUIBase);__reflect(ShopResultUIPre.prototype,"ShopResultUIPre");var ShopUI=function(e){function t(t){void 0===t&&(t=1);var i=e.call(this)||this;return i.part=1,i.part=t,i.skinName="ShopUISkin",i}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.topBoard=new UITopComponent(this.getMc("topBoard")),this.scroller=this.getMc("scroller"),this.scroller.verticalScrollBar=null,this.scroller.bounces=!1;var i=this.getMc("contentGroup");this.scroller.viewport=i,this.drawCom=new ShopDrawComponent(this.getMc("drawCom")),this.drawCom.updateDraws(),this.goldCom=new ShopGoldComponent(this.getMc("goldCom")),this.goldCom.updateGolds(),this.silverCom=new ShopSilverComponent(this.getMc("silverCom")),this.silverCom.updateSilvers(),TimerManager.ins.addTimer(this),EventCenter.ins.add(EventCenter.SHOP_BUY_GOLD,this.onBuyGold,this),EventCenter.ins.add(EventCenter.SHOP_SHOW_SILVER_SURE,this.showSilverSure,this),EventCenter.ins.add(EventCenter.SHOP_GOTO_PART,this.onGotoPart,this),EventCenter.ins.add(EventCenter.SHOP_UPDATE_DRAW,this.updateView,this),EventCenter.ins.add(EventCenter.GUIDE_CHECK,this.checkGuide,this),t.isOpened=!0,this.gotoPart(this.part),this.drawCom.checkGuide(),this.checkGuide()},t.prototype.checkGuide=function(){GuideVoManager.ins.isShopStep(5)&&Guide.ins.nextStep2()},t.prototype.updateView=function(){this.drawCom.updateDraws()},t.prototype.onGotoPart=function(e){var t=e.data;this.gotoPart(t)},t.prototype.gotoPart=function(e){void 0===e&&(e=1),2==e?TweenMax.to(this.scroller.viewport,.4,{delay:.1,scrollV:this.goldCom.skin.y}):3==e&&TweenMax.to(this.scroller.viewport,.4,{delay:.1,scrollV:this.silverCom.skin.y-(this.scroller.height-this.silverCom.skin.height)})},t.prototype.onBuyGold=function(e){var t=e.data;if(GamePlatform.ins.isDebug)return void Alert.ins.showAlert(AlertType.NORMAL,"DEBUG版本不能充值!");if(Game.isKuaFu)return void Alert.ins.showAlert(AlertType.ERROR,"请您返回游戏服充值!");if(!GamePlatform.ins.canRecharge())return void Alert.ins.showAlert(AlertType.ERROR,"该渠道目前不支持支付!");var i=0,n=ActivityVoManager.ins.getActivity(Activity.FAN_BEI);if(n){var o=parseInt(n.param),r=ShopVoManager.ins.hasDoubleN(t.id);i=t.gold*(r?1:o)}else{var s=ShopVoManager.ins.hasDoubleN(t.id);if(s)i=t.gold;else{var a=ShopVoManager.ins.hasDoubled(t.id);i=t.gold*(a?1:2)}}var h=(ShopVoManager.ins.hasDoubled(t.id),GamePlatform.ins.getGoodsId(t));GamePlatform.ins.pay({goodsId:h,name:t.name,cost:t.rmb,gold:i},this.onSurePay,this)},t.prototype.onSurePay=function(e){var t=e[0],i=(e[1],MetaShopManager.ins.getShopGold(t)),n=0,o=ActivityVoManager.ins.getActivity(Activity.FAN_BEI);if(o){var r=ShopVoManager.ins.hasDoubleN(i.id);n=i.gold*(r?1:parseInt(o.param)),ShopVoManager.ins.addDoubleN(i.id)}else{var s=ShopVoManager.ins.hasDoubled(i.id);ShopVoManager.ins.addDouble(i.id),n=i.gold*(s?1:2)}this.goldCom.updateGolds(),Alert.ins.showAlert(AlertType.TIP,"购买"+n+"元宝成功!")},t.prototype.showSilverSure=function(e){var t=new ShopSilverSureComponent(e.data);this.addChild(t)},t.prototype.dispose=function(){e.prototype.dispose.call(this),t.isOpened=!1,TimerManager.ins.removeTimer(this),TweenMax.killTweensOf(this.scroller.viewport),this.drawCom.dispose(),this.drawCom=null,this.topBoard.dispose(),this.topBoard=null,this.goldCom.dispose(),this.goldCom=null,this.silverCom.dispose(),this.silverCom=null,EventCenter.ins.remove(EventCenter.SHOP_SHOW_SILVER_SURE,this.showSilverSure,this),EventCenter.ins.remove(EventCenter.SHOP_BUY_GOLD,this.onBuyGold,this),EventCenter.ins.remove(EventCenter.SHOP_GOTO_PART,this.onGotoPart,this),EventCenter.ins.remove(EventCenter.SHOP_UPDATE_DRAW,this.updateView,this),EventCenter.ins.remove(EventCenter.GUIDE_CHECK,this.checkGuide,this),UIUtil.destroyRes(t.RES_NAME),GuideVoManager.ins.isShopStep(5)&&Guide.ins.nextStep2(),UIUtil.dispose(this)},t.prototype.runTimer=function(){this.drawCom.runTime()},t.RES_NAME="shop",t.isOpened=!1,t}(BaseUI);__reflect(ShopUI.prototype,"ShopUI",["ITimer"]);var ShopUIPre=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.startPre=function(){UIResLoading.loadReses(ShopUI.RES_NAME,this.requestInfo,this)},t.prototype.requestInfo=function(){LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.ACITVITY_PANEL},this.onActivity,this)},t.prototype.onActivity=function(e){LoadingIcon.instance.hide(),ActivityVoManager.ins.fromServer(e.dataVo),LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.SHOP_PANEL},this.onShopPanel,this)},t.prototype.onShopPanel=function(e){LoadingIcon.instance.hide();var t=e.dataVo;ShopVoManager.ins.fromServer(t),this.finishPre(new ShopUI(this.arg))},t}(PreUIBase);__reflect(ShopUIPre.prototype,"ShopUIPre");var ShopUtil=function(){function e(){}return e.draw=function(t,i,n){void 0===n&&(n=!1);var o=ShopVoManager.ins.getDrawVo(t),r=MetaShopManager.ins.getDraw(t);i?o.oneFreeTime>0?e.doDraw(o.id,!0,n):o.oneFreeCount>0?e.doResult(o.id,!0,n):e.doDraw(o.id,!0,n):o.tenFreeTime>0?e.doDraw(o.id,!1,n):r.tenCD>0?0==o.tenFreeCount&&e.doResult(o.id,!1,n):e.doDraw(o.id,!1,n)},e.doDraw=function(t,i,n){void 0===n&&(n=!1);var o=ShopVoManager.ins.getDrawVo(t),r=MetaShopManager.ins.getDraw(t);if(i){if(o.oneCount>=r.oneCount)return void Alert.ins.showAlert(AlertType.ERROR,"今天抽卡次数已用完!");var s=PlayerVoManager.ins.playerVo;if(s.gold<r.oneCost)return void Alert.ins.showAlert(AlertType.ERROR,"元宝不足!")}else{if(o.tenCount>=r.tenCount)return void Alert.ins.showAlert(AlertType.ERROR,"今天抽卡次数已用完!");var s=PlayerVoManager.ins.playerVo;if(s.gold<r.tenCost)return void Alert.ins.showAlert(AlertType.ERROR,"元宝不足!")}e.doResult(t,i,n,!0)},e.doResult=function(e,t,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1);var o=0;1==e?o=t?1:10:2==e?o=t?2:20:3==e&&(o=t?3:30);var r={cmd:BookCmd.SHOP_DRAW_CARD,id:e,type:o};LoadingIcon.instance.show(),Game.net.sendData(r,function(e){LoadingIcon.instance.hide();var o=e.dataVo,r=o.id,s=(ShopVoManager.ins.getDrawVo(r),MetaShopManager.ins.getDraw(r));n&&DataCount.ins.onItemPurchase({item:"[抽卡] "+s.type+"_"+(t?1:10),itemNum:1,itemPrice:t?s.oneCost:s.tenCost}),ShopVoManager.ins.fromServer(o.panel);for(var a=0,h=new Array,p=o.ten,l=0;l<p.length;l++){var u=p[l],c=MetaOfficerManager.ins.getOfficerForTypeAndLevel(u.hero,1);if(1!=u.full){for(var d=!1,f=0;f<h.length;f++)if(u.hero==h[f].id){d=!0,h[f].count++;break}if(!d){var g={id:u.hero,count:1};h.push(g)}OfficerVoManager.ins.addOfficerPiece(u.hero,1)}else Alert.ins.showAlert(AlertType.OFFICER_2_EXP,"获得了"+c.name+"(满),兑换"+Util.handleUnit2(c.addExp)+"经验"),a+=c.addExp}for(var f=0;f<h.length;f++){var g=h[f],c=MetaOfficerManager.ins.getOfficerForTypeAndLevel(g.id,1);Alert.ins.showAlert(AlertType.GET_OFFICER,"",GameUtil.getColor(c.quality),c.name+"*"+g.count)}o.exp&&(Alert.ins.showAlert(AlertType.TIP,"抽卡获取"+Util.handleUnit2(o.exp)+"经验"),a+=o.exp);var m={isOne:t,drawId:r,officers:p,isResult:i};i?EventCenter.ins.send(EventCenter.SHOP_UPDATE_DRAW_RESULT,m):GameUIUtil.showShopResult(m),EventCenter.ins.send(EventCenter.SHOP_UPDATE_DRAW),EventCenter.ins.send(EventCenter.SHOP_FREE_UPDATE)},null)},e}();__reflect(ShopUtil.prototype,"ShopUtil");var ShopDrawItemBtnComponent=function(e){function t(t,i){void 0===i&&(i=null);var n=e.call(this,t,i)||this;return n.mIsOne=!1,n.drawId=0,n}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.freeLabel=this.getMc("freeLabel"),this.btn=new DDButton(this.getMc("btn"),this.onBtn,this),this.costLabel=this.getMc("costLabel"),this.goldImg=this.getMc("goldImg"),this.countLabel=this.getMc("countLabel")},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.btn.dispose()},t.prototype.onBtn=function(e){EventCenter.ins.send(EventCenter.SHOP_DRAW_ITEM_BTN,{isOne:this.mIsOne,drawId:this.drawId})},Object.defineProperty(t.prototype,"isOne",{get:function(){return this.mIsOne},set:function(e){this.mIsOne=e;var t=e?"blue_btn":"green_btn";this.btn.btnImg.source=t+"_up",this.btn.btnImg.source.down=t+"_up"},enumerable:!0,configurable:!0}),t.prototype.showCost=function(e){e?(this.costLabel.visible=!0,this.goldImg.visible=!0,this.countLabel.visible=!0):(this.costLabel.visible=!1,this.goldImg.visible=!1,this.countLabel.visible=!1)},t.prototype.updateBtn=function(e,t){t==e?(this.freeLabel.text="免费次数用完!",this.isOne?this.btn.label="抽卡一次":this.btn.label="十连抽"):(this.isOne?this.freeLabel.text="免费抽卡"+e+"/"+t:this.freeLabel.text="免费十连抽",this.btn.label="免费抽")},t}(BaseSkin);__reflect(ShopDrawItemBtnComponent.prototype,"ShopDrawItemBtnComponent");var ShopDrawComponent=function(e){function t(t,i){return void 0===i&&(i=null),e.call(this,t,i)||this}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.item1Com=new ShopDrawItem(this.getMc("item1Com")),this.item2Com=new ShopDrawItem(this.getMc("item2Com")),this.item3Com=new ShopDrawItem(this.getMc("item3Com"))},t.prototype.updateDraws=function(){for(var e,t=MetaShopManager.ins.draws,i=0,n=t.length;n>i;i++)e=this["item"+(i+1)+"Com"],e.updateDraw(t[i])},t.prototype.checkGuide=function(){this.item1Com.checkGuide()},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.item1Com.dispose(),this.item2Com.dispose(),this.item3Com.dispose()},t.prototype.runTime=function(){this.item1Com.runTime(),this.item2Com.runTime(),this.item3Com.runTime()},t}(BaseSkin);__reflect(ShopDrawComponent.prototype,"ShopDrawComponent");var ShopGoldComponent=function(e){function t(t,i){return void 0===i&&(i=null),e.call(this,t,i)||this}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.item1Com=new ShopGoldItem(this.getMc("item1Com")),this.item2Com=new ShopGoldItem(this.getMc("item2Com")),this.item3Com=new ShopGoldItem(this.getMc("item3Com")),this.item4Com=new ShopGoldItem(this.getMc("item4Com")),this.item5Com=new ShopGoldItem(this.getMc("item5Com")),this.item6Com=new ShopGoldItem(this.getMc("item6Com")),this.tipGroup=this.getMc("tipGroup"),this.tipLabel=this.getMc("tipLabel"),this.tipGroup.visible=!1;var t=ActivityVoManager.ins.getActivity(Activity.FAN_BEI);if(t){var i=(new Date(t.beginTime),new Date(t.endTime),DateUtils.getRiQi(t.beginTime)+"-"+DateUtils.getRiQi(t.endTime)+"每天首次充值"+parseInt(t.param)+"倍元宝奖励!");this.tipLabel.text=i,this.tipGroup.visible=!0}},t.prototype.updateGolds=function(){for(var e,t=MetaShopManager.ins.getShopGolds(),i=0,n=t.length;n>i;i++)e=this["item"+(i+1)+"Com"],e.updateGold(t[i])},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.item1Com.dispose(),this.item2Com.dispose(),this.item3Com.dispose(),this.item4Com.dispose(),this.item5Com.dispose(),this.item6Com.dispose()},t}(BaseSkin);__reflect(ShopGoldComponent.prototype,"ShopGoldComponent");var ShopSilverComponent=function(e){function t(t,i){return void 0===i&&(i=null),e.call(this,t,i)||this}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.item1Com=new ShopSilverItem(this.getMc("item1Com")),this.item2Com=new ShopSilverItem(this.getMc("item2Com")),this.item3Com=new ShopSilverItem(this.getMc("item3Com"))},t.prototype.updateSilvers=function(){for(var e,t=MetaShopManager.ins.silvers,i=0,n=t.length;n>i;i++)e=this["item"+(i+1)+"Com"],e.updateSilver(t[i])},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.item1Com.dispose(),this.item2Com.dispose(),this.item3Com.dispose()},t}(BaseSkin);__reflect(ShopSilverComponent.prototype,"ShopSilverComponent");var ShopSilverSureComponent=function(e){function t(t){var i=e.call(this)||this;return i.skinName="resource/skins/ui/shop/silver/ShopSilverSureSkin.exml",i.metaShopSilver=t,i.once(eui.UIEvent.CREATION_COMPLETE,i.onCreated,i),i}return __extends(t,e),t.prototype.onCreated=function(e){this.nameLabel.text=this.metaShopSilver.name,this.iconImg.texture=RES.getRes(this.metaShopSilver.icon),this.countLabel.text=this.metaShopSilver.gold+"",this.buyBtn=new DDButton(this.buyBtn,this.onBuy,this),this.bgImg.once(egret.TouchEvent.TOUCH_TAP,this.onClose,this)},t.prototype.onClose=function(){UIUtil.removeChildFromParent(this)},t.prototype.onBuy=function(){var e=PlayerVoManager.ins.playerVo;if(e.gold<this.metaShopSilver.gold)return void Alert.ins.showAlert(AlertType.ERROR,"元宝不足。兑换失败!");var t={cmd:BookCmd.SHOP_EXCHANGE_SILVER,id:this.metaShopSilver.id};LoadingIcon.instance.show(),Game.net.sendData(t,this.onSureBuy,this)},t.prototype.onSureBuy=function(e){LoadingIcon.instance.hide();e.dataVo;DataCount.ins.onItemPurchase({item:"[商城]"+this.metaShopSilver.name,itemNum:1,itemPrice:this.metaShopSilver.gold}),Alert.ins.showAlert(AlertType.TIP,"获得了"+Util.handleUnit2(this.metaShopSilver.silver)+"银两。")},t}(eui.Component);__reflect(ShopSilverSureComponent.prototype,"ShopSilverSureComponent");var ShopDrawItem=function(e){function t(t,i){void 0===i&&(i=null);var n=e.call(this,t,i)||this;return n.isOpen=!1,n}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.nameImg=this.getMc("nameImg"),this.iconImg=this.getMc("iconImg"),this.lowestOfficerLabel=this.getMc("lowestOfficerLabel"),this.conditionLabel=this.getMc("conditionLabel"),this.conditionOfficerLabel=this.getMc("conditionOfficerLabel"),this.maskImg=this.getMc("maskImg"),this.limitLevelLabel=this.getMc("limitLevelLabel"),this.oneDrawCom=new ShopDrawItemBtnComponent(this.getMc("oneDrawCom")),this.oneDrawCom.isOne=!0,this.tenDrawCom=new ShopDrawItemBtnComponent(this.getMc("tenDrawCom")),this.tenDrawCom.isOne=!1,EventCenter.ins.add(EventCenter.SHOP_UPDATE_DRAW_ITEM,this.onUpdate,this),EventCenter.ins.add(EventCenter.SHOP_DRAW_ITEM_BTN,this.onBtn,this)},t.prototype.checkGuide=function(){if(GuideVoManager.ins.isShopStep(1)){var e=UIUtil.local2Global(this.tenDrawCom.btn.target);Guide.ins.show(e.x+12,e.y,this.tenDrawCom.btn.width+10,this.tenDrawCom.btn.height)}},t.prototype.onUpdate=function(e){var t=e.data;t==this.shopDrawVo.id&&this.updateView()},t.prototype.onBtn=function(e){var t=e.data,i=t.isOne,n=t.drawId;n==this.shopDrawVo.id&&(i?this.shopDrawVo.oneFreeTime>0?ShopUtil.doDraw(this.shopDrawVo.id,!0):this.shopDrawVo.oneFreeCount<this.metaShopDraw.oneFreeCount?ShopUtil.doResult(this.shopDrawVo.id,!0):ShopUtil.doDraw(this.shopDrawVo.id,!0):(GuideVoManager.ins.isShopStep(1)&&Guide.ins.nextStep2(3),ShopUtil.draw(this.shopDrawVo.id,!1)))
},t.prototype.updateDraw=function(e){this.metaShopDraw=e,this.shopDrawVo=ShopVoManager.ins.getDrawVo(this.metaShopDraw.id),this.oneDrawCom.drawId=this.tenDrawCom.drawId=this.metaShopDraw.id;var t=PlayerVoManager.ins.playerVo,i=HozaVoManager.ins.hozaVo,n=null,o="";if(1==e.type)o="shop_5",this.iconImg.texture=RES.getRes("shop_4"),this.lowestOfficerLabel.text="绿色武将",this.lowestOfficerLabel.textColor=GameUtil.getColor(ColorType.GREEN),n=MetaHozaManager.ins.getHoza(4),i.level<4?(this.conditionLabel.text="达到厚劲"+n.id+"级"+n.name+"可抽到",this.conditionOfficerLabel.text="蓝色武将",this.conditionOfficerLabel.textColor=GameUtil.getColor(ColorType.BLUE)):(n=MetaHozaManager.ins.getHoza(7),this.conditionLabel.text="达到厚劲"+n.id+"级"+n.name+"可抽到",this.conditionOfficerLabel.text="紫色武将",this.conditionOfficerLabel.textColor=GameUtil.getColor(ColorType.PURPLE));else if(2==e.type)o="shop_10",this.iconImg.texture=RES.getRes("shop_9"),this.lowestOfficerLabel.text="蓝色武将",this.lowestOfficerLabel.textColor=GameUtil.getColor(ColorType.BLUE),n=MetaHozaManager.ins.getHoza(7),i.level<7?(this.conditionLabel.text="达到厚劲"+n.id+"级"+n.name+"可抽到",this.conditionOfficerLabel.text="紫色武将",this.conditionOfficerLabel.textColor=GameUtil.getColor(ColorType.PURPLE)):(n=MetaHozaManager.ins.getHoza(9),this.conditionLabel.text="达到厚劲"+n.id+"级"+n.name+"可抽到",this.conditionOfficerLabel.text="橙色武将",this.conditionOfficerLabel.textColor=GameUtil.getColor(ColorType.ORANGE));else if(3==e.type){o="shop_3",this.iconImg.texture=RES.getRes("shop_2"),this.lowestOfficerLabel.text="橙色武将",this.lowestOfficerLabel.textColor=GameUtil.getColor(ColorType.ORANGE);var r=MetaHozaManager.ins.getHoza(10);this.conditionLabel.text="达到厚劲"+r.id+"级"+r.name+"可抽到",this.conditionOfficerLabel.text="红色武将",this.conditionOfficerLabel.textColor=GameUtil.getColor(ColorType.RED)}this.nameImg.texture=RES.getRes(o),this.isOpen=e.level<=t.level,this.isOpen?(this.maskImg.visible=!1,this.limitLevelLabel.visible=!1):(this.maskImg.visible=!0,this.limitLevelLabel.text=e.level+"级开放",this.limitLevelLabel.visible=!0),this.updateView()},t.prototype.runTime=function(){this.isOpen&&this.updateView()},t.prototype.updateView=function(){this.oneDrawCom.costLabel.text=this.metaShopDraw.oneCost+"",this.tenDrawCom.costLabel.text=this.metaShopDraw.tenCost+"",this.oneDrawCom.countLabel.text=this.shopDrawVo.oneCount+"/"+this.metaShopDraw.oneCount,this.tenDrawCom.countLabel.text=this.shopDrawVo.tenCount+"/"+this.metaShopDraw.tenCount,this.shopDrawVo.oneFreeTime>0?(this.oneDrawCom.showCost(!0),this.oneDrawCom.freeLabel.text=DateUtils.getTimeStr2(this.shopDrawVo.oneFreeTime)+" 后免费",this.oneDrawCom.btn.label="抽卡1次"):this.metaShopDraw.oneFreeCount>0?(this.shopDrawVo.oneFreeCount<this.metaShopDraw.oneFreeCount?this.oneDrawCom.showCost(!1):this.oneDrawCom.showCost(!0),this.oneDrawCom.updateBtn(this.shopDrawVo.oneFreeCount,this.metaShopDraw.oneFreeCount)):(this.oneDrawCom.showCost(!0),this.oneDrawCom.freeLabel.visible=!1,this.oneDrawCom.countLabel.text=this.shopDrawVo.oneCount+"/"+this.metaShopDraw.oneCount,this.oneDrawCom.btn.label="抽卡1次"),this.shopDrawVo.tenFreeTime>0?(this.tenDrawCom.countLabel.text=this.shopDrawVo.tenCount+"/"+this.metaShopDraw.tenCount,this.tenDrawCom.showCost(!0),this.tenDrawCom.freeLabel.visible=!0,this.tenDrawCom.freeLabel.text=DateUtils.getTimeStr3(this.shopDrawVo.tenFreeTime),this.tenDrawCom.btn.label="十连抽"):this.metaShopDraw.tenCD>0?(this.tenDrawCom.showCost(!1),this.tenDrawCom.freeLabel.visible=!0,this.tenDrawCom.updateBtn(0,1)):(this.tenDrawCom.showCost(!0),this.tenDrawCom.freeLabel.visible=!1,this.tenDrawCom.updateBtn(0,0))},t.prototype.dispose=function(){e.prototype.dispose.call(this),EventCenter.ins.remove(EventCenter.SHOP_UPDATE_DRAW_ITEM,this.onUpdate,this),EventCenter.ins.remove(EventCenter.SHOP_DRAW_ITEM_BTN,this.onBtn,this),this.oneDrawCom.dispose(),this.tenDrawCom.dispose()},t}(BaseSkin);__reflect(ShopDrawItem.prototype,"ShopDrawItem");var ShopGoldItem=function(e){function t(t,i){return void 0===i&&(i=null),e.call(this,t,i)||this}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.nameLabel=this.getMc("nameLabel"),this.countLabel=this.getMc("countLabel"),this.iconImg=this.getMc("iconImg"),this.rmbLabel=this.getMc("rmbLabel"),this.addLabel=this.getMc("addLabel"),this.addBgImg=this.getMc("addBgImg"),this.skin.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},t.prototype.onClick=function(e){EventCenter.ins.send(EventCenter.SHOP_BUY_GOLD,this.metaShopGold)},t.prototype.updateGold=function(e){this.metaShopGold=e,this.nameLabel.text=this.metaShopGold.name,this.countLabel.text=this.metaShopGold.gold+"",this.iconImg.texture=RES.getRes(this.metaShopGold.icon),this.rmbLabel.text=GamePlatform.ins.getCurrency(this.metaShopGold.rmb);var t=ActivityVoManager.ins.getActivity(Activity.FAN_BEI);if(t){var i=parseInt(t.param);this.addLabel.text="送"+this.metaShopGold.gold*(i-1);var n=ShopVoManager.ins.hasDoubleN(this.metaShopGold.id);this.addLabel.visible=this.addBgImg.visible=!n}else{this.addLabel.text="首充送"+this.metaShopGold.gold;var o=ShopVoManager.ins.hasDoubleN(this.metaShopGold.id);if(o)return void(this.addLabel.visible=this.addBgImg.visible=!1);var n=ShopVoManager.ins.hasDoubled(this.metaShopGold.id);this.addLabel.visible=this.addBgImg.visible=!n}},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.skin.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.skin=null,this.argObj=null},t}(BaseSkin);__reflect(ShopGoldItem.prototype,"ShopGoldItem");var ShopResultItem=function(e){function t(t,i){return void 0===i&&(i=null),e.call(this,t,i)||this}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this)},t.prototype.updateOfficer=function(e){UIUtil.getImage(GameUtil.getOfficerHead(e.type),"iconImg",this.skin),UIUtil.getImage(RES.getRes("officer_head_icon_bg_"+e.quality),"colorImg",this.skin),UIUtil.getImage(RES.getRes("officer_name_"+e.type),"nameImg",this.skin)},t.prototype.closeEffect=function(){var e=this.skin.getChildByName("effectMc");e&&this.skin.removeChild(e)},t.prototype.showEffect=function(){var e=this,t=this;UtilMovieClip.loadMc("officer_level_up","officer_level_up",function(){var i=UtilMovieClip.getMovieClip("officer_level_up_json","officer_level_up_png","officer_level_up");i.name="effectMc",e.skin.addChild(i),i.x=e.skin.width/2,i.y=e.skin.height/2,i.addEventListener(egret.Event.COMPLETE,function(){t.skin.removeChild(i)},t),i.play(1)},this)},t}(BaseSkin);__reflect(ShopResultItem.prototype,"ShopResultItem");var ShopSilverItem=function(e){function t(t,i){return void 0===i&&(i=null),e.call(this,t,i)||this}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.nameLabel=this.getMc("nameLabel"),this.silverLabel=this.getMc("silverLabel"),this.iconImg=this.getMc("iconImg"),this.goldLabel=this.getMc("goldLabel"),this.skin.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},t.prototype.onClick=function(e){EventCenter.ins.send(EventCenter.SHOP_SHOW_SILVER_SURE,this.metaShopSilver)},t.prototype.updateSilver=function(e){this.metaShopSilver=e,this.nameLabel.text=this.metaShopSilver.name,this.silverLabel.text=this.metaShopSilver.silver+"",this.iconImg.texture=RES.getRes(this.metaShopSilver.icon),this.goldLabel.text=this.metaShopSilver.gold+""},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.skin.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},t}(BaseSkin);__reflect(ShopSilverItem.prototype,"ShopSilverItem");var StrongUI=function(e){function t(){var t=e.call(this)||this;return t.skinName="StrongUISkin",t}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.go1Btn=UIUtil.getButton("go1Btn",this.skin,this.onGo,this),this.go2Btn=UIUtil.getButton("go2Btn",this.skin,this.onGo,this),this.go3Btn=UIUtil.getButton("go3Btn",this.skin,this.onGo,this)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.go1Btn.dispose(),this.go1Btn=null,this.go2Btn.dispose(),this.go2Btn=null,this.go3Btn.dispose(),this.go3Btn=null,UIUtil.dispose(this)},t.prototype.onGo=function(e){var t=e.currentTarget,i=parseInt(t.name.split("_")[1]);if(1==i){if(!VoUtil.checkFunctionOpen(FunctionId.SHOP)){var n=MetaFunctionOpenManager.ins.getOpenForFunctionId(FunctionId.SHOP);return void Alert.ins.showAlert(AlertType.ERROR,"藏宝需要玩家等级达到"+n.openLevel+"级")}GameUIUtil.showShop(i),UIManager.ins.close(this)}else if(2==i)Util.sendEvent(EventCenter.SHOW_MAIN_WORLD_MAP,null),UIManager.ins.close(this);else if(3==i){var o=GameUtil.getMainCityIdForCamp(PlayerVoManager.ins.playerVo.camp);if(Game.mapId==o)return void UIManager.ins.close(this);var r={cmd:BookCmd.ENTER_MAP,map:o};LoadingIcon.instance.show(),Game.net.sendData(r,this.responseEnterMap,this)}},t.prototype.responseEnterMap=function(e){LoadingIcon.instance.hide();var t=GameUtil.getMainCityIdForCamp(PlayerVoManager.ins.playerVo.camp);Game.battleType=BattleType.NO,EventCenter.ins.send(EventCenter.SURE_ENTER_MAP),MapEntityVoManager.ins.onEnterMap(e.dataVo),Util.sendEvent(EventCenter.ENTER_MAP,t),UIManager.ins.close(this)},t}(BaseUI);__reflect(StrongUI.prototype,"StrongUI");var TianShuInfoUI=function(e){function t(t){var i=e.call(this)||this;return i.metaId=t,i.skinName="TianShuInfoUISkin",i}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.colorLabel=this.getMc("colorLabel"),this.hpLabel=this.getMc("hpLabel"),this.attackLabel=this.getMc("attackLabel"),this.defenceLabel=this.getMc("defenceLabel"),this.group=this.getMc("group"),this.nameLabel=this.getMc("nameLabel"),this.allImg=this.getMc("allImg"),this.iconImg=this.getMc("iconImg"),this.lightImg=this.getMc("lightImg"),this.mapLabel=this.getMc("mapLabel"),this.enterMapLabel=this.getMc("enterMapLabel"),this.bookBtn=UIUtil.getButton("bookBtn",this.skin,this.onBook,this),this.enterMapLabel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEnterMap,this);var t=MetaTianShuManager.ins.getTianShu(this.metaId);this.colorLabel.text=GameUtil.getColorName(t.quality),this.colorLabel.textColor=GameUtil.getColor(t.quality),this.iconImg.source="tianshu_icon_"+t.id,this.nameLabel.text=t.name,this.hpLabel.text=t.hp+"",this.attackLabel.text=t.attack+"",this.defenceLabel.text=t.defence+"";var i;0!=t.wuli&&(i=new TianShuInfoPropertyItem({name:"武力：",value:t.wuli}),this.group.addChild(i)),0!=t.zhili&&(i=new TianShuInfoPropertyItem({name:"智力：",value:t.zhili}),this.group.addChild(i)),0!=t.neili&&(i=new TianShuInfoPropertyItem({name:"内力：",value:t.neili}),this.group.addChild(i)),0!=t.tongshuai&&(i=new TianShuInfoPropertyItem({name:"统帅：",value:t.tongshuai}),this.group.addChild(i)),0!=t.minjie&&(i=new TianShuInfoPropertyItem({name:"敏捷：",value:t.minjie}),this.group.addChild(i)),0!=t.meili&&(i=new TianShuInfoPropertyItem({name:"魅力：",value:t.meili}),this.group.addChild(i));var n=t.mapIds.length;if(n>1)for(var o=0;n>o&&(this.metaMap=MetaMapManager.ins.getMap(t.mapIds[o]),this.metaMap.type!=PlayerVoManager.ins.playerVo.camp+9);o++);else this.metaMap=MetaMapManager.ins.getMap(t.mapIds[0]);var r=MainMapUtil.getMapPath(this.metaMap);this.mapLabel.text="产出地图： "+r,this.updateTianShu(),EventCenter.ins.add(EventCenter.GUIDE_CHECK,this.checkGuide,this),this.checkGuide()},t.prototype.onEnterMap=function(e){MainMapUtil.showEnterMap(this.metaMap.id,this.closeUI,this)},t.prototype.closeUI=function(){this.onClose(),EventCenter.ins.send(EventCenter.TIAN_SHU_UI_CLOSE)},t.prototype.checkGuide=function(){if(GuideVoManager.ins.isTianShuStep(2)){var e=UIUtil.local2Global(this.bookBtn.target);Guide.ins.show(e.x,e.y,this.bookBtn.target.width,this.bookBtn.target.height)}else GuideVoManager.ins.isTianShuStep(3)&&Guide.ins.nextStep2()},t.prototype.updateTianShu=function(){var e=MetaTianShuManager.ins.getTianShu(this.metaId),t=TianShuVoManager.ins.getTianShu(this.metaId);this.allImg.visible=!1,this.bookBtn.visible=!1,t?t.hasBook?(this.lightImg.visible=!0,this.allImg.visible=!0):(this.bookBtn.visible=!0,this.lightImg.visible=!1,t.count<e.count?this.bookBtn.currentState="disabled":this.bookBtn.currentState="up"):(this.bookBtn.currentState="disabled",this.bookBtn.visible=!0,this.lightImg.visible=!1)},t.prototype.onBook=function(e){var t=MetaTianShuManager.ins.getTianShu(this.metaId),i=TianShuVoManager.ins.getTianShu(this.metaId);return i?i.count<t.count?void Alert.ins.showAlert(AlertType.ERROR,t.name+"碎片不足!"):(LoadingIcon.instance.show(),void Game.net.sendData({cmd:BookCmd.BOOK_PANEL_BOOK,id:this.metaId},this.onResponseBook,this)):void Alert.ins.showAlert(AlertType.ERROR,t.name+"碎片不足!")},t.prototype.onResponseBook=function(e){LoadingIcon.instance.hide();var t=new DDMovieClip("tianshu_effect_1",1);this.addChild(t),t.x=Game.stage.stageWidth/2,t.y=Game.stage.stageHeight/2;var i=e.dataVo.id,n=TianShuVoManager.ins.getSixPro(),o=TianShuVoManager.ins.getNormalProperty();TianShuVoManager.ins.book(i);var r=TianShuVoManager.ins.getSixPro(),s=TianShuVoManager.ins.getNormalProperty();GameUtil.handleNormalProperty(o,s),GameUtil.handleSixProperty2(n,r),this.updateTianShu(),GuideVoManager.ins.isTianShuStep(2)&&Guide.ins.nextStep2()},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.bookBtn.dispose(),this.bookBtn=null,EventCenter.ins.remove(EventCenter.GUIDE_CHECK,this.checkGuide,this),this.enterMapLabel.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEnterMap,this),GuideVoManager.ins.isTianShuStep(3)&&Guide.ins.nextStep2(),UIUtil.dispose(this)},t}(BaseUI);__reflect(TianShuInfoUI.prototype,"TianShuInfoUI");var TianShuUI=function(e){function t(){var t=e.call(this)||this;return t.skinName="TianShuUISkin",t}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.scroller=this.getMc("scroller"),this.scroller.verticalScrollBar=null,this.list=this.getMc("list"),this.list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onItem,this),EventCenter.ins.add(EventCenter.TIAN_SHU_UPDATE,this.updateList,this),this.list.itemRenderer=TianShuListItem,this.updateList(),EventCenter.ins.add(EventCenter.GUIDE_CHECK,this.checkGuide,this),EventCenter.ins.add(EventCenter.TIAN_SHU_UI_CLOSE,this.onClose,this),this.checkGuide()},t.prototype.checkGuide=function(){if(GuideVoManager.ins.isTianShuStep(1)){var e=TianShuVoManager.ins.getCanBook();if(e.length<=0)return void Guide.ins.nextStep2();var t=e[0],i=this.getItem(t.id);if(!i)return void Guide.ins.nextStep2();var n=UIUtil.local2Global(i);Guide.ins.show(n.x+8,n.y,i.width,i.height)}},t.prototype.updateList=function(){this.list.dataProvider=new eui.ArrayCollection(MetaTianShuManager.ins.tianshuArr),this.list.validateNow()},t.prototype.getItem=function(e){for(var t=null,i=0,n=this.list.dataProvider.length;n>i;i++)if(t=this.list.getVirtualElementAt(i),t.data.id==e)return t;return null},t.prototype.onItem=function(e){this.nowSelectedItem&&this.nowSelectedItem.showSelected(!1),this.nowSelectedItem=this.list.getVirtualElementAt(this.list.selectedIndex),this.nowSelectedItem.showSelected(!0),GuideVoManager.ins.isTianShuStep(1)&&Guide.ins.nextStep2(),GameUIUtil.showTianShuUIInfo(this.nowSelectedItem.data.id)},t.prototype.dispose=function(){e.prototype.dispose.call(this),UIUtil.destroyRes(t.RES_NAME),this.list.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onItem,this),EventCenter.ins.remove(EventCenter.TIAN_SHU_UPDATE,this.updateList,this),EventCenter.ins.remove(EventCenter.TIAN_SHU_UI_CLOSE,this.onClose,this),EventCenter.ins.remove(EventCenter.GUIDE_CHECK,this.checkGuide,this),UIUtil.dispose(this)},t.RES_NAME="tianshu",t}(BaseUI);__reflect(TianShuUI.prototype,"TianShuUI");var TianShuUIPre=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.startPre=function(){UIResLoading.loadReses(TianShuUI.RES_NAME,this.onRequest,this)},t.prototype.onRequest=function(){LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.BOOK_PANEL},this.responseBook,this)},t.prototype.responseBook=function(e){LoadingIcon.instance.hide(),TianShuVoManager.ins.fromServer(e.dataVo.dtoList),this.finishPre(new TianShuUI)},t}(PreUIBase);__reflect(TianShuUIPre.prototype,"TianShuUIPre");var TianShuInfoPropertyItem=function(e){function t(t){var i=e.call(this)||this;return i.infoObj=t,i.skinName="resource/skins/ui/tianshu/common/TianShuInfoPropertyItemSkin.exml",i.addEventListener(eui.UIEvent.CREATION_COMPLETE,i.onCreated,i),i.addEventListener(egret.Event.REMOVED_FROM_STAGE,i.onRemoved,i),i}return __extends(t,e),t.prototype.onCreated=function(e){this.nameLabel.text=this.infoObj.name,this.valueLabel.text=this.infoObj.value},t.prototype.onRemoved=function(e){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.onCreated,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this)},t}(eui.Component);__reflect(TianShuInfoPropertyItem.prototype,"TianShuInfoPropertyItem");var TianShuListItem=function(e){function t(){var t=e.call(this)||this;return t.metaId=0,t.skinName="resource/skins/ui/tianshu/list/TianShuListItemSkin.exml",t}return __extends(t,e),t.prototype.showSelected=function(e){this.selectedImg.visible=e},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this);var t=this.data;this.nameLabel.text=t.name,this.iconImg.source="tianshu_icon_"+t.id;var i=TianShuVoManager.ins.getTianShu(t.id),n=0,o=!1;i&&(n=i.count,o=i.hasBook),this.countLabel.text=n+"/"+t.count,o?(this.countLabel.visible=!1,this.bookImg.visible=!0,this.noBookImg.visible=!1):(this.countLabel.visible=!0,this.bookImg.visible=!1,this.noBookImg.visible=!0),this.noBookImg.visible=!1,this.qualityImg.source="tianshu_color_"+t.quality},t}(eui.ItemRenderer);__reflect(TianShuListItem.prototype,"TianShuListItem");var VipUI=function(e){function t(){var t=e.call(this)||this;return t.vipType=0,t.skinName="VipUISkin",t}return __extends(t,e),t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.list=this.getMc("list"),this.close2Btn=UIUtil.getButton("close2Btn",this.skin,this.onClose,this),this.list.itemRenderer=VipListItemRender,this.updateList(),EventCenter.ins.add(EventCenter.VIP_ITEM_CLICK,this.onItemClick,this)},t.prototype.dispose=function(){e.prototype.dispose.call(this),EventCenter.ins.remove(EventCenter.VIP_ITEM_CLICK,this.onItemClick,this),this.list.dataProvider=null,this.close2Btn.dispose(),this.close2Btn=null,UIUtil.dispose(this),t.guangQuan=!1,EventCenter.ins.send(EventCenter.CLISE_GUANG_QUAN)},t.prototype.updateList=function(){var e=MetaShopManager.ins.getVip();this.list.dataProvider=new eui.ArrayCollection(e),EventCenter.ins.send(EventCenter.VIP_UPDATE),EventCenter.ins.send(EventCenter.HUFU_TIMER)},t.prototype.onItemClick=function(e){var t=(e.data,MetaShopManager.ins.getShopGold(e.data)),i=VipVoManager.ins.vipVo;t.type==ShopType.YUE_KA?i.hasMonthCardBuy?i.hasMonthCardGetReward||this.getVipReward(ShopType.YUE_KA):this.buyVip(t):i.hasFinalCardBuy?i.hasFinalCardGetReward||this.getVipReward(ShopType.YONG_JIU_KA):this.buyVip(t)},t.prototype.buyVip=function(e){if(GamePlatform.ins.isDebug)return void Alert.ins.showAlert(AlertType.NORMAL,"DEBUG状态下不能购买!");var t=GamePlatform.ins.getGoodsId(e);GamePlatform.ins.pay({goodsId:t,name:e.name,cost:e.rmb,gold:0},this.onBuyVip,this)},t.prototype.onBuyVip=function(e){var t=e[0],i=MetaShopManager.ins.getShopGold(t);VipVoManager.ins.vipVo;VipVoManager.ins.buy(i.type),this.updateList()},t.prototype.getVipReward=function(e){this.vipType=e,LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.MONTH_CARD_GET_REWARD,type:e-1},this.onVipReward,this)},t.prototype.onVipReward=function(e){LoadingIcon.instance.hide(),this.vipType==ShopType.YONG_JIU_KA?VipVoManager.ins.vipVo.hasFinalCardGetReward=!0:VipVoManager.ins.vipVo.hasMonthCardGetReward=!0,GameUtil.handleBags(e.dataVo.dtoList),this.updateList()},t.guangQuan=!0,t}(BaseUI);__reflect(VipUI.prototype,"VipUI");var VipUIPre=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.startPre=function(){LoadingIcon.instance.show(),Game.net.sendData({cmd:BookCmd.MONTH_CARD_PANEL},this.onMonthCardPanel,this)},t.prototype.onMonthCardPanel=function(e){LoadingIcon.instance.hide(),VipVoManager.ins.fromServer(e.dataVo),this.finishPre(new VipUI)},t}(PreUIBase);__reflect(VipUIPre.prototype,"VipUIPre");var VipListItemRender=function(e){function t(){var t=e.call(this)||this;return t.buyVipBtn=null,t.skinName="resource/skins/ui/vip/list/VipListItemSkin.exml",t.addEventListener(egret.Event.REMOVED_FROM_STAGE,t.dispose,t),t}return __extends(t,e),t.prototype.dispose=function(){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.dispose,this),this.buyVipBtn&&this.buyVipBtn.dispose()},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.buyVipBtn||(this.buyVipBtn=UIUtil.getButton("buyBtn",this,this.onBuy,this));var t=this.data,i="vip_1_png";t.type==ShopType.YONG_JIU_KA&&(i="vip_2_png"),this.iconImg.source=i,this.nameLabel.text=t.name;var n=new Array;n.push({text:"每天登录可领取"}),n.push({text:t.gold+"元宝",style:{textColor:11490830}}),this.desLabel.textFlow=n,this.rmbLabel.text="售价 : "+GamePlatform.ins.getCurrency(t.rmb);var o=VipVoManager.ins.vipVo;t.type==ShopType.YUE_KA?(this.hufuLabel.text="虎符恢复-5秒(可与永久卡叠加)",o.hasMonthCardBuy?(this.buyVipBtn.label="领取",o.hasMonthCardGetReward&&(this.buyVipBtn.label="已领取"),this.buyVipBtn.enabled=!o.hasMonthCardGetReward):this.buyVipBtn.label="购买"):(this.hufuLabel.text="虎符恢复-10秒(可与月卡叠加)",o.hasFinalCardBuy?(this.buyVipBtn.label="领取",o.hasFinalCardGetReward&&(this.buyVipBtn.label="已领取"),this.buyVipBtn.enabled=!o.hasFinalCardGetReward):this.buyVipBtn.label="购买")},t.prototype.onBuy=function(){EventCenter.ins.send(EventCenter.VIP_ITEM_CLICK,this.data.id)},t}(eui.ItemRenderer);__reflect(VipListItemRender.prototype,"VipListItemRender");var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,i,n){function o(e){t.call(n,e)}function r(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),i.call(n))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(e,o,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var GameSocket=function(){function e(e){this.isConnect=!1,this.connectedCallBack=null,this.connectedCallBackThisObj=null,this.socketUrl="",this.protobufHelper=e,this.listenerDic={}}return e.prototype.setUrl=function(e,t){this.ip=e,this.port=t},e.prototype.addEvents=function(){this.socket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveMessage,this),this.socket.addEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this.socket.addEventListener(egret.Event.CLOSE,this.onSocketClose,this),this.socket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onSocketError,this)},e.prototype.removeEvents=function(){this.socket.removeEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveMessage,this),this.socket.removeEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this.socket.removeEventListener(egret.Event.CLOSE,this.onSocketClose,this),this.socket.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onSocketError,this)},e.prototype.startConnnet=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=null),this.connectedCallBack=e,this.connectedCallBackThisObj=t,this.isConnect?void(this.connectedCallBack&&this.connectedCallBack.call(this.connectedCallBackThisObj)):void this.doStartConnect()},e.prototype.ping=function(){this.isConnect&&this.sendData({cmd:BookCmd.PING})},e.prototype.sendData=function(t,i,n,o){if(void 0===i&&(i=null),void 0===n&&(n=null),void 0===o&&(o=null),this.isConnect){if(null!=i){var r=new SocketListener;r.cmd=t.cmd,r.mainKey=e.SOCKET_LISTENER_KEY+r.cmd,r.isRemovedForCall=!0,r.thisArg=n,r.callBack=i,r.errorFun=o,this.addListener(r)}var s=JSON.stringify(t);log("jsonStr:"+s);var a=new egret.ByteArray;a.writeUTFBytes(s),this.socket.writeBytes(a,0,a.bytesAvailable),this.socket.flush()}else this.onSocketErrorOrClose()},e.prototype.onReceiveMessage=function(t){var i=new egret.ByteArray;this.socket.readBytes(i);var n=i.readUnsignedShort(),o=i.readByte();if(16==n&&log(":::"),log("接收到协议 cmd:"+n+",resultCode:"+o),100!=o)this.handleResponse(n,o,i);else{var r=i.readUnsignedShort();log("警告》》》》》》》》》》》》》》》》errorCode:"+r),Alert.ins.showAlert(AlertType.ERROR,MetaConfigManager.ins.getError(r)),16==r&&GameUtil.showStopLogin(),LoadingIcon.instance.hide();var s=e.SOCKET_LISTENER_KEY+n;if(null!=this.listenerDic[s]){for(var a=this.listenerDic[s],h=a.length,p=h-1;p>=0;p--){var l=a[p];l.errorFun&&l.errorFun.call(l.thisArg,{cmd:l.cmd,resultCode:o,dataVo:r}),l.isRemovedForCall&&a.splice(p,1)}0==a.length&&(this.listenerDic[s]=null,delete this.listenerDic[s])}}},e.prototype.handleResponse=function(t,i,n){var o=null;if(i==e.RESULT_SUCCES){var r=new egret.ByteArray;n.readBytes(r,0,0);var s=new Uint8Array(this.getUint8Array(r));o=this.protobufHelper.handleData(t,s)}var a=e.SOCKET_LISTENER_KEY+t;if(null!=this.listenerDic[a]){for(var h=this.listenerDic[a],p=h.length,l=p-1;l>=0;l--){var u=h[l];u.callBack.call(u.thisArg,{cmd:u.cmd,resultCode:i,dataVo:o}),u.isRemovedForCall&&h.splice(l,1)}0==h.length&&(this.listenerDic[a]=null,delete this.listenerDic[a])}},e.prototype.getUint8Array=function(e){for(var t=[],i=0;i<e.length;i++)t.push(e.dataView.getUint8(i));return t},e.prototype.doStartConnect=function(){this.socket=new egret.WebSocket,this.socket.type=egret.WebSocket.TYPE_BINARY;var e="ws";GamePlatform.ins.isHttps&&(e="wss"),this.socketUrl=e+"://"+this.ip+":"+this.port+"/ws",this.socket.connectByUrl(this.socketUrl),this.addEvents()},e.prototype.onSocketOpen=function(){this.isConnect=!0,this.connectedCallBack&&this.connectedCallBack.call(this.connectedCallBackThisObj)},e.prototype.onSocketClose=function(e){this.onSocketErrorOrClose()},e.prototype.onSocketError=function(e){this.onSocketErrorOrClose()},e.prototype.onSocketErrorOrClose=function(){this.isConnect=!1,LoadingIcon.instance.hide(),GameUIUtil.showError({type:2,errContent:"   网络出现错误,请重新登录!"}),this.dispose()},e.prototype.reconnect=function(e){void 0===e&&(e=null),this.connectedCallBack=e,this.removeEvents(),this.socket.close(),this.socket=null,this.doStartConnect()},e.prototype.dispose=function(){null!=this.socket&&(this.removeEvents(),this.socket.close()),this.disposeListeners(),this.socket=null,this.isConnect=!1,this.connectedCallBack=null},e.prototype.disposeListeners=function(){for(var e in this.listenerDic){for(var t=this.listenerDic[e],i=0,n=t.length;n>i;i++)delete t[e];delete this.listenerDic[e]}this.listenerDic={}},e.prototype.registerServerNotifyResponse=function(t,i,n,o){void 0===n&&(n=null),void 0===o&&(o=null);var r=new SocketListener;return r.cmd=t,r.mainKey=e.SOCKET_LISTENER_KEY+t,r.errorFun=o,r.callBack=i,r.thisArg=n,r.isRemovedForCall=!1,this.addListener(r),r},e.prototype.addListener=function(e){var t=null;null==this.listenerDic[e.mainKey]?(t=new Array,this.listenerDic[e.mainKey]=t):t=this.listenerDic[e.mainKey],t.push(e)},e.prototype.removeListener=function(e){var t=null;null!=this.listenerDic[e.mainKey]&&(t=this.listenerDic[e.mainKey],Util.removeFromArray(e,t))},e.SOCKET_EVENT="socket_event_",e.SOCKET_LISTENER_KEY="socket_listener_key_",e.RESULT_SUCCES=0,e.RESULT_ERROR=100,e}();__reflect(GameSocket.prototype,"GameSocket");var SocketListener=function(){function e(){}return e}();__reflect(SocketListener.prototype,"SocketListener");var NetHandler=function(){function e(){}return e.handle=function(t){var i=t.cmd,n=(t.resultCode,t.dataVo);switch(i){case BookCmd.GET_MAP_LIST:e.handleMapList(n);break;case BookCmd.GET_OFFICER_LIST:e.handleMapList(n);break;case BookCmd.GET_EQUIPE_LIST:e.handleMapList(n)}},e.handleMapList=function(e){MapVoManager.ins.fromServer(e.maps)},e.handleOfficer=function(e){OfficerVoManager.ins.initFromServer(e)},e}();__reflect(NetHandler.prototype,"NetHandler");var ProtobufHelper=function(){function e(e){this.protobuf=e,this.init()}return e.prototype.init=function(){this.protobufs=new Array;for(var e in ProtobufDataConfig)this.protobufs.push(ProtobufDataConfig[e])},e.prototype.handleData=function(e,t){var i=this.getProtobuf(e);if(i){var n=this.protobuf[i.protoBufName],o=n.decode(t);return o}},e.prototype.getProtobuf=function(e){for(var t=this.protobufs.length,i=null,n=0;t>n;n++)if(i=this.protobufs[n],i.cmd==e)return i;return null},e}();__reflect(ProtobufHelper.prototype,"ProtobufHelper");var DateTimer=function(e){function t(t,i){void 0===i&&(i=0);var n=e.call(this)||this;return n.delay=t,n.repeatCount=i,n}return __extends(t,e),t.prototype.start=function(){this.previous=egret.getTimer(),this.accTime=0,egret.startTick(this.update,this)},t.prototype.reset=function(){this.previous=egret.getTimer(),this.accTime=0,this.currentCount=0},t.prototype.stop=function(){egret.stopTick(this.update,this)},t.prototype.update=function(){for(this.curTime=egret.getTimer(),this.passTime=this.curTime-this.previous,this.previous=this.curTime,this.accTime+=this.passTime;this.accTime>=this.delay;)this.accTime-=this.delay,this.currentCount++,this.repeatCount>0&&this.currentCount==this.repeatCount&&(this.dispatchEvent(new egret.TimerEvent(egret.TimerEvent.TIMER_COMPLETE)),this.stop()),this.dispatchEvent(new egret.TimerEvent(egret.TimerEvent.TIMER));return!1},t}(egret.EventDispatcher);__reflect(DateTimer.prototype,"DateTimer");var DateUtils=function(){function e(){}return e.formatReaminTime=function(e){e=Math.max(0,e);var t=Math.floor(e/1440);e-=1440*t;var i=Math.floor(e/60);e-=60*i;var n=Math.floor(e);e-=n;var o=Math.floor(60*e);return{day:t,hour:i,min:n,second:o}},e.getLeitaiDaojishiByRemainTime=function(e){var t=this.formatReaminTime(e/60);return t.day<=0&&t.hour<=0?t.min+"min"+this.addZeroFun(t.second)+"s":"error"},e.getMailTimeByData=function(e){var t=this.changeDateObj(e);return t.y+"-"+t.m+"-"+t.d+"  "+t.h+":"+t.minute+":"+t.s},e.getChatAttackBossTime=function(t){var i=new Date(t),n=i.getHours(),o=i.getMinutes();return e.addZeroFun(n)+"时"+e.addZeroFun(o)+"分"},e.getTimeStr=function(e){e=Math.max(0,e);var t=Math.floor(e/3600),i=Math.floor(e/60),n=e%60,o=10>t?"0"+t:""+t,r=10>i?"0"+i:""+i,s=10>n?"0"+n:""+n;return o+":"+r+":"+s},e.getBossTime=function(e){var t=Math.floor(e/86400);e-=24*t*3600;var i=Math.floor(e/3600);if(t>0)return t+"天"+this.addZeroFun(i)+"小时";e-=3600*i;var n=Math.floor(e/60);if(i>0)return i+"小时"+this.addZeroFun(n)+"分";e-=60*n;var o=Math.round(e);return n+"分"+this.addZeroFun(o)+"秒"},e.getTimeStr2=function(e){var t=Math.floor(e/86400);e-=24*t*3600;var i=Math.floor(e/3600);e-=3600*i;var n=Math.floor(e/60);e-=60*n;var o=Math.round(e);return t>0?this.addZeroFun(t)+":"+this.addZeroFun(i)+":"+this.addZeroFun(n):this.addZeroFun(i)+":"+this.addZeroFun(n)+":"+this.addZeroFun(o)},e.getTimeStr3=function(e){var t=Math.floor(e/86400);e-=24*t*3600;var i=Math.floor(e/3600);e-=3600*i;var n=Math.floor(e/60);e-=60*n;var o=Math.round(e);return t>0?this.addZeroFun(t)+"天"+this.addZeroFun(i)+"时"+this.addZeroFun(n)+"分":this.addZeroFun(i)+":"+this.addZeroFun(n)+":"+this.addZeroFun(o)},e.changeDateObj=function(e){var t=new Date(1e3*e),i=t.getFullYear(),n=this.addZeroFun(t.getMonth()+1),o=this.addZeroFun(t.getDate()),r=this.addZeroFun(t.getHours()),s=this.addZeroFun(t.getMinutes()),a=this.addZeroFun(t.getSeconds());return{y:i,m:n,d:o,h:r,minute:s,s:a}},e.addZeroFun=function(e){return 10>e?"0"+e:""+e},e.getRiQi=function(e,t){void 0===t&&(t=!0);var i=new Date(e),n=i.getFullYear()+"."+this.addZeroFun(i.getMonth()+1)+"."+this.addZeroFun(i.getDate()),o=this.addZeroFun(i.getHours())+":"+this.addZeroFun(i.getMinutes())+":"+this.addZeroFun(i.getSeconds());return t&&(n+=" "+o),n},e}();__reflect(DateUtils.prototype,"DateUtils");var UIUtil=function(){function e(){}return e.local2Global=function(e){var t=new egret.Point(0,0),i=e.x-e.anchorOffsetX,n=e.y-e.anchorOffsetY;return e.parent.localToGlobal(i,n,t),t},e.local2Global2=function(e,t){var i=new egret.Point(0,0);return e.localToGlobal(t.x,t.y,i),i},e.global2Local=function(e,t){var i=new egret.Point;return t.globalToLocal(e.x,e.y,i),i},e.getBmp=function(e){var t=new egret.Bitmap;return t.texture=RES.getRes(e),t
},e.setBmp=function(t,i,n){void 0===n&&(n=null);var o=RES.getRes(t);o?i.texture=o:e.syncTexture(t,i,n)},e.setImg=function(t,i,n){void 0===n&&(n=null);var o=RES.getRes(t);o?i.texture=o:e.syncTexture(t,i,n)},e.syncTexture=function(e,t,i){void 0===i&&(i=null),RES.getResAsync(e,function(e){t.texture=e},i)},e.getBitmapLabel=function(e,t,i){var n=i[t];return n.text=e,n},e.getLabel=function(e,t,i){var n=i[t];return n.text=e,n},e.getImage=function(e,t,i){var n=i[t];return n.texture=e,n},e.removeChildFromParent=function(e){return e&&e.parent?(e.parent.removeChild(e),e=null,!0):!1},e.getImageBtn=function(e,t,i,n){var o=t[e];return o.addEventListener(egret.TouchEvent.TOUCH_TAP,i,n),o},e.getButton=function(e,t,i,n,o,r){void 0===i&&(i=null),void 0===n&&(n=null),void 0===o&&(o=!0),void 0===r&&(r="btn_click_mp3");var s=t[e];if(s||(s=t.getChildByName(e)),s){var a=new DDButton(s,i,n);return o&&(a.clickSound=r),a}},e.getProgressBar=function(e){return new DDProgressBar(e)},e.getSkin=function(e,t){void 0===t&&(t=null);var i;if(t){var n=egret.getQualifiedClassName(t);i=new n}else i=new eui.Component;return i.skinName=e,i},e.setButton=function(e,t){void 0===t&&(t="btn_click_mp3"),e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=e.x+e.width/2,e.y=e.y+e.height/2,e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){e.scaleX=.96,e.scaleY=.96},e),e.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.scaleX=1,e.scaleY=1,""!=t&&GameUtil.playBtnSound(t)},e),e.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,function(){e.scaleX=1,e.scaleY=1},e)},e.setCenter=function(e){e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=e.x+e.width/2,e.y=e.y+e.height/2},e.zoomTween=function(e,t,i){void 0===t&&(t=-1),void 0===i&&(i=1.2),TweenMax.killTweensOf(e),TweenMax.to(e,.3,{repeat:-1,scaleX:i,scaleY:i,yoyo:!0})},e.shakeEntity=function(e,t){TweenMax.killTweensOf(e),e.x=e.pos.x,e.y=e.pos.y,TweenMax.to(e,.1,{repeat:t-1,y:e.y+(1+5*Math.random()),x:e.x+(1+5*Math.random()),delay:.1,ease:Expo.easeInOut}),TweenMax.to(e,.1,{y:e.pos.y,x:e.pos.x,delay:.1*(t+1),ease:Expo.easeInOut})},e.shakeTween=function(e,t){TweenMax.to(e,.1,{repeat:t-1,y:e.y+(1+5*Math.random()),x:e.x+(1+5*Math.random()),delay:.1,ease:Expo.easeInOut}),TweenMax.to(e,.1,{y:e.y,x:e.x,delay:.1*(t+1),ease:Expo.easeInOut})},e.destroyRes=function(e){},e.dispose=function(e){for(var t=e.numChildren-1;t>=0;t--){var i=e.getChildAt(t);TweenMax.killTweensOf(i),e.removeChild(i),i=null}},e}();__reflect(UIUtil.prototype,"UIUtil");var Util=function(){function e(){}return e.saveItem=function(e,t){localStorage.setItem(e,t)},e.isSame=function(e,t){for(var i in e)if(e[i]!=t[i])return!1;return!0},e.delSame=function(t){for(var i=new Array,n=0,o=t.length;o>n;n++){for(var r=t[n],s=!1,a=0,h=i.length;h>a;a++)if(e.isSame(r,i[a])){s=!0;break}s||i.push(r)}return i},e.disposeArr=function(e){for(var t=0,i=e.length;i>t;t++)delete e[t];e.length=0},e.sortNumber=function(e,t){return e-t},e.handleUnit2=function(e){var t=e+"",i=t.length;if(4>=i)return t;var n="",o="";if(8>=i){var r=t.slice(0,i-4),s=t.slice(i-4,i-3);n="0"==s?r+"万":r+"."+s+"万"}else if(10>=i){o=t.slice(0,i-8);var a=t.slice(i-8,i-7);n="0"==a?o+"亿":o+"."+a+"亿"}return n},e.handleUnit=function(e){var t=!1;"-"==e.charAt(0)&&(t=!0,e=e.slice(1));var i=e.length,n=0,o="",r=!1;if(7>=i)if(n=parseInt(e),1e3>n)o=e,r=!0;else if(n>=1e3&&1e6>n){for(var s=0,a=new Array,h=e.length-1;h>=0;h--)s++,a.unshift(e.charAt(h)),0!=h&&3===s&&(s=0,a.unshift(","));r=!0,o=a.join("")}if(!r){var p=["万","百万","T","P","D"],l=Math.min(19,i),u=Math.floor(l/3)-2,c=4,d=!1;i>=19&&(c=i-18,d=!0);var f=e.slice(0,c);n=parseInt(f);var g="";if(!d){var m=1*n/1e3;g=m.toFixed(2)}o=n+p[u]}return t&&(o="-"+o),o},e.sendEvent=function(e,t){void 0===t&&(t=null),Game.eventCenter.send(e,t)},e.addEvent=function(e,t,i){Game.eventCenter.add(e,t,i)},e.removeFromArray=function(e,t){if(null!=e&&null!=t)for(var i=t.length,n=0;i>n;n++)if(t[n]==e)return t.splice(n,1),!0;return!1},e.num2daxie=function(e){var t="一";switch(e){case 1:t="一";break;case 2:t="二";break;case 3:t="三";break;case 4:t="四";break;case 5:t="五";break;case 6:t="六";break;case 7:t="七";break;case 8:t="八";break;case 9:t="九"}return t},e}();__reflect(Util.prototype,"Util");var UtilMovieClip=function(){function e(){}return e.getMovieClip=function(e,t,i){var n=RES.getRes(e),o=RES.getRes(t),r=new egret.MovieClipDataFactory(n,o),s=new egret.MovieClip(r.generateMovieClipData(i));return s},e.loadMc=function(e,t,i,n){void 0===n&&(n=null);var o=RES.getRes(e+"_json"),r=RES.getRes(t+"_png");return o&&r?void i.call(n):void(o&&r||RES.getResAsync(e+"_json",function(e,o){e=e,r?i.call(n):RES.getResAsync(t+"_png",function(e,t){r=e,i.call(n)},null)},null))},e.getMovieClipByJson=function(e,t){var i=RES.getRes(e+"_json"),n=RES.getRes(e+"_png"),o=new egret.MovieClipDataFactory(i,n),r=new egret.MovieClip(o.generateMovieClipData(t));return r},e.getMovieClipByFactory=function(e,t){var i=new egret.MovieClip(e.generateMovieClipData(t));return i},e.getMCData=function(e,t){var i=RES.getRes(e+"_json"),n=RES.getRes(e+"_png"),o=new egret.MovieClipDataFactory(i,n);return o.generateMovieClipData(t)},e}();__reflect(UtilMovieClip.prototype,"UtilMovieClip");var DisposeHelper=function(){function e(){this.mAllNotDisposeResNameDic=new Object,this.mAlreadyPushResPackNameDic=new Object,this.mAllNoNeedDisposeResPackNameArray=[]}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.addNoNeedDisposeResPackName=function(e){this.mAllNoNeedDisposeResPackNameArray.push(e)},e.prototype.addNoNeedDisposeResName=function(e){this.mAllNotDisposeResNameDic[e]=!0},e.prototype.disposeMc=function(e){this.tryToPushNotDisposeResGroup();for(var t=0,i=e.numChildren;i>t;t++){var n=e.getChildAt(t);if(n instanceof egret.DisplayObjectContainer)this.disposeMc(n);else if(n instanceof eui.Image){var o=n,r=""+o.source;null!=r&&""!=r&&r.indexOf("json")<0&&!this.mAllNotDisposeResNameDic.hasOwnProperty(r)&&RES.destroyRes(r,!1)}}},e.prototype.tryToPushNotDisposeResGroup=function(){for(var e=0,t=this.mAllNoNeedDisposeResPackNameArray.length;t>e;e++)this.pushNotDisposeResInPack(this.mAllNoNeedDisposeResPackNameArray[e])},e.prototype.pushNotDisposeResInPack=function(e){if(!this.mAlreadyPushResPackNameDic.hasOwnProperty(e)){var t=RES.getRes(e);if(null!=t){for(var i in t._textureMap)this.mAllNotDisposeResNameDic[i]=!0;this.mAlreadyPushResPackNameDic[e]=!0}}},e._ins=null,e}();__reflect(DisposeHelper.prototype,"DisposeHelper");var GameBlinkMc=function(){function e(e,t){this.mTarget=e,this.mBlinkeTime=t}return e.prototype.start=function(){this.mIsAlreadyStart||(this.mIsAlreadyStart=!0,this.mCurrentTL=new TimelineMax({repeat:-1,yoyo:!1}),this.mCurrentTL.append(TweenMax.to(this.mTarget,this.mBlinkeTime,{alpha:0})),this.mCurrentTL.append(TweenMax.to(this.mTarget,this.mBlinkeTime,{alpha:1})),this.mCurrentTL.play())},e.prototype.start2=function(){this.mIsAlreadyStart||(this.stop(),this.mIsAlreadyStart=!0,this.mCurrentTL=new TimelineMax({repeat:-1,yoyo:!1}),this.mCurrentTL.append(TweenMax.to(this.mTarget,this.mBlinkeTime,{delay:.5,alpha:0})),this.mCurrentTL.append(TweenMax.to(this.mTarget,this.mBlinkeTime,{delay:.5,alpha:1})),this.mCurrentTL.play())},e.prototype.stop=function(){null!=this.mCurrentTL&&(this.mCurrentTL.stop(),this.mCurrentTL.clear(),this.mCurrentTL.kill(),this.mCurrentTL=null),TweenMax.killTweensOf(this.mTarget),this.mIsAlreadyStart=!1},e.prototype.show2=function(){this.mTarget.visible=!0,this.start2()},e.prototype.hide2=function(){this.stop(),this.mTarget.visible=!1},e.prototype.show=function(){this.mTarget.visible=!0,this.start()},Object.defineProperty(e.prototype,"visible",{set:function(e){this.mTarget.visible=e},enumerable:!0,configurable:!0}),e.prototype.hide=function(){this.mTarget.visible=!1},e.prototype.dispose=function(){this.stop()},e}();__reflect(GameBlinkMc.prototype,"GameBlinkMc");var GameJumpMc=function(){function e(e,t){this.mTarget=e,this.orignY=this.mTarget.y,this.jumpTime=t}return e.prototype.start=function(){this.mIsAlreadyStart||(this.mIsAlreadyStart=!0,this.mCurrentTL=new TimelineMax({repeat:-1,yoyo:!1}),this.mCurrentTL.append(TweenMax.to(this.mTarget,this.jumpTime,{ease:Linear.easeNone,y:this.orignY-10})),this.mCurrentTL.append(TweenMax.to(this.mTarget,2*this.jumpTime,{ease:Linear.easeNone,y:this.orignY+10})),this.mCurrentTL.append(TweenMax.to(this.mTarget,this.jumpTime,{ease:Linear.easeNone,y:this.orignY})),this.mCurrentTL.play())},e.prototype.stop=function(){null!=this.mCurrentTL&&(this.mCurrentTL.stop(),this.mCurrentTL.kill(),this.mCurrentTL=null),this.mIsAlreadyStart=!1},e.prototype.show=function(){this.mTarget.visible=!0,this.start()},e.prototype.hide=function(){this.mTarget.visible=!1},e.prototype.dispose=function(){this.stop()},e}();__reflect(GameJumpMc.prototype,"GameJumpMc");var ImageButton=function(){function e(){}return e}();__reflect(ImageButton.prototype,"ImageButton");var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,i){function n(n){t.call(i,n,e)}if(RES.hasRes(e)){var o=RES.getRes(e);o?n(o):RES.getResAsync(e,n,this)}else RES.getResByUrl(e,n,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var DataCount=function(){function e(){}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.init=function(e){this._dc=new TDCount,this._dc.init(e)},e.prototype.joinGame=function(e){this._dc.joinGame(e)},e.prototype.leaveGame=function(e){this._dc.leaveGame(e)},e.prototype.playerAccountName=function(e){this._dc.playerAccountName(e)},e.prototype.playerAccountType=function(e){this._dc.playerAccountType(e)},e.prototype.playerGender=function(e){this._dc.playerGender(e)},e.prototype.playerLevel=function(e){this._dc.playerLevel(e)},e.prototype.playerAge=function(e){this._dc.playerAge(e)},e.prototype.gameServer=function(e){this._dc.gameServer(e)},e.prototype.payRequest=function(e){this._dc.payRequest(e)},e.prototype.paySuccess=function(e){this._dc.paySuccess(e)},e.prototype.onReward=function(e){this._dc.onReward(e)},e.prototype.onItemPurchase=function(e){this._dc.onItemPurchase(e)},e.prototype.onItemUse=function(e){this._dc.onItemUse(e)},e.prototype.onMissionBegin=function(e){this._dc.onMissionBegin(e)},e.prototype.onMissionCompleted=function(e){this._dc.onMissionCompleted(e)},e.prototype.onMissionFailed=function(e){this._dc.onMissionFailed(e)},e.prototype.onEvent=function(e){this._dc.onEvent(e)},e._ins=null,e}();__reflect(DataCount.prototype,"DataCount");var TDCount=function(e){function t(){return e.call(this)||this}return __extends(t,e),Object.defineProperty(t.prototype,"td",{get:function(){return window.TDGA},enumerable:!0,configurable:!0}),t.prototype.joinGame=function(e){var t={};t.accountId=e.plat+"-"+e.accountId,t.level=e.level||1,t.gameServer=e.serverId||1,t.accountType=e.accoutType||1,t.gender=e.gender||1,t.accountName=e.accountName||"默认玩家名称",this.td&&this.td.Account(t)},t.prototype.leaveGame=function(e){this.td&&this.td.onPageLeave()},t.prototype.playerAccountName=function(e){this.td&&this.td.Account.setAccountName(e)},t.prototype.playerAccountType=function(e){this.td&&this.td.Account.setAccountType(e)},t.prototype.playerGender=function(e){this.td&&this.td.Account.setGender(e)},t.prototype.playerLevel=function(e){this.td&&this.td.Account.setLevel(e)},t.prototype.playerAge=function(e){this.td&&this.td.Account.setAge(e)},t.prototype.gameServer=function(e){this.td&&this.td.Account.setGameServer(e)},t.prototype.payRequest=function(e){this.td&&this.td.onChargeRequest(e)},t.prototype.paySuccess=function(e){this.td&&this.td.onChargeSuccess(e)},t.prototype.onReward=function(e){var t=e.count||0,i=e.reason||"系统奖励";this.td&&this.td.onReward(t,i)},t.prototype.onItemPurchase=function(e){var t={};t.item=e.item||"编号",t.itemNumber=e.itemNum||0,t.priceInVirtualCurrency=e.itemPrice||1,this.td&&this.td.onItemPurchase(t)},t.prototype.onItemUse=function(e){var t={};t.item=e.item||"消费编号",t.itemNumber=t.itemCount||0,this.td&&this.td.onItemUse(t)},t.prototype.onMissionBegin=function(e){var t=e.missionId||"默认任务ID";this.td&&this.td.onMissionBegin(t)},t.prototype.onMissionCompleted=function(e){var t=e.missionId||"默认任务ID";this.td&&this.td.onMissionCompleted(t)},t.prototype.onMissionFailed=function(e){var t=e.missionId||"默认任务ID",i=e.cause||"默认失败原因";this.td&&this.td.onMissionFailed(t,i)},t.prototype.onEvent=function(e){if(e.eventId){e.eventData||{};this.td&&this.td.onEvent(e.eventId,e.eventData)}},t}(BaseCount);__reflect(TDCount.prototype,"TDCount");var DDButton=function(){function e(e,t,i){void 0===t&&(t=null),void 0===i&&(i=null),this.mThisObj=null,this.mClickSound="",this.mTarget=e,this.mCallback=t,this.mThisObj=i,this.mTarget.anchorOffsetX=this.mTarget.width/2,this.mTarget.anchorOffsetY=this.mTarget.height/2,this.mTarget.x=this.mTarget.x+this.mTarget.width/2,this.mTarget.y=this.mTarget.y+this.mTarget.height/2,this.mBtnImg=e.btnImg,this.addListener()}return e.prototype.addListener=function(){this.mTarget.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickButton,this),this.mTarget.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this.mTarget.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.mTarget.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchRollOver,this)},e.prototype.removeListener=function(){this.mTarget.filters=null,this.mTarget.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickButton,this),this.mTarget.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this.mTarget.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.mTarget.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchRollOver,this)},e.prototype.dispose=function(){this.removeListener()},e.prototype.onTouchBegin=function(){this.mTarget.scaleX=.96,this.mTarget.scaleY=.96},e.prototype.onTouchEnd=function(){},e.prototype.onTouchRollOver=function(){this.mTarget.scaleX=1,this.mTarget.scaleY=1},e.prototype.onClickButton=function(e){this.mTarget.scaleX=1,this.mTarget.scaleY=1,this.mCallback&&this.mCallback.call(this.mThisObj,e),""==this.mClickSound},Object.defineProperty(e.prototype,"filters",{set:function(e){this.mTarget.filters=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.mTarget.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.mTarget.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"clickSound",{set:function(e){this.mClickSound=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"label",{get:function(){return this.mTarget.label},set:function(e){this.mTarget.label=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enabled",{get:function(){return this.mTarget.enabled},set:function(e){this.mTarget.enabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return this.mTarget.visible},set:function(e){this.mTarget.visible=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.mTarget.alpha},set:function(e){this.mTarget.alpha=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"labelDisplay",{get:function(){return this.mTarget.labelDisplay},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentState",{get:function(){return this.mTarget.currentState},set:function(e){this.mTarget.currentState=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return this.mTarget},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this.mTarget.x},set:function(e){this.mTarget.x=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.mTarget.y},set:function(e){this.mTarget.y=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"btnImg",{get:function(){return this.mBtnImg},enumerable:!0,configurable:!0}),e}();__reflect(DDButton.prototype,"DDButton");var DDImage=function(){function e(e,t){void 0===t&&(t=""),this.mTarget=e,""!=t&&(this.imgName=t)}return Object.defineProperty(e.prototype,"source",{set:function(e){this.mTarget.source=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imgName",{set:function(e){""!=e&&(this.mImgName=e,RES.getResAsync(this.mImgName,this.imgLoaded,this))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visible",{set:function(e){this.mTarget.visible=e},enumerable:!0,configurable:!0}),e.prototype.imgLoaded=function(e,t){this.mTarget.texture=e},e.prototype.dispose=function(){},e}();__reflect(DDImage.prototype,"DDImage");var DDMovieClip=function(e){function t(t,i,n,o){void 0===i&&(i=1),void 0===n&&(n=!0),void 0===o&&(o=!0);var r=e.call(this)||this;return r.texture=null,r.isAutoPlay=!1,r.isNeedRemove=!1,r.stopFrame=1,r.mRepeatCount=i,r.addEventListener(egret.Event.REMOVED_FROM_STAGE,r.onRemoved,r),r.mMcName=t,r.isAutoPlay=n,r.isNeedRemove=o,r.loadMc(t),r}return __extends(t,e),t.prototype.gotoAndStop=function(t){this.stopFrame=t,this.texture&&e.prototype.gotoAndStop.call(this,t)},t.prototype.loadMc=function(e){var t=this;RES.getResAsync(e+"_json",function(i,n){t.data=i,RES.getResAsync(e+"_png",function(e,i){t.texture=e,t.isAutoPlay?t.playMc():t.gotoAndStop(t.stopFrame)},this)},this)},t.prototype.playMc=function(){var e=new egret.MovieClipDataFactory(this.data,this.texture);this.movieClipData=e.generateMovieClipData(this.mMcName),this.gotoAndPlay(0,this.mRepeatCount),1==this.mRepeatCount&&this.addEventListener(egret.Event.COMPLETE,this.onPlayEnd,this)},t.prototype.onPlayEnd=function(e){this.isNeedRemove&&UIUtil.removeChildFromParent(this)},t.prototype.onRemoved=function(e){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this),this.hasEventListener(egret.Event.COMPLETE)&&this.removeEventListener(egret.Event.COMPLETE,this.onPlayEnd,this)},t}(egret.MovieClip);__reflect(DDMovieClip.prototype,"DDMovieClip");var DDProgressBar=function(){function e(e){this.mRealValue=-1,this.stepType=0,this.stepIndex=0,this.mCurrentTweenValue=0,this.mTarget=e,this.mTarget.slideDuration=0}return e.prototype.initValue=function(e,t){this.mTarget.maximum=t,this.mTarget.value=e},Object.defineProperty(e.prototype,"value",{get:function(){return this.mTarget.value},set:function(e){log("value:"+e+"..............."),null!=this.mCurrentTween&&this.mCurrentTween.kill(),this.mCurrentTween=TweenMax.to(this.mTarget,.4,{value:e,onUpdate:this.onUpdate.bind(this),onComplete:this.onTweenValueComplete,onCompleteScope:this})},enumerable:!0,configurable:!0}),e.prototype.onUpdate=function(){if(0!=this.stepType){var e=1*this.mTarget.value/this.mTarget.maximum;1==this.stepType&&(0==this.stepIndex?e>.45&&.75>e&&(this.thumb=RES.getRes("player_hp_bar_orange"),this.stepIndex=1):1==this.stepIndex&&.45>=e&&(this.thumb=RES.getRes("player_hp_bar_red"),this.stepIndex=2))}},Object.defineProperty(e.prototype,"maxValue",{set:function(e){this.mTarget.maximum=e},enumerable:!0,configurable:!0}),e.prototype.onTweenValueComplete=function(){this.mCurrentTween=null},Object.defineProperty(e.prototype,"thumb",{set:function(e){var t=this.mTarget.thumb;t.texture=e},enumerable:!0,configurable:!0}),e}();__reflect(DDProgressBar.prototype,"DDProgressBar");var DDZoomEffect=function(){function e(e){this.mMaxScale=1.2,this.mRepeatCount=-1,this.dis=e,this.zoom()}return Object.defineProperty(e.prototype,"maxScale",{set:function(e){this.mMaxScale=e,this.zoom(this.mRepeatCount,this.mMaxScale)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"repeatCount",{set:function(e){this.mRepeatCount=e,this.zoom(this.mRepeatCount,this.mMaxScale)},enumerable:!0,configurable:!0}),e.prototype.zoom=function(e,t){void 0===e&&(e=-1),void 0===t&&(t=1.2),TweenMax.killTweensOf(this.dis),TweenMax.to(this.dis,.3,{repeat:-1,scaleX:t,scaleY:t,yoyo:!0})},Object.defineProperty(e.prototype,"visible",{set:function(e){this.dis.visible=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x",{set:function(e){this.dis.x=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{set:function(e){this.dis.y=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{set:function(e){this.dis.rotation=e},enumerable:!0,configurable:!0}),e}();__reflect(DDZoomEffect.prototype,"DDZoomEffect");var HTMLText=function(){function e(){this._fontSize=40;var e=document.getElementById("gameDiv");this.p=document.createElement("p"),e.appendChild(this.p),this.p.style.border="0px",this.p.style.backgroundColor="transparent",this.p.style.fontSize=this.fontSize+"px",this.p.style.display="none",this.p.style.color="#000000",this.p.style.backgroundColor="#cccccc",this.p.style.textAlign="center",this.p.style.width=document.body.clientWidth+"px",this.p.style.height=document.body.clientHeight+"px",this.p.style.lineHeight=this.p.style.height}return Object.defineProperty(e.prototype,"fontColor",{set:function(e){this.p.style.color=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontFamily",{set:function(e){this.p.style.fontFamily=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return this._fontSize},set:function(e){this._fontSize=e,this.p.style.fontSize=this._fontSize+"px"},enumerable:!0,configurable:!0}),e.prototype.setValue=function(e){this.p.style.display="inline",this.p.innerHTML=e},e.prototype.setPosition=function(e,t,i,n){document.body.clientWidth/Game.stage.stageWidth,document.body.clientHeight/Game.stage.stageHeight;this.p.style.display="inline"},e.prototype.show=function(){this.p&&(this.p.style.display="inline")},e.prototype.hide=function(){this.p&&(this.p.style.display="none")},e}();__reflect(HTMLText.prototype,"HTMLText");var ResizeManager=function(){function e(){this.resizes=new Array}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.add=function(e){this.resizes.push(e)},e.prototype.update=function(){for(var e=0,t=this.resizes.length;t>e;e++)this.resizes[e].resize()},e._ins=null,e}();__reflect(ResizeManager.prototype,"ResizeManager");var GamePlatform=function(){function e(){this.payData=null,window.gamePlatform=this}return Object.defineProperty(e,"ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.isLocal=function(){return this.sdk.isLocal},e.prototype.showAlert=function(e,t){Alert.ins.showAlert(e,t)},e.prototype.getOpenId=function(t){this.getPlatName()==e.SHENGTIAN_IOS?this.sdk.getOpenIdForSTIOS(t,null):this.sdk.getOpenId(t,null)},e.prototype.canRecharge=function(){return this.sdk.canRecharge()},e.prototype.levelUp=function(e){this.sdk.levelUp(e)},Object.defineProperty(e.prototype,"isInitSDK",{get:function(){return this.sdk.sdkInited},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDebug",{get:function(){return"debug"==this.channelName},enumerable:!0,configurable:!0}),e.prototype.showTopShare=function(){GameUIUtil.showMainShare()},e.prototype.getServerInfo=function(e,t){this.sdk.getServerInfo(e,t)},e.prototype.getServerList=function(e,t){this.sdk.getServerList(e,t)},e.prototype.setServerData=function(e){this.serverVo=e,this.sdk.currServer=e,this.sdk.serverId=this.serverVo.serverId},e.prototype.setLoginServer=function(e){this.sdk.setLoginServer()},e.prototype.savePlayerData=function(e){this.sdk.playerData={},this.sdk.playerData.serverId=e.serverId,this.sdk.playerData.name=e.name,this.sdk.playerData.level=e.level,this.sdk.playerData.gold=e.gold,this.sdk.playerData.roleId=e.id,this.sdk.playerData.fighting=e.fightingForce,this.sdk.playerData.campName=GameUtil.getCampName(e.camp)},e.prototype.loginComplete=function(e){void 0===e&&(e=!1),this.sdk.isNewUser=e,this.sdk.loginComplete()},e.prototype.getPlatName=function(){return Global.isH5?this.sdk.platformId:"debug"},Object.defineProperty(e.prototype,"channelName",{get:function(){return Global.isH5?this.sdk.channel:e.DEBUG},enumerable:!0,configurable:!0}),e.prototype.getLoginParams=function(){var e=this.sdk.getLoginParams();return e.pf=this.getPlatName(),e.openid=this.sdk.openId,e},Object.defineProperty(e.prototype,"sdk",{get:function(){return window.SDK},enumerable:!0,configurable:!0}),e.prototype.getProp=function(e){return window[e]},e.prototype.getResPath=function(){if(!Global.isH5)return"";var e=this.getProp("cdn_path")+"res/"+this.getProp("res_ver")+"/";return e},e.prototype.hasShortCut=function(){return this.sdk.hasShortCut},Object.defineProperty(e.prototype,"isHttps",{get:function(){return this.sdk.isHttps},enumerable:!0,configurable:!0}),e.prototype.getCurrency=function(e){return this.sdk.getCurrency(e)},e.prototype.getLogoName=function(){return"game_logo_"+window.game_logo},Object.defineProperty(e.prototype,"canLiBao",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canShare",{get:function(){return this.sdk.canShare},enumerable:!0,configurable:!0}),e.prototype.setShareCallback=function(e,t){this.sdk.setShareCallback(e,t)},e.prototype.setFollowCallback=function(e,t){this.sdk.setFollowCallback(e,t)},e.prototype.shortCut=function(){this.sdk.shortCut()},e.prototype.setShortCutCallback=function(e,t){this.sdk.setShortCutCallback(e,t)},e.prototype.share=function(e){void 0===e&&(e=null),this.sdk.share(e)},Object.defineProperty(e.prototype,"canFollow",{get:function(){return this.sdk.canFollow},enumerable:!0,configurable:!0}),e.prototype.follow=function(){this.sdk.follow()},Object.defineProperty(e.prototype,"canShowGM",{get:function(){return"debug"==this.sdk.platformId},enumerable:!0,configurable:!0}),e.prototype.getShareConfig=function(){var e=MetaConfigManager.ins.getConfigForAll("share_1758"),t=MetaConfigManager.ins.getConfigForAll("invited_1758");return{share:e,invated:t}},e.prototype.onGetShenTianOrder=function(e){LoadingIcon.instance.hide();var t=(e.dataVo,this.payData);t.dataVo=e.dataVo;var i=this.sdk.getPayParams(t);this.sdk.pay(i)},e.prototype.onWanbaPay=function(e){LoadingIcon.instance.hide();var t=e.dataVo.id;return log("result:"+t),1!=t?void Alert.ins.showAlert(AlertType.ERROR,"购买失败!"):void 0},e.prototype.payForWanBa=function(){LoadingIcon.instance.show();var e=this.sdk.getPayParams(this.payData);e.cmd=BookCmd.PLAT_WANBA_PAY,Game.net.sendData(e,this.onWanbaPay,this)},e.prototype.onGetWanBaXB=function(e){LoadingIcon.instance.hide();var t=e.dataVo.id,i=10*this.payData.cost;if(log("获取到的星币数量:"+t+",需要星币数量:"+i),t>=i){var n=new Array;n.push({text:"确认购买"+this.payData.gold+"元宝?"}),GameUIUtil.showAlertTip(n,this.payForWanBa,this,null,!0)}else{var o=this.sdk.getPayParams(this.payData);this.sdk.pay(o)}},e.prototype.getWanBaXB=function(){LoadingIcon.instance.show();var e=this.sdk.getPayParams(this.payData);e.cmd=BookCmd.PLAT_WANBA_GET_XINGBI,Game.net.sendData(e,this.onGetWanBaXB,this)},e.prototype.showPayStatus=function(e){Alert.ins.showAlert(AlertType.NORMAL,e)},e.prototype.getGoodsId=function(e){return this.sdk.getGoodsId(e)},e.prototype.pay=function(t,i,n){if(this.payCallBack=i,this.payCallBackTarget=n,this.sdk.setPayCallback(this.showPayStatus,this),this.payData=t,"shengtian"==this.getPlatName())return LoadingIcon.instance.show(),void Game.net.sendData({cmd:BookCmd.PLAT_SHENGTIAN_PAY,goodsId:t.goodsId},this.onGetShenTianOrder,this);if(this.getPlatName()==e.WAN_BA)return void this.getWanBaXB();if(this.getPlatName()==e.SHENGTIAN_IOS)return LoadingIcon.instance.show(),void Game.net.sendData({cmd:BookCmd.PLAT_SHENGTINA_IOS_PAY,goodsId:t.goodsId},this.onGetShenTianOrder,this);if(this.sdk.needGetOrder){LoadingIcon.instance.show();var o=this.sdk.getPayOrderParams(t);o.pf=this.sdk.platformId,o.goodsId=t.goodsId,o.cmd=BookCmd.PLAT_GET_RECHARGE_ORDER,Game.net.sendData(o,this.sureGetOrderId,this)}else{var r=this.sdk.getPayParams(t);this.sdk.pay(r)}},e.prototype.sureGetOrderId=function(e){LoadingIcon.instance.hide();var t=this.payData;t.playerName=PlayerVoManager.ins.playerVo.name,t.serverId=this.serverVo.serverId,t.result=e.dataVo.result;var i=this.sdk.getPayParams(t);this.sdk.pay(i)},e.prototype.sureRecharge=function(e){this.payCallBack&&this.payCallBack.call(this.payCallBackTarget,[e.id,e.str])},e.prototype.reload=function(){this.sdk.reload()},e.prototype.setOpenId=function(e){this.sdk.openId=e},e.prototype.getCSInfo=function(){return Global.isH5?{qq:this.sdk.csInfo,name:this.sdk.csName,des:this.sdk.csDes}:""},e.prototype.getArgStr=function(e){var t="";if(e){for(var i in e)t+=i+"="+e[i]+"&";t=t.slice(0,t.length-1)}return t},e.DEBUG="debug",e.ZHANG_MENG="plat_zhangmeng",e.WAN_BA="wanba_ts",e.SHENGTIAN_IOS="shengtian_ios",e._ins=null,e}();__reflect(GamePlatform.prototype,"GamePlatform");